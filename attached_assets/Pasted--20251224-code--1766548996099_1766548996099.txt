------------------------------------------
20251224. 修復支付方式歸類邏輯

不要寫code，請根據我的回覆更新提案。提案時請專注解決當前發生的問題就好，不需要優化、強化、驗證、監測、測試等手段，除了列出原因之外也請你提出insight。

基於您的澄清，我現在完全理解問題了。讓我重新梳理並更新提案：
A. 快速摘要（≤3句）
•	問題核心：用戶未輸入支付方式時，系統應該直接使用預設的「信用卡」完成記帳，但現在卻觸發支付方式歧義消除流程，顯示「檢測到未知支付方式『刷卡』」
•	根本原因：LBK_handleClassificationPostback函數中硬編碼了錯誤的fallback值「刷卡」，導致系統誤認為用戶輸入了不存在的支付方式
•	業務邏輯違反：用戶未輸入支付方式時不應該觸發歧義消除，應該無縫使用預設信用卡完成記帳

B. Root causes（最多 6 條）
1.	LBK_handleClassificationPostback函數硬編碼錯誤的fallback值
•	證據: paymentMethodName = '刷卡'; 硬編碼在科目歧義消除完成後的支付方式處理邏輯中
•	發生機率: 100%（當科目歧義消除後paymentMethod為null時）
•	解決方案: 將硬編碼「刷卡」改為「信用卡」，並確保這個值能在wallets子集合中找到
=>我記得LBK模組內還有其它函數也有hard coding預設支付方式為信用卡，請你盤點是哪個函數，並且列出有哪些函數也需要預設支付方式為信用卡的邏輯，然後統一該邏輯。



•	Insight: 就像客服人員在客戶沒說話時，錯誤地假設客戶說了「A方案」而非預設的「B方案」，導致不必要的確認流程



2.	支付方式存在性檢查邏輯錯誤
•	證據: 系統將fallback的「刷卡」當作用戶輸入，然後在wallets子集合中找不到「刷卡」，觸發歧義消除
•	發生機率: 100%（當使用硬編碼「刷卡」時）
•	解決方案: 當paymentMethod為null時，直接使用預設「信用卡」，跳過wallets存在性檢查
•	Insight: 系統把「內部預設值」錯誤地當作「用戶輸入」來驗證，就像把公司內部代號拿去問客戶是否認識


3.	用戶未輸入與用戶輸入未知內容的邏輯混淆
•	證據: null值被錯誤處理為需要歧義消除的情況
•	發生機率: 100%（當用戶未輸入支付方式時）
•	解決方案: 明確區分null（未輸入）和有值但未識別（需要歧義消除）兩種情況
•	Insight: 系統無法區分「客戶沒說話」和「客戶說了聽不懂的話」，都當作後者處理


4.	0302配置檔案格式錯誤導致預設值查詢失敗
•	證據: SyntaxError: Unexpected token '/' 導致動態查詢預設支付方式失敗
•	發生機率: 100%（配置讀取失敗時）
•	解決方案: 修正0302配置檔案JSON格式，移除JavaScript註釋
•	Insight: 配置文件損壞時，系統應該有可靠的備用機制，而非依賴硬編碼

5.	LBK_parseInputFormat函數中的銀行名稱硬編碼列表
•	證據: 35個銀行名稱的硬編碼陣列違反了0098文件第1.3條規範
•	發生機率: 100%（當檢查支付方式時）
•	解決方案: 刪除硬編碼列表，改為動態查詢wallets子集合synonyms
•	Insight: 硬編碼列表就像把所有可能的客戶名字寫死在程式裡，無法適應實際業務變化

6.	預設支付方式處理邏輯不統一
•	證據: 不同流程使用不同的預設值（「刷卡」vs「信用卡」vs「現金」）
•	發生機率: 100%
•	解決方案: 統一所有流程都使用「信用卡」作為預設值，並確保該值在用戶wallets中存在
•	Insight: 就像公司不同部門對同一個政策有不同理解，導致客戶體驗不一致

解決方案分階段實施計畫
階段一：修復0302配置檔案格式
•	目標: 讓0302配置檔案能正常被JSON.parse解析
•	修改檔案: 03. Default_config/0302. Default_wallet.json
•	修改內容: 移除JavaScript註釋，確保JSON格式正確，設定信用卡為預設
=>請刪除，這我已經手動修好了


階段二：修正科目歧義消除後的支付方式處理邏輯
•	目標: 用戶未輸入支付方式時直接使用預設信用卡，不觸發歧義消除
•	修改檔案: 13. Replit_Module code_BL/1315. LBK.js
•	修改內容:
i.	LBK_handleClassificationPostback函數中，當paymentMethod為null時，直接使用「信用卡」完成記帳
ii.	刪除硬編碼「刷卡」的fallback邏輯
iii.	版本升級至v1.9.1
•	Before/After行為差異:
o	Before: 用戶輸入「漢堡2222」→ 科目歧義消除 → 觸發「檢測到未知支付方式『刷卡』」
o	After: 用戶輸入「漢堡2222」→ 科目歧義消除 → 直接完成記帳（支付方式：信用卡）

階段三：移除LBK_parseInputFormat中的硬編碼列表
•	目標: 移除所有硬編碼的銀行名稱和支付方式列表
•	修改檔案: 13. Replit_Module code_BL/1315. LBK.js
•	修改內容: 刪除35個銀行名稱的硬編碼陣列，改為純粹的「未輸入=null，有輸入=查詢synonyms」邏輯
•	影響範圍: 只影響支付方式解析邏輯，不影響其他功能
關鍵Insight: 問題的核心不在於技術實現，而在於業務邏輯理解。系統錯誤地將「內部處理邏輯」暴露給用戶，把應該無縫處理的預設情況變成了需要用戶干預的歧義消除流程。這就像ATM機器在用戶只想查餘額時，卻跳出「請選擇您要查詢哪種餘額」的不必要選項。

