------------------------------------------
20251113. 通過SIT_P2(7571)_協作功能

不要寫code，請根據我的回覆更新提案。現在是MVP階段，提案時請專注解決當前發生的問題就好，不需要優化、強化、驗證、監測、測試等手段，除了列出原因之外也請你提出insight。

根據您的分析，我以資深SA身份更新提案。確實，問題的根本在於7571測試模組違反了0098憲法規範，而7303模組本身應該已經具備完整的協作功能。

🔍 更新後的問題分析
核心洞察
您的判斷完全正確 - 7303模組作為帳本協作功能群，理論上應該已經具備完整的協作管理方法。問題出在7571測試模組自創了不存在的API介面，違反了0098憲法第8條「禁止自創8020文件中沒有的API端點」。
0098規範違反詳細清單（以測試案例為主）

第4條違規：模擬業務邏輯
違規測試案例：
•	TC-009: 7571自行判斷協作帳本創建是否成功，包含if (response.success && response.data != null)的業務判斷
•	TC-010-020: 每個測試都有if (currentCollaborationId != null)的業務邏輯判斷
•	所有TC: 7571自行決定plResult = {'success': true/false}而非直接回傳PL層結果

第3條違規：Hard Coding
違規測試案例：
•	TC-009: 'collaboration.test@test.lcas.app' - 硬編碼測試email
=>email要引用7598的collaboration.test@test.lcas.app才對

•	TC-009: '協作帳本測試_${DateTime.now().millisecondsSinceEpoch}' - 硬編碼名稱格式
•	TC-014: 'user_collaboration_test_1697363500000' - 硬編碼協作測試用戶ID
=>使用者ID要去調用業務邏輯的狀態管理函數取得使用者ID，應該是在CM模組，但PL 7303也應該要做一個。但話說回來，應該是要PL去call CM讓CM去firebase查詢使用者ID才對。請評估現在狀況與我的提案

•	TC-015: role: 'admin' - 硬編碼權限角色
=>此項應該在7598 hard coding一個權限角色讓7571去引用

•	TC-016-018: 多處硬編碼用戶ID如'user_expert_1697363200000'
=>使用者ID要去調用業務邏輯的狀態管理函數取得使用者ID，應該是在CM模組，但PL 7303也應該要做一個。但話說回來，應該是要PL去call CM讓CM去firebase查詢使用者ID才對。請評估現在狀況與我的提案

第9條違規：測試代碼修改業務邏輯
違規測試案例：
•	TC-013: 調用不存在的processCollaboratorList方法
•	TC-014: 傳遞7303不支援的permissions參數給PermissionData建構函式
•	TC-019: 調用callAPI時傳遞不存在的queryParams參數
•	TC-020: 調用不存在的validateLedgerData方法


第11條違規：業務邏輯引用測試資料
違規測試案例：
•	TC-009到TC-020: 7571通過_dynamicCollaborationId變數管理狀態，強迫7303適應此測試邏輯
•	InvitationData類別: 測試需求反向定義了業務邏輯的資料結構

🎯 修正後的解決方案提案
階段一：檢查並確認7303現有API（預計1小時）
目標：確認7303模組現有的協作功能介面
實施計畫：
1.	修改檔案：無需修改，僅檢查現況
2.	檢查內容：
•	確認7303是否已有查詢協作者列表的方法
•	確認PermissionData建構函式的正確參數
•	確認API調用方法的正確參數格式
•	確認資料驗證方法是否存在

階段二：修正7571測試模組符合0098規範（預計3小時）
目標：完全移除違規代碼，實現純粹調用模式
實施計畫：
1.	修改檔案：75. Flutter_Test_code_PL/7571. SIT_P2.dart
2.	版本升級：7571模組 v2.5.0 → v3.0.0
3.	修改內容：
•	移除所有模擬業務邏輯：刪除所有if判斷，直接回傳PL層結果
•	移除所有硬編碼：改為從7598 Data warehouse.json載入所有測試資料
•	使用7303現有方法：調用正確的方法名稱和參數
•	移除狀態管理：刪除_dynamicCollaborationId，改用PL層提供的查詢方法
Before/After行為差異：
•	Before: 7571包含業務邏輯判斷、硬編碼資料、自創API介面