=>ä»¥ä¸‹æ–¹æ¡ˆè«‹æ•´åˆæˆä¸€å€‹ä¸‰éšæ®µè§£æ±ºæ–¹æ¡ˆ


åŸºæ–¼æ‚¨çš„å›è¦†å’Œ7306æ¨¡çµ„é•å0098æ†²æ³•çš„å•é¡Œåˆ†æï¼Œæˆ‘æå‡ºä»¥ä¸‹æ•´åˆè§£æ±ºæ–¹æ¡ˆï¼š

ğŸ¯ 7306æ¨¡çµ„0098æ†²æ³•é•è¦æ•´åˆè§£æ±ºæ–¹æ¡ˆ
å•é¡Œåˆ†æèˆ‡Insight
æ ¸å¿ƒå•é¡Œ: 7306æ¨¡çµ„ç‚ºäº†å¿«é€Ÿé–‹ç™¼MVPï¼Œæ¡ç”¨äº†å¤§é‡ç¡¬ç·¨ç¢¼å’ŒMockå¯¦ä½œï¼Œé€™é•èƒŒäº†ç³»çµ±æ¶æ§‹çš„åŸºæœ¬åŸå‰‡ã€‚
é—œéµInsight:
â€¢	ç¡¬ç·¨ç¢¼å•é¡Œæºæ–¼ç¼ºä¹çµ±ä¸€çš„é…ç½®ç®¡ç†æ©Ÿåˆ¶
â€¢	APIç«¯é»å•é¡Œåæ˜ äº†å°8020è¦ç¯„çš„å¿½è¦–
â€¢	Mockå¯¦ä½œå•é¡Œé¡¯ç¤ºäº†å°æ¥­å‹™é‚è¼¯å®Œæ•´æ€§çš„å¦¥å”

1. ç¡¬ç·¨ç¢¼å•é¡Œè§£æ±ºæ–¹æ¡ˆ
1.1 APIåŸºç¤URLé…ç½®æ–¹æ¡ˆ
å»ºè­°: æ˜¯çš„ï¼ŒAPIåŸºç¤URLæ‡‰è©²å­˜æ”¾åœ¨Replit Secretsä¸­æ–¹ä¾¿æ¨¡çµ„èª¿ç”¨
å¯¦æ–½æ–¹æ¡ˆ:
class ConfigManager {
  static String? _baseUrl;

  static String get baseUrl {
    return _baseUrl ?? 'http://0.0.0.0:3000/api/v1'; // fallback
  }

  static void initFromEnvironment() {
    // å¾ç’°å¢ƒè®Šæ•¸æˆ–Secretsè®€å–
    _baseUrl = const String.fromEnvironment('API_BASE_URL');
  }
}

Replit Secretsè¨­å®š:
â€¢	Key: API_BASE_URL
â€¢	Value: http://0.0.0.0:3000/api/v1

1.2 HTTPæ¨™é ­å‹•æ…‹é…ç½®æ–¹æ¡ˆ
class HttpConfig {
  static Map<String, String> getHeaders({Map<String, String>? additional}) {
    final baseHeaders = <String, String>{
      'Content-Type': const String.fromEnvironment('HTTP_CONTENT_TYPE', defaultValue: 'application/json'),
      'Accept': const String.fromEnvironment('HTTP_ACCEPT', defaultValue: 'application/json'),
    };

    if (additional != null) {
      baseHeaders.addAll(additional);
    }

    return baseHeaders;
  }
}

2. æšèˆ‰å€¼é…ç½®è§£æ±ºæ–¹æ¡ˆ
ç”±æ–¼ç›®å‰ç¼ºä¹æšèˆ‰å€¼é…ç½®ç³»çµ±ï¼Œå»ºè­°å»ºç«‹åŸºæœ¬é…ç½®æ–‡ä»¶ï¼š
class DataConfig {
  static const Map<String, List<String>> _enumConfigs = {
    'walletTypes': ['cash', 'bank', 'credit', 'ewallet'],
    'categoryTypes': ['income', 'expense', 'transfer'],
    'currencies': ['TWD', 'USD', 'CNY', 'EUR', 'JPY', 'HKD', 'SGD'],
  };

  static List<String> getValidValues(String type) {
    return _enumConfigs[type] ?? [];
  }
}

3. APIç«¯é»è¦ç¯„å°é½Šæ–¹æ¡ˆ
å•é¡Œ: ç•¶å‰ä½¿ç”¨çš„ç«¯é»éœ€è¦èˆ‡8020æ–‡ä»¶å°é½Š
è§£æ±ºæ–¹æ¡ˆ: å»ºç«‹APIç«¯é»å¸¸æ•¸é¡
class ApiEndpoints {
  static const String accounts = '/api/v1/accounts';
  static const String categories = '/api/v1/categories';

  static String accountsList(String ledgerId) => '$accounts?ledgerId=$ledgerId';
  static String accountDetail(String walletId) => '$accounts/$walletId';
  static String accountBalance(String walletId) => '$accounts/$walletId/balance';
  static String categoriesList(String ledgerId) => '$categories?ledgerId=$ledgerId';
  static String categoryDetail(String categoryId) => '$categories/$categoryId';
}

4. Mockå¯¦ä½œç§»é™¤æ–¹æ¡ˆ
å•é¡Œ: validateCategoryHierarchyå‡½æ•¸ä½¿ç”¨Mockå¯¦ä½œ
è§£æ±ºæ–¹æ¡ˆ: å¯¦ä½œåŸºæœ¬æ¥­å‹™é‚è¼¯é©—è­‰
static bool validateCategoryHierarchy(String parentId, String categoryType) {
  // åŸºæœ¬åƒæ•¸é©—è­‰
  if (parentId.isEmpty || categoryType.isEmpty) return false;

  // é©—è­‰ç§‘ç›®é¡å‹åˆæ³•æ€§
  if (!DataConfig.getValidValues('categoryTypes').contains(categoryType)) {
    return false;
  }

  // åŸºæœ¬IDæ ¼å¼é©—è­‰
  if (!RegExp(r'^[a-zA-Z0-9\-_]+$').hasMatch(parentId)) {
    return false;
  }

  return true;
}

5. æ™‚å€è™•ç†è§£æ±ºæ–¹æ¡ˆ
class DateTimeHelper {
  static DateTime nowInTaiwanTime() {
    final utcNow = DateTime.now().toUtc();
    return utcNow.add(const Duration(hours: 8)); // UTC+8
  }

  static String toIso8601StringTW() {
    return nowInTaiwanTime().toIso8601String();
  }
}

6. ä¿®æ­£å„ªå…ˆç´šå»ºè­°
é«˜å„ªå…ˆç´šï¼ˆç«‹å³ä¿®æ­£ï¼‰:
1.	ç§»é™¤APIåŸºç¤URLç¡¬ç·¨ç¢¼
2.	å°é½Š8020 APIç«¯é»è¦ç¯„
3.	ç§»é™¤Mockå¯¦ä½œ
ä¸­å„ªå…ˆç´šï¼ˆéšæ®µå®Œæˆå¾Œä¿®æ­£ï¼‰:
1.	å¯¦ä½œå‹•æ…‹é…ç½®ç³»çµ±
2.	çµ±ä¸€æ™‚å€è™•ç†
3.	å®Œå–„è³‡æ–™é©—è­‰é‚è¼¯
Insight: MVPéšæ®µæ‡‰è©²å°ˆæ³¨æ–¼ç§»é™¤é•è¦é …ç›®ï¼Œè€Œéå»ºç«‹å®Œæ•´çš„é…ç½®ç³»çµ±ã€‚å„ªå…ˆè§£æ±ºç¡¬ç·¨ç¢¼å’ŒMockå¯¦ä½œå•é¡Œï¼Œç¢ºä¿ä»£ç¢¼ç¬¦åˆåŸºæœ¬è¦ç¯„ã€‚
é€™å€‹è§£æ±ºæ–¹æ¡ˆå°ˆæ³¨æ–¼è§£æ±ºç•¶å‰é•è¦å•é¡Œï¼Œé¿å…éåº¦å·¥ç¨‹ï¼Œç¬¦åˆMVPéšæ®µçš„é–‹ç™¼åŸå‰‡ã€‚