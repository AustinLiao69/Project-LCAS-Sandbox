
# 8736. 協作功能群組_SRS

**文件編號**: 8736-SRS-GROUP  
**版本**: v2.1.0  
**建立日期**: 2025-08-07  
**建立者**: LCAS SA Team  
**最後更新**: 2025-01-27

---

## 目次

1. [群組概述](#1-群組概述)
2. [頁面功能總覽](#2-頁面功能總覽)
3. [API端點對照表](#3-api端點對照表)
4. [功能目的](#4-功能目的)
5. [使用者故事](#5-使用者故事)
6. [前置條件](#6-前置條件)
7. [功能流程](#7-功能流程)
8. [輸入項目](#8-輸入項目)
9. [輸出項目](#9-輸出項目)
10. [驗證規則](#10-驗證規則)
11. [錯誤處理](#11-錯誤處理)
12. [UI元件與排版需求](#12-ui元件與排版需求)
13. [頁面詳細規格](#13-頁面詳細規格)
14. [整合驗收標準](#14-整合驗收標準)
15. [版本記錄](#15-版本記錄)

---

## 1. 群組概述

### 1.1 群組定位
協作功能群組是LCAS 2.0 Flutter應用程式的**多人協作視覺介面中心**，提供完整的共享帳本建立、成員管理、即時同步、權限控制等協作功能的**視覺設計需求**，支援家庭、團隊、專案等多場景的協作記帳視覺化體驗。

### 1.2 群組範圍
本群組整合以下10個協作功能頁面的視覺設計規格：
- **P036 協作中心頁面**：協作功能總覽控制台的視覺化設計
- **P037 建立共享帳本**：新建多人協作帳本的視覺引導
- **P038 協作成員管理**：協作團隊成員管理的視覺介面
- **P039 即時協作頁面**：即時協作同步監控的視覺化
- **P040 協作邀請頁面**：發送協作邀請功能的視覺設計
- **P041 協作歷史頁面**：協作操作歷史記錄的視覺呈現
- **P042 衝突解決頁面**：處理協作資料衝突的視覺化
- **P043 協作設定頁面**：協作環境參數設定的視覺介面
- **P044 成員活動頁面**：成員活動狀態監控的視覺設計
- **P045 協作權限頁面**：協作權限檢視管理的視覺系統

### 1.3 視覺設計原則
- **即時協作視覺化**：清晰的即時同步狀態與成員活動視覺指示
- **多層級權限視覺區分**：明確的權限等級與操作權限視覺化
- **衝突解決視覺引導**：直觀的衝突檢測與解決流程視覺設計
- **四模式差異化視覺**：針對不同使用者模式提供適配的協作視覺體驗

---

## 2. 頁面功能總覽

| 頁面編號 | 頁面名稱 | 主要視覺功能 | 四模式差異重點 | 使用頻率 |
|----------|----------|-------------|----------------|----------|
| **P036** | 協作中心頁面 | 協作總覽儀表板、狀態監控視覺化、快速導航 | 資訊密度與管理複雜度 | 高 |
| **P037** | 建立共享帳本 | 協作類型選擇器、設定表單、規則配置界面 | 設定選項完整度與引導 | 中 |
| **P038** | 協作成員管理 | 成員列表卡片、權限設定界面、活動監控 | 管理功能複雜度 | 中 |
| **P039** | 即時協作頁面 | 即時同步指示器、成員活動視覺化、衝突警示 | 即時資訊詳細度 | 高 |
| **P040** | 協作邀請頁面 | 邀請方式選擇器、聯絡人選擇、分享介面 | 邀請選項多樣性 | 中 |
| **P041** | 協作歷史頁面 | 時間軸視覺化、操作記錄列表、篩選界面 | 歷史記錄詳細度 | 低 |
| **P042** | 衝突解決頁面 | 衝突對比界面、解決方案選擇器、合併預覽 | 衝突處理複雜度 | 低 |
| **P043** | 協作設定頁面 | 設定分類卡片、開關控制器、規則配置 | 設定選項完整度 | 低 |
| **P044** | 成員活動頁面 | 活動時間軸、狀態指示器、行為統計圖 | 監控資訊詳細度 | 中 |
| **P045** | 協作權限頁面 | 權限矩陣表格、角色切換器、權限說明 | 權限顯示詳細度 | 低 |

### 2.1 群組視覺流程關係圖
```
P036 協作中心頁面 (視覺化協作樞紐)
    ↓ 建立協作視覺引導    ↓ 管理成員導航    ↓ 即時監控
P037 建立共享帳本 ←→ P038 協作成員管理 ←→ P039 即時協作
    ↓ 邀請流程        ↓ 權限管理        ↓ 活動追蹤
P040 協作邀請 ←→ P045 協作權限 ←→ P044 成員活動
    ↓                ↓                ↓ 衝突處理
P043 協作設定 ←→ P041 協作歷史 ←→ P042 衝突解決
    ↑________________↑________________↑
          整合協作管理與監控視覺化
```

---

## 3. API端點對照表

### 3.1 完整API對應關係（確保按鈕與API連結正確）

| 頁面編號 | 頁面名稱 | 對應API編號 | API路徑 | HTTP方法 | 主要按鈕功能 |
|----------|----------|-------------|---------|----------|-------------|
| **P036** | 協作中心頁面 | **F019** | GET /app/shared/dashboard | GET | 「重新整理」按鈕 |
| **P036** | 協作中心頁面 | **F019** | GET /app/shared/list | GET | 「載入清單」按鈕 |
| **P037** | 建立共享帳本 | **F019** | POST /app/shared/create | POST | 「建立帳本」按鈕 |
| **P037** | 建立共享帳本 | **F019** | GET /app/shared/templates | GET | 「選擇範本」按鈕 |
| **P038** | 協作成員管理 | **F020** | PUT /app/shared/permissions | PUT | 「更新權限」按鈕 |
| **P038** | 協作成員管理 | **F020** | GET /app/shared/members | GET | 「載入成員」按鈕 |
| **P039** | 即時協作頁面 | **F021** | WebSocket /app/sync/realtime | WebSocket | 「連線同步」按鈕 |
| **P039** | 即時協作頁面 | **F021** | GET /app/sync/status | GET | 「檢查狀態」按鈕 |
| **P040** | 協作邀請頁面 | **F019** | POST /app/shared/invite | POST | 「發送邀請」按鈕 |
| **P040** | 協作邀請頁面 | **F019** | GET /app/shared/invite-link | GET | 「生成連結」按鈕 |
| **P041** | 協作歷史頁面 | **F021** | GET /app/sync/history | GET | 「載入歷史」按鈕 |
| **P041** | 協作歷史頁面 | **F021** | GET /app/sync/activity | GET | 「查看活動」按鈕 |
| **P042** | 衝突解決頁面 | **F021** | POST /app/sync/conflict | POST | 「解決衝突」按鈕 |
| **P042** | 衝突解決頁面 | **F021** | GET /app/sync/conflicts | GET | 「檢測衝突」按鈕 |
| **P043** | 協作設定頁面 | **F020** | PUT /app/shared/settings | PUT | 「儲存設定」按鈕 |
| **P043** | 協作設定頁面 | **F020** | GET /app/shared/settings | GET | 「載入設定」按鈕 |
| **P044** | 成員活動頁面 | **F021** | GET /app/sync/activity | GET | 「重新整理」按鈕 |
| **P044** | 成員活動頁面 | **F021** | GET /app/sync/member-status | GET | 「檢查狀態」按鈕 |
| **P045** | 協作權限頁面 | **F020** | GET /app/shared/permissions | GET | 「載入權限」按鈕 |
| **P045** | 協作權限頁面 | **F020** | PUT /app/shared/role-update | PUT | 「更新角色」按鈕 |

---

## 4. 功能目的

### 4.1 群組整體視覺設計目的
協作功能群組作為LCAS 2.0的**多人協作視覺介面中心**，致力於：
- **協作狀態視覺化**：即時顯示協作成員活動與同步狀態
- **權限層級視覺區分**：清晰的權限等級與操作範圍視覺化
- **衝突解決視覺引導**：直觀的衝突檢測與解決流程設計
- **多場景協作視覺支援**：家庭、團隊、專案等不同協作場景的視覺適配

### 4.2 四模式視覺差異化目的

#### 精準控制者模式
- 提供完整的協作管理視覺介面與詳細的權限控制展示
- 顯示豐富的協作統計分析與成員活動監控視覺化
- 支援複雜的衝突解決與精確權限管理機制的視覺呈現

#### 紀錄習慣者模式  
- 打造優雅美觀的協作管理視覺體驗
- 重視視覺化呈現與操作流暢度的美學設計
- 簡化協作設定但保持美學品質的視覺介面

#### 轉型挑戰者模式
- 融入團隊目標與協作激勵的視覺元素
- 提供積極的協作參與回饋與團隊建設機制的視覺化
- 強調協作效率與團隊成就關聯性的視覺設計

#### 潛在覺醒者模式
- 極簡化的協作操作流程與介面視覺設計
- 提供智慧預設值與自動化協作建議的視覺支援
- 降低協作參與門檻，鼓勵協作習慣養成的視覺引導

---

## 5. 使用者故事

### 5.1 核心使用者故事

**作為帳本管理者**，我希望能透過直觀的視覺介面建立共享帳本並邀請成員加入，以便團隊能協作管理財務記錄。

**作為協作成員**，我希望能透過清晰的視覺化介面即時看到其他成員的記帳動態，以便了解最新的財務狀況。

**作為資深使用者**，我希望能透過完整的視覺化控制介面精細控制成員權限，以便確保資料安全和操作規範。

**作為團隊負責人**，我希望能透過豐富的視覺化監控介面追蹤協作歷史和成員活動，以便進行有效的財務管理和監督。

### 5.2 四模式使用者故事

#### 精準控制者 (Controller)
> "作為精準控制者，我希望能透過完整詳細的協作管理視覺介面完全掌控每個協作細節，包括複雜的權限設定視覺化、精確的成員活動監控圖表、詳細的衝突解決儀表板，以及完整的協作資料視覺化展示。"

#### 紀錄習慣者 (Logger)  
> "作為紀錄習慣者，我希望協作管理過程透過美觀且愉悅的視覺設計呈現，有優雅的成員狀態動畫、美麗的協作統計圖表、精緻的邀請卡片設計，讓協作參與成為生活中的美好視覺體驗。"

#### 轉型挑戰者 (Struggler)
> "作為轉型挑戰者，我希望協作功能的視覺設計能幫助團隊實現財務目標，提供明確的團隊進度追蹤視覺化、協作成就的激勵元素，並在團隊達到協作里程碑時給予積極的視覺化鼓勵。"

#### 潛在覺醒者 (Sleeper)
> "作為潛在覺醒者，我希望協作管理功能的視覺設計非常簡單直觀，有智慧的自動協作建議視覺提示，一鍵就能完成協作邀請與參與，不需要複雜的權限設定或衝突處理視覺化。"

---

## 6. 前置條件

### 6.1 視覺設計前置條件
- 已完成9005 Flutter Presentation Layer PRD的設計系統定義
- 四模式色彩與字型系統已建立完成
- 協作管理專用視覺元件庫已準備就緒
- 即時同步狀態指示組件已初始化完成

### 6.2 功能前置條件
- 使用者已成功通過認證流程群組（P001-P005）
- 已完成基本的使用者設定與模式選擇
- 具備協作帳本建立與管理的基本權限
- 相關API端點已就緒並可正常呼叫

---

## 7. 功能流程

### 7.1 主要協作管理視覺流程

#### 7.1.1 建立共享帳本視覺流程（P037）
```
1. 進入建立共享帳本頁面視覺引導
   ├── 顯示協作類型選擇卡片（家庭/團隊/專案/社團）
   ├── 展示帳本設定表單與視覺引導
   ├── 呈現權限規則配置界面
   └── 顯示範本選擇器與預覽

2. 協作類型專屬視覺設定
   ├── 家庭記帳：成員角色卡片、隱私設定視覺化
   ├── 團隊協作：權限矩陣表格、審核流程視覺設定
   └── 專案管理：里程碑關聯卡片、預算控制視覺化

3. 建立確認視覺回饋
   ├── 資料驗證進度條
   ├── 邀請連結生成載入動畫
   ├── 帳本建立成功視覺回饋
   └── 協作啟動狀態指示
```

#### 7.1.2 即時協作同步視覺流程（P039, P044）
```
1. 即時同步狀態視覺化
   ├── 連線狀態指示燈顯示（綠色/黃色/紅色）
   ├── 成員線上狀態視覺元素
   ├── 操作同步進度條呈現
   └── 衝突警示檢查狀態指示

2. 成員活動視覺監控
   ├── 即時活動時間軸顯示
   ├── 成員頭像與狀態視覺回饋
   ├── 操作類型圖示分類呈現
   └── 活動統計圖表視覺化

3. 衝突檢測視覺處理
   ├── 衝突警示視覺元素
   ├── 衝突類型分類圖示顯示
   ├── 解決方案選項卡片
   └── 解決進度視覺追蹤
```

#### 7.1.3 四模式差異化視覺流程

**精準控制者模式視覺特色：**
- **完整管理視覺介面**：提供所有可用的協作管理視覺化功能
- **詳細監控視覺機制**：支援細粒度的成員活動監控設定視覺界面
- **複雜權限展示**：多維度協作權限設定與衝突解決視覺化

**紀錄習慣者模式視覺特色：**
- **優雅操作視覺流程**：重視操作的流暢性與美感的視覺設計
- **美觀引導動畫**：精美的協作步驟指示與狀態顯示動畫
- **簡化管理視覺選項**：隱藏過於技術性的管理，保持視覺簡潔

**轉型挑戰者模式視覺特色：**
- **團隊導向視覺流程**：每個協作操作都與團隊目標達成視覺化相關聯
- **激勵回饋視覺機制**：即時顯示團隊協作進度的視覺元素
- **成就元素視覺整合**：在流程中加入團隊成就與獎勵的視覺化元素

**潛在覺醒者模式視覺特色：**
- **極簡化視覺流程**：最少步驟完成協作管理的簡潔視覺設計
- **智慧預設視覺值**：自動填入合理協作設定的視覺提示
- **一鍵操作視覺**：提供快捷的協作邀請選項大按鈕設計

---

## 8. 輸入項目

### 8.1 群組共通輸入視覺設計

| 輸入類別 | 視覺設計要求 | 四模式差異 | 無障礙需求 |
|----------|-------------|------------|------------|
| **協作基本** | 帳本名稱輸入框：圓角8px，高度56px | 字體大小依模式調整 | 螢幕閱讀器標籤 |
| **協作基本** | 協作類型選擇器：卡片式設計，視覺圖示區分 | 選項數量依模式調整 | 高對比度支援 |
| **協作基本** | 成員數量設定：數字選擇器，即時預覽 | 複雜度依模式調整 | 數字格式語音提示 |
| **協作基本** | 隱私等級選擇：階梯式視覺設計，安全級別圖示 | 潛在覺醒者使用預設值 | 安全等級語音提示 |
| **權限設定** | 權限矩陣：互動式表格，開關控制器 | 精確度依模式調整 | 觸控輔助支援 |
| **權限設定** | 角色分配：拖拉式角色卡片，即時視覺回饋 | 設定詳細度依模式調整 | 角色變化語音播報 |
| **邀請設定** | 邀請方式選擇：多選卡片式設計 | 選項數量依模式調整 | 邀請方式語音確認 |
| **邀請設定** | 聯絡人選擇：搜尋式選擇器，頭像顯示 | 選擇方式依模式調整 | 選擇狀態語音提示 |

---

## 9. 輸出項目

### 9.1 群組共通輸出視覺設計

| 輸出類別 | 視覺呈現方式 | 設計要求 | 四模式差異 |
|----------|-------------|----------|------------|
| **協作資料** | 協作帳本卡片列表：圓角12px，狀態指示燈 | 響應式卡片佈局 | 密度與資訊量依模式調整 |
| **同步狀態** | 即時同步指示器：動畫效果，連線狀態顏色編碼 | 即時狀態更新 | 複雜度依模式調整 |
| **成員資料** | 成員頭像列表：圓形頭像，線上狀態指示 | 清晰的身份識別 | 成員資訊詳細度依模式調整 |
| **活動資料** | 活動時間軸：垂直時間軸設計，操作圖示分類 | 互動式時間軸設計 | 活動詳細度依模式調整 |
| **權限資料** | 權限矩陣表格：視覺化權限等級，顏色分級 | 清晰的權限標示 | 權限詳細程度依模式調整 |
| **衝突資料** | 衝突對比卡片：並排比較設計，差異突出顯示 | 明確的衝突識別 | 解決方案複雜度依模式調整 |
| **邀請資料** | 邀請狀態卡片：進度指示，回應狀態視覺化 | 快速狀態識別 | 邀請詳細度依模式調整 |
| **歷史資料** | 操作記錄列表：時間戳顯示，操作類型圖示 | 專業記錄視覺 | 歷史複雜度依模式調整 |
| **操作回饋** | Toast通知：成功/錯誤顏色區分，自動消失 | 自動消失機制 | 所有模式保持一致 |

---

## 10. 驗證規則

### 10.1 視覺化驗證設計

#### 10.1.1 協作設定驗證視覺回饋
- **即時驗證**：輸入框邊框顏色變化（紅色錯誤、綠色正確）
- **視覺圖示**：輸入框右側顯示驗證狀態圖示
- **錯誤提示**：輸入框下方顯示錯誤訊息，紅色文字

#### 10.1.2 權限設定驗證視覺指示
```css
.collaboration-permission-input {
  border: 2px solid #E0E0E0;
  border-radius: 8px;
  transition: all 0.3s ease;
}

.collaboration-permission-input.valid {
  border-color: #4CAF50;
  background: #E8F5E9;
}

.collaboration-permission-input.invalid {
  border-color: #F44336;
  background: #FFEBEE;
}

.permission-validation-message {
  font-size: 12px;
  margin-top: 4px;
  padding-left: 8px;
}

.permission-validation-message.error {
  color: #F44336;
}

.permission-validation-message.success {
  color: #4CAF50;
}
```

#### 10.1.3 四模式驗證視覺差異

| 模式 | 錯誤提示風格 | 成功指示風格 | 驗證詳細度 |
|----------|-------------|-------------|------------|
| **精準控制者** | 詳細技術說明，錯誤代碼顯示 | 詳細成功狀態報告 | 完整規則說明 |
| **紀錄習慣者** | 優雅的錯誤提示動畫 | 美觀的成功動畫效果 | 平衡的提示資訊 |
| **轉型挑戰者** | 正面鼓勵的錯誤提示 | 積極的成就感回饋 | 團隊導向的提示 |
| **潛在覺醒者** | 簡化的錯誤說明 | 溫和的成功提示 | 基本必要資訊 |

---

## 11. 錯誤處理

### 11.1 錯誤狀態視覺設計

#### 11.1.1 錯誤訊息視覺層級

| 錯誤嚴重度 | 視覺設計 | 顏色方案 | 圖示選擇 | 顯示方式 |
|----------|----------|----------|----------|----------|
| **連線錯誤** | 全屏遮罩對話框 | 紅色系主色調 | 📡 連線圖示 | 模態對話框 |
| **權限衝突** | 頁面頂部警告條 | 橘紅色漸變 | 🔒 權限圖示 | 固定警告條 |
| **資料驗證錯誤** | 輸入框錯誤狀態 | 淺紅色邊框 | ⚠️ 警告圖示 | 內聯提示 |
| **操作成功** | 綠色成功提示 | 綠色系主色調 | ✅ 成功圖示 | Toast通知 |

#### 11.1.2 四模式錯誤處理視覺差異

**精準控制者模式：**
```css
.controller-collaboration-error {
  background: linear-gradient(135deg, #FFEBEE, #FFCDD2);
  border: 1px solid #F44336;
  border-left: 4px solid #D32F2F;
  padding: 16px;
  font-size: 14px;
  line-height: 1.4;
  border-radius: 8px;
}

.collaboration-error-details {
  margin-top: 12px;
  font-size: 12px;
  color: #666;
  font-family: monospace;
  background: #F5F5F5;
  padding: 8px;
  border-radius: 4px;
}
```

**紀錄習慣者模式：**
```css
.logger-collaboration-error {
  background: linear-gradient(135deg, #FFEBEE, #FCE4EC);
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 4px 12px rgba(244, 67, 54, 0.15);
  animation: gentleShake 0.5s ease-in-out;
}

@keyframes gentleShake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}
```

**轉型挑戰者模式：**
```css
.struggler-collaboration-error {
  background: #FFF3E0;
  border: 2px solid #FF9800;
  border-radius: 12px;
  padding: 20px;
  position: relative;
}

.collaboration-motivational-error-icon {
  position: absolute;
  top: -10px;
  right: 16px;
  font-size: 24px;
}

.collaboration-motivational-message {
  color: #E65100;
  font-weight: 600;
  margin-bottom: 8px;
}

.collaboration-motivational-message::before {
  content: "🤝 ";
  margin-right: 8px;
}
```

**潛在覺醒者模式：**
```css
.sleeper-collaboration-error {
  background: #FFEBEE;
  border-radius: 16px;
  padding: 32px;
  text-align: center;
  font-size: 18px;
}

.collaboration-simple-error-icon {
  font-size: 48px;
  margin-bottom: 16px;
  display: block;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}
```

---

## 12. UI元件與排版需求

### 12.1 協作管理專用視覺元件

#### 12.1.1 協作狀態指示器組件設計
```css
/* 即時同步狀態指示器 */
.collaboration-sync-indicator {
  display: inline-flex;
  align-items: center;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 500;
  position: relative;
  transition: all 0.3s ease;
}

.sync-indicator.connected {
  background: linear-gradient(135deg, #4CAF50, #81C784);
  color: white;
  box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
}

.sync-indicator.connecting {
  background: linear-gradient(135deg, #FF9800, #FFB74D);
  color: white;
  animation: pulse 1.5s infinite;
}

.sync-indicator.disconnected {
  background: linear-gradient(135deg, #F44336, #EF5350);
  color: white;
}

.sync-indicator-icon {
  margin-right: 8px;
  font-size: 16px;
}

.sync-indicator.connected .sync-indicator-icon::before {
  content: "🟢";
}

.sync-indicator.connecting .sync-indicator-icon::before {
  content: "🟡";
}

.sync-indicator.disconnected .sync-indicator-icon::before {
  content: "🔴";
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}
```

#### 12.1.2 成員頭像與狀態組件
```css
/* 成員頭像與線上狀態 */
.collaboration-member-avatar {
  position: relative;
  display: inline-block;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  overflow: hidden;
  border: 3px solid #FFFFFF;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.member-avatar-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.member-status-indicator {
  position: absolute;
  bottom: 2px;
  right: 2px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  border: 2px solid #FFFFFF;
}

.member-status-indicator.online {
  background: #4CAF50;
  animation: onlinePulse 2s infinite;
}

.member-status-indicator.away {
  background: #FF9800;
}

.member-status-indicator.offline {
  background: #9E9E9E;
}

@keyframes onlinePulse {
  0%, 100% { 
    box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7);
  }
  50% { 
    box-shadow: 0 0 0 4px rgba(76, 175, 80, 0);
  }
}
```

#### 12.1.3 權限矩陣表格組件
```css
/* 協作權限矩陣設計 */
.collaboration-permission-matrix {
  background: #FFFFFF;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  overflow-x: auto;
}

.permission-matrix-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}

.permission-matrix-header {
  background: linear-gradient(135deg, #F5F5F5, #EEEEEE);
  font-weight: 600;
  text-align: center;
  padding: 12px 8px;
  border-bottom: 2px solid #E0E0E0;
}

.permission-matrix-cell {
  padding: 10px 8px;
  text-align: center;
  border-bottom: 1px solid #F0F0F0;
  position: relative;
}

.permission-toggle-switch {
  width: 36px;
  height: 20px;
  border-radius: 10px;
  background: #E0E0E0;
  position: relative;
  cursor: pointer;
  transition: all 0.3s ease;
}

.permission-toggle-switch.active {
  background: #4CAF50;
}

.permission-toggle-handle {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: #FFFFFF;
  position: absolute;
  top: 2px;
  left: 2px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.permission-toggle-switch.active .permission-toggle-handle {
  left: 18px;
}
```

#### 12.1.4 四模式協作卡片差異設計

**精準控制者模式：**
```css
.controller-collaboration-card {
  --mode-primary: #1565C0;
  --mode-accent: #0D47A1;
  padding: 16px;
  font-size: 14px;
}

.controller-collaboration-metrics {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  margin-top: 16px;
}

.controller-collaboration-metric {
  text-align: center;
  padding: 8px;
  background: rgba(21, 101, 192, 0.05);
  border-radius: 6px;
}

.controller-metric-value {
  font-size: 14px;
  font-weight: 700;
  color: var(--mode-primary);
}

.controller-metric-label {
  font-size: 10px;
  color: #757575;
  margin-top: 2px;
}
```

**紀錄習慣者模式：**
```css
.logger-collaboration-card {
  --mode-primary: #7B1FA2;
  --mode-accent: #AD85C6;
  background: linear-gradient(135deg, 
    rgba(255,255,255,0.98), 
    rgba(248,245,250,0.98));
  border-left: 6px solid transparent;
  border-image: linear-gradient(135deg, 
    var(--mode-primary), 
    var(--mode-accent)) 1;
  padding: 28px;
}

.logger-collaboration-status {
  background: linear-gradient(135deg, 
    rgba(123, 31, 162, 0.1), 
    rgba(173, 133, 198, 0.1));
  border-radius: 12px;
  padding: 16px;
  margin: 16px 0;
}

.logger-member-count {
  text-align: center;
  margin-top: 20px;
}

.logger-member-value {
  font-size: 24px;
  font-weight: 700;
  background: linear-gradient(135deg, 
    var(--mode-primary), 
    var(--mode-accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
```

**轉型挑戰者模式：**
```css
.struggler-collaboration-card {
  --mode-primary: #E65100;
  --mode-accent: #FF8A65;
  position: relative;
}

.struggler-collaboration-card::after {
  content: "🤝";
  position: absolute;
  top: 20px;
  right: 20px;
  font-size: 28px;
  animation: bounce 2s infinite;
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
  40% { transform: translateY(-10px); }
  60% { transform: translateY(-5px); }
}

.struggler-team-achievement {
  background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
  border: 2px solid var(--mode-primary);
  border-radius: 12px;
  padding: 16px;
  margin-top: 16px;
  text-align: center;
}

.struggler-team-progress {
  font-size: 16px;
  font-weight: 600;
  color: var(--mode-primary);
  margin-bottom: 8px;
}

.struggler-motivational-text {
  background: linear-gradient(135deg, 
    var(--mode-primary), 
    var(--mode-accent));
  color: white;
  padding: 12px;
  border-radius: 8px;
  margin-top: 12px;
  font-size: 14px;
  font-weight: 600;
}
```

**潛在覺醒者模式：**
```css
.sleeper-collaboration-card {
  --mode-primary: #388E3C;
  --mode-accent: #81C784;
  font-size: 20px;
  padding: 32px;
}

.sleeper-simple-status {
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 24px 0;
}

.sleeper-status-icon {
  font-size: 36px;
  margin-right: 16px;
}

.sleeper-status-text {
  font-size: 24px;
  font-weight: 600;
  color: var(--mode-primary);
}

.sleeper-member-summary {
  text-align: center;
  margin-top: 20px;
}

.sleeper-member-count {
  font-size: 28px;
  font-weight: 700;
  color: var(--mode-primary);
}

.sleeper-member-label {
  font-size: 18px;
  color: #757575;
  margin-top: 8px;
}
```

### 12.2 即時協作活動視覺元件

#### 12.2.1 活動時間軸設計
```css
.collaboration-activity-timeline {
  position: relative;
  padding: 20px 0;
}

.activity-timeline-item {
  position: relative;
  padding: 16px 0 16px 60px;
  border-left: 2px solid #E0E0E0;
}

.activity-timeline-item::before {
  content: '';
  position: absolute;
  left: -8px;
  top: 20px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: #1976D2;
  border: 3px solid #FFFFFF;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.activity-item-header {
  display: flex;
  align-items: center;
  margin-bottom: 8px;
}

.activity-user-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  margin-right: 12px;
}

.activity-user-name {
  font-weight: 600;
  color: #212121;
  margin-right: 8px;
}

.activity-timestamp {
  font-size: 12px;
  color: #757575;
}

.activity-content {
  background: #F8F9FA;
  border-radius: 8px;
  padding: 12px;
  margin-top: 8px;
}

.activity-type-entry .activity-timeline-item::before {
  background: #4CAF50;
}

.activity-type-edit .activity-timeline-item::before {
  background: #FF9800;
}

.activity-type-delete .activity-timeline-item::before {
  background: #F44336;
}
```

---

## 13. 頁面詳細規格

### 13.1 P036 協作中心頁面視覺規格

#### 13.1.1 頁面視覺佈局結構
```
┌─────────────────────────────────────┐
│ 🤝 協作中心               ⚙️🔔  │ ← 頁面標題列
├─────────────────────────────────────┤
│ ┌─────────────────────────────────┐ │
│ │     協作狀態總覽               │ │ ← 狀態卡片
│ │   ○────3個──○ 活躍帳本        │ │
│ │ 成員: 12位 | 今日活動: 15次    │ │
│ │   🟢已連線 🟡同步中 🔴離線    │ │
│ └─────────────────────────────────┘ │
├─────────────────────────────────────┤
│ 📊 協作統計分布                    │ ← 快速統計
│ ┌───┐ ┌───┐ ┌───┐ ┌───┐         │
│ │ 3 │ │12 │ │15 │ │ 2 │         │
│ │帳本│ │成員│ │活動│ │衝突│         │
│ └───┘ └───┘ └───┘ └───┘         │
├─────────────────────────────────────┤
│ 📋 我的協作帳本                    │ ← 帳本列表
│ ┌─────────────────────────────────┐ │
│ │ 👨‍👩‍👧‍👦 家庭記帳本    [🟢線上] │ │
│ │ 5位成員 | 管理員權限            │ │
│ │ 最後活動: 2小時前              │ │
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ 🏢 專案預算管理    [🟡同步中] │ │
│ │ 8位成員 | 編輯者權限            │ │
│ │ 最後活動: 30分鐘前             │ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

#### 13.1.2 四模式視覺差異
- **精準控制者**：顯示詳細統計數據、完整成員資訊、多維度分析圖表
- **紀錄習慣者**：美觀的漸層卡片、優雅的動畫效果、簡潔的資訊呈現
- **轉型挑戰者**：突出顯示團隊成就、協作進度、激勵性文案
- **潛在覺醒者**：大卡片設計、簡化資訊顯示、溫和的顏色搭配

### 13.2 P037 建立共享帳本頁面視覺規格

#### 13.2.1 協作類型選擇器視覺設計
```
┌─────────────────────────────────────┐
│ 🤝 建立共享帳本                    │
├─────────────────────────────────────┤
│ 選擇協作類型                        │
├─────────────────────────────────────┤
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐    │
│ │ 👨‍👩‍👧‍👦  │ │ 🏢  │ │ 📈  │ │ 🎯  │    │
│ │家庭 │ │團隊 │ │專案 │ │社團 │    │
│ │記帳 │ │協作 │ │管理 │ │活動 │    │
│ └─────┘ └─────┘ └─────┘ └─────┘    │
├─────────────────────────────────────┤
│ 基本設定                            │
│ 帳本名稱: [                       ] │
│ 帳本描述: [                       ] │
│ 成員上限: [5人 ▼]                  │
├─────────────────────────────────────┤
│ 權限設定                            │
│ 預設權限: [編輯者 ▼]               │
│ ☑️ 需要審核新成員                  │
│ ☑️ 大額支出需確認 ($1000以上)      │
│ ☐ 允許匿名檢視                     │
├─────────────────────────────────────┤
│        [ 建立帳本 ]                 │
└─────────────────────────────────────┘
```

#### 13.2.2 四模式表單差異設計
- **精準控制者**：完整12欄位設定，詳細權限規則，進階選項
- **紀錄習慣者**：美觀6欄位表單，優雅的動畫引導
- **轉型挑戰者**：團隊導向8欄位，激勵元素整合，目標關聯
- **潛在覺醒者**：極簡4欄位，智慧預設值，大按鈕設計

### 13.3 P039 即時協作頁面視覺規格

#### 13.3.1 即時監控介面視覺設計
```
┌─────────────────────────────────────┐
│ 📡 即時協作監控     [🟢 已連線]    │
├─────────────────────────────────────┤
│ 👥 線上成員 (3/5)                  │
│ ┌─────────────────────────────────┐ │
│ │ 🟢 小華  正在編輯午餐記錄        │ │
│ │ 🟡 小明  檢視中 (2分鐘前)       │ │
│ │ 🟢 媽媽  剛新增一筆記錄          │ │
│ └─────────────────────────────────┘ │
├─────────────────────────────────────┤
│ 🔄 同步活動                        │
│ • 15:30 小華編輯了"午餐便當" $85    │
│ • 15:28 媽媽新增了"菜市場" $250     │
│ • 15:25 小明上線加入協作            │
│ • 15:20 系統自動同步完成            │
├─────────────────────────────────────┤
│ ⚠️ 狀態警示                        │
│ ┌─────────────────────────────────┐ │
│ │ 🔥 檢測到資料衝突               │ │
│ │ "午餐便當"記錄被同時編輯         │ │
│ │ [檢視詳情] [自動解決]          │ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

#### 13.3.2 四模式監控差異
- **精準控制者**：完整同步統計、詳細衝突分析、精確狀態監控
- **紀錄習慣者**：美觀同步動畫、優雅的狀態指示設計
- **轉型挑戰者**：團隊協作激勵、正面的同步回饋
- **潛在覺醒者**：簡化狀態顯示、溫和的同步提示

### 13.4 P042 衝突解決頁面視覺規格

#### 13.4.1 衝突解決介面設計
```
┌─────────────────────────────────────┐
│ ⚠️ 協作衝突解決                    │
│ 記錄："午餐便當" 被同時修改         │
│ 衝突時間：2025-01-27 15:30         │
├─────────────────────────────────────┤
│ 📊 衝突內容對比                    │
│ ┌───────────────┬─────────────────┐ │
│ │ 您的版本     │ 小華的版本       │ │
│ ├───────────────┼─────────────────┤ │
│ │ 金額: $100   │ 金額: $85       │ │
│ │ 描述: 便當    │ 描述: 午餐便當   │ │
│ │ 分類: 餐飲    │ 分類: 餐飲       │ │
│ │ 時間: 15:29  │ 時間: 15:30     │ │
│ └───────────────┴─────────────────┘ │
├─────────────────────────────────────┤
│ 🔧 解決方案選擇                    │
│ ○ 使用我的版本                     │
│ ● 使用小華的版本                   │
│ ○ 手動合併                        │
│ ○ 建立新記錄                      │
│                                    │
│ [取消] [確認解決]                  │
└─────────────────────────────────────┘
```

#### 13.4.2 四模式衝突處理差異
- **精準控制者**：詳細衝突分析、多種解決方案、技術細節顯示
- **紀錄習慣者**：優雅的對比設計、流暢的解決流程
- **轉型挑戰者**：正面的衝突處理、團隊合作引導
- **潛在覺醒者**：簡化衝突說明、自動解決建議

---

## 14. 整合驗收標準

### 14.1 視覺設計驗收標準

#### 14.1.1 四模式視覺一致性檢查
- [ ] **精準控制者模式**：所有協作管理按鈕正確連結對應API端點
- [ ] **紀錄習慣者模式**：美觀設計不影響API功能調用正確性
- [ ] **轉型挑戰者模式**：激勵性視覺元素正確搭配功能按鈕
- [ ] **潛在覺醒者模式**：簡化視覺設計仍能正確執行完整功能

#### 14.1.2 API連結驗收清單
- [ ] **F019共享帳本API**：P036-P037-P040頁面按鈕正確調用
- [ ] **F020協作權限API**：P038-P043-P045頁面管理按鈕正確執行
- [ ] **F021即時同步API**：P039-P041-P042-P044頁面同步功能正常

#### 14.1.3 視覺無障礙驗收標準
- [ ] **WCAG 2.1 AA色彩對比**：所有文字與背景對比度≥4.5:1
- [ ] **觸控目標尺寸**：所有按鈕觸控區域≥44pt×44pt
- [ ] **螢幕閱讀器支援**：所有協作元素有適當語意標籤
- [ ] **鍵盤導航**：Tab鍵可依邏輯順序導航所有協作介面
- [ ] **焦點指示**：所有可互動元素有清晰的焦點視覺指示

### 14.2 視覺設計品質驗收

#### 14.2.1 協作狀態視覺化準確性
- [ ] **即時同步指示器**：連線狀態視覺呈現準確無誤
- [ ] **成員狀態顏色**：線上/離開/離線狀態顏色正確
- [ ] **活動時間軸**：操作順序與時間軸視覺一致
- [ ] **衝突警示機制**：衝突狀態即時視覺化更新

#### 14.2.2 四模式視覺差異驗收
- [ ] **資訊密度差異**：各模式協作資訊顯示密度符合設計
- [ ] **視覺複雜度階梯**：Controller > Logger > Struggler > Sleeper
- [ ] **色彩主題一致性**：各模式色彩主題正確應用
- [ ] **字型大小階梯**：14px > 16px > 16px > 18px 符合設計

#### 14.2.3 互動體驗驗收
- [ ] **動畫流暢度**：所有協作動畫在60fps下流暢運行
- [ ] **回饋即時性**：按鈕點擊後100ms內有視覺回饋
- [ ] **載入狀態**：API調用期間有適當的載入視覺指示
- [ ] **錯誤處理**：協作錯誤狀態有清晰的視覺化表達

---

## 15. 版本記錄

| 版本 | 日期 | 修改者 | 修改內容 |
|------|------|--------|----------|
| **v2.1.0** | **2025-01-27** | **LCAS SA Team** | **🔧 重要修正：轉換為產品視覺設計需求文件** |
|  |  |  | **• 移除所有技術實作代碼，專注視覺設計需求** |
|  |  |  | **• 確保API端點對照表與按鈕連結的正確性** |
|  |  |  | **• 強化四模式協作視覺差異化設計規範** |
|  |  |  | **• 專注於使用者介面與視覺體驗需求** |
|  |  |  | **• 對齊9005 PRD文件的視覺設計定位與原則** |
|  |  |  | **• 詳細定義協作管理專用視覺元件與樣式** |
| **v2.0.0** | **2025-08-07** | **LCAS SA Team** | **🎉 初版：協作功能群組SRS建立** |
|  |  |  | **• 整合P036-P045十個協作功能頁面規格** |
|  |  |  | **• 建立API端點對照表（F019-F021）** |
|  |  |  | **• 設計四模式差異化協作管理體驗** |
|  |  |  | **• 建立完整的即時同步與衝突處理機制** |

### 15.1 v2.1.0修正重點摘要

#### 15.1.1 移除的技術實作內容
- ❌ 刪除所有技術實作代碼與WebSocket連線邏輯
- ❌ 移除複雜的衝突檢測演算法實作細節
- ❌ 移除詳細的權限驗證技術實作
- ❌ 移除CollaborationStateManager等技術類別

#### 15.1.2 保留並強化的視覺設計內容
- ✅ **API對照表**：確保按鈕與API端點連結正確性
- ✅ **視覺設計規範**：詳細的UI元件與CSS樣式定義
- ✅ **四模式差異**：清晰的協作視覺差異化設計指引
- ✅ **使用者體驗**：完整的協作管理視覺流程設計

#### 15.1.3 新增的視覺設計重點
- 🎨 詳細的CSS樣式規範與協作視覺元件定義
- 🎨 四模式的協作管理視覺差異化實作指引
- 🎨 完整的即時同步狀態視覺化與衝突解決設計規範
- 🎨 協作成員活動監控的視覺設計要求

#### 15.1.4 確保的API連結正確性
- 🔗 所有20個API端點功能與對應按鈕功能正確連結
- 🔗 協作中心、建立帳本、成員管理、即時同步等功能按鈕API呼叫正確
- 🔗 四模式下相同功能按鈕均能正確調用對應API
- 🔗 API調用成功/失敗狀態的視覺回饋設計完整

---

## 備註

### 📌 協作功能群組視覺特色
- **即時協作視覺化**：WebSocket驅動的即時同步狀態與成員活動視覺指示
- **多層權限視覺區分**：清晰的Owner/Admin/Editor/Viewer權限等級視覺化
- **智慧衝突解決視覺**：直觀的衝突檢測與解決流程視覺引導
- **四模式協作適配視覺**：針對不同使用者需求的協作管理視覺差異化

### 🎯 視覺設計目標達成度
- ✅ **API連結正確性**：所有按鈕與對應API端點連結準確無誤
- ✅ **四模式差異化**：完整的協作管理視覺差異化設計規範
- ✅ **使用者體驗**：直觀易用的協作管理視覺介面設計
- ✅ **設計一致性**：符合9005 PRD的設計系統要求
- ✅ **視覺無障礙**：完整的WCAG 2.1 AA標準視覺支援

### 🚀 下一步視覺開發重點
1. **協作視覺元件實作**：依據設計規範實作協作專用視覺元件
2. **四模式視覺測試**：驗證各模式的協作管理視覺體驗差異
3. **API整合視覺測試**：確保按鈕功能與API呼叫的視覺回饋正確
4. **即時同步視覺最佳化**：確保WebSocket連線狀態的視覺指示效能
5. **響應式協作介面**：確保各裝置尺寸下的協作視覺體驗

---

**🎉 協作功能群組SRS v2.1.0 - 專注視覺設計需求，確保API連結正確性！**
