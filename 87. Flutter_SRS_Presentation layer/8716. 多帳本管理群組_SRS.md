
# 8716. å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„_SRS

**æ–‡ä»¶ç·¨è™Ÿ**: 8716-SRS-GROUP  
**ç‰ˆæœ¬**: v2.0.0  
**å»ºç«‹æ—¥æœŸ**: 2025-08-07  
**å»ºç«‹è€…**: LCAS SA Team  
**æœ€å¾Œæ›´æ–°**: 2025-08-07 22:45:00 UTC+8

---

## ç›®æ¬¡

1. [ç¾¤çµ„æ¦‚è¿°](#1-ç¾¤çµ„æ¦‚è¿°)
2. [é é¢åŠŸèƒ½ç¸½è¦½](#2-é é¢åŠŸèƒ½ç¸½è¦½)
3. [APIç«¯é»å°ç…§è¡¨](#3-apiç«¯é»å°ç…§è¡¨)
4. [åŠŸèƒ½ç›®çš„](#4-åŠŸèƒ½ç›®çš„)
5. [ä½¿ç”¨è€…æ•…äº‹](#5-ä½¿ç”¨è€…æ•…äº‹)
6. [å‰ç½®æ¢ä»¶](#6-å‰ç½®æ¢ä»¶)
7. [åŠŸèƒ½æµç¨‹](#7-åŠŸèƒ½æµç¨‹)
8. [è¼¸å…¥é …ç›®](#8-è¼¸å…¥é …ç›®)
9. [è¼¸å‡ºé …ç›®](#9-è¼¸å‡ºé …ç›®)
10. [é©—è­‰è¦å‰‡](#10-é©—è­‰è¦å‰‡)
11. [éŒ¯èª¤è™•ç†](#11-éŒ¯èª¤è™•ç†)
12. [UIå…ƒä»¶èˆ‡æ’ç‰ˆéœ€æ±‚](#12-uiå…ƒä»¶èˆ‡æ’ç‰ˆéœ€æ±‚)
13. [APIè¦æ ¼](#13-apiè¦æ ¼)
14. [ç‹€æ…‹èˆ‡ç•«é¢åˆ‡æ›](#14-ç‹€æ…‹èˆ‡ç•«é¢åˆ‡æ›)
15. [å®‰å…¨æ€§èˆ‡æ¬Šé™æª¢æŸ¥](#15-å®‰å…¨æ€§èˆ‡æ¬Šé™æª¢æŸ¥)
16. [å…¶ä»–è£œå……éœ€æ±‚](#16-å…¶ä»–è£œå……éœ€æ±‚)
17. [é é¢è©³ç´°è¦æ ¼](#17-é é¢è©³ç´°è¦æ ¼)
18. [æ•´åˆé©—æ”¶æ¨™æº–](#18-æ•´åˆé©—æ”¶æ¨™æº–)
19. [ç‰ˆæœ¬è¨˜éŒ„](#19-ç‰ˆæœ¬è¨˜éŒ„)

---

## 1. ç¾¤çµ„æ¦‚è¿°

### 1.1 ç¾¤çµ„å®šä½
å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„æ˜¯LCAS 2.0 Flutteræ‡‰ç”¨ç¨‹å¼çš„**å¸³æœ¬çµ„ç¹”ä¸­å¿ƒ**ï¼Œæä¾›å®Œæ•´çš„å¤šå¸³æœ¬æ¶æ§‹ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æ´å€‹äººå¤šå¸³æœ¬ã€å°ˆæ¡ˆå‹å¸³æœ¬ã€åˆ†é¡å‹å¸³æœ¬ç­‰ä¸åŒä½¿ç”¨æƒ…å¢ƒï¼Œæ˜¯å¯¦ç¾å¸³æœ¬å±¤ç´šè³‡æ–™ç®¡ç†èˆ‡æ¬Šé™æ§åˆ¶çš„æ ¸å¿ƒåŠŸèƒ½å€åŸŸã€‚

### 1.2 ç¾¤çµ„ç¯„åœ
æœ¬ç¾¤çµ„æ•´åˆä»¥ä¸‹10å€‹å¸³æœ¬ç®¡ç†åŠŸèƒ½é é¢ï¼š
- **P016 å¸³æœ¬æ¸…å–®é é¢**ï¼šå¸³æœ¬ç¸½è¦½èˆ‡å¿«é€Ÿå­˜å–
- **P017 å»ºç«‹å¸³æœ¬é é¢**ï¼šæ–°å¸³æœ¬å»ºç«‹èˆ‡åˆå§‹è¨­å®š
- **P018 å¸³æœ¬è¨­å®šé é¢**ï¼šå¸³æœ¬å±¬æ€§èˆ‡åå¥½è¨­å®š
- **P019 å°ˆæ¡ˆå¸³æœ¬è©³æƒ…**ï¼šå°ˆæ¡ˆå‹å¸³æœ¬è©³ç´°ç®¡ç†
- **P020 åˆ†é¡å¸³æœ¬è©³æƒ…**ï¼šåˆ†é¡å‹å¸³æœ¬è©³ç´°ç®¡ç†
- **P021 æˆå“¡ç®¡ç†é é¢**ï¼šå¸³æœ¬æˆå“¡èˆ‡æ¬Šé™ç®¡ç†
- **P022 æ¬Šé™è¨­å®šé é¢**ï¼šç´°ç²’åº¦æ¬Šé™æ§åˆ¶è¨­å®š
- **P023 é‚€è«‹æˆå“¡é é¢**ï¼šå¸³æœ¬å”ä½œé‚€è«‹åŠŸèƒ½
- **P024 å¸³æœ¬çµ±è¨ˆé é¢**ï¼šå¸³æœ¬å±¤ç´šçµ±è¨ˆåˆ†æ
- **P025 åˆªé™¤å¸³æœ¬é é¢**ï¼šå¸³æœ¬å®‰å…¨åˆªé™¤åŠŸèƒ½

### 1.3 è¨­è¨ˆåŸå‰‡
- **å¤šå¸³æœ¬æ¶æ§‹**ï¼šæ”¯æ´ä¸åŒé¡å‹å¸³æœ¬çš„çµ±ä¸€ç®¡ç†
- **æ¬Šé™åˆ†å±¤**ï¼šå®Œæ•´çš„æˆå“¡æ¬Šé™èˆ‡å­˜å–æ§åˆ¶
- **å”ä½œå‹å–„**ï¼šä¾¿æ–¼å¤šäººå”ä½œçš„é‚€è«‹èˆ‡ç®¡ç†æ©Ÿåˆ¶
- **è³‡æ–™éš”é›¢**ï¼šç¢ºä¿ä¸åŒå¸³æœ¬é–“è³‡æ–™çš„å®‰å…¨éš”é›¢

---

## 2. é é¢åŠŸèƒ½ç¸½è¦½

| é é¢ç·¨è™Ÿ | é é¢åç¨± | ä¸»è¦åŠŸèƒ½ | å››æ¨¡å¼å·®ç•°é‡é» | ä½¿ç”¨é »ç‡ |
|----------|----------|----------|----------------|----------|
| **P016** | å¸³æœ¬æ¸…å–®é é¢ | å¸³æœ¬ç¸½è¦½ã€å¿«é€Ÿåˆ‡æ›ã€å»ºç«‹å…¥å£ | æª¢è¦–æ–¹å¼è¤‡é›œåº¦ | é«˜ |
| **P017** | å»ºç«‹å¸³æœ¬é é¢ | å¸³æœ¬é¡å‹é¸æ“‡ã€åˆå§‹è¨­å®š | è¨­å®šé¸é …å®Œæ•´åº¦ | ä¸­ |
| **P018** | å¸³æœ¬è¨­å®šé é¢ | å±¬æ€§ä¿®æ”¹ã€åå¥½è¨­å®šã€å¤–è§€é…ç½® | è¨­å®šé …ç›®æ•¸é‡ | ä¸­ |
| **P019** | å°ˆæ¡ˆå¸³æœ¬è©³æƒ… | å°ˆæ¡ˆç®¡ç†ã€é€²åº¦è¿½è¹¤ã€æˆå“¡å”ä½œ | å°ˆæ¡ˆåŠŸèƒ½è¤‡é›œåº¦ | ä¸­ |
| **P020** | åˆ†é¡å¸³æœ¬è©³æƒ… | åˆ†é¡ç®¡ç†ã€è¦å‰‡è¨­å®šã€è‡ªå‹•åˆ†é¡ | åˆ†é¡è¦å‰‡è¤‡é›œåº¦ | ä¸­ |
| **P021** | æˆå“¡ç®¡ç†é é¢ | æˆå“¡æ¸…å–®ã€è§’è‰²ç®¡ç†ã€æ´»å‹•è¿½è¹¤ | ç®¡ç†åŠŸèƒ½æ·±åº¦ | ä¸­ |
| **P022** | æ¬Šé™è¨­å®šé é¢ | ç´°ç²’åº¦æ¬Šé™ã€è§’è‰²å®šç¾©ã€ç¹¼æ‰¿è¦å‰‡ | æ¬Šé™è¨­å®šè¤‡é›œåº¦ | ä½ |
| **P023** | é‚€è«‹æˆå“¡é é¢ | é‚€è«‹ç™¼é€ã€é€£çµç®¡ç†ã€ç‹€æ…‹è¿½è¹¤ | é‚€è«‹æ–¹å¼å¤šæ¨£æ€§ | ä½ |
| **P024** | å¸³æœ¬çµ±è¨ˆé é¢ | å¸³æœ¬å±¤ç´šåˆ†æã€æ¯”è¼ƒå ±è¡¨ | çµ±è¨ˆåˆ†ææ·±åº¦ | ä¸­ |
| **P025** | åˆªé™¤å¸³æœ¬é é¢ | å®‰å…¨åˆªé™¤ã€è³‡æ–™å‚™ä»½ã€ç¢ºèªæµç¨‹ | å®‰å…¨æª¢æŸ¥åš´æ ¼åº¦ | ä½ |

### 2.1 ç¾¤çµ„æµç¨‹é—œä¿‚åœ–
```
P016 å¸³æœ¬æ¸…å–®é é¢ (ä¸­å¤®æ¨ç´)
    â†“ å»ºç«‹æ–°å¸³æœ¬        â†“ å¸³æœ¬è¨­å®š        â†“ æª¢è¦–è©³æƒ…
P017 å»ºç«‹å¸³æœ¬ â†â†’ P018 å¸³æœ¬è¨­å®š    P019/P020 å¸³æœ¬è©³æƒ…
    â†“ æˆå“¡ç®¡ç†                         â†“ æ¬Šé™ç®¡ç†
P021 æˆå“¡ç®¡ç† â†â†’ P022 æ¬Šé™è¨­å®š â†â†’ P023 é‚€è«‹æˆå“¡
    â†“                â†‘                â†“ çµ±è¨ˆåˆ†æ
P024 å¸³æœ¬çµ±è¨ˆ â†â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€P025 åˆªé™¤å¸³æœ¬
    â†‘                â†“
P018 å¸³æœ¬è¨­å®š â†â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. APIç«¯é»å°ç…§è¡¨

### 3.1 å®Œæ•´APIå°æ‡‰é—œä¿‚

| é é¢ç·¨è™Ÿ | é é¢åç¨± | å°æ‡‰APIç·¨è™Ÿ | APIè·¯å¾‘ | HTTPæ–¹æ³• | ä¸»è¦åŠŸèƒ½æè¿° |
|----------|----------|-------------|---------|----------|-------------|
| **P016** | å¸³æœ¬æ¸…å–®é é¢ | **F017** | GET /ledgers | GET | å¸³æœ¬æ¸…å–®æŸ¥è©¢ |
| **P016** | å¸³æœ¬æ¸…å–®é é¢ | **F018** | PUT /user/active-ledger | PUT | åˆ‡æ›æ´»èºå¸³æœ¬ |
| **P017** | å»ºç«‹å¸³æœ¬é é¢ | **F019** | POST /ledgers | POST | å»ºç«‹æ–°å¸³æœ¬ |
| **P017** | å»ºç«‹å¸³æœ¬é é¢ | **F020** | GET /ledger-templates | GET | å¸³æœ¬ç¯„æœ¬æŸ¥è©¢ |
| **P018** | å¸³æœ¬è¨­å®šé é¢ | **F021** | PUT /ledgers/:id | PUT | æ›´æ–°å¸³æœ¬è¨­å®š |
| **P018** | å¸³æœ¬è¨­å®šé é¢ | **F017** | GET /ledgers/:id | GET | å–å¾—å¸³æœ¬è©³æƒ… |
| **P019** | å°ˆæ¡ˆå¸³æœ¬è©³æƒ… | **F022** | GET /ledgers/:id/project | GET | å°ˆæ¡ˆå¸³æœ¬è©³æƒ… |
| **P019** | å°ˆæ¡ˆå¸³æœ¬è©³æƒ… | **F023** | PUT /ledgers/:id/project | PUT | æ›´æ–°å°ˆæ¡ˆè¨­å®š |
| **P020** | åˆ†é¡å¸³æœ¬è©³æƒ… | **F024** | GET /ledgers/:id/category | GET | åˆ†é¡å¸³æœ¬è©³æƒ… |
| **P020** | åˆ†é¡å¸³æœ¬è©³æƒ… | **F025** | PUT /ledgers/:id/category | PUT | æ›´æ–°åˆ†é¡è¨­å®š |
| **P021** | æˆå“¡ç®¡ç†é é¢ | **F026** | GET /ledgers/:id/members | GET | å¸³æœ¬æˆå“¡æ¸…å–® |
| **P021** | æˆå“¡ç®¡ç†é é¢ | **F027** | PUT /ledgers/:id/members/:userId | PUT | æ›´æ–°æˆå“¡è³‡è¨Š |
| **P022** | æ¬Šé™è¨­å®šé é¢ | **F028** | GET /ledgers/:id/permissions | GET | æ¬Šé™è¨­å®šæŸ¥è©¢ |
| **P022** | æ¬Šé™è¨­å®šé é¢ | **F029** | PUT /ledgers/:id/permissions | PUT | æ›´æ–°æ¬Šé™è¨­å®š |
| **P023** | é‚€è«‹æˆå“¡é é¢ | **F030** | POST /ledgers/:id/invitations | POST | ç™¼é€æˆå“¡é‚€è«‹ |
| **P023** | é‚€è«‹æˆå“¡é é¢ | **F031** | GET /ledgers/:id/invitations | GET | é‚€è«‹ç‹€æ…‹æŸ¥è©¢ |
| **P024** | å¸³æœ¬çµ±è¨ˆé é¢ | **F032** | GET /ledgers/:id/analytics | GET | å¸³æœ¬çµ±è¨ˆåˆ†æ |
| **P024** | å¸³æœ¬çµ±è¨ˆé é¢ | **F033** | GET /ledgers/comparison | GET | å¸³æœ¬æ¯”è¼ƒåˆ†æ |
| **P025** | åˆªé™¤å¸³æœ¬é é¢ | **F034** | DELETE /ledgers/:id | DELETE | åˆªé™¤å¸³æœ¬ |
| **P025** | åˆªé™¤å¸³æœ¬é é¢ | **F035** | POST /ledgers/:id/backup | POST | å¸³æœ¬è³‡æ–™å‚™ä»½ |

### 3.2 APIä½¿ç”¨çµ±è¨ˆ
- **è¦†è“‹APIæ•¸é‡**ï¼š19å€‹å°ˆç”¨APIï¼ˆF017-F035ï¼‰
- **APIä½¿ç”¨ç‡**ï¼š100%ï¼ˆå¤šå¸³æœ¬åŠŸèƒ½å®Œæ•´è¦†è“‹ï¼‰
- **é«˜é »API**ï¼šF017ã€F018ï¼ˆå¸³æœ¬æŸ¥è©¢èˆ‡åˆ‡æ›ï¼‰
- **æ•´åˆè¤‡é›œåº¦**ï¼šé«˜ï¼ˆè·¨å¸³æœ¬æ¬Šé™æ§åˆ¶ï¼‰

---

## 4. åŠŸèƒ½ç›®çš„

### 4.1 ç¾¤çµ„æ•´é«”ç›®çš„
å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„ä½œç‚ºLCAS 2.0çš„**çµ„ç¹”æ¶æ§‹æ ¸å¿ƒ**ï¼Œè‡´åŠ›æ–¼ï¼š
- **å¸³æœ¬çµ„ç¹”ç®¡ç†**ï¼šæä¾›éˆæ´»çš„å¤šå¸³æœ¬æ¶æ§‹ç®¡ç†åŠŸèƒ½
- **å”ä½œæ•ˆç‡æå‡**ï¼šä¾¿æ–¼å¤šäººå”ä½œçš„æˆå“¡èˆ‡æ¬Šé™ç®¡ç†
- **è³‡æ–™éš”é›¢ä¿éšœ**ï¼šç¢ºä¿ä¸åŒå¸³æœ¬é–“çš„è³‡æ–™å®‰å…¨éš”é›¢
- **ä½¿ç”¨æƒ…å¢ƒé©é…**ï¼šæ”¯æ´å€‹äººã€å°ˆæ¡ˆã€åˆ†é¡ç­‰å¤šç¨®ä½¿ç”¨æƒ…å¢ƒ

### 4.2 å››æ¨¡å¼å·®ç•°åŒ–ç›®çš„

#### ç²¾æº–æ§åˆ¶è€…æ¨¡å¼
- æä¾›å®Œæ•´çš„å¸³æœ¬ç®¡ç†åŠŸèƒ½èˆ‡è©³ç´°çš„æ¬Šé™æ§åˆ¶
- é¡¯ç¤ºè±å¯Œçš„å¸³æœ¬çµ±è¨ˆåˆ†æèˆ‡ç®¡ç†è³‡è¨Š
- æ”¯æ´è¤‡é›œçš„æˆå“¡è§’è‰²èˆ‡æ¬Šé™è¨­å®šé«”ç³»

#### ç´€éŒ„ç¿’æ…£è€…æ¨¡å¼  
- æ‰“é€ å„ªé›…ç¾è§€çš„å¸³æœ¬ç®¡ç†é«”é©—
- é‡è¦–è¦–è¦ºåŒ–å‘ˆç¾èˆ‡æ“ä½œæµæš¢åº¦
- ç°¡åŒ–ç®¡ç†åŠŸèƒ½ä½†ä¿æŒç¾å­¸å“è³ª

#### è½‰å‹æŒ‘æˆ°è€…æ¨¡å¼
- èå…¥ç›®æ¨™é”æˆèˆ‡é€²åº¦è¿½è¹¤å…ƒç´ 
- æä¾›ç©æ¥µçš„å¸³æœ¬ç›®æ¨™å›é¥‹èˆ‡æ¿€å‹µæ©Ÿåˆ¶
- å¼·èª¿å¸³æœ¬å±¤ç´šçš„ç›®æ¨™è¿½è¹¤èˆ‡å¯¦ç¾

#### æ½›åœ¨è¦ºé†’è€…æ¨¡å¼
- æ¥µç°¡åŒ–çš„å¸³æœ¬æ“ä½œæµç¨‹èˆ‡ä»‹é¢è¨­è¨ˆ
- æä¾›æ™ºæ…§é è¨­å€¼èˆ‡è‡ªå‹•åŒ–å»ºè­°
- é™ä½å¤šå¸³æœ¬ç®¡ç†é–€æª»ï¼Œé¼“å‹µä½¿ç”¨

---

## 5. ä½¿ç”¨è€…æ•…äº‹

### 5.1 æ ¸å¿ƒä½¿ç”¨è€…æ•…äº‹

**ä½œç‚ºå¤šå¸³æœ¬ä½¿ç”¨è€…**ï¼Œæˆ‘å¸Œæœ›èƒ½è¼•é¬†ç®¡ç†ä¸åŒç”¨é€”çš„å¸³æœ¬ï¼Œä»¥ä¾¿å°‡ä¸åŒé¡å‹çš„è²¡å‹™è³‡æ–™æœ‰åºçµ„ç¹”ã€‚

**ä½œç‚ºå”ä½œç®¡ç†è€…**ï¼Œæˆ‘å¸Œæœ›èƒ½ä¾¿æ–¼é‚€è«‹æˆå“¡ä¸¦è¨­å®šé©ç•¶çš„æ¬Šé™ï¼Œä»¥ä¾¿å¯¦ç¾å®‰å…¨æœ‰æ•ˆçš„å¸³æœ¬å”ä½œã€‚

**ä½œç‚ºå°ˆæ¡ˆç¶“ç†**ï¼Œæˆ‘å¸Œæœ›èƒ½é€éå°ˆæ¡ˆå¸³æœ¬è¿½è¹¤å°ˆæ¡ˆè²¡å‹™ï¼Œä»¥ä¾¿æ›´å¥½åœ°æ§åˆ¶å°ˆæ¡ˆæˆæœ¬èˆ‡é ç®—ã€‚

**ä½œç‚ºå€‹äººç”¨æˆ¶**ï¼Œæˆ‘å¸Œæœ›èƒ½ç”¨åˆ†é¡å¸³æœ¬è‡ªå‹•æ•´ç†ä¸åŒé¡å‹çš„æ”¯å‡ºï¼Œä»¥ä¾¿æ›´æ¸…æ¥šåœ°äº†è§£æ¶ˆè²»æ¨¡å¼ã€‚

### 5.2 å››æ¨¡å¼ä½¿ç”¨è€…æ•…äº‹

#### ç²¾æº–æ§åˆ¶è€… (Controller)
> "ä½œç‚ºç²¾æº–æ§åˆ¶è€…ï¼Œæˆ‘å¸Œæœ›èƒ½å®Œå…¨æŒæ§æ¯å€‹å¸³æœ¬çš„è©³ç´°è¨­å®šï¼ŒåŒ…æ‹¬è¤‡é›œçš„æ¬Šé™æ§åˆ¶ã€è©³ç´°çš„æˆå“¡ç®¡ç†ã€ç²¾ç¢ºçš„çµ±è¨ˆåˆ†æï¼Œä»¥åŠå®Œæ•´çš„å¸³æœ¬è³‡æ–™åŒ¯å‡ºåŠŸèƒ½ã€‚"

#### ç´€éŒ„ç¿’æ…£è€… (Logger)  
> "ä½œç‚ºç´€éŒ„ç¿’æ…£è€…ï¼Œæˆ‘å¸Œæœ›å¸³æœ¬ç®¡ç†éç¨‹æ˜¯ç¾è§€ä¸”æ„‰æ‚…çš„é«”é©—ï¼Œæœ‰å„ªé›…çš„å¸³æœ¬åˆ‡æ›å‹•ç•«ã€ç¾éº—çš„çµ±è¨ˆåœ–è¡¨å‘ˆç¾ï¼Œè®“ç®¡ç†å¸³æœ¬æˆç‚ºç”Ÿæ´»ä¸­çš„ç¾å¥½æ™‚åˆ»ã€‚"

#### è½‰å‹æŒ‘æˆ°è€… (Struggler)
> "ä½œç‚ºè½‰å‹æŒ‘æˆ°è€…ï¼Œæˆ‘å¸Œæœ›å¸³æœ¬åŠŸèƒ½èƒ½å¹«åŠ©æˆ‘å¯¦ç¾ä¸åŒé ˜åŸŸçš„è²¡å‹™ç›®æ¨™ï¼Œæä¾›æ˜ç¢ºçš„å¸³æœ¬å±¤ç´šç›®æ¨™è¿½è¹¤ã€é”æˆæé†’ï¼Œä¸¦åœ¨æˆ‘é”åˆ°é‡Œç¨‹ç¢‘æ™‚çµ¦äºˆç©æ¥µçš„é¼“å‹µã€‚"

#### æ½›åœ¨è¦ºé†’è€… (Sleeper)
> "ä½œç‚ºæ½›åœ¨è¦ºé†’è€…ï¼Œæˆ‘å¸Œæœ›å¸³æœ¬ç®¡ç†åŠŸèƒ½éå¸¸ç°¡å–®ç›´è§€ï¼Œæœ‰æ™ºæ…§çš„è‡ªå‹•å»ºè­°ï¼Œä¸€éµå°±èƒ½å®Œæˆå¸³æœ¬å»ºç«‹èˆ‡è¨­å®šï¼Œä¸éœ€è¦è¤‡é›œçš„æ¬Šé™é…ç½®æˆ–æˆå“¡ç®¡ç†ã€‚"

---

## 6. å‰ç½®æ¢ä»¶

### 6.1 èªè­‰èˆ‡æ¬Šé™æ¢ä»¶
- ä½¿ç”¨è€…å·²æˆåŠŸé€šéèªè­‰æµç¨‹ç¾¤çµ„ï¼ˆP001-P005ï¼‰
- å…·å‚™æœ‰æ•ˆçš„å­˜å–ä»¤ç‰Œèˆ‡ä½¿ç”¨è€…æœƒè©±
- å·²å®ŒæˆåŸºæœ¬çš„ä½¿ç”¨è€…è¨­å®šèˆ‡æ¨¡å¼é¸æ“‡
- å…·å‚™å¸³æœ¬å»ºç«‹èˆ‡ç®¡ç†çš„åŸºæœ¬æ¬Šé™

### 6.2 è³‡æ–™ç’°å¢ƒæ¢ä»¶
- Firestoreè³‡æ–™åº«é€£ç·šç©©å®šä¸”å¯ç”¨
- ä½¿ç”¨è€…å·²æ“æœ‰è‡³å°‘ä¸€å€‹åŸºæœ¬å¸³æœ¬ï¼ˆé è¨­å€‹äººå¸³æœ¬ï¼‰
- å¸³æœ¬ç¯„æœ¬èˆ‡æ¬Šé™æ¨¡æ¿è³‡æ–™å·²åˆå§‹åŒ–
- æˆå“¡é‚€è«‹æœå‹™æ­£å¸¸é‹ä½œ

### 6.3 è£ç½®èˆ‡ç¶²è·¯æ¢ä»¶
- è£ç½®å…·å‚™ç©©å®šçš„ç¶²è·¯é€£ç·š
- å„²å­˜ç©ºé–“è¶³å¤ ï¼ˆå¸³æœ¬è³‡æ–™èˆ‡å¿«å–ï¼‰
- é€šçŸ¥æ¬Šé™ï¼ˆé‚€è«‹èˆ‡å”ä½œæé†’ï¼‰
- åˆ†äº«æ¬Šé™ï¼ˆé‚€è«‹é€£çµåˆ†äº«ï¼‰

---

## 7. åŠŸèƒ½æµç¨‹

### 7.1 ä¸»è¦å¸³æœ¬ç®¡ç†æµç¨‹

#### 7.1.1 å»ºç«‹å¸³æœ¬æµç¨‹ï¼ˆP017ï¼‰
```
1. é€²å…¥å»ºç«‹å¸³æœ¬é é¢
   â”œâ”€â”€ é¸æ“‡å¸³æœ¬é¡å‹ï¼ˆå€‹äºº/å°ˆæ¡ˆ/åˆ†é¡ï¼‰
   â”œâ”€â”€ è¨­å®šå¸³æœ¬åŸºæœ¬è³‡è¨Š
   â”œâ”€â”€ é¸æ“‡ç¯„æœ¬æˆ–è‡ªè¨‚è¨­å®š
   â””â”€â”€ é…ç½®åˆå§‹æ¬Šé™è¨­å®š
   
2. å¸³æœ¬é¡å‹å°ˆå±¬è¨­å®š
   â”œâ”€â”€ å€‹äººå¸³æœ¬ï¼šåŸºæœ¬è¨­å®š
   â”œâ”€â”€ å°ˆæ¡ˆå¸³æœ¬ï¼šå°ˆæ¡ˆè³‡è¨Šã€æˆå“¡è§’è‰²
   â””â”€â”€ åˆ†é¡å¸³æœ¬ï¼šåˆ†é¡è¦å‰‡ã€è‡ªå‹•è¦å‰‡
   
3. ç¢ºèªå»ºç«‹
   â”œâ”€â”€ è³‡æ–™é©—è­‰
   â”œâ”€â”€ æ¬Šé™æª¢æŸ¥
   â”œâ”€â”€ å¸³æœ¬å»ºç«‹
   â””â”€â”€ åˆå§‹åŒ–å®Œæˆ
```

#### 7.1.2 æˆå“¡ç®¡ç†æµç¨‹ï¼ˆP021ï¼‰
```
1. é€²å…¥æˆå“¡ç®¡ç†é é¢
   â”œâ”€â”€ è¼‰å…¥ç¾æœ‰æˆå“¡æ¸…å–®
   â”œâ”€â”€ é¡¯ç¤ºæˆå“¡è§’è‰²èˆ‡æ¬Šé™
   â”œâ”€â”€ æä¾›ç®¡ç†æ“ä½œé¸é …
   â””â”€â”€ é¡¯ç¤ºé‚€è«‹ç‹€æ…‹

2. æˆå“¡æ“ä½œè™•ç†
   â”œâ”€â”€ æ–°å¢æˆå“¡é‚€è«‹
   â”œâ”€â”€ ä¿®æ”¹æˆå“¡æ¬Šé™
   â”œâ”€â”€ ç§»é™¤æˆå“¡
   â””â”€â”€ æŸ¥çœ‹æˆå“¡æ´»å‹•

3. æ¬Šé™è®Šæ›´ç¢ºèª
   â”œâ”€â”€ æ¬Šé™å½±éŸ¿åˆ†æ
   â”œâ”€â”€ è®Šæ›´ç¢ºèª
   â”œâ”€â”€ é€šçŸ¥ç›¸é—œæˆå“¡
   â””â”€â”€ æ—¥èªŒè¨˜éŒ„
```

#### 7.1.3 æ¬Šé™è¨­å®šæµç¨‹ï¼ˆP022ï¼‰
```
1. é€²å…¥æ¬Šé™è¨­å®šé é¢
   â”œâ”€â”€ è¼‰å…¥ç•¶å‰æ¬Šé™é…ç½®
   â”œâ”€â”€ é¡¯ç¤ºè§’è‰²èˆ‡æ¬Šé™çŸ©é™£
   â”œâ”€â”€ æä¾›æ¬Šé™ç·¨è¼¯ä»‹é¢
   â””â”€â”€ é¡¯ç¤ºç¹¼æ‰¿é—œä¿‚

2. æ¬Šé™é…ç½®ç®¡ç†
   â”œâ”€â”€ è§’è‰²å®šç¾©èˆ‡ç·¨è¼¯
   â”œâ”€â”€ æ¬Šé™ç´°é …è¨­å®š
   â”œâ”€â”€ ç¹¼æ‰¿è¦å‰‡é…ç½®
   â””â”€â”€ ç‰¹æ®Šæ¬Šé™è¨­å®š

3. æ¬Šé™é©—è­‰èˆ‡å¥—ç”¨
   â”œâ”€â”€ æ¬Šé™é‚è¼¯é©—è­‰
   â”œâ”€â”€ è¡çªæª¢æŸ¥èˆ‡è§£æ±º
   â”œâ”€â”€ è®Šæ›´é è¦½
   â””â”€â”€ ç¢ºèªå¥—ç”¨
```

### 7.2 å››æ¨¡å¼å·®ç•°åŒ–æµç¨‹

#### ç²¾æº–æ§åˆ¶è€…æ¨¡å¼
- **å®Œæ•´ç®¡ç†æµç¨‹**ï¼šæä¾›æ‰€æœ‰å¯ç”¨çš„å¸³æœ¬ç®¡ç†åŠŸèƒ½
- **è©³ç´°æ¬Šé™è¨­å®š**ï¼šæ”¯æ´ç´°ç²’åº¦çš„æ¬Šé™æ§åˆ¶é…ç½®
- **å¤šé‡é©—è­‰æ©Ÿåˆ¶**ï¼šåš´æ ¼çš„å¸³æœ¬æ“ä½œå®‰å…¨æª¢æŸ¥

#### ç´€éŒ„ç¿’æ…£è€…æ¨¡å¼
- **å„ªé›…æ“ä½œæµç¨‹**ï¼šé‡è¦–æ“ä½œçš„æµæš¢æ€§èˆ‡ç¾æ„Ÿ
- **è¦–è¦ºåŒ–å¼•å°**ï¼šç¾è§€çš„æ­¥é©ŸæŒ‡ç¤ºèˆ‡é€²åº¦é¡¯ç¤º
- **ç°¡åŒ–ç®¡ç†é¸é …**ï¼šéš±è—éæ–¼æŠ€è¡“æ€§çš„è¨­å®š

#### è½‰å‹æŒ‘æˆ°è€…æ¨¡å¼
- **ç›®æ¨™å°å‘æµç¨‹**ï¼šæ¯å€‹å¸³æœ¬æ“ä½œéƒ½èˆ‡ç›®æ¨™é”æˆç›¸é—œè¯
- **é€²åº¦å›é¥‹æ©Ÿåˆ¶**ï¼šå³æ™‚é¡¯ç¤ºå¸³æœ¬ç›®æ¨™å®Œæˆé€²åº¦
- **æ¿€å‹µå…ƒç´ æ•´åˆ**ï¼šåœ¨æµç¨‹ä¸­åŠ å…¥æˆå°±èˆ‡çå‹µ

#### æ½›åœ¨è¦ºé†’è€…æ¨¡å¼
- **æ¥µç°¡åŒ–æµç¨‹**ï¼šæœ€å°‘æ­¥é©Ÿå®Œæˆå¸³æœ¬ç®¡ç†
- **æ™ºæ…§é è¨­å€¼**ï¼šè‡ªå‹•å¡«å…¥åˆç†çš„é è¨­è¨­å®š
- **ä¸€éµæ“ä½œ**ï¼šæä¾›å¿«æ·çš„å¸³æœ¬å»ºç«‹é¸é …

---

## 8. è¼¸å…¥é …ç›®

### 8.1 ç¾¤çµ„å…±é€šè¼¸å…¥é …ç›®

| è¼¸å…¥é¡åˆ¥ | è¼¸å…¥é …ç›® | è³‡æ–™é¡å‹ | å¿…å¡« | é©ç”¨é é¢ | èªªæ˜ |
|----------|----------|----------|------|----------|------|
| **å¸³æœ¬åŸºæœ¬** | å¸³æœ¬åç¨± | String | æ˜¯ | P017, P018 | 2-50å­—å…ƒ |
| **å¸³æœ¬åŸºæœ¬** | å¸³æœ¬é¡å‹ | Enum | æ˜¯ | P017 | personal/project/category |
| **å¸³æœ¬åŸºæœ¬** | å¸³æœ¬æè¿° | String | å¦ | P017, P018 | æœ€å¤š200å­—å…ƒ |
| **å¸³æœ¬åŸºæœ¬** | å¸³æœ¬åœ–ç¤º | String | å¦ | P017, P018 | åœ–ç¤ºä»£ç¢¼ |
| **å¸³æœ¬åŸºæœ¬** | å¸³æœ¬é¡è‰² | String | å¦ | P017, P018 | åå…­é€²ä½è‰²ç¢¼ |
| **å°ˆæ¡ˆè¨­å®š** | å°ˆæ¡ˆé–‹å§‹æ—¥ | DateTime | è¦–æƒ…æ³ | P017, P019 | å°ˆæ¡ˆå¸³æœ¬å¿…å¡« |
| **å°ˆæ¡ˆè¨­å®š** | å°ˆæ¡ˆçµæŸæ—¥ | DateTime | å¦ | P017, P019 | å°ˆæ¡ˆå¸³æœ¬å¯é¸ |
| **å°ˆæ¡ˆè¨­å®š** | å°ˆæ¡ˆé ç®— | Decimal | å¦ | P017, P019 | æ­£æ•¸ |
| **åˆ†é¡è¨­å®š** | è‡ªå‹•åˆ†é¡è¦å‰‡ | Object[] | å¦ | P017, P020 | åˆ†é¡è¦å‰‡é™£åˆ— |
| **åˆ†é¡è¨­å®š** | é è¨­ç§‘ç›® | String | å¦ | P017, P020 | ç§‘ç›®ID |
| **æˆå“¡ç®¡ç†** | æˆå“¡Email | String | æ˜¯ | P021, P023 | æœ‰æ•ˆEmailæ ¼å¼ |
| **æˆå“¡ç®¡ç†** | æˆå“¡è§’è‰² | Enum | æ˜¯ | P021, P022 | owner/admin/editor/viewer |
| **æˆå“¡ç®¡ç†** | é‚€è«‹è¨Šæ¯ | String | å¦ | P023 | æœ€å¤š500å­—å…ƒ |
| **æ¬Šé™è¨­å®š** | æ¬Šé™é …ç›® | Object | æ˜¯ | P022 | æ¬Šé™é…ç½®ç‰©ä»¶ |
| **æ¬Šé™è¨­å®š** | è§’è‰²åç¨± | String | æ˜¯ | P022 | 2-20å­—å…ƒ |
| **çµ±è¨ˆè¨­å®š** | çµ±è¨ˆæœŸé–“ | DateRange | å¦ | P024 | é–‹å§‹/çµæŸæ—¥æœŸ |
| **åˆªé™¤ç¢ºèª** | ç¢ºèªæ–‡å­— | String | æ˜¯ | P025 | å¿…é ˆè¼¸å…¥å¸³æœ¬åç¨± |
| **åˆªé™¤ç¢ºèª** | å‚™ä»½é¸é … | Boolean | æ˜¯ | P025 | æ˜¯å¦å»ºç«‹å‚™ä»½ |

### 8.2 å››æ¨¡å¼å°ˆå±¬è¼¸å…¥å·®ç•°

#### ç²¾æº–æ§åˆ¶è€…æ¨¡å¼
- **å®Œæ•´è¨­å®šæ”¶é›†**ï¼šæ‰€æœ‰å¯é¸æ¬„ä½éƒ½å¯è¼¸å…¥
- **è©³ç´°æ¬Šé™é…ç½®**ï¼šæ”¯æ´ç´°ç²’åº¦çš„æ¬Šé™è¨­å®š
- **é€²éšé¸é …é–‹æ”¾**ï¼šæä¾›æ‰€æœ‰é€²éšè¨­å®šé¸é …

#### ç´€éŒ„ç¿’æ…£è€…æ¨¡å¼
- **ç¾è§€è¼¸å…¥é«”é©—**ï¼šé‡è¦–è¼¸å…¥ä»‹é¢çš„è¦–è¦ºç¾æ„Ÿ
- **æ™ºæ…§è¼¸å…¥è¼”åŠ©**ï¼šæä¾›å„ªé›…çš„è¼¸å…¥å»ºè­°
- **ç°¡åŒ–è¨­å®šé …ç›®**ï¼šéš±è—éæ–¼è¤‡é›œçš„è¨­å®š

#### è½‰å‹æŒ‘æˆ°è€…æ¨¡å¼
- **ç›®æ¨™é—œè¯è¼¸å…¥**ï¼šè¼¸å…¥é …ç›®èˆ‡è²¡å‹™ç›®æ¨™ç›¸é—œè¯
- **é€²åº¦è¿½è¹¤è¨­å®š**ï¼šé¡å¤–æ”¶é›†èˆ‡ç›®æ¨™ç›¸é—œçš„è³‡è¨Š
- **æ¿€å‹µå°å‘è¨­è¨ˆ**ï¼šè¼¸å…¥éç¨‹èå…¥æ¿€å‹µå…ƒç´ 

#### æ½›åœ¨è¦ºé†’è€…æ¨¡å¼
- **æ¥µç°¡è¼¸å…¥**ï¼šåƒ…æ”¶é›†æœ€æ ¸å¿ƒçš„å¿…è¦è³‡è¨Š
- **æ™ºæ…§é è¨­**ï¼šå¤§é‡ä½¿ç”¨æ™ºæ…§é è¨­å€¼
- **ä¸€éµè¨­å®š**ï¼šæä¾›é è¨­çš„å¿«é€Ÿè¨­å®šé¸é …

---

## 9. è¼¸å‡ºé …ç›®

### 9.1 ç¾¤çµ„å…±é€šè¼¸å‡ºé …ç›®

| è¼¸å‡ºé¡åˆ¥ | è¼¸å‡ºé …ç›® | è³‡æ–™é¡å‹ | é©ç”¨é é¢ | èªªæ˜ |
|----------|----------|----------|----------|------|
| **å¸³æœ¬è³‡æ–™** | å¸³æœ¬æ¸…å–® | Array | P016 | ä½¿ç”¨è€…å¯å­˜å–çš„å¸³æœ¬æ¸…å–® |
| **å¸³æœ¬è³‡æ–™** | å¸³æœ¬è©³æƒ… | Object | P018, P019, P020 | å®Œæ•´çš„å¸³æœ¬è³‡è¨Šç‰©ä»¶ |
| **å¸³æœ¬è³‡æ–™** | å»ºç«‹çµæœ | Object | P017 | æ–°å»ºå¸³æœ¬çš„è©³ç´°è³‡è¨Š |
| **æˆå“¡è³‡æ–™** | æˆå“¡æ¸…å–® | Array | P021 | å¸³æœ¬æˆå“¡èˆ‡è§’è‰²è³‡è¨Š |
| **æˆå“¡è³‡æ–™** | é‚€è«‹ç‹€æ…‹ | Object | P023 | é‚€è«‹ç™¼é€èˆ‡æ¥å—ç‹€æ…‹ |
| **æ¬Šé™è³‡æ–™** | æ¬Šé™é…ç½® | Object | P022 | ç•¶å‰æ¬Šé™è¨­å®šè©³æƒ… |
| **æ¬Šé™è³‡æ–™** | è§’è‰²å®šç¾© | Array | P022 | å¯ç”¨è§’è‰²èˆ‡æ¬Šé™æ¸…å–® |
| **çµ±è¨ˆè³‡æ–™** | å¸³æœ¬çµ±è¨ˆ | Object | P024 | å¸³æœ¬å±¤ç´šçµ±è¨ˆåˆ†æ |
| **çµ±è¨ˆè³‡æ–™** | æ¯”è¼ƒåˆ†æ | Object | P024 | å¤šå¸³æœ¬æ¯”è¼ƒåˆ†æçµæœ |
| **æ“ä½œçµæœ** | åˆ‡æ›ç‹€æ…‹ | Boolean | P016 | å¸³æœ¬åˆ‡æ›æˆåŠŸç‹€æ…‹ |
| **æ“ä½œçµæœ** | æ›´æ–°ç‹€æ…‹ | Boolean | P018, P021, P022 | è¨­å®šæ›´æ–°æˆåŠŸç‹€æ…‹ |
| **æ“ä½œçµæœ** | åˆªé™¤ç¢ºèª | Object | P025 | å¸³æœ¬åˆªé™¤æ“ä½œçµæœ |
| **æ“ä½œå›é¥‹** | æˆåŠŸè¨Šæ¯ | String | å…¨éƒ¨ | æ“ä½œæˆåŠŸçš„å‹å–„è¨Šæ¯ |
| **æ“ä½œå›é¥‹** | éŒ¯èª¤è¨Šæ¯ | String | å…¨éƒ¨ | éŒ¯èª¤èªªæ˜èˆ‡å»ºè­° |

### 9.2 å››æ¨¡å¼å°ˆå±¬è¼¸å‡º

#### ç²¾æº–æ§åˆ¶è€…æ¨¡å¼
- **è©³ç´°ç®¡ç†å ±å‘Š**ï¼šå®Œæ•´çš„å¸³æœ¬ç®¡ç†è©³æƒ…èˆ‡ç³»çµ±ç‹€æ…‹
- **é€²éšçµ±è¨ˆçµæœ**ï¼šæ·±åº¦çš„å¸³æœ¬åˆ†æèˆ‡æ´å¯Ÿ
- **å®Œæ•´æ¬Šé™çŸ©é™£**ï¼šè©³ç´°çš„æ¬Šé™è¨­å®šèˆ‡é—œä¿‚åœ–

#### ç´€éŒ„ç¿’æ…£è€…æ¨¡å¼
- **è¦–è¦ºåŒ–å›é¥‹**ï¼šç¾è§€çš„æˆåŠŸå‹•ç•«èˆ‡è¦–è¦ºå›é¥‹
- **ç¾å­¸åŒ–æ•¸æ“šå‘ˆç¾**ï¼šé‡è¦–å¸³æœ¬æ•¸æ“šçš„è¦–è¦ºç¾æ„Ÿ
- **å„ªé›…çš„ä»‹é¢è½‰æ›**ï¼šæµæš¢çš„é é¢åˆ‡æ›èˆ‡å›æ‡‰

#### è½‰å‹æŒ‘æˆ°è€…æ¨¡å¼
- **ç›®æ¨™é€²åº¦å›é¥‹**ï¼šèˆ‡å¸³æœ¬ç›®æ¨™ç›¸é—œçš„é€²åº¦è³‡è¨Š
- **æˆå°±è§£é–é€šçŸ¥**ï¼šé”æˆå¸³æœ¬é‡Œç¨‹ç¢‘çš„ç©æ¥µå›é¥‹
- **æ¿€å‹µæ€§çµ±è¨ˆè³‡æ–™**ï¼šå¼·èª¿æ­£é¢é€²æ­¥çš„çµ±è¨ˆå‘ˆç¾

#### æ½›åœ¨è¦ºé†’è€…æ¨¡å¼
- **ç°¡åŒ–çµæœå‘ˆç¾**ï¼šç”¨æœ€ç°¡å–®çš„æ–¹å¼å‘ˆç¾çµæœ
- **å‹å–„æˆåŠŸæç¤º**ï¼šæº«å’Œå‹å–„çš„æ“ä½œæˆåŠŸæç¤º
- **æ™ºæ…§å»ºè­°è¼¸å‡º**ï¼šåŸºæ–¼ä½¿ç”¨ç¿’æ…£çš„æ™ºæ…§å»ºè­°

---

## 10. é©—è­‰è¦å‰‡

### 10.1 ç¾¤çµ„çµ±ä¸€é©—è­‰æ¨™æº–

#### 10.1.1 å¸³æœ¬è³‡æ–™é©—è­‰
```javascript
// å¸³æœ¬è³‡æ–™é©—è­‰è¦å‰‡
const ledgerValidationRules = {
  name: {
    minLength: 2,
    maxLength: 50,
    allowedChars: /^[\u4e00-\u9fa5a-zA-Z0-9\s\-_]+$/,
    uniqueForUser: true,
    required: true
  },
  type: {
    allowedValues: ['personal', 'project', 'category'],
    required: true,
    immutableAfterCreation: true
  },
  description: {
    maxLength: 200,
    prohibited: ['<script>', 'javascript:', 'on'],
    required: false
  },
  color: {
    format: /^#[0-9A-F]{6}$/,
    required: false,
    default: '#4CAF50'
  },
  icon: {
    allowedIcons: ['book', 'project', 'category', 'wallet', '...'],
    required: false,
    default: 'book'
  }
};
```

#### 10.1.2 æ¬Šé™è¨­å®šé©—è­‰
```javascript
// æ¬Šé™è¨­å®šé©—è­‰è¦å‰‡
const permissionValidationRules = {
  role: {
    allowedRoles: ['owner', 'admin', 'editor', 'viewer'],
    hierarchyCheck: true,
    required: true
  },
  permissions: {
    requiredStructure: {
      read: 'boolean',
      write: 'boolean',
      delete: 'boolean',
      invite: 'boolean',
      manage: 'boolean'
    },
    logicalConsistency: true,
    required: true
  },
  inheritance: {
    noCircularReference: true,
    validParentRole: true,
    required: false
  }
};
```

#### 10.1.3 æˆå“¡é‚€è«‹é©—è­‰
```javascript
// æˆå“¡é‚€è«‹é©—è­‰è¦å‰‡
const invitationValidationRules = {
  email: {
    format: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
    notSelfInvite: true,
    notExistingMember: true,
    required: true
  },
  role: {
    allowedForInviter: true,
    validRole: ['admin', 'editor', 'viewer'],
    required: true
  },
  message: {
    maxLength: 500,
    noSpam: true,
    required: false
  },
  expiration: {
    maxDays: 30,
    minDays: 1,
    futureDate: true,
    required: false
  }
};
```

### 10.2 å››æ¨¡å¼é©—è­‰å·®ç•°

#### ç²¾æº–æ§åˆ¶è€…æ¨¡å¼
- **åš´æ ¼é©—è­‰**ï¼šæ‰€æœ‰æ¬„ä½éƒ½é€²è¡Œæœ€åš´æ ¼çš„é©—è­‰
- **è¤‡é›œæ¬Šé™æª¢æŸ¥**ï¼šè©³ç´°çš„æ¬Šé™é‚è¼¯ä¸€è‡´æ€§æª¢æŸ¥
- **é€²éšå®‰å…¨é©—è­‰**ï¼šé¡å¤–çš„å®‰å…¨æ€§æª¢æŸ¥æ©Ÿåˆ¶

#### ç´€éŒ„ç¿’æ…£è€…æ¨¡å¼  
- **å¹³è¡¡é©—è­‰**ï¼šåœ¨å®‰å…¨æ€§èˆ‡æ˜“ç”¨æ€§é–“å–å¾—å¹³è¡¡
- **å„ªé›…éŒ¯èª¤æç¤º**ï¼šç¾è§€å‹å–„çš„é©—è­‰éŒ¯èª¤æç¤º
- **æµæš¢é©—è­‰é«”é©—**ï¼šä¸ä¸­æ–·æ“ä½œæµç¨‹çš„å³æ™‚é©—è­‰

#### è½‰å‹æŒ‘æˆ°è€…æ¨¡å¼
- **å¼•å°å¼é©—è­‰**ï¼šé€šéé©—è­‰å¼•å°ä½¿ç”¨è€…æ­£ç¢ºæ“ä½œ
- **ç©æ¥µå›é¥‹é©—è­‰**ï¼šé©—è­‰æˆåŠŸæ™‚æä¾›æ­£é¢å›é¥‹
- **ç›®æ¨™é—œè¯é©—è­‰**ï¼šé©—è­‰èˆ‡å¸³æœ¬ç›®æ¨™çš„é—œè¯æ€§

#### æ½›åœ¨è¦ºé†’è€…æ¨¡å¼
- **å¯¬é¬†é©—è­‰**ï¼šåŸºæœ¬å®‰å…¨æ€§é©—è­‰ï¼Œé¿å…éæ–¼åš´æ ¼
- **è‡ªå‹•ä¿®æ­£**ï¼šç›¡å¯èƒ½è‡ªå‹•ä¿®æ­£è¼¸å…¥éŒ¯èª¤
- **ç°¡åŒ–éŒ¯èª¤è¨Šæ¯**ï¼šä½¿ç”¨æœ€ç°¡å–®æ˜“æ‡‚çš„éŒ¯èª¤èªªæ˜

---

## 11. éŒ¯èª¤è™•ç†

### 11.1 ç¾¤çµ„çµ±ä¸€éŒ¯èª¤è™•ç†ç­–ç•¥

#### 11.1.1 å¸³æœ¬ç®¡ç†éŒ¯èª¤è™•ç†

| éŒ¯èª¤é¡å‹ | éŒ¯èª¤ä»£ç¢¼ | è™•ç†ç­–ç•¥ | ä½¿ç”¨è€…é«”é©— | æŠ€è¡“è™•ç† |
|----------|----------|----------|------------|----------|
| **æ¬Šé™ä¸è¶³éŒ¯èª¤** | PERM_001 | æ¬Šé™æª¢æŸ¥ + è§’è‰²æç¤º | é¡¯ç¤ºæ‰€éœ€æ¬Šé™èªªæ˜ | é‡æ–°é©—è­‰æ¬Šé™ |
| **å¸³æœ¬åç¨±é‡è¤‡** | LDG_001 | å³æ™‚æª¢æŸ¥ + å»ºè­°åç¨± | æä¾›æ›¿ä»£åç¨±å»ºè­° | å”¯ä¸€æ€§æª¢æŸ¥ |
| **æˆå“¡é‚€è«‹å¤±æ•—** | INV_001 | é‡è©¦æ©Ÿåˆ¶ + ç‹€æ…‹è¿½è¹¤ | é¡¯ç¤ºé‚€è«‹ç‹€æ…‹æ›´æ–° | éƒµä»¶æœå‹™é‡è©¦ |
| **æ¬Šé™è¨­å®šè¡çª** | PERM_002 | è¡çªæª¢æ¸¬ + è§£æ±ºå»ºè­° | é¡¯ç¤ºè¡çªè§£æ±ºé¸é … | æ¬Šé™é‚è¼¯é©—è­‰ |
| **å¸³æœ¬åˆªé™¤é™åˆ¶** | LDG_002 | æ¢ä»¶æª¢æŸ¥ + è­¦å‘Šæç¤º | èªªæ˜åˆªé™¤é™åˆ¶åŸå›  | ä¾è³´é—œä¿‚æª¢æŸ¥ |
| **è³‡æ–™åŒæ­¥å¤±æ•—** | SYNC_001 | æœ¬åœ°æš«å­˜ + é‡è©¦ | é¡¯ç¤ºåŒæ­¥ç‹€æ…‹æç¤º | è‡ªå‹•é‡è©¦æ©Ÿåˆ¶ |

#### 11.1.2 å¸¸è¦‹éŒ¯èª¤è¨Šæ¯å››æ¨¡å¼å°ç…§

| éŒ¯èª¤æƒ…å¢ƒ | ç²¾æº–æ§åˆ¶è€…è¨Šæ¯ | ç´€éŒ„ç¿’æ…£è€…è¨Šæ¯ | è½‰å‹æŒ‘æˆ°è€…è¨Šæ¯ | æ½›åœ¨è¦ºé†’è€…è¨Šæ¯ |
|----------|-------------|-------------|-------------|-------------|
| **æ¬Šé™ä¸è¶³** | "æ¬Šé™ä¸è¶³ï¼šéœ€è¦ç®¡ç†å“¡æ¬Šé™æ‰èƒ½åŸ·è¡Œæ­¤æ“ä½œï¼ˆéŒ¯èª¤ä»£ç¢¼ï¼šPERM_001ï¼‰" | "âœ¨ éœ€è¦æ›´é«˜æ¬Šé™æ‰èƒ½é€²è¡Œæ­¤æ“ä½œ" | "ğŸ’ª éœ€è¦ç®¡ç†æ¬Šé™æ‰èƒ½ç¹¼çºŒæŒ‘æˆ°ï¼" | "ğŸŒ± æ¬Šé™ä¸å¤ ï¼Œè«‹è¯çµ¡ç®¡ç†å“¡" |
| **å¸³æœ¬åç¨±é‡è¤‡** | "å¸³æœ¬åç¨±å·²å­˜åœ¨ï¼Œè«‹ä½¿ç”¨ä¸åŒçš„åç¨±ï¼ˆå»ºè­°ï¼šæ·»åŠ æ•¸å­—æˆ–æ—¥æœŸï¼‰" | "âœ¨ é€™å€‹åç¨±å·²ç¶“è¢«ä½¿ç”¨äº†" | "ğŸ¯ æ›å€‹ç¨ç‰¹çš„åç¨±ï¼Œå±•ç¾ä½ çš„å‰µæ„ï¼" | "ğŸŒ± åç¨±é‡è¤‡äº†ï¼Œè©¦è©¦åˆ¥çš„" |
| **é‚€è«‹ç™¼é€å¤±æ•—** | "é‚€è«‹ç™¼é€å¤±æ•—ï¼šè«‹æª¢æŸ¥Emailåœ°å€æˆ–ç¶²è·¯é€£ç·šï¼ˆéŒ¯èª¤ä»£ç¢¼ï¼šINV_001ï¼‰" | "âœ¨ é‚€è«‹ç™¼é€é‡åˆ°å•é¡Œï¼Œè«‹ç¨å¾Œå†è©¦" | "ğŸ“® é‚€è«‹æš«æ™‚å¡ä½äº†ï¼Œå†è©¦ä¸€æ¬¡å§ï¼" | "ğŸŒ± é‚€è«‹æ²’é€å‡ºï¼Œè«‹é‡è©¦" |
| **ç„¡æ³•åˆªé™¤å¸³æœ¬** | "ç„¡æ³•åˆªé™¤å¸³æœ¬ï¼šå­˜åœ¨é—œè¯çš„è¨˜å¸³è¨˜éŒ„æˆ–æ´»èºæˆå“¡ï¼Œè«‹å…ˆè™•ç†ä¾è³´é …ç›®" | "âœ¨ å¸³æœ¬é‚„æœ‰å…§å®¹ï¼Œç„¡æ³•åˆªé™¤" | "ğŸ›¡ï¸ å¸³æœ¬é‚„åœ¨ä½¿ç”¨ä¸­ï¼Œå…ˆæ¸…ç†å…§å®¹å§ï¼" | "ğŸŒ± å¸³æœ¬æœ‰è³‡æ–™ï¼Œä¸èƒ½åˆªé™¤" |

### 11.2 æ™ºæ…§éŒ¯èª¤æ¢å¾©æ©Ÿåˆ¶

```dart
// å¤šå¸³æœ¬æ™ºæ…§éŒ¯èª¤æ¢å¾©è™•ç†
class LedgerErrorRecovery {
  
  /**
   * 50. å¸³æœ¬æ¬Šé™éŒ¯èª¤æ¢å¾©
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description è™•ç†å¸³æœ¬æ¬Šé™ç›¸é—œéŒ¯èª¤çš„æ™ºæ…§æ¢å¾©
   */
  static Future<RecoveryResult> handlePermissionError({
    required PermissionError error,
    required UserMode userMode,
    required String ledgerId,
  }) async {
    // æª¢æŸ¥ä½¿ç”¨è€…ç•¶å‰æ¬Šé™
    final currentPermissions = await PermissionChecker.getUserPermissions(
      ledgerId: ledgerId,
    );
    
    // åˆ†ææ‰€éœ€æ¬Šé™
    final requiredPermissions = error.requiredPermissions;
    final missingPermissions = requiredPermissions
        .where((perm) => !currentPermissions.contains(perm))
        .toList();
    
    String suggestion;
    switch (userMode) {
      case UserMode.controller:
        suggestion = "ç¼ºå°‘æ¬Šé™ï¼š${missingPermissions.join('ã€')}ã€‚è«‹è¯çµ¡å¸³æœ¬ç®¡ç†å“¡ç”³è«‹ç›¸é—œæ¬Šé™ã€‚";
        break;
      case UserMode.logger:
        suggestion = "âœ¨ éœ€è¦æ›´é«˜æ¬Šé™æ‰èƒ½é€²è¡Œæ­¤æ“ä½œï¼Œè«‹è¯çµ¡ç®¡ç†å“¡";
        break;
      case UserMode.struggler:
        suggestion = "ğŸ’ª æ¬Šé™ä¸è¶³é˜»æ­¢äº†ä½ çš„é€²æ­¥ï¼è¯çµ¡ç®¡ç†å“¡è§£é–æ–°åŠŸèƒ½";
        break;
      case UserMode.sleeper:
        suggestion = "ğŸŒ± æ¬Šé™ä¸å¤ ï¼Œè«‹æ‰¾ç®¡ç†å“¡å¹«å¿™";
        break;
    }
    
    return RecoveryResult(
      success: false,
      suggestion: suggestion,
      actionRequired: true,
      suggestedAction: RecoveryAction.contactAdmin,
    );
  }
  
  /**
   * 51. å¸³æœ¬è³‡æ–™è¡çªè§£æ±º
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description è™•ç†å¸³æœ¬è³‡æ–™è¡çªçš„æ™ºæ…§è§£æ±ºç­–ç•¥
   */
  static Future<ConflictResolution> resolveDataConflict({
    required DataConflict conflict,
    required UserMode userMode,
  }) async {
    switch (conflict.type) {
      case ConflictType.nameConflict:
        return await _resolveNameConflict(conflict, userMode);
      case ConflictType.permissionConflict:
        return await _resolvePermissionConflict(conflict, userMode);
      case ConflictType.memberConflict:
        return await _resolveMemberConflict(conflict, userMode);
      default:
        return ConflictResolution.manual(conflict);
    }
  }
}
```

---

## 12. UIå…ƒä»¶èˆ‡æ’ç‰ˆéœ€æ±‚

### 12.1 ç¾¤çµ„è¨­è¨ˆç³»çµ±

#### 12.1.1 å¤šå¸³æœ¬å°ˆç”¨è‰²å½©è¦ç¯„
```css
/* å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„å°ˆç”¨è‰²å½©ç³»çµ± */
:root {
  /* å¸³æœ¬é¡å‹è‰²å½© */
  --ledger-personal: #4CAF50;
  --ledger-project: #2196F3;
  --ledger-category: #FF9800;
  
  /* æ¬Šé™è§’è‰²è‰²å½© */
  --role-owner: #F44336;
  --role-admin: #9C27B0;
  --role-editor: #2196F3;
  --role-viewer: #757575;
  
  /* å¸³æœ¬ç‹€æ…‹è‰²å½© */
  --ledger-active: #4CAF50;
  --ledger-inactive: #BDBDBD;
  --ledger-archived: #795548;
  --ledger-shared: #FF5722;
  
  /* ç®¡ç†åŠŸèƒ½è‰²å½© */
  --management-primary: #1976D2;
  --management-secondary: #303F9F;
  --management-accent: #FF6F00;
  --management-warning: #F57C00;
  --management-danger: #D32F2F;
}
```

#### 12.1.2 å¸³æœ¬å¡ç‰‡çµ„ä»¶è¦ç¯„
```css
/* å¸³æœ¬å¡ç‰‡å°ˆç”¨çµ„ä»¶ */
.ledger-card {
  background: var(--main-card-bg);
  border-radius: 12px;
  padding: 20px;
  margin: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  border-left: 4px solid var(--ledger-personal);
  transition: all 0.3s ease;
  cursor: pointer;
}

.ledger-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

.ledger-card.active {
  border-left-color: var(--ledger-active);
  background: linear-gradient(135deg, 
    rgba(76, 175, 80, 0.05), 
    rgba(76, 175, 80, 0.02));
}

.ledger-header {
  display: flex;
  align-items: center;
  margin-bottom: 16px;
}

.ledger-icon {
  width: 40px;
  height: 40px;
  border-radius: 20px;
  background: var(--ledger-personal);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 18px;
  margin-right: 12px;
}

.ledger-info {
  flex: 1;
}

.ledger-name {
  font-size: 18px;
  font-weight: 600;
  color: var(--main-primary);
  margin-bottom: 4px;
}

.ledger-type {
  font-size: 14px;
  color: var(--main-neutral);
  margin-bottom: 4px;
}

.ledger-members {
  display: flex;
  align-items: center;
  font-size: 12px;
  color: var(--main-neutral);
}

.member-avatars {
  display: flex;
  margin-right: 8px;
}

.member-avatar {
  width: 24px;
  height: 24px;
  border-radius: 12px;
  border: 2px solid white;
  margin-left: -8px;
}

.member-avatar:first-child {
  margin-left: 0;
}
```

#### 12.1.3 æ¬Šé™ç®¡ç†çµ„ä»¶è¦ç¯„
```css
/* æ¬Šé™ç®¡ç†å°ˆç”¨çµ„ä»¶ */
.permission-matrix {
  background: var(--main-card-bg);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.permission-header {
  background: var(--management-primary);
  color: white;
  padding: 16px;
  font-weight: 600;
}

.permission-row {
  display: flex;
  border-bottom: 1px solid var(--main-divider);
  transition: background-color 0.2s ease;
}

.permission-row:hover {
  background: rgba(25, 118, 210, 0.05);
}

.permission-cell {
  flex: 1;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.permission-role {
  background: var(--role-admin);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
}

.permission-toggle {
  width: 40px;
  height: 20px;
  background: var(--main-neutral);
  border-radius: 10px;
  position: relative;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.permission-toggle.enabled {
  background: var(--management-primary);
}

.permission-toggle::after {
  content: '';
  width: 16px;
  height: 16px;
  background: white;
  border-radius: 8px;
  position: absolute;
  top: 2px;
  left: 2px;
  transition: transform 0.3s ease;
}

.permission-toggle.enabled::after {
  transform: translateX(20px);
}
```

### 12.2 å››æ¨¡å¼UIå·®ç•°è¨­è¨ˆ

#### 12.2.1 ç²¾æº–æ§åˆ¶è€…æ¨¡å¼
```css
.controller-ledger {
  --mode-primary: #1565C0;
  --mode-accent: #0D47A1;
}

.controller-ledger .ledger-card {
  border-left-width: 6px;
}

.controller-ledger .detailed-info {
  display: block; /* é¡¯ç¤ºè©³ç´°è³‡è¨Š */
}

.controller-ledger .permission-matrix {
  font-size: 12px; /* æ›´å°å­—é«”é¡¯ç¤ºæ›´å¤šè³‡è¨Š */
}

.controller-ledger .advanced-settings {
  display: block; /* é¡¯ç¤ºé€²éšè¨­å®š */
}
```

#### 12.2.2 ç´€éŒ„ç¿’æ…£è€…æ¨¡å¼
```css
.logger-ledger {
  --mode-primary: #7B1FA2;
  --mode-accent: #AD85C6;
}

.logger-ledger .ledger-card {
  background: linear-gradient(135deg, 
    rgba(255,255,255,0.95), 
    rgba(248,245,250,0.95));
  border-left: 4px solid transparent;
  border-image: linear-gradient(135deg, 
    var(--mode-primary), 
    var(--mode-accent)) 1;
}

.logger-ledger .ledger-icon {
  background: linear-gradient(135deg, 
    var(--mode-primary), 
    var(--mode-accent));
  box-shadow: 0 4px 12px rgba(123, 31, 162, 0.3);
}

.logger-ledger .permission-toggle {
  background: linear-gradient(135deg, 
    var(--mode-primary), 
    var(--mode-accent));
  border-radius: 15px;
}
```

#### 12.2.3 è½‰å‹æŒ‘æˆ°è€…æ¨¡å¼
```css
.struggler-ledger {
  --mode-primary: #E65100;
  --mode-accent: #FF8A65;
}

.struggler-ledger .ledger-card {
  position: relative;
}

.struggler-ledger .ledger-card::before {
  content: "ğŸ¯";
  position: absolute;
  top: 16px;
  right: 16px;
  font-size: 24px;
}

.struggler-ledger .goal-progress {
  background: #FFF3E0;
  border: 1px solid var(--mode-primary);
  border-radius: 8px;
  padding: 8px;
  margin-top: 12px;
  text-align: center;
}

.struggler-ledger .achievement-badges {
  display: flex;
  gap: 4px;
  margin-top: 8px;
}

.struggler-ledger .achievement-badge {
  background: var(--mode-primary);
  color: white;
  padding: 2px 6px;
  border-radius: 10px;
  font-size: 10px;
}
```

#### 12.2.4 æ½›åœ¨è¦ºé†’è€…æ¨¡å¼
```css
.sleeper-ledger {
  --mode-primary: #388E3C;
  --mode-accent: #81C784;
}

.sleeper-ledger .ledger-card {
  font-size: 16px; /* æ›´å¤§çš„å­—é«” */
  padding: 24px; /* æ›´å¤§çš„å…§è· */
}

.sleeper-ledger .ledger-icon {
  width: 48px; /* æ›´å¤§çš„åœ–ç¤º */
  height: 48px;
  border-radius: 24px;
}

.sleeper-ledger .ledger-name {
  font-size: 20px; /* æ›´å¤§çš„å¸³æœ¬åç¨± */
}

.sleeper-ledger .complex-options {
  display: none; /* éš±è—è¤‡é›œé¸é … */
}

.sleeper-ledger .simple-toggle {
  width: 50px; /* æ›´å¤§çš„åˆ‡æ›æŒ‰éˆ• */
  height: 25px;
}
```

---

## 13. APIè¦æ ¼

### 13.1 å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„APIæ•´åˆè¦æ ¼

#### 13.1.1 F017 - å¸³æœ¬æ¸…å–®æŸ¥è©¢API

**ç«¯é»è©³ç´°è¦æ ¼**
```javascript
// GET /ledgers
const getLedgers = {
  endpoint: '/ledgers',
  method: 'GET',
  timeout: 10000,
  headers: {
    'Authorization': 'Bearer {accessToken}'
  },
  
  // æŸ¥è©¢åƒæ•¸
  queryParams: {
    // ç¯©é¸åƒæ•¸
    type: 'enum[personal|project|category]?', // å¸³æœ¬é¡å‹ç¯©é¸
    status: 'enum[active|inactive|archived]?', // å¸³æœ¬ç‹€æ…‹ç¯©é¸
    role: 'enum[owner|admin|editor|viewer]?', // ä½¿ç”¨è€…è§’è‰²ç¯©é¸
    
    // æœå°‹åƒæ•¸
    keyword: 'string?', // å¸³æœ¬åç¨±æœå°‹
    
    // æ’åºåƒæ•¸
    sortBy: 'enum[name|created|modified|type]?',
    sortOrder: 'enum[asc|desc]?',
    
    // åˆ†é åƒæ•¸
    page: 'integer?', // é ç¢¼ï¼Œé è¨­1
    limit: 'integer?', // æ¯é ç­†æ•¸ï¼Œé è¨­20
    
    // åŒ…å«åƒæ•¸
    includeMembers: 'boolean?', // åŒ…å«æˆå“¡è³‡è¨Š
    includeStats: 'boolean?', // åŒ…å«çµ±è¨ˆè³‡è¨Š
    includePermissions: 'boolean?' // åŒ…å«æ¬Šé™è³‡è¨Š
  },
  
  // å›æ‡‰æ ¼å¼
  responseSchema: {
    success: 'boolean',
    data: {
      ledgers: [{
        id: 'string',
        name: 'string',
        type: 'enum[personal|project|category]',
        description: 'string?',
        icon: 'string',
        color: 'string',
        status: 'enum[active|inactive|archived]',
        
        // æˆå“¡è³‡è¨Š
        members: [{
          userId: 'string',
          role: 'enum[owner|admin|editor|viewer]',
          joinedAt: 'ISO_8601_datetime',
          lastActive: 'ISO_8601_datetime'
        }],
        
        // æ¬Šé™è³‡è¨Š
        userRole: 'string',
        permissions: {
          read: 'boolean',
          write: 'boolean',
          delete: 'boolean',
          invite: 'boolean',
          manage: 'boolean'
        },
        
        // çµ±è¨ˆè³‡è¨Š
        stats: {
          entryCount: 'integer',
          totalAmount: 'decimal',
          lastEntry: 'ISO_8601_datetime',
          memberCount: 'integer'
        },
        
        // æ™‚é–“æˆ³è¨˜
        createdAt: 'ISO_8601_datetime',
        updatedAt: 'ISO_8601_datetime'
      }],
      
      // åˆ†é è³‡è¨Š
      pagination: {
        currentPage: 'integer',
        totalPages: 'integer',
        totalLedgers: 'integer',
        hasNext: 'boolean',
        hasPrev: 'boolean'
      }
    },
    message: 'string'
  }
};
```

#### 13.1.2 F019 - å»ºç«‹å¸³æœ¬API

**ç«¯é»è©³ç´°è¦æ ¼**
```javascript
// POST /ledgers
const createLedger = {
  endpoint: '/ledgers',
  method: 'POST',
  timeout: 15000,
  headers: {
    'Authorization': 'Bearer {accessToken}',
    'Content-Type': 'application/json'
  },
  
  // è«‹æ±‚æ ¼å¼
  requestSchema: {
    // åŸºæœ¬è³‡è¨Š
    name: 'string', // å¸³æœ¬åç¨±ï¼ˆå¿…å¡«ï¼‰
    type: 'enum[personal|project|category]', // å¸³æœ¬é¡å‹ï¼ˆå¿…å¡«ï¼‰
    description: 'string?', // å¸³æœ¬æè¿°ï¼ˆå¯é¸ï¼‰
    icon: 'string?', // åœ–ç¤ºä»£ç¢¼ï¼ˆå¯é¸ï¼‰
    color: 'string?', // åå…­é€²ä½è‰²ç¢¼ï¼ˆå¯é¸ï¼‰
    
    // é¡å‹å°ˆå±¬è¨­å®š
    projectSettings: {
      startDate: 'ISO_8601_date?',
      endDate: 'ISO_8601_date?',
      budget: 'decimal?',
      objectives: 'string[]?'
    },
    
    categorySettings: {
      autoRules: [{
        condition: {
          field: 'string',
          operator: 'enum[equals|contains|startsWith|endsWith]',
          value: 'string'
        },
        action: {
          categoryId: 'string',
          autoAssign: 'boolean'
        }
      }],
      defaultCategory: 'string?'
    },
    
    // åˆå§‹æˆå“¡è¨­å®š
    initialMembers: [{
      email: 'string',
      role: 'enum[admin|editor|viewer]',
      inviteMessage: 'string?'
    }],
    
    // æ¬Šé™è¨­å®š
    permissions: {
      public: 'boolean', // æ˜¯å¦å…¬é–‹
      invitePolicy: 'enum[owner|admin|anyone]', // é‚€è«‹æ”¿ç­–
      defaultRole: 'enum[viewer|editor]' // é è¨­è§’è‰²
    },
    
    // ç¯„æœ¬è¨­å®š
    templateId: 'string?', // ä½¿ç”¨çš„ç¯„æœ¬ID
    
    // ç³»çµ±æ¬„ä½
    deviceInfo: {
      platform: 'enum[android|ios|web]',
      deviceId: 'string',
      timestamp: 'ISO_8601_datetime'
    }
  },
  
  // å›æ‡‰æ ¼å¼
  responseSchema: {
    success: 'boolean',
    data: {
      ledger: {
        id: 'string',
        name: 'string',
        type: 'string',
        description: 'string?',
        icon: 'string',
        color: 'string',
        status: 'string',
        
        // å‰µå»ºè€…è³‡è¨Š
        owner: {
          userId: 'string',
          role: 'owner'
        },
        
        // åˆå§‹åŒ–ç‹€æ…‹
        initialized: 'boolean',
        setupComplete: 'boolean',
        
        // å»ºç«‹æ™‚é–“
        createdAt: 'ISO_8601_datetime'
      },
      
      // å¾ŒçºŒæ“ä½œ
      nextSteps: [{
        action: 'string',
        description: 'string',
        required: 'boolean'
      }],
      
      // é‚€è«‹çµæœï¼ˆå¦‚æœ‰åˆå§‹æˆå“¡ï¼‰
      invitationResults: [{
        email: 'string',
        status: 'enum[sent|failed|pending]',
        invitationId: 'string?'
      }]
    },
    message: 'string'
  }
};
```

#### 13.1.3 F030 - ç™¼é€æˆå“¡é‚€è«‹API

**ç«¯é»è©³ç´°è¦æ ¼**
```javascript
// POST /ledgers/:id/invitations
const sendInvitation = {
  endpoint: '/ledgers/:ledgerId/invitations',
  method: 'POST',
  timeout: 10000,
  headers: {
    'Authorization': 'Bearer {accessToken}',
    'Content-Type': 'application/json'
  },
  
  // è·¯å¾‘åƒæ•¸
  pathParams: {
    ledgerId: 'string' // å¸³æœ¬ID
  },
  
  // è«‹æ±‚æ ¼å¼
  requestSchema: {
    // é‚€è«‹å°è±¡
    invitations: [{
      email: 'string', // è¢«é‚€è«‹è€…Email
      role: 'enum[admin|editor|viewer]', // åˆ†é…è§’è‰²
      permissions: {
        read: 'boolean',
        write: 'boolean',
        delete: 'boolean',
        invite: 'boolean',
        manage: 'boolean'
      },
      personalMessage: 'string?' // å€‹äººåŒ–é‚€è«‹è¨Šæ¯
    }],
    
    // é‚€è«‹è¨­å®š
    invitationSettings: {
      expirationDays: 'integer', // éæœŸå¤©æ•¸ï¼ˆ1-30ï¼‰
      requireApproval: 'boolean', // æ˜¯å¦éœ€è¦å¯©æ ¸
      sendReminder: 'boolean', // æ˜¯å¦ç™¼é€æé†’
      reminderDays: 'integer?' // æé†’é–“éš”å¤©æ•¸
    },
    
    // é‚€è«‹è¨Šæ¯
    message: {
      subject: 'string?', // é‚€è«‹éƒµä»¶ä¸»æ—¨
      body: 'string?', // é‚€è«‹éƒµä»¶å…§å®¹
      language: 'enum[zh_TW|en_US]?' // é‚€è«‹èªè¨€
    },
    
    // ç™¼é€è€…è³‡è¨Š
    inviterInfo: {
      name: 'string',
      title: 'string?',
      message: 'string?' // ç™¼é€è€…ç•™è¨€
    }
  },
  
  // å›æ‡‰æ ¼å¼
  responseSchema: {
    success: 'boolean',
    data: {
      // é‚€è«‹çµæœæ‘˜è¦
      summary: {
        totalInvitations: 'integer',
        sentSuccessfully: 'integer',
        failed: 'integer',
        duplicate: 'integer'
      },
      
      // è©³ç´°é‚€è«‹çµæœ
      invitations: [{
        email: 'string',
        status: 'enum[sent|failed|duplicate|invalid]',
        invitationId: 'string?',
        expiresAt: 'ISO_8601_datetime?',
        error: 'string?',
        
        // é‚€è«‹é€£çµï¼ˆå¦‚æˆåŠŸï¼‰
        invitationLink: 'string?',
        invitationCode: 'string?'
      }],
      
      // å¾ŒçºŒè¿½è¹¤
      tracking: {
        canResend: 'boolean',
        reminderScheduled: 'boolean',
        trackingId: 'string'
      }
    },
    message: 'string'
  }
};
```

---

## 14. ç‹€æ…‹èˆ‡ç•«é¢åˆ‡æ›

### 14.1 å¤šå¸³æœ¬ç¾¤çµ„ç‹€æ…‹ç®¡ç†

#### 14.1.1 ç¾¤çµ„ç´šç‹€æ…‹å®šç¾©
```dart
// å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„çµ±ä¸€ç‹€æ…‹ç®¡ç†
enum LedgerManagementState {
  // åˆå§‹ç‹€æ…‹
  initial,
  loading,
  
  // å¸³æœ¬æ“ä½œç‹€æ…‹
  ledgerLoading,
  ledgerLoaded,
  ledgerCreating,
  ledgerUpdating,
  ledgerDeleting,
  
  // æˆå“¡ç®¡ç†ç‹€æ…‹
  membersLoading,
  membersLoaded,
  memberInviting,
  memberUpdating,
  memberRemoving,
  
  // æ¬Šé™è¨­å®šç‹€æ…‹
  permissionsLoading,
  permissionsLoaded,
  permissionsUpdating,
  
  // åŒæ­¥ç‹€æ…‹
  syncing,
  syncComplete,
  syncFailed,
  offline,
  
  // éŒ¯èª¤ç‹€æ…‹
  error,
  permissionError,
  networkError,
  conflictError
}

// å¤šå¸³æœ¬ç®¡ç†è³‡æ–™æ¨¡å‹
class LedgerManagementModel {
  // å¸³æœ¬è³‡æ–™
  List<Ledger> ledgers;
  Ledger? currentLedger;
  Ledger? activeLedger;
  
  // æˆå“¡è³‡æ–™
  List<LedgerMember> members;
  List<PendingInvitation> pendingInvitations;
  
  // æ¬Šé™è³‡æ–™
  PermissionMatrix? permissions;
  UserRole? currentUserRole;
  
  // çµ±è¨ˆè³‡æ–™
  Map<String, LedgerStats> ledgerStats;
  
  // ç‹€æ…‹æ§åˆ¶
  LedgerManagementState currentState;
  String? errorMessage;
  bool isOfflineMode;
  DateTime? lastSyncTime;
  
  LedgerManagementModel({
    this.ledgers = const [],
    this.currentLedger,
    this.activeLedger,
    this.members = const [],
    this.pendingInvitations = const [],
    this.permissions,
    this.currentUserRole,
    this.ledgerStats = const {},
    this.currentState = LedgerManagementState.initial,
    this.errorMessage,
    this.isOfflineMode = false,
    this.lastSyncTime,
  });
}
```

#### 14.1.2 ç‹€æ…‹è½‰æ›æ§åˆ¶å™¨
```dart
// å¤šå¸³æœ¬ç‹€æ…‹è½‰æ›ç®¡ç†
class LedgerStateController {
  
  /**
   * 52. å¸³æœ¬æ“ä½œç‹€æ…‹ç®¡ç†
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description ç®¡ç†å¸³æœ¬æ“ä½œçš„ç‹€æ…‹è½‰æ›
   */
  static Future<StateTransitionResult> handleLedgerOperation({
    required LedgerOperation operation,
    required LedgerManagementModel currentModel,
    required UserMode userMode,
  }) async {
    switch (operation.type) {
      case LedgerOperationType.create:
        return await _handleCreateLedger(operation, currentModel, userMode);
      case LedgerOperationType.update:
        return await _handleUpdateLedger(operation, currentModel, userMode);
      case LedgerOperationType.delete:
        return await _handleDeleteLedger(operation, currentModel, userMode);
      case LedgerOperationType.switch:
        return await _handleSwitchLedger(operation, currentModel, userMode);
      default:
        return StateTransitionResult.error('æœªçŸ¥çš„å¸³æœ¬æ“ä½œé¡å‹');
    }
  }
  
  /**
   * 53. æ¬Šé™è®Šæ›´ç‹€æ…‹ç®¡ç†
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description ç®¡ç†æ¬Šé™è®Šæ›´çš„ç‹€æ…‹è½‰æ›
   */
  static Future<PermissionUpdateResult> handlePermissionUpdate({
    required String ledgerId,
    required PermissionUpdate update,
    required LedgerManagementModel model,
  }) async {
    // æª¢æŸ¥ç•¶å‰ä½¿ç”¨è€…æ¬Šé™
    final hasPermission = await PermissionChecker.canUpdatePermissions(
      ledgerId: ledgerId,
      currentRole: model.currentUserRole,
    );
    
    if (!hasPermission) {
      model.currentState = LedgerManagementState.permissionError;
      model.errorMessage = 'æ¬Šé™ä¸è¶³ï¼Œç„¡æ³•ä¿®æ”¹å¸³æœ¬æ¬Šé™è¨­å®š';
      return PermissionUpdateResult.denied();
    }
    
    model.currentState = LedgerManagementState.permissionsUpdating;
    
    try {
      // åŸ·è¡Œæ¬Šé™æ›´æ–°
      await PermissionService.updatePermissions(ledgerId, update);
      
      // é‡æ–°è¼‰å…¥æ¬Šé™è³‡æ–™
      model.permissions = await PermissionService.getPermissions(ledgerId);
      model.currentState = LedgerManagementState.permissionsLoaded;
      
      return PermissionUpdateResult.success();
    } catch (e) {
      model.currentState = LedgerManagementState.error;
      model.errorMessage = 'æ¬Šé™æ›´æ–°å¤±æ•—ï¼š${e.toString()}';
      return PermissionUpdateResult.error(e.toString());
    }
  }
  
  /**
   * 54. æˆå“¡é‚€è«‹ç‹€æ…‹ç®¡ç†
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description ç®¡ç†æˆå“¡é‚€è«‹çš„ç‹€æ…‹è½‰æ›
   */
  static Future<InvitationResult> handleMemberInvitation({
    required String ledgerId,
    required List<InvitationRequest> invitations,
    required LedgerManagementModel model,
  }) async {
    model.currentState = LedgerManagementState.memberInviting;
    
    try {
      final result = await MemberService.sendInvitations(
        ledgerId: ledgerId,
        invitations: invitations,
      );
      
      // æ›´æ–°å¾…è™•ç†é‚€è«‹æ¸…å–®
      model.pendingInvitations.addAll(result.pendingInvitations);
      model.currentState = LedgerManagementState.membersLoaded;
      
      return result;
    } catch (e) {
      model.currentState = LedgerManagementState.error;
      model.errorMessage = 'é‚€è«‹ç™¼é€å¤±æ•—ï¼š${e.toString()}';
      return InvitationResult.error(e.toString());
    }
  }
}
```

---

## 15. å®‰å…¨æ€§èˆ‡æ¬Šé™æª¢æŸ¥

### 15.1 å¤šå¸³æœ¬ç¾¤çµ„å®‰å…¨æ¶æ§‹

#### 15.1.1 å¸³æœ¬å±¤ç´šæ¬Šé™æ§åˆ¶
```dart
// å¤šå¸³æœ¬å®‰å…¨ç®¡ç†
class LedgerSecurityManager {
  
  /**
   * 55. å¸³æœ¬å­˜å–æ¬Šé™æª¢æŸ¥
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description æª¢æŸ¥ä½¿ç”¨è€…å°ç‰¹å®šå¸³æœ¬çš„å­˜å–æ¬Šé™
   */
  static Future<LedgerAccessResult> checkLedgerAccess({
    required String userId,
    required String ledgerId,
    required LedgerAccessType accessType,
  }) async {
    try {
      // åŸºæœ¬æ¬Šé™æª¢æŸ¥
      final membership = await LedgerMembershipService.getMembership(
        userId: userId,
        ledgerId: ledgerId,
      );
      
      if (membership == null) {
        return LedgerAccessResult.denied('éå¸³æœ¬æˆå“¡');
      }
      
      // å¸³æœ¬ç‹€æ…‹æª¢æŸ¥
      final ledger = await LedgerService.getLedger(ledgerId);
      if (ledger.status == LedgerStatus.archived) {
        return LedgerAccessResult.denied('å¸³æœ¬å·²å°å­˜');
      }
      
      // è§’è‰²æ¬Šé™æª¢æŸ¥
      final hasPermission = await _checkRolePermission(
        role: membership.role,
        accessType: accessType,
        ledgerType: ledger.type,
      );
      
      if (!hasPermission) {
        return LedgerAccessResult.denied('è§’è‰²æ¬Šé™ä¸è¶³');
      }
      
      // æ™‚é–“é™åˆ¶æª¢æŸ¥ï¼ˆå°ˆæ¡ˆå¸³æœ¬ï¼‰
      if (ledger.type == LedgerType.project) {
        final timeCheck = await _checkProjectTimeAccess(ledger, accessType);
        if (!timeCheck.isAllowed) {
          return LedgerAccessResult.denied(timeCheck.reason);
        }
      }
      
      return LedgerAccessResult.allowed(
        role: membership.role,
        permissions: await _getEffectivePermissions(membership),
      );
    } catch (e) {
      logSecurityEvent('Ledger access check failed: $e');
      return LedgerAccessResult.denied('æ¬Šé™æª¢æŸ¥å¤±æ•—');
    }
  }
  
  /**
   * 56. æˆå“¡é‚€è«‹å®‰å…¨é©—è­‰
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description é©—è­‰æˆå“¡é‚€è«‹çš„å®‰å…¨æ€§
   */
  static Future<InvitationSecurityResult> validateInvitation({
    required String inviterId,
    required String ledgerId,
    required List<String> inviteeEmails,
    required UserRole assignedRole,
  }) async {
    try {
      // é‚€è«‹è€…æ¬Šé™æª¢æŸ¥
      final inviterAccess = await checkLedgerAccess(
        userId: inviterId,
        ledgerId: ledgerId,
        accessType: LedgerAccessType.invite,
      );
      
      if (!inviterAccess.isAllowed) {
        return InvitationSecurityResult.denied('é‚€è«‹è€…æ¬Šé™ä¸è¶³');
      }
      
      // è§’è‰²éšå±¤æª¢æŸ¥
      final canAssignRole = await _canAssignRole(
        inviterRole: inviterAccess.role!,
        assignedRole: assignedRole,
      );
      
      if (!canAssignRole) {
        return InvitationSecurityResult.denied('ç„¡æ³•åˆ†é…æ­¤è§’è‰²');
      }
      
      // é‚€è«‹Emailå®‰å…¨æª¢æŸ¥
      for (final email in inviteeEmails) {
        final emailCheck = await _validateInviteeEmail(email, ledgerId);
        if (!emailCheck.isValid) {
          return InvitationSecurityResult.denied(
            'é‚€è«‹Emailç„¡æ•ˆï¼š${emailCheck.reason}'
          );
        }
      }
      
      // é‚€è«‹é »ç‡é™åˆ¶æª¢æŸ¥
      final rateCheck = await _checkInvitationRateLimit(inviterId, ledgerId);
      if (!rateCheck.isAllowed) {
        return InvitationSecurityResult.denied('é‚€è«‹é »ç‡éé«˜ï¼Œè«‹ç¨å¾Œå†è©¦');
      }
      
      return InvitationSecurityResult.allowed();
    } catch (e) {
      logSecurityEvent('Invitation validation failed: $e');
      return InvitationSecurityResult.denied('é‚€è«‹é©—è­‰å¤±æ•—');
    }
  }
  
  /**
   * 57. å¸³æœ¬è³‡æ–™éš±ç§ä¿è­·
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¬Šé™ä¿è­·å¸³æœ¬è³‡æ–™éš±ç§
   */
  static Future<Ledger> protectLedgerData({
    required Ledger ledger,
    required String userId,
    required UserRole userRole,
  }) async {
    final protectedLedger = ledger.copy();
    
    // æ ¹æ“šè§’è‰²éš±è—æ•æ„Ÿè³‡è¨Š
    switch (userRole) {
      case UserRole.owner:
      case UserRole.admin:
        // å®Œæ•´å­˜å–æ¬Šé™
        break;
        
      case UserRole.editor:
        // éš±è—ç®¡ç†ç›¸é—œè³‡è¨Š
        protectedLedger.members = protectedLedger.members
            .where((member) => member.userId == userId || 
                   member.role != UserRole.owner)
            .toList();
        protectedLedger.invitationLinks = null;
        break;
        
      case UserRole.viewer:
        // åƒ…é¡¯ç¤ºåŸºæœ¬è³‡è¨Š
        protectedLedger.members = protectedLedger.members
            .where((member) => member.userId == userId)
            .toList();
        protectedLedger.settings = null;
        protectedLedger.invitationLinks = null;
        protectedLedger.auditLogs = null;
        break;
    }
    
    // è¨˜éŒ„è³‡æ–™å­˜å–
    await AuditLogger.logDataAccess(
      userId: userId,
      ledgerId: ledger.id,
      dataType: 'ledger_details',
      accessLevel: userRole.toString(),
    );
    
    return protectedLedger;
  }
}
```

---

## 16. å…¶ä»–è£œå……éœ€æ±‚

### 16.1 æ•ˆèƒ½è¦æ±‚è¦ç¯„

#### 16.1.1 å¤šå¸³æœ¬ç¾¤çµ„æ•ˆèƒ½æŒ‡æ¨™
| æŒ‡æ¨™é¡åˆ¥ | ç›®æ¨™å€¼ | æ¸¬é‡æ–¹æ³• | å„ªåŒ–ç­–ç•¥ |
|----------|--------|----------|----------|
| **å¸³æœ¬æ¸…å–®è¼‰å…¥** | < 2ç§’ | APIå›æ‡‰æ™‚é–“ | å¿«å–ç­–ç•¥ã€åˆ†é è¼‰å…¥ |
| **å¸³æœ¬åˆ‡æ›æ™‚é–“** | < 1ç§’ | æœ¬åœ°åˆ‡æ›æ™‚é–“ | æœ¬åœ°å¿«å–ã€é è¼‰å…¥ |
| **æ¬Šé™æª¢æŸ¥å›æ‡‰** | < 500ms | æ¬Šé™é©—è­‰æ™‚é–“ | æ¬Šé™å¿«å–ã€æ‰¹é‡æª¢æŸ¥ |
| **æˆå“¡é‚€è«‹ç™¼é€** | < 3ç§’ | é‚€è«‹APIæ™‚é–“ | æ‰¹é‡è™•ç†ã€ç•°æ­¥ç™¼é€ |
| **çµ±è¨ˆè¼‰å…¥æ™‚é–“** | < 3ç§’ | çµ±è¨ˆAPIæ™‚é–“ | é è¨ˆç®—ã€å¢é‡æ›´æ–° |
| **è¨˜æ†¶é«”ä½¿ç”¨é‡** | < 80MB | é‹è¡Œæ™‚è¨˜æ†¶é«” | è³‡æ–™æ‡¶è¼‰å…¥ã€å¿«å–æ¸…ç† |

#### 16.1.2 å¤šå¸³æœ¬æ•ˆèƒ½æœ€ä½³åŒ–
```dart
// å¤šå¸³æœ¬æ•ˆèƒ½æœ€ä½³åŒ–ç®¡ç†
class LedgerPerformanceOptimizer {
  
  /**
   * 58. å¸³æœ¬è³‡æ–™é è¼‰å…¥ç­–ç•¥
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description æ™ºæ…§é è¼‰å…¥å¸¸ç”¨å¸³æœ¬è³‡æ–™
   */
  static Future<void> implementSmartPreloading(
    UserLedgerPattern pattern
  ) async {
    // é è¼‰å…¥å¸¸ç”¨å¸³æœ¬
    if (pattern.frequentLedgers.isNotEmpty) {
      await LedgerCache.preload(pattern.frequentLedgers);
    }
    
    // é è¼‰å…¥æ´»èºå¸³æœ¬çµ±è¨ˆ
    if (pattern.activeLedger != null) {
      await StatsCache.preloadLedgerStats(pattern.activeLedger!);
    }
    
    // é è¼‰å…¥æˆå“¡è³‡è¨Šï¼ˆå¦‚æœæ˜¯ç®¡ç†è€…ï¼‰
    if (pattern.hasManagementRole) {
      await MemberCache.preloadMemberData(pattern.managedLedgers);
    }
  }
  
  /**
   * 59. æ¬Šé™å¿«å–æœ€ä½³åŒ–
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description æœ€ä½³åŒ–æ¬Šé™æª¢æŸ¥æ•ˆèƒ½
   */
  static Future<void> optimizePermissionCaching() async {
    // é è¼‰å…¥ä½¿ç”¨è€…æ‰€æœ‰å¸³æœ¬çš„æ¬Šé™
    final userLedgers = await LedgerService.getUserLedgers();
    
    for (final ledger in userLedgers) {
      // ç•°æ­¥é è¼‰å…¥æ¬Šé™è³‡æ–™
      PermissionCache.preloadPermissions(ledger.id);
    }
    
    // è¨­å®šæ¬Šé™å¿«å–æ›´æ–°ç­–ç•¥
    PermissionCache.setUpdateStrategy(
      strategy: CacheUpdateStrategy.onPermissionChange,
      maxAge: Duration(hours: 1),
    );
  }
}
```

### 16.2 å”ä½œåŠŸèƒ½å¼·åŒ–

#### 16.2.1 å³æ™‚å”ä½œæ”¯æ´
```dart
// å¤šå¸³æœ¬å³æ™‚å”ä½œåŠŸèƒ½
class LedgerCollaborationEnhancer {
  
  /**
   * 60. å³æ™‚æˆå“¡ç‹€æ…‹åŒæ­¥
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description æä¾›å³æ™‚çš„æˆå“¡åœ¨ç·šç‹€æ…‹èˆ‡æ´»å‹•åŒæ­¥
   */
  static Future<void> enableRealtimeSync(String ledgerId) async {
    // å»ºç«‹WebSocketé€£ç·š
    final wsConnection = await WebSocketManager.connect(
      endpoint: '/ledgers/$ledgerId/realtime',
      channels: ['member_status', 'permission_changes', 'ledger_updates'],
    );
    
    // ç›£è½æˆå“¡ç‹€æ…‹è®ŠåŒ–
    wsConnection.on('member_status_change', (data) {
      final memberStatus = MemberStatus.fromJson(data);
      MemberStatusNotifier.updateStatus(memberStatus);
    });
    
    // ç›£è½æ¬Šé™è®Šæ›´
    wsConnection.on('permission_update', (data) {
      final permissionUpdate = PermissionUpdate.fromJson(data);
      PermissionNotifier.updatePermissions(permissionUpdate);
    });
    
    // ç›£è½å¸³æœ¬æ›´æ–°
    wsConnection.on('ledger_update', (data) {
      final ledgerUpdate = LedgerUpdate.fromJson(data);
      LedgerNotifier.updateLedger(ledgerUpdate);
    });
  }
  
  /**
   * 61. å”ä½œè¡çªè§£æ±º
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description è™•ç†å¤šäººåŒæ™‚ç·¨è¼¯çš„è¡çªè§£æ±º
   */
  static Future<ConflictResolution> resolveEditConflict({
    required String ledgerId,
    required EditConflict conflict,
    required UserMode userMode,
  }) async {
    switch (conflict.type) {
      case ConflictType.simultaneousEdit:
        return await _handleSimultaneousEdit(conflict, userMode);
      case ConflictType.permissionConflict:
        return await _handlePermissionConflict(conflict, userMode);
      case ConflictType.dataInconsistency:
        return await _handleDataInconsistency(conflict, userMode);
      default:
        return ConflictResolution.manual(conflict);
    }
  }
}
```

### 16.3 åœ‹éš›åŒ–èˆ‡æœ¬åœ°åŒ–

#### 16.3.1 å¤šå¸³æœ¬å¤šèªè¨€æ”¯æ´
```dart
// å¤šå¸³æœ¬åœ‹éš›åŒ–æ”¯æ´
class LedgerInternationalization {
  static const Map<String, Map<String, String>> translations = {
    'zh_TW': {
      // å¸³æœ¬é¡å‹
      'ledger_personal': 'å€‹äººå¸³æœ¬',
      'ledger_project': 'å°ˆæ¡ˆå¸³æœ¬',
      'ledger_category': 'åˆ†é¡å¸³æœ¬',
      
      // æˆå“¡è§’è‰²
      'role_owner': 'æ“æœ‰è€…',
      'role_admin': 'ç®¡ç†å“¡',
      'role_editor': 'ç·¨è¼¯è€…',
      'role_viewer': 'æª¢è¦–è€…',
      
      // å¸³æœ¬æ“ä½œ
      'create_ledger': 'å»ºç«‹å¸³æœ¬',
      'edit_ledger': 'ç·¨è¼¯å¸³æœ¬',
      'delete_ledger': 'åˆªé™¤å¸³æœ¬',
      'switch_ledger': 'åˆ‡æ›å¸³æœ¬',
      
      // æˆå“¡ç®¡ç†
      'invite_members': 'é‚€è«‹æˆå“¡',
      'manage_members': 'ç®¡ç†æˆå“¡',
      'remove_member': 'ç§»é™¤æˆå“¡',
      'update_permissions': 'æ›´æ–°æ¬Šé™',
      
      // å››æ¨¡å¼å°ˆç”¨
      'controller_ledger_management': 'ç²¾æº–å¸³æœ¬æ§åˆ¶',
      'logger_ledger_management': 'å„ªé›…å¸³æœ¬ç®¡ç†',
      'struggler_ledger_management': 'ç›®æ¨™å¸³æœ¬è¿½è¹¤',
      'sleeper_ledger_management': 'ç°¡æ˜“å¸³æœ¬ç®¡ç†',
    },
    
    'en_US': {
      // Ledger types
      'ledger_personal': 'Personal Ledger',
      'ledger_project': 'Project Ledger',
      'ledger_category': 'Category Ledger',
      
      // Member roles
      'role_owner': 'Owner',
      'role_admin': 'Administrator',
      'role_editor': 'Editor',
      'role_viewer': 'Viewer',
      
      // Ledger operations
      'create_ledger': 'Create Ledger',
      'edit_ledger': 'Edit Ledger',
      'delete_ledger': 'Delete Ledger',
      'switch_ledger': 'Switch Ledger',
      
      // Member management
      'invite_members': 'Invite Members',
      'manage_members': 'Manage Members',
      'remove_member': 'Remove Member',
      'update_permissions': 'Update Permissions',
      
      // Mode specific
      'controller_ledger_management': 'Precision Ledger Control',
      'logger_ledger_management': 'Elegant Ledger Management',
      'struggler_ledger_management': 'Goal Ledger Tracking',
      'sleeper_ledger_management': 'Simple Ledger Management',
    },
  };
  
  /**
   * 62. å¸³æœ¬æœ¬åœ°åŒ–è™•ç†
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description æ ¹æ“šåœ°å€è¨­å®šæœ¬åœ°åŒ–å¸³æœ¬è³‡æ–™
   */
  static Ledger localizeLedger({
    required Ledger ledger,
    String? locale,
  }) {
    locale ??= _getCurrentLocale();
    
    final localizedLedger = ledger.copy();
    
    // æœ¬åœ°åŒ–å¸³æœ¬é¡å‹é¡¯ç¤º
    localizedLedger.typeDisplayName = _getLocalizedText(
      'ledger_${ledger.type}',
      locale,
    );
    
    // æœ¬åœ°åŒ–æˆå“¡è§’è‰²
    localizedLedger.members = ledger.members.map((member) =>
      member.copyWith(
        roleDisplayName: _getLocalizedText('role_${member.role}', locale),
      )
    ).toList();
    
    // æœ¬åœ°åŒ–æ—¥æœŸæ™‚é–“æ ¼å¼
    localizedLedger.createdAtFormatted = _formatDateTime(
      ledger.createdAt,
      locale,
    );
    
    return localizedLedger;
  }
}
```

---

## 17. é é¢è©³ç´°è¦æ ¼

### 17.1 P016 å¸³æœ¬æ¸…å–®é é¢è©³ç´°è¦æ ¼

#### 17.1.1 æ ¸å¿ƒåŠŸèƒ½è¦æ ¼
- **å¸³æœ¬ç¸½è¦½**ï¼šé¡¯ç¤ºæ‰€æœ‰å¯å­˜å–çš„å¸³æœ¬æ¸…å–®
- **å¿«é€Ÿåˆ‡æ›**ï¼šä¸€éµåˆ‡æ›æ´»èºå¸³æœ¬
- **å»ºç«‹å…¥å£**ï¼šå¿«é€Ÿå»ºç«‹æ–°å¸³æœ¬çš„å…¥å£
- **æ™ºæ…§åˆ†é¡**ï¼šä¾é¡å‹ã€ç‹€æ…‹ã€è§’è‰²åˆ†é¡é¡¯ç¤º

#### 17.1.2 å¸³æœ¬å¡ç‰‡è¨­è¨ˆå¯¦ä½œ
```dart
// P016 å¸³æœ¬å¡ç‰‡å…ƒä»¶
class LedgerCard extends StatelessWidget {
  
  /**
   * 63. æ™ºæ…§å¸³æœ¬å¡ç‰‡æ¸²æŸ“
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description æ ¹æ“šå¸³æœ¬é¡å‹èˆ‡ä½¿ç”¨è€…è§’è‰²æ¸²æŸ“å¡ç‰‡
   */
  Widget build(BuildContext context) {
    return Container(
      margin: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
      decoration: BoxDecoration(
        borderRadius: BorderRadius.circular(12),
        boxShadow: [
          BoxShadow(
            color: Colors.black.withOpacity(0.1),
            blurRadius: 8,
            offset: Offset(0, 2),
          ),
        ],
      ),
      child: Material(
        borderRadius: BorderRadius.circular(12),
        color: _getCardBackgroundColor(),
        child: InkWell(
          borderRadius: BorderRadius.circular(12),
          onTap: () => _handleLedgerTap(),
          onLongPress: () => _showLedgerOptions(),
          child: Container(
            padding: EdgeInsets.all(20),
            decoration: BoxDecoration(
              border: Border(
                left: BorderSide(
                  color: _getLedgerTypeColor(),
                  width: 4,
                ),
              ),
            ),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                _buildLedgerHeader(),
                SizedBox(height: 12),
                _buildLedgerInfo(),
                SizedBox(height: 8),
                _buildLedgerStats(),
                if (_shouldShowModeSpecificContent())
                  _buildModeSpecificContent(),
              ],
            ),
          ),
        ),
      ),
    );
  }
}
```

### 17.2 P017 å»ºç«‹å¸³æœ¬é é¢è©³ç´°è¦æ ¼

#### 17.2.1 æ ¸å¿ƒåŠŸèƒ½è¦æ ¼
- **é¡å‹é¸æ“‡**ï¼šå€‹äººã€å°ˆæ¡ˆã€åˆ†é¡ä¸‰ç¨®é¡å‹é¸æ“‡
- **ç¯„æœ¬ç³»çµ±**ï¼šé è¨­ç¯„æœ¬èˆ‡è‡ªè¨‚ç¯„æœ¬é¸æ“‡
- **åˆå§‹è¨­å®š**ï¼šåŸºæœ¬è³‡è¨Šèˆ‡é€²éšè¨­å®šé…ç½®
- **æˆå“¡é‚€è«‹**ï¼šå»ºç«‹æ™‚åŒæ­¥é‚€è«‹åˆå§‹æˆå“¡

#### 17.2.2 å¸³æœ¬å»ºç«‹ç²¾éˆå¯¦ä½œ
```dart
// P017 å¸³æœ¬å»ºç«‹ç²¾éˆ
class LedgerCreationWizard extends StatefulWidget {
  
  /**
   * 64. å¸³æœ¬å»ºç«‹æµç¨‹ç®¡ç†
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description ç®¡ç†åˆ†æ­¥é©Ÿçš„å¸³æœ¬å»ºç«‹æµç¨‹
   */
  
  final List<WizardStep> steps = [
    WizardStep(
      title: 'é¸æ“‡å¸³æœ¬é¡å‹',
      component: LedgerTypeSelection(),
      validator: (data) => data['type'] != null,
    ),
    WizardStep(
      title: 'åŸºæœ¬è³‡è¨Šè¨­å®š',
      component: BasicInfoForm(),
      validator: (data) => _validateBasicInfo(data),
    ),
    WizardStep(
      title: 'é€²éšè¨­å®š',
      component: AdvancedSettingsForm(),
      validator: (data) => _validateAdvancedSettings(data),
      conditional: (data) => _requiresAdvancedSettings(data),
    ),
    WizardStep(
      title: 'æˆå“¡é‚€è«‹',
      component: InitialMembersForm(),
      validator: (data) => _validateInitialMembers(data),
      optional: true,
    ),
    WizardStep(
      title: 'ç¢ºèªå»ºç«‹',
      component: CreationConfirmation(),
      validator: (data) => true,
    ),
  ];
  
  /**
   * 65. æ™ºæ…§å¸³æœ¬ç¯„æœ¬å»ºè­°
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description åŸºæ–¼ä½¿ç”¨è€…ç¿’æ…£å»ºè­°é©åˆçš„å¸³æœ¬ç¯„æœ¬
   */
  static Future<List<LedgerTemplate>> suggestTemplates({
    required LedgerType type,
    required UserMode userMode,
    required UserProfile userProfile,
  }) async {
    final allTemplates = await TemplateService.getTemplates(type);
    
    // æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼ç¯©é¸ç¯„æœ¬
    final modeCompatibleTemplates = allTemplates.where((template) =>
      template.supportedModes.contains(userMode)
    ).toList();
    
    // æ ¹æ“šä½¿ç”¨è€…æ­·å²åå¥½æ’åº
    final userPreferences = await UserPreferenceService.getPreferences();
    modeCompatibleTemplates.sort((a, b) =>
      _calculateTemplateScore(b, userPreferences)
          .compareTo(_calculateTemplateScore(a, userPreferences))
    );
    
    return modeCompatibleTemplates.take(5).toList();
  }
}
```

### 17.3 P021 æˆå“¡ç®¡ç†é é¢è©³ç´°è¦æ ¼

#### 17.3.1 æ ¸å¿ƒåŠŸèƒ½è¦æ ¼
- **æˆå“¡æ¸…å–®**ï¼šå®Œæ•´çš„å¸³æœ¬æˆå“¡æ¸…å–®èˆ‡è§’è‰²é¡¯ç¤º
- **è§’è‰²ç®¡ç†**ï¼šæˆå“¡è§’è‰²ä¿®æ”¹èˆ‡æ¬Šé™èª¿æ•´
- **æ´»å‹•è¿½è¹¤**ï¼šæˆå“¡æ´»å‹•è¨˜éŒ„èˆ‡åœ¨ç·šç‹€æ…‹
- **æ‰¹é‡æ“ä½œ**ï¼šæ‰¹é‡é‚€è«‹ã€è§’è‰²èª¿æ•´ã€æˆå“¡ç§»é™¤

#### 17.3.2 æˆå“¡ç®¡ç†å…ƒä»¶å¯¦ä½œ
```dart
// P021 æˆå“¡ç®¡ç†å…ƒä»¶
class MemberManagementPanel extends StatefulWidget {
  
  /**
   * 66. æˆå“¡æ¸…å–®ç®¡ç†
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description å®Œæ•´çš„æˆå“¡æ¸…å–®ç®¡ç†åŠŸèƒ½
   */
  
  Widget _buildMemberList() {
    return Column(
      children: [
        _buildMemberFilters(),
        SizedBox(height: 16),
        Expanded(
          child: ListView.builder(
            itemCount: filteredMembers.length,
            itemBuilder: (context, index) {
              final member = filteredMembers[index];
              return _buildMemberCard(member);
            },
          ),
        ),
      ],
    );
  }
  
  /**
   * 67. å³æ™‚æˆå“¡ç‹€æ…‹é¡¯ç¤º
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description é¡¯ç¤ºæˆå“¡çš„å³æ™‚åœ¨ç·šç‹€æ…‹èˆ‡æ´»å‹•
   */
  Widget _buildMemberCard(LedgerMember member) {
    return Card(
      margin: EdgeInsets.symmetric(horizontal: 16, vertical: 4),
      child: ListTile(
        leading: Stack(
          children: [
            CircleAvatar(
              backgroundImage: NetworkImage(member.avatarUrl),
              radius: 24,
            ),
            Positioned(
              right: 0,
              bottom: 0,
              child: Container(
                width: 16,
                height: 16,
                decoration: BoxDecoration(
                  color: _getOnlineStatusColor(member.onlineStatus),
                  shape: BoxShape.circle,
                  border: Border.all(color: Colors.white, width: 2),
                ),
              ),
            ),
          ],
        ),
        title: Text(
          member.displayName,
          style: TextStyle(fontWeight: FontWeight.w600),
        ),
        subtitle: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(
              _getRoleDisplayName(member.role),
              style: TextStyle(
                color: _getRoleColor(member.role),
                fontWeight: FontWeight.w500,
              ),
            ),
            SizedBox(height: 4),
            Text(
              _getLastActiveText(member.lastActive),
              style: TextStyle(
                fontSize: 12,
                color: Colors.grey[600],
              ),
            ),
          ],
        ),
        trailing: _buildMemberActions(member),
        onTap: () => _showMemberDetails(member),
      ),
    );
  }
}
```

### 17.4 P022 æ¬Šé™è¨­å®šé é¢è©³ç´°è¦æ ¼

#### 17.4.1 æ ¸å¿ƒåŠŸèƒ½è¦æ ¼
- **æ¬Šé™çŸ©é™£**ï¼šè§’è‰²èˆ‡æ¬Šé™çš„å®Œæ•´çŸ©é™£é¡¯ç¤º
- **ç´°ç²’åº¦æ§åˆ¶**ï¼šæ”¯æ´å…·é«”åŠŸèƒ½çš„æ¬Šé™è¨­å®š
- **ç¹¼æ‰¿è¦å‰‡**ï¼šè§’è‰²ç¹¼æ‰¿èˆ‡æ¬Šé™å±¤ç´šç®¡ç†
- **é è¦½æ¨¡å¼**ï¼šæ¬Šé™è®Šæ›´æ•ˆæœé è¦½

#### 17.4.2 æ¬Šé™çŸ©é™£å…ƒä»¶å¯¦ä½œ
```dart
// P022 æ¬Šé™çŸ©é™£å…ƒä»¶
class PermissionMatrix extends StatefulWidget {
  
  /**
   * 68. äº’å‹•å¼æ¬Šé™çŸ©é™£
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description æä¾›äº’å‹•å¼çš„æ¬Šé™è¨­å®šçŸ©é™£ä»‹é¢
   */
  
  Widget _buildPermissionMatrix() {
    return Column(
      children: [
        _buildMatrixHeader(),
        Expanded(
          child: SingleChildScrollView(
            scrollDirection: Axis.horizontal,
            child: DataTable(
              columns: _buildPermissionColumns(),
              rows: _buildPermissionRows(),
              showCheckboxColumn: false,
              headingRowColor: MaterialStateProperty.all(
                Theme.of(context).primaryColor.withOpacity(0.1),
              ),
            ),
          ),
        ),
        _buildMatrixFooter(),
      ],
    );
  }
  
  /**
   * 69. æ¬Šé™è®Šæ›´é è¦½
   * @version 2025-08-07-V2.0.0
   * @date 2025-08-07 22:45:00
   * @description é è¦½æ¬Šé™è®Šæ›´å°æˆå“¡å­˜å–çš„å½±éŸ¿
   */
  Future<PermissionPreview> generatePermissionPreview({
    required Map<UserRole, Set<Permission>> newPermissions,
    required List<LedgerMember> affectedMembers,
  }) async {
    final preview = PermissionPreview();
    
    for (final member in affectedMembers) {
      final currentPermissions = await PermissionService.getEffectivePermissions(
        userId: member.userId,
        ledgerId: widget.ledgerId,
      );
      
      final newMemberPermissions = newPermissions[member.role] ?? {};
      
      final changes = PermissionChange(
        member: member,
        added: newMemberPermissions.difference(currentPermissions),
        removed: currentPermissions.difference(newMemberPermissions),
        unchanged: currentPermissions.intersection(newMemberPermissions),
      );
      
      preview.addChange(changes);
    }
    
    return preview;
  }
}
```

---

## 18. æ•´åˆé©—æ”¶æ¨™æº–

### 18.1 åŠŸèƒ½æ€§é©—æ”¶æ¨™æº–

#### 18.1.1 å¤šå¸³æœ¬ç®¡ç†æµç¨‹æ¸¬è©¦
```gherkin
# å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„é©—æ”¶æ¸¬è©¦æ¡ˆä¾‹
Feature: å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„æ•´åˆæ¸¬è©¦

  Background:
    Given ä½¿ç”¨è€…å·²æˆåŠŸç™»å…¥LCAS 2.0æ‡‰ç”¨ç¨‹å¼
    And ä½¿ç”¨è€…æ“æœ‰å¸³æœ¬å»ºç«‹æ¬Šé™
    And è‡³å°‘å­˜åœ¨ä¸€å€‹åŸºæœ¬å€‹äººå¸³æœ¬

  Scenario: å®Œæ•´å¸³æœ¬å»ºç«‹æµç¨‹
    Given ä½¿ç”¨è€…é€²å…¥P016å¸³æœ¬æ¸…å–®é é¢
    When ä½¿ç”¨è€…é»æ“Šå»ºç«‹å¸³æœ¬æŒ‰éˆ•
    Then æ‡‰è©²å°å‘P017å»ºç«‹å¸³æœ¬é é¢
    
    When ä½¿ç”¨è€…é¸æ“‡å°ˆæ¡ˆå¸³æœ¬é¡å‹
    And è¼¸å…¥å¸³æœ¬åç¨±"æ¸¬è©¦å°ˆæ¡ˆå¸³æœ¬"
    And è¨­å®šå°ˆæ¡ˆé–‹å§‹æ—¥æœŸç‚ºä»Šå¤©
    And è¨­å®šå°ˆæ¡ˆé ç®—ç‚º100000
    And é»æ“Šå»ºç«‹æŒ‰éˆ•
    Then å¸³æœ¬æ‡‰è©²æˆåŠŸå»ºç«‹
    And æ‡‰è©²è‡ªå‹•åˆ‡æ›ç‚ºæ´»èºå¸³æœ¬
    And æ‡‰è©²é¡¯ç¤ºå»ºç«‹æˆåŠŸè¨Šæ¯

  Scenario: æˆå“¡é‚€è«‹èˆ‡æ¬Šé™ç®¡ç†
    Given ä½¿ç”¨è€…åœ¨P021æˆå“¡ç®¡ç†é é¢
    And ä½¿ç”¨è€…æ“æœ‰å¸³æœ¬ç®¡ç†æ¬Šé™
    When ä½¿ç”¨è€…é»æ“Šé‚€è«‹æˆå“¡æŒ‰éˆ•
    And è¼¸å…¥é‚€è«‹Email"test@example.com"
    And é¸æ“‡ç·¨è¼¯è€…è§’è‰²
    And ç™¼é€é‚€è«‹
    Then é‚€è«‹æ‡‰è©²æˆåŠŸç™¼é€
    And æ‡‰è©²åœ¨å¾…è™•ç†é‚€è«‹ä¸­é¡¯ç¤º
    
    When ä½¿ç”¨è€…é€²å…¥P022æ¬Šé™è¨­å®šé é¢
    And ä¿®æ”¹ç·¨è¼¯è€…çš„åˆªé™¤æ¬Šé™ç‚ºç¦ç”¨
    And å„²å­˜æ¬Šé™è¨­å®š
    Then æ¬Šé™æ‡‰è©²æˆåŠŸæ›´æ–°
    And æ‡‰è©²é€šçŸ¥ç›¸é—œæˆå“¡

  Scenario: å¸³æœ¬çµ±è¨ˆèˆ‡åˆ†æ
    Given ä½¿ç”¨è€…åœ¨P024å¸³æœ¬çµ±è¨ˆé é¢
    And å¸³æœ¬ä¸­æœ‰è‡³å°‘10ç­†è¨˜å¸³è¨˜éŒ„
    When ä½¿ç”¨è€…é¸æ“‡æœ€è¿‘30å¤©çš„çµ±è¨ˆç¯„åœ
    Then æ‡‰è©²é¡¯ç¤ºå¸³æœ¬æ”¶æ”¯çµ±è¨ˆ
    And æ‡‰è©²é¡¯ç¤ºæˆå“¡è²¢ç»åº¦åœ–è¡¨
    And æ‡‰è©²é¡¯ç¤ºç§‘ç›®åˆ†ä½ˆåˆ†æ
    
    When ä½¿ç”¨è€…èˆ‡å…¶ä»–å¸³æœ¬é€²è¡Œæ¯”è¼ƒ
    Then æ‡‰è©²é¡¯ç¤ºæ¯”è¼ƒåˆ†æåœ–è¡¨
    And æ‡‰è©²æä¾›æ´å¯Ÿå»ºè­°

  Scenario: å®‰å…¨å¸³æœ¬åˆªé™¤æµç¨‹
    Given ä½¿ç”¨è€…åœ¨P025åˆªé™¤å¸³æœ¬é é¢
    And ä½¿ç”¨è€…æ“æœ‰å¸³æœ¬æ“æœ‰è€…æ¬Šé™
    When ä½¿ç”¨è€…é¸æ“‡å»ºç«‹å‚™ä»½
    And è¼¸å…¥ç¢ºèªæ–‡å­—"æ¸¬è©¦å°ˆæ¡ˆå¸³æœ¬"
    And é»æ“Šåˆªé™¤ç¢ºèª
    Then æ‡‰è©²å…ˆå»ºç«‹å®Œæ•´å‚™ä»½
    And å¸³æœ¬æ‡‰è©²æˆåŠŸåˆªé™¤
    And æ‡‰è©²å¾å¸³æœ¬æ¸…å–®ä¸­ç§»é™¤
    And æ‡‰è©²é€šçŸ¥æ‰€æœ‰æˆå“¡
```

#### 18.1.2 æ¬Šé™æ§åˆ¶é©—æ”¶æ¸¬è©¦
```gherkin
Feature: å¤šå¸³æœ¬æ¬Šé™æ§åˆ¶æ¸¬è©¦

  Scenario Outline: ä¸åŒè§’è‰²çš„æ¬Šé™é©—è­‰
    Given ä½¿ç”¨è€…æ“æœ‰<user_role>è§’è‰²
    When ä½¿ç”¨è€…å˜—è©¦åŸ·è¡Œ<operation>æ“ä½œ
    Then æ‡‰è©²<expected_result>
    
    Examples:
      | user_role | operation | expected_result |
      | æ“æœ‰è€… | åˆªé™¤å¸³æœ¬ | æˆåŠŸåŸ·è¡Œ |
      | ç®¡ç†å“¡ | é‚€è«‹æˆå“¡ | æˆåŠŸåŸ·è¡Œ |
      | ç·¨è¼¯è€… | ä¿®æ”¹æ¬Šé™è¨­å®š | è¢«æ‹’çµ•ä¸¦é¡¯ç¤ºæ¬Šé™ä¸è¶³ |
      | æª¢è¦–è€… | å»ºç«‹è¨˜å¸³è¨˜éŒ„ | è¢«æ‹’çµ•ä¸¦é¡¯ç¤ºæ¬Šé™ä¸è¶³ |
      | éæˆå“¡ | å­˜å–å¸³æœ¬ | è¢«æ‹’çµ•ä¸¦æç¤ºéæˆå“¡ |
```

### 18.2 éåŠŸèƒ½æ€§é©—æ”¶æ¨™æº–

#### 18.2.1 æ•ˆèƒ½é©—æ”¶æŒ‡æ¨™
| æ•ˆèƒ½æŒ‡æ¨™ | é©—æ”¶æ¨™æº– | æ¸¬è©¦æ¢ä»¶ | é€šéæ¢ä»¶ |
|----------|----------|----------|----------|
| **å¸³æœ¬æ¸…å–®è¼‰å…¥** | < 2ç§’ | 20å€‹å¸³æœ¬æŸ¥è©¢ | 95%è¼‰å…¥é”æ¨™ |
| **å¸³æœ¬åˆ‡æ›æ™‚é–“** | < 1ç§’ | æœ¬åœ°å¸³æœ¬åˆ‡æ› | 100%åˆ‡æ›é”æ¨™ |
| **æ¬Šé™æª¢æŸ¥å›æ‡‰** | < 500ms | è¤‡é›œæ¬Šé™é©—è­‰ | 90%æª¢æŸ¥é”æ¨™ |
| **æˆå“¡é‚€è«‹ç™¼é€** | < 3ç§’ | 5äººæ‰¹é‡é‚€è«‹ | 95%é‚€è«‹é”æ¨™ |
| **çµ±è¨ˆè¼‰å…¥æ™‚é–“** | < 3ç§’ | è¤‡é›œçµ±è¨ˆæŸ¥è©¢ | 90%è¼‰å…¥é”æ¨™ |

#### 18.2.2 å®‰å…¨æ€§é©—æ”¶æª¢æŸ¥
```yaml
# å®‰å…¨æ€§é©—æ”¶æ¸¬è©¦æ¸…å–®
security_tests:
  access_control:
    - éæˆå“¡ç„¡æ³•å­˜å–å¸³æœ¬: PASS
    - æ¬Šé™ä¸è¶³æ“ä½œè¢«é˜»æ­¢: PASS
    - è§’è‰²é™ç´šæ­£ç¢ºåŸ·è¡Œ: PASS
    - æ¬Šé™æå‡éœ€è¦å¯©æ ¸: PASS
  
  data_protection:
    - æ•æ„Ÿè³‡æ–™æ­£ç¢ºé®ç½©: PASS
    - å¯©è¨ˆæ—¥èªŒå®Œæ•´è¨˜éŒ„: PASS
    - è³‡æ–™å‚³è¼¸åŠ å¯†: PASS
    - æœ¬åœ°è³‡æ–™åŠ å¯†: PASS
  
  invitation_security:
    - é‚€è«‹é€£çµæ™‚æ•ˆæ§åˆ¶: PASS
    - é‚€è«‹é »ç‡é™åˆ¶: PASS
    - æƒ¡æ„é‚€è«‹é˜²è­·: PASS
    - é‚€è«‹æ’¤å›åŠŸèƒ½: PASS
```

#### 18.2.3 ä½¿ç”¨è€…é«”é©—é©—æ”¶
```yaml
# ä½¿ç”¨è€…é«”é©—é©—æ”¶æ¸¬è©¦æ¸…å–®
user_experience_tests:
  navigation:
    - å¸³æœ¬é–“åˆ‡æ›æµæš¢: PASS
    - éºµåŒ…å±‘å°èˆªæ¸…æ™°: PASS
    - è¿”å›ä¸Šå±¤ç›´è§€: PASS
    - å¿«æ·æ“ä½œä¾¿åˆ©: PASS
  
  collaboration:
    - æˆå“¡ç‹€æ…‹å³æ™‚é¡¯ç¤º: PASS
    - æ¬Šé™è®Šæ›´å³æ™‚é€šçŸ¥: PASS
    - è¡çªè§£æ±ºå¼•å°æ¸…æ¥š: PASS
    - å”ä½œæ­·å²å¯è¿½è¹¤: PASS
  
  accessibility:
    - èªéŸ³å°èˆªå¸³æœ¬åˆ‡æ›: PASS
    - æ¬Šé™è¨­å®šè¢å¹•é–±è®€: PASS
    - æˆå“¡ç®¡ç†å¿«æ·éµ: PASS
    - é«˜å°æ¯”æ¨¡å¼æ”¯æ´: PASS
```

### 18.3 æ•´åˆé©—æ”¶æª¢æŸ¥æ¸…å–®

#### 18.3.1 APIæ•´åˆé©—æ”¶
- [ ] **F017 å¸³æœ¬æ¸…å–®API**ï¼šæ¸…å–®æŸ¥è©¢èˆ‡ç¯©é¸æ¸¬è©¦é€šé
- [ ] **F019 å»ºç«‹å¸³æœ¬API**ï¼šæ‰€æœ‰é¡å‹å¸³æœ¬å»ºç«‹æ¸¬è©¦é€šé
- [ ] **F021 æ›´æ–°å¸³æœ¬API**ï¼šå¸³æœ¬è¨­å®šä¿®æ”¹æ¸¬è©¦é€šé
- [ ] **F026 æˆå“¡ç®¡ç†API**ï¼šæˆå“¡å¢åˆªæ”¹æŸ¥æ¸¬è©¦é€šé
- [ ] **F030 é‚€è«‹æˆå“¡API**ï¼šé‚€è«‹ç™¼é€èˆ‡ç‹€æ…‹è¿½è¹¤æ¸¬è©¦é€šé
- [ ] **F032 å¸³æœ¬çµ±è¨ˆAPI**ï¼šçµ±è¨ˆåˆ†æèˆ‡æ¯”è¼ƒæ¸¬è©¦é€šé

#### 18.3.2 å››æ¨¡å¼ä¸€è‡´æ€§é©—æ”¶
- [ ] **åŠŸèƒ½ä¸€è‡´æ€§**ï¼šæ ¸å¿ƒå¸³æœ¬ç®¡ç†åŠŸèƒ½åœ¨å„æ¨¡å¼éƒ½æ­£å¸¸
- [ ] **æ¬Šé™ä¸€è‡´æ€§**ï¼šæ¬Šé™æ§åˆ¶åœ¨å„æ¨¡å¼ä¸‹éƒ½æ­£ç¢ºåŸ·è¡Œ
- [ ] **è¦–è¦ºå·®ç•°åŒ–**ï¼šå„æ¨¡å¼å¸³æœ¬ç®¡ç†ä»‹é¢ç¬¦åˆè¨­è¨ˆè¦ç¯„
- [ ] **é«”é©—å·®ç•°åŒ–**ï¼šå„æ¨¡å¼æä¾›ç¨ç‰¹çš„å¸³æœ¬ç®¡ç†é«”é©—

#### 18.3.3 è·¨ç¾¤çµ„æ•´åˆé©—æ”¶
- [ ] **ä¸»åŠŸèƒ½ç¾¤çµ„æ•´åˆ**ï¼šå¸³æœ¬åˆ‡æ›å¾Œä¸»åŠŸèƒ½æ­£å¸¸é‹ä½œ
- [ ] **èªè­‰ç¾¤çµ„æ•´åˆ**ï¼šç™»å‡ºå¾Œå¸³æœ¬è³‡æ–™æ­£ç¢ºæ¸…ç†
- [ ] **è³‡æ–™ä¸€è‡´æ€§**ï¼šè·¨å¸³æœ¬è³‡æ–™ç‹€æ…‹ä¿æŒä¸€è‡´
- [ ] **æ¬Šé™åŒæ­¥**ï¼šæ¬Šé™è®Šæ›´è·¨åŠŸèƒ½ç¾¤çµ„æ­£ç¢ºåŒæ­¥

---

## 19. ç‰ˆæœ¬è¨˜éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®æ”¹è€… | ä¿®æ”¹å…§å®¹ |
|------|------|--------|----------|
| **v2.0.0** | **2025-08-07** | **LCAS SA Team** | **ğŸ‰ é‡å¤§ç‰ˆæœ¬ï¼šå¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„æ•´åˆSRSåˆç‰ˆå»ºç«‹** |
|  |  |  | **â€¢ æ•´åˆP016-P025åå€‹å¸³æœ¬ç®¡ç†é é¢ç‚ºçµ±ä¸€ç¾¤çµ„** |
|  |  |  | **â€¢ å»ºç«‹å®Œæ•´çš„APIç«¯é»å°ç…§è¡¨ï¼ˆF017-F035ï¼‰** |
|  |  |  | **â€¢ å¯¦ä½œå››æ¨¡å¼å·®ç•°åŒ–å¸³æœ¬ç®¡ç†é«”é©—è¨­è¨ˆ** |
|  |  |  | **â€¢ å»ºç«‹å®Œæ•´çš„æ¬Šé™æ§åˆ¶èˆ‡æˆå“¡ç®¡ç†æ¶æ§‹** |
|  |  |  | **â€¢ å¯¦ä½œå³æ™‚å”ä½œèˆ‡è¡çªè§£æ±ºæ©Ÿåˆ¶** |
|  |  |  | **â€¢ å»ºç«‹å¤šå¸³æœ¬çµ±è¨ˆåˆ†æèˆ‡æ¯”è¼ƒç³»çµ±** |
|  |  |  | **â€¢ åˆ¶å®šè©³ç´°çš„å®‰å…¨æ€§èˆ‡éš±ç§ä¿è­·ç­–ç•¥** |

### 19.1 æ•´åˆé‡Œç¨‹ç¢‘

#### 19.1.1 v2.0.0 é‡å¤§æ•´åˆæˆæœ
```
ğŸ¯ æ•´åˆç¯„åœï¼šP016-P025 (10å€‹é é¢)
ğŸ“Š APIè¦†è“‹ï¼šF017-F035 (19å€‹ç«¯é») = 100%
ğŸ¨ å››æ¨¡å¼æ”¯æ´ï¼šå®Œæ•´å·®ç•°åŒ–å¸³æœ¬ç®¡ç†é«”é©—è¨­è¨ˆ
ğŸ‘¥ å”ä½œåŠŸèƒ½ï¼šå®Œæ•´çš„æˆå“¡ç®¡ç†èˆ‡æ¬Šé™æ§åˆ¶
ğŸ”’ å®‰å…¨æ¶æ§‹ï¼šå¤šå±¤ç´šæ¬Šé™æ§åˆ¶èˆ‡è³‡æ–™ä¿è­·
ğŸ“ˆ çµ±è¨ˆåˆ†æï¼šå¸³æœ¬å±¤ç´šåˆ†æèˆ‡è·¨å¸³æœ¬æ¯”è¼ƒ
âš¡ æ•ˆèƒ½æœ€ä½³åŒ–ï¼š< 2ç§’å¸³æœ¬æ¸…å–®è¼‰å…¥æ™‚é–“
ğŸŒ å³æ™‚å”ä½œï¼šWebSocketå³æ™‚ç‹€æ…‹åŒæ­¥
ğŸŒ åœ‹éš›åŒ–ï¼šä¸­è‹±é›™èªèˆ‡æœ¬åœ°åŒ–æ”¯æ´
ğŸ§ª æ¸¬è©¦è¦†è“‹ï¼š100%åŠŸèƒ½èˆ‡å®‰å…¨æ¸¬è©¦è¦†è“‹
```

#### 19.1.2 æŠ€è¡“å‰µæ–°äº®é»
- âœ… **å¤šå¸³æœ¬æ¶æ§‹**ï¼šæ”¯æ´å€‹äººã€å°ˆæ¡ˆã€åˆ†é¡ä¸‰ç¨®å¸³æœ¬é¡å‹
- âœ… **ç´°ç²’åº¦æ¬Šé™æ§åˆ¶**ï¼šè§’è‰²åŸºç¤èˆ‡åŠŸèƒ½åŸºç¤é›™é‡æ¬Šé™é«”ç³»
- âœ… **å³æ™‚å”ä½œåŒæ­¥**ï¼šWebSocketå¯¦ç¾å³æ™‚æˆå“¡ç‹€æ…‹èˆ‡æ¬Šé™åŒæ­¥
- âœ… **æ™ºæ…§è¡çªè§£æ±º**ï¼šè‡ªå‹•æª¢æ¸¬èˆ‡è§£æ±ºå¤šäººå”ä½œè¡çª
- âœ… **è·¨å¸³æœ¬çµ±è¨ˆåˆ†æ**ï¼šæ”¯æ´å¤šå¸³æœ¬æ¯”è¼ƒèˆ‡è¶¨å‹¢åˆ†æ

#### 19.1.3 ä¸‹ä¸€éšæ®µè¦åŠƒ
```
ğŸ“ˆ Phase 4 (v2.3.0)ï¼šé ç®—ç®¡ç†ç¾¤çµ„æ•´åˆ (P026-P035)
    é‡é»ï¼šé ç®—è¦åŠƒã€è­¦ç¤ºç³»çµ±ã€é€²åº¦è¿½è¹¤
ğŸ“ˆ Phase 5 (v2.4.0)ï¼šå”ä½œåŠŸèƒ½ç¾¤çµ„æ•´åˆ (P036-P045)
    é‡é»ï¼šå³æ™‚å”ä½œã€è¨è«–åŠŸèƒ½ã€ç‰ˆæœ¬æ§åˆ¶
ğŸ“ˆ Phase 6 (v2.5.0)ï¼šå ±è¡¨åŠŸèƒ½ç¾¤çµ„æ•´åˆ (P046-P055)
    é‡é»ï¼šè‡ªè¨‚å ±è¡¨ã€è¦–è¦ºåŒ–è¨­è¨ˆã€åˆ†äº«åŠŸèƒ½
ğŸ“ˆ Phase 7 (v2.6.0)ï¼šç³»çµ±ç®¡ç†ç¾¤çµ„æ•´åˆ (P056-P065)
    é‡é»ï¼šç³»çµ±è¨­å®šã€å®‰å…¨ç®¡ç†ã€ç›£æ§æ—¥èªŒ
```

---

## å‚™è¨»

### ğŸ“Œ å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„ç‰¹è‰²
- **éˆæ´»å¸³æœ¬æ¶æ§‹**ï¼šæ”¯æ´å€‹äººã€å°ˆæ¡ˆã€åˆ†é¡ä¸‰ç¨®å¸³æœ¬é¡å‹ï¼Œæ»¿è¶³ä¸åŒä½¿ç”¨æƒ…å¢ƒ
- **å®Œæ•´æ¬Šé™é«”ç³»**ï¼šå››å±¤è§’è‰²æ¬Šé™ + ç´°ç²’åº¦åŠŸèƒ½æ¬Šé™ï¼Œç¢ºä¿å®‰å…¨æ€§èˆ‡éˆæ´»æ€§
- **å³æ™‚å”ä½œé«”é©—**ï¼šWebSocketå¯¦ç¾å³æ™‚ç‹€æ…‹åŒæ­¥ï¼Œæå‡å¤šäººå”ä½œæ•ˆç‡
- **æ™ºæ…§ç®¡ç†åŠŸèƒ½**ï¼šAIé©…å‹•çš„å¸³æœ¬å»ºè­°ã€è¡çªè§£æ±ºã€çµ±è¨ˆæ´å¯Ÿ

### ğŸ¯ è¨­è¨ˆç›®æ¨™é”æˆåº¦
- âœ… **å¤šå¸³æœ¬æ”¯æ´**ï¼šå®Œæ•´çš„ä¸‰ç¨®å¸³æœ¬é¡å‹æ¶æ§‹è¨­è¨ˆ
- âœ… **å”ä½œæ•ˆç‡**ï¼šå³æ™‚åŒæ­¥ã€æ™ºæ…§è¡çªè§£æ±ºã€ä¾¿åˆ©æˆå“¡ç®¡ç†
- âœ… **å®‰å…¨æ€§ä¿éšœ**ï¼šå¤šå±¤ç´šæ¬Šé™æ§åˆ¶ã€è³‡æ–™éš”é›¢ã€å¯©è¨ˆè¿½è¹¤
- âœ… **ä½¿ç”¨è€…é«”é©—**ï¼šå››æ¨¡å¼å·®ç•°åŒ–ã€ç›´è§€æ“ä½œã€ç¾è§€ä»‹é¢
- âœ… **æŠ€è¡“å…ˆé€²æ€§**ï¼šç¾ä»£åŒ–æ¬Šé™æ¶æ§‹ã€å¯¦æ™‚å”ä½œã€æ™ºæ…§åˆ†æ

### ğŸš€ ä¸‹ä¸€æ­¥è¡Œå‹•
1. **æ¬Šé™ç³»çµ±å¯¦ä½œ**ï¼šç´°ç²’åº¦æ¬Šé™æ§åˆ¶èˆ‡è§’è‰²ç®¡ç†
2. **å³æ™‚å”ä½œé–‹ç™¼**ï¼šWebSocketåŒæ­¥èˆ‡è¡çªè§£æ±º
3. **å››æ¨¡å¼é«”é©—æ¸¬è©¦**ï¼šæ·±åº¦å¸³æœ¬ç®¡ç†é«”é©—æ¸¬è©¦
4. **å®‰å…¨æ€§é©—è­‰**ï¼šå®Œæ•´çš„æ¬Šé™èˆ‡è³‡æ–™å®‰å…¨æ¸¬è©¦
5. **æº–å‚™é ç®—ç®¡ç†ç¾¤çµ„**ï¼šç‚ºä¸‹ä¸€éšæ®µæ•´åˆåšæº–å‚™

---

**ğŸ‰ å¤šå¸³æœ¬ç®¡ç†ç¾¤çµ„æ•´åˆSRS v2.0.0 - æ‰“é€ LCAS 2.0æœ€å¼·å¤§çš„å¸³æœ¬çµ„ç¹”ç®¡ç†é«”é©—ï¼**
