
# LCAS 2.0 功能列表文件 (Feature List)
**版本**: 2.1  
**建立日期**: 2025-07-23  
**建立者**: AustinLiao69  
**最後更新**: 2025-07-23 15:30:00 UTC+8  
**基於規格**: 0015. Product_SPEC_LCAS_2.0.md v1.3

---

## 📋 文件概述

本文件根據 LCAS 2.0 產品規格書設計，涵蓋雙平台（LINE OA + Mobile APP）的完整功能規劃，提供清晰的 API 路徑與模組對應關係。

## 🏗️ 架構總覽

```
LCAS 2.0 功能架構與模組群分類
├── 認證與帳戶管理 (F001-F011) - 雙平台共用
├── LINE OA 專屬功能 (F021-F026) - 基礎版
├── APP 進階功能 (F031-F058) - 專業版
└── 系統管理功能 (F051-F058) - 後台管理

模組群分類:
├── LINE OA模組群: WH, LBK
├── APP模組群: BK, MLS, BM, BS, DD1/DD2/DD3
└── 共用模組群: FS, DL, AM, SR, CM, MRA
```

---

## 📊 功能總覽表

| 功能編號 | 功能名稱 | 平台支援 | API 路徑 | 對應模組 | 模組群 | 優先級 |
|----------|----------|----------|----------|----------|--------|--------|
| **認證與帳戶管理 (雙平台共用)** |
| F001 | 使用者註冊 | LINE OA + APP | POST /auth/register | 2009. AM.js | 共用模組群 | P0 |
| F002 | 使用者登入 | LINE OA + APP | POST /auth/login | 2009. AM.js | 共用模組群 | P0 |
| F003 | 使用者登出 | LINE OA + APP | POST /auth/logout | 2009. AM.js | 共用模組群 | P1 |
| F004 | 帳號刪除 | APP | DELETE /auth/account | 2009. AM.js | 共用模組群 | P2 |
| F005 | 密碼重設 | APP | POST /auth/reset-password | 2009. AM.js | 共用模組群 | P2 |
| **基礎記帳功能** |
| F006 | LINE OA 記帳功能 | LINE OA | POST /lineoa/ledger/entry | 2015. LBK.js | LINE OA模組群 | P0 |
| F007 | APP 記帳功能 | APP | POST /app/ledger/entry | 2001. BK.js | APP模組群 | P0 |
| F008 | LINE OA 記錄查詢 | LINE OA | GET /lineoa/ledger/query | 2015. LBK.js | LINE OA模組群 | P0 |
| F009 | APP 記錄查詢 | APP | GET /app/ledger/query | 2001. BK.js | APP模組群 | P0 |
| F010 | 科目代碼管理 | APP | GET /app/subjects/list | 2031. DD1.js | APP模組群 | P1 |
| F011 | 使用者設定管理 | APP | PUT /app/user/settings | 2009. AM.js | 共用模組群 | P1 |
| **LINE OA 專屬功能** |
| F021 | 自動資料庫初始化 | LINE OA | POST /lineoa/init | 2011. FS.js | 共用模組群 | P0 |
| F022 | Webhook 處理 | LINE OA | POST /lineoa/webhook | 2020. WH.js | LINE OA模組群 | P0 |
| F023 | 自然語言記帳解析 | LINE OA | POST /lineoa/parse | 2015. LBK.js | LINE OA模組群 | P0 |
| F024 | Quick Reply 統計查詢 | LINE OA | POST /lineoa/statistics | 2005. SR.js | 共用模組群 | P1 |
| F025 | Rich Menu 互動 | LINE OA | POST /lineoa/richmenu | 2031. DD1.js | APP模組群 | P1 |
| F026 | 簡易查詢回應 | LINE OA | GET /lineoa/simple-query | 2015. LBK.js | LINE OA模組群 | P1 |
| **APP 進階功能** |
| F031 | 專案帳本建立 | APP | POST /app/projects/create | 2051. MLS.js | APP模組群 | P1 |
| F032 | 專案帳本管理 | APP | PUT /app/projects/manage | 2051. MLS.js | APP模組群 | P1 |
| F033 | 專案帳本刪除 | APP | DELETE /app/projects/delete | 2051. MLS.js | APP模組群 | P2 |
| F034 | 分類帳本建立 | APP | POST /app/categories/create | 2051. MLS.js | APP模組群 | P1 |
| F035 | 分類帳本管理 | APP | PUT /app/categories/manage | 2051. MLS.js | APP模組群 | P1 |
| F036 | 多帳本切換 | APP | GET /app/ledgers/switch | 2051. MLS.js | APP模組群 | P1 |
| F037 | 預算設定建立 | APP | POST /app/budgets/create | 2012. BM.js | APP模組群 | P2 |
| F038 | 預算追蹤監控 | APP | GET /app/budgets/monitor | 2012. BM.js | APP模組群 | P2 |
| F039 | 預算警示設定 | APP | PUT /app/budgets/alerts | 2012. BM.js | APP模組群 | P2 |
| F040 | 共享帳本建立 | APP | POST /app/shared/create | 2013. CM.js | 共用模組群 | P2 |
| F041 | 多人協作權限 | APP | PUT /app/shared/permissions | 2013. CM.js | 共用模組群 | P2 |
| F042 | 即時協作同步 | APP | WebSocket /app/sync/realtime | 2013. CM.js | 共用模組群 | P2 |
| F043 | 標準報表產出 | APP | POST /app/reports/generate | 2041. MRA.js | 共用模組群 | P2 |
| F044 | 自定義報表設計 | APP | POST /app/reports/custom | 2041. MRA.js | 共用模組群 | P3 |
| F045 | 報表匯出功能 | APP | GET /app/reports/export | 2041. MRA.js | 共用模組群 | P2 |
| **系統管理功能** |
| F051 | 定期自動備份 | 系統 | POST /system/backup/schedule | 2014. BS.js | APP模組群 | P1 |
| F052 | 手動備份還原 | APP | POST /app/backup/manual | 2014. BS.js | APP模組群 | P2 |
| F053 | 備份檔案管理 | APP | GET /app/backup/list | 2014. BS.js | APP模組群 | P2 |
| F054 | 資料同步檢查 | 系統 | GET /system/sync/status | 2011. FS.js | 共用模組群 | P1 |
| F055 | 系統健康監控 | 系統 | GET /system/health/check | 2010. DL.js | 共用模組群 | P0 |
| F056 | 錯誤日誌管理 | 系統 | GET /system/logs/errors | 2010. DL.js | 共用模組群 | P1 |
| F057 | 排程提醒設定 | LINE OA + APP | POST /schedule/reminder | 2005. SR.js | 共用模組群 | P1 |
| F058 | 排程提醒執行 | 系統 | POST /schedule/execute | 2005. SR.js | 共用模組群 | P1 |

---

## 🔧 詳細功能規格

### F001 使用者註冊

**使用者故事**  
作為新使用者，我想要快速註冊帳號，以便開始使用LCAS記帳功能。

**業務需求**
- 支援LINE OA自動註冊與APP手動註冊
- 自動生成統一UID並初始化用戶資料
- 預設科目自動導入（9999個標準科目）
- 跨平台帳號關聯準備

**功能描述**
- **LINE OA註冊**：使用者加入好友時自動觸發註冊流程
- **APP端註冊**：提供Email/Google/Apple多種註冊方式
- **統一身份管理**：生成唯一的LCAS_UID作為主要識別碼
- **資料初始化**：自動建立用戶基礎資料結構和預設科目

**使用者操作流程**
1. **LINE OA路徑**：
   - 使用者掃描QR Code或搜尋加入LINE OA
   - 系統接收follow事件並提取LINE UID
   - 檢查是否為新用戶
   - 自動建立帳號並初始化科目數據
   - 發送歡迎訊息及使用指南

2. **APP路徑**：
   - 使用者下載APP並點擊註冊
   - 選擇註冊方式（Email/Google/Apple）
   - 完成平台認證流程
   - 填寫基本資料（暱稱、時區等）
   - 系統建立帳號並初始化預設設定

**API規格**
```javascript
POST /auth/register
Headers: {
  "Content-Type": "application/json",
  "X-Platform": "line_oa|mobile_app"
}
Body: {
  "platform": "line_oa|mobile_app",
  "line_uid": "Uxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx", // LINE OA專用
  "device_info": {}, // APP專用
  "display_name": "string",
  "timezone": "Asia/Taipei"
}
Response: {
  "success": true,
  "unified_uid": "LCAS_UID_xxxxxxxxxx",
  "user_type": "S", // 預設單一帳本用戶
  "subjects_initialized": true,
  "created_at": "2025-07-23T15:30:00+08:00"
}
```

**對應模組**: 2009. AM.js  
**核心函數**: `AM_registerUser()`  
**錯誤處理**: 重複註冊檢查、平台驗證失敗、科目初始化異常

---

### F002 使用者登入

**使用者故事**  
作為既有使用者，我想要透過LINE OA或APP快速登入，以便存取我的記帳資料。

**業務需求**
- LINE OA透過Webhook自動驗證
- APP支援多種登入方式（Email/Google/Apple）
- 登入狀態跨平台同步
- 最後活動時間更新

**功能描述**
- **自動登入驗證**：LINE OA用戶發送訊息時自動驗證身份
- **多元認證支援**：APP端支援第三方OAuth登入
- **會話管理**：維護安全的登入會話狀態
- **跨平台同步**：登入狀態在所有關聯平台同步

**使用者操作流程**
1. **LINE OA路徑**：
   - 使用者向LINE OA發送任何訊息
   - 系統自動驗證LINE UID
   - 查詢用戶資料並更新最後活動時間
   - 直接進入記帳功能

2. **APP路徑**：
   - 使用者開啟APP並點擊登入
   - 選擇登入方式進行認證
   - 系統驗證憑證並建立會話
   - 載入用戶個人化設定和資料

**API規格**
```javascript
POST /auth/login
Body: {
  "platform": "line_oa|mobile_app",
  "credentials": {
    "line_uid": "string", // LINE OA
    "email": "string", // APP
    "oauth_token": "string" // 第三方登入
  }
}
Response: {
  "success": true,
  "unified_uid": "LCAS_UID_xxxxxxxxxx",
  "user_profile": {
    "display_name": "string",
    "user_type": "M|S|J",
    "last_active": "2025-07-23T15:30:00+08:00"
  },
  "session_token": "jwt_token_string"
}
```

**對應模組**: 2009. AM.js  
**核心函數**: `AM_authenticateUser()`  
**錯誤處理**: 認證失敗、帳號不存在、權限過期

---

### F003 使用者登出

**使用者故事**  
作為使用者，我想要安全登出系統，以便保護我的隱私資料。

**業務需求**
- 清除登入狀態與暫存資料
- 更新最後活動時間
- 跨平台登出狀態同步
- 安全性日誌記錄

**功能描述**
- **安全登出**：完全清除用戶會話和敏感資料
- **狀態同步**：登出狀態同步到所有關聯平台
- **資料保護**：確保登出後無法存取用戶資料
- **審計記錄**：記錄登出操作以供安全審計

**使用者操作流程**
1. **LINE OA路徑**：
   - 使用者發送「登出」指令
   - 系統清除該用戶的暫存狀態
   - 更新最後活動時間
   - 發送登出確認訊息

2. **APP路徑**：
   - 使用者點擊APP設定中的登出按鈕
   - 系統提示確認登出操作
   - 清除本地儲存的會話資料
   - 返回登入頁面

**API規格**
```javascript
POST /auth/logout
Headers: {
  "Authorization": "Bearer jwt_token"
}
Body: {
  "platform": "line_oa|mobile_app",
  "unified_uid": "LCAS_UID_xxxxxxxxxx"
}
Response: {
  "success": true,
  "message": "登出成功",
  "logged_out_at": "2025-07-23T15:30:00+08:00"
}
```

**對應模組**: 2009. AM.js  
**核心函數**: `AM_logoutUser()`  
**錯誤處理**: 無效Token、重複登出、系統異常

---

### F004 帳號刪除

**使用者故事**  
作為使用者，我想要完全刪除我的帳號，以便行使資料主權。

**業務需求**
- 僅限APP平台使用（LINE OA不支援）
- 完整刪除用戶資料與關聯記錄
- 保留必要審計日誌
- 跨平台帳號解除綁定

**功能描述**
- **完整刪除**：徹底移除用戶所有個人資料
- **關聯清理**：刪除跨平台帳號關聯
- **資料保護**：確保刪除後資料無法復原
- **合規要求**：符合GDPR等資料保護法規

**使用者操作流程**
1. **APP路徑**：
   - 使用者進入帳號設定頁面
   - 點擊「刪除帳號」選項
   - 輸入確認文字「DELETE_MY_ACCOUNT」
   - 系統執行完整資料刪除流程
   - 帳號永久停用並返回註冊頁面

**API規格**
```javascript
DELETE /auth/account
Headers: {
  "Authorization": "Bearer jwt_token",
  "X-Platform": "mobile_app"
}
Body: {
  "unified_uid": "LCAS_UID_xxxxxxxxxx",
  "confirmation": "DELETE_MY_ACCOUNT",
  "reason": "string" // 可選
}
Response: {
  "success": true,
  "message": "帳號已安全刪除",
  "deleted_at": "2025-07-23T15:30:00+08:00",
  "audit_id": "AUDIT_xxxxxxxxxx"
}
```

**對應模組**: 2009. AM.js  
**核心函數**: `AM_deleteAccount()`  
**錯誤處理**: 權限不足、確認字串錯誤、關聯資料清理失敗

---

### F005 密碼重設

**使用者故事**  
作為APP使用者，我想要重設密碼，以便在忘記密碼時恢復帳號存取。

**業務需求**
- 僅限APP平台使用（LINE OA使用OAuth）
- 多重驗證機制（Email/SMS）
- 安全性驗證碼機制
- 重設歷史記錄

**功能描述**
- **多重驗證**：支援Email和SMS驗證方式
- **安全機制**：時效性驗證碼和重設次數限制
- **密碼強度**：強制要求符合安全標準的新密碼
- **歷史記錄**：記錄重設操作以供安全審計

**使用者操作流程**
1. **重設申請**：
   - 使用者在登入頁點擊「忘記密碼」
   - 輸入註冊Email地址
   - 選擇驗證方式（Email/SMS）
   - 系統發送驗證碼

2. **密碼重設**：
   - 使用者輸入收到的驗證碼
   - 設定符合安全要求的新密碼
   - 系統更新密碼並登出所有裝置
   - 使用新密碼重新登入

**API規格**
```javascript
POST /auth/reset-password
Body: {
  "platform": "mobile_app",
  "email": "user@example.com",
  "verification_method": "email|sms"
}
Response: {
  "success": true,
  "message": "重設連結已發送",
  "verification_id": "VERIFY_xxxxxxxxxx",
  "expires_at": "2025-07-23T16:30:00+08:00"
}

// 確認重設
POST /auth/confirm-reset
Body: {
  "verification_id": "VERIFY_xxxxxxxxxx",
  "verification_code": "123456",
  "new_password": "hashed_password"
}
```

**對應模組**: 2009. AM.js  
**核心函數**: `AM_resetPassword()`  
**錯誤處理**: 驗證碼過期、密碼強度不足、重設頻率限制

---

### F002 基礎記帳功能

- **使用者故事**  
  作為使用者，我想要快速記錄收支，以便追蹤個人財務狀況。

- **展示層元件**  
  - LINE OA: 文字訊息輸入
  - APP: 記帳表單介面

- **使用者操作流程**  
  1. 輸入記帳資訊（金額、項目、收支類型）
  2. 系統自動解析並分類
  3. 確認記帳內容
  4. 儲存至資料庫並回饋確認

- **API 規格**  
  ```
  POST /ledger/entry
  Body: {
    "amount": 1000,
    "item": "午餐",
    "type": "expense|income",
    "category": "飲食",
    "date": "2025-07-23"
  }
  Response: {
    "success": true,
    "entry_id": "string",
    "balance": 15000
  }
  ```

- **對應模組**: 2015. LBK.js v2.1.0
- **錯誤處理**: 金額格式錯誤、科目代碼無效

---

### F021 專案帳戶管理

- **使用者故事**  
  作為進階使用者，我想要建立不同專案的獨立帳本，以便分別管理各專案的財務。

- **展示層元件**  
  - 專案建立界面
  - 專案列表與切換
  - 專案成員管理

- **使用者操作流程**  
  1. 點擊「新增專案」
  2. 填寫專案名稱、類型、預算
  3. 設定專案成員（可選）
  4. 建立專案專屬帳本
  5. 開始專案記帳

- **API 規格**  
  ```
  POST /projects/create
  Body: {
    "project_name": "工作差旅",
    "project_type": "work|personal|investment",
    "budget": 50000,
    "members": ["user_id_1", "user_id_2"]
  }
  Response: {
    "success": true,
    "project_id": "string",
    "ledger_id": "string"
  }
  ```

- **對應模組**: 2051. MLS.js v2.1.0
- **錯誤處理**: 專案名稱重複、權限不足

---

### F024 預算設定管理

- **使用者故事**  
  作為使用者，我想要設定各類別的預算限制，以便控制支出並避免超支。

- **展示層元件**  
  - 預算設定界面
  - 預算使用進度條
  - 超支警示通知

- **使用者操作流程**  
  1. 選擇預算類型（月度/分類/專案）
  2. 設定預算金額和期間
  3. 配置警示閾值
  4. 啟用自動監控
  5. 接收預算狀態通知

- **API 規格**  
  ```
  POST /budgets/create
  Body: {
    "budget_type": "monthly|category|project",
    "target_amount": 30000,
    "period": {
      "start": "2025-07-01",
      "end": "2025-07-31"
    },
    "alert_threshold": 80
  }
  Response: {
    "success": true,
    "budget_id": "string",
    "monitoring_active": true
  }
  ```

- **對應模組**: 2012. BM.js v2.1.0
- **錯誤處理**: 預算金額無效、期間設定錯誤

---

### F029 標準報表產出

- **使用者故事**  
  作為使用者，我想要產生標準財務報表，以便分析收支狀況和財務趨勢。

- **展示層元件**  
  - 報表類型選擇
  - 時間範圍設定
  - 報表格式選擇（PDF/Excel/CSV）
  - 報表預覽與下載

- **使用者操作流程**  
  1. 選擇報表類型（損益表/現金流量表/資產負債表）
  2. 設定報表時間範圍
  3. 選擇輸出格式
  4. 產生並預覽報表
  5. 下載或分享報表

- **API 規格**  
  ```
  POST /reports/generate
  Body: {
    "report_type": "income_statement|cash_flow|balance_sheet",
    "date_range": {
      "start": "2025-01-01",
      "end": "2025-07-23"
    },
    "format": "pdf|excel|csv",
    "filters": {
      "projects": ["proj_1"],
      "categories": ["食物", "交通"]
    }
  }
  Response: {
    "success": true,
    "report_id": "string",
    "download_url": "string",
    "generated_at": "2025-07-23T15:30:00Z"
  }
  ```

- **對應模組**: 2041. MRA.js v2.1.0
- **錯誤處理**: 資料範圍無效、格式不支援

---

## 🔄 模組版次升級計畫

根據功能列表更新，以下模組需要版次升級：

### LINE OA模組群
| 模組 | 當前版本 | 目標版本 | 升級原因 |
|------|----------|----------|----------|
| 2020. WH.js | 2.0.x | 2.1.0 | 強化Webhook處理與路由 |
| 2015. LBK.js | 2.0.x | 2.1.0 | 強化記帳解析功能 |

### APP模組群
| 模組 | 當前版本 | 目標版本 | 升級原因 |
|------|----------|----------|----------|
| 2001. BK.js | 2.0.x | 2.1.0 | 強化APP記帳處理 |
| 2051. MLS.js | 2.0.x | 2.1.0 | 新增專案帳戶管理 |
| 2012. BM.js | 1.0.x | 2.1.0 | 新增預算管理系統 |
| 2014. BS.js | 1.0.x | 2.1.0 | 新增自動備份機制 |
| 2031. DD1.js | 2.0.x | 2.1.0 | 強化數據分發功能 |

### 共用模組群
| 模組 | 當前版本 | 目標版本 | 升級原因 |
|------|----------|----------|----------|
| 2009. AM.js | 2.0.x | 2.1.0 | 新增雙平台認證支援 |
| 2005. SR.js | 1.0.x | 2.1.0 | 新增排程提醒功能 |
| 2013. CM.js | 1.0.x | 2.1.0 | 新增協作功能支援 |
| 2041. MRA.js | 1.0.x | 2.1.0 | 新增報表產出引擎 |
| 2011. FS.js | 2.0.x | 2.1.0 | 強化資料庫初始化 |
| 2010. DL.js | 2.0.x | 2.1.0 | 強化日誌管理功能 |

---

## 📈 開發優先級說明

- **P0 (必要)**: 核心功能，影響基本可用性
- **P1 (重要)**: 主要功能，影響使用者體驗
- **P2 (有用)**: 進階功能，提升產品價值
- **P3 (可選)**: 延伸功能，未來擴展方向

---

## 🎯 下一步行動

1. **技術團隊** - 審核 API 設計可行性
2. **UI/UX 團隊** - 根據功能列表設計介面原型
3. **開發團隊** - 制定詳細開發時程
4. **測試團隊** - 準備功能測試計畫

---

**版本異動記錄**:
- v2.1 (2025-07-23) - 新增模組群欄位，細化功能拆分至API層級，修正模組群分類
- v2.0 (2025-07-23) - 基於 LCAS 2.0 產品規格書重新設計完整功能列表
- v1.0 (2025-07-23) - 初版建立（僅 F001 範本）

**審核狀態**: ✅ PM 已確認 - 可開始後續開發規劃
