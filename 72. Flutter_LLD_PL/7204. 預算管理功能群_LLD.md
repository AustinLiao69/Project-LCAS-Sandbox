
# 7204. é ç®—ç®¡ç†åŠŸèƒ½ç¾¤_LLD.md

**æ–‡ä»¶ç·¨è™Ÿ**: 7204  
**ç‰ˆæœ¬**: v2.0.0  
**å»ºç«‹æ—¥æœŸ**: 2025-10-22  
**å»ºç«‹è€…**: LCAS SA Team  
**æœ€å¾Œæ›´æ–°**: 2025-10-22  
**æ›´æ–°å…§å®¹**: éšæ®µäºŒé‡æ–°è¨­è¨ˆ - åŸºæ–¼æ­£ç¢ºAPIæ¶æ§‹ä¾è³´çš„æ ¸å¿ƒæ¥­å‹™é‚è¼¯å‡½æ•¸è¨­è¨ˆ

---

## ğŸ“‘ ç›®æ¬¡ (Table of Contents)

1. [æ¨¡çµ„æ¦‚è¿° (Module Overview)](#10-æ¨¡çµ„æ¦‚è¿°module-overview)
2. [æ¶æ§‹ä¾è³´é‡æ–°è¨­è¨ˆ (Architecture Dependency Redesign)](#20-æ¶æ§‹ä¾è³´é‡æ–°è¨­è¨ˆarchitecture-dependency-redesign)
3. [æ ¸å¿ƒæ¥­å‹™é‚è¼¯å‡½æ•¸è¨­è¨ˆ (Core Business Logic Design)](#30-æ ¸å¿ƒæ¥­å‹™é‚è¼¯å‡½æ•¸è¨­è¨ˆcore-business-logic-design)
4. [APIæ¶ˆè²»ç«¯å‡½æ•¸è¨­è¨ˆ (API Consumer Function Design)](#40-apiæ¶ˆè²»ç«¯å‡½æ•¸è¨­è¨ˆapi-consumer-function-design)
5. [å››æ¨¡å¼é©é…å‡½æ•¸è¨­è¨ˆ (Four Mode Adaptation Design)](#50-å››æ¨¡å¼é©é…å‡½æ•¸è¨­è¨ˆfour-mode-adaptation-design)
6. [å‡½æ•¸ä»‹é¢è¦æ ¼ (Function Interface Specifications)](#60-å‡½æ•¸ä»‹é¢è¦æ ¼function-interface-specifications)

---

## 1.0 æ¨¡çµ„æ¦‚è¿°ï¼ˆModule Overviewï¼‰

### 1.1 éšæ®µäºŒé‡æ–°è¨­è¨ˆç›®æ¨™

åŸºæ–¼éšæ®µä¸€çš„æ¶æ§‹ä¾è³´åˆ†æçµæœï¼Œé‡æ–°è¨­è¨ˆé ç®—ç®¡ç†åŠŸèƒ½ç¾¤çš„PLå±¤æ¥­å‹™é‚è¼¯å‡½æ•¸ä»‹é¢ï¼Œç¢ºä¿ï¼š
- **æ­£ç¢ºAPIæ¶ˆè²»**ï¼šé€šéAPL.dartçµ±ä¸€Gatewayæ¶ˆè²»8107é ç®—ç®¡ç†æœå‹™API
- **æ ¸å¿ƒåŠŸèƒ½èšç„¦**ï¼šå°ˆæ³¨S-307ã€S-308å…©å€‹æ ¸å¿ƒç•«é¢çš„æ¥­å‹™é‚è¼¯
- **å››æ¨¡å¼å·®ç•°åŒ–**ï¼šå¯¦ç¾Expertã€Inertialã€Cultivationã€Guidingæ¨¡å¼é©é…
- **MVPç¯„åœæ§åˆ¶**ï¼šåš´æ ¼é™åˆ¶åœ¨Phase 2é ç®—ç®¡ç†æ ¸å¿ƒåŠŸèƒ½

### 1.2 ç¢ºèªçš„APIæ¶æ§‹ä¾è³´

**æ­£ç¢ºçš„æ¶æ§‹æµç¨‹**ï¼š
```
PLå±¤ 7204é ç®—ç®¡ç†åŠŸèƒ½ç¾¤
    â†“ (HTTPèª¿ç”¨)
APL.dartçµ±ä¸€Gateway
    â†“ (HTTPè½‰ç™¼)
ASL.js API Service Layer (Port 5000)
    â†“ (å‡½æ•¸èª¿ç”¨)
BLå±¤ï¼š1312.BM.jsé ç®—ç®¡ç†æ¨¡çµ„
    â†“ (Firestoreèª¿ç”¨)
Firebase (é€šé1311.FS.js)
```

### 1.3 ç¢ºèªçš„APIç«¯é»å°æ‡‰

| PLå±¤å‡½æ•¸ | APL.dartæ–¹æ³• | 8107 APIç«¯é» | å°æ‡‰ç•«é¢ |
|----------|-------------|-------------|----------|
| é ç®—åˆ—è¡¨æŸ¥è©¢ | `getBudgets()` | `GET /budgets` | S-307 |
| å»ºç«‹é ç®— | `createBudget()` | `POST /budgets` | S-308 |
| é ç®—è©³æƒ… | `getBudgetDetail()` | `GET /budgets/{id}` | S-307 |
| æ›´æ–°é ç®— | `updateBudget()` | `PUT /budgets/{id}` | S-308 |
| åˆªé™¤é ç®— | `deleteBudget()` | `DELETE /budgets/{id}` | S-307 |
| é ç®—ç‹€æ³ | `getBudgetStatus()` | `GET /budgets/status` | S-307 |
| é ç®—æ¨¡æ¿ | `getBudgetTemplates()` | `GET /budgets/templates` | S-308 |
| è¨­å®šè­¦ç¤º | `setBudgetAlerts()` | `POST /budgets/templates` | S-308 |

---

## 2.0 æ¶æ§‹ä¾è³´é‡æ–°è¨­è¨ˆï¼ˆArchitecture Dependency Redesignï¼‰

### 2.1 ç§»é™¤éŒ¯èª¤ä¾è³´

**éšæ®µä¸€ç¢ºèªç§»é™¤**ï¼š
- âŒ 81XXæ¨¡çµ„ç›´æ¥èª¿ç”¨ï¼ˆå·²å»¢æ£„ï¼‰
- âŒ ä¸‰å±¤é‡è¤‡æ¶æ§‹ï¼ˆBLå±¤é‡è¤‡å°è£ï¼‰
- âŒ è¤‡é›œçš„ä¸­é–“è½‰æ›å±¤

### 2.2 å»ºç«‹æ­£ç¢ºä¾è³´

**éšæ®µäºŒé‡æ–°è¨­è¨ˆ**ï¼š
- âœ… APL.dartçµ±ä¸€Gatewayä½œç‚ºå”¯ä¸€APIæ¶ˆè²»å…¥å£
- âœ… ç›´æ¥èª¿ç”¨APL.dartçš„BudgetManagementService
- âœ… çµ±ä¸€éŒ¯èª¤è™•ç†èˆ‡å›æ‡‰æ ¼å¼è½‰æ›
- âœ… å››æ¨¡å¼å·®ç•°åŒ–è™•ç†é‚è¼¯

### 2.3 PLå±¤è·è²¬é‡æ–°å®šç¾©

**æ ¸å¿ƒè·è²¬**ï¼š
1. **æ¥­å‹™é‚è¼¯è™•ç†**ï¼šé ç®—è¨ˆç®—ã€é©—è­‰ã€ç‹€æ…‹ç®¡ç†
2. **APIæ¶ˆè²»å°è£**ï¼šèª¿ç”¨APL.dartæœå‹™ä¸¦è™•ç†å›æ‡‰
3. **å››æ¨¡å¼é©é…**ï¼šæ ¹æ“šç”¨æˆ¶æ¨¡å¼èª¿æ•´åŠŸèƒ½èˆ‡é¡¯ç¤º
4. **éŒ¯èª¤è™•ç†è½‰æ›**ï¼šå°‡APIéŒ¯èª¤è½‰æ›ç‚ºç”¨æˆ¶å‹å–„è¨Šæ¯
5. **ç‹€æ…‹ç®¡ç†**ï¼šé ç®—ç›¸é—œçš„æœ¬åœ°ç‹€æ…‹ç®¡ç†

---

## 3.0 æ ¸å¿ƒæ¥­å‹™é‚è¼¯å‡½æ•¸è¨­è¨ˆï¼ˆCore Business Logic Designï¼‰

### 3.1 é ç®—ç®¡ç†æ ¸å¿ƒå‡½æ•¸

#### 3.1.1 é ç®—CRUDæ“ä½œçµ±ä¸€è™•ç†
```dart
/**
 * 01. çµ±ä¸€é ç®—CRUDè™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description çµ±ä¸€è™•ç†é ç®—çš„å»ºç«‹ã€æŸ¥è©¢ã€æ›´æ–°ã€åˆªé™¤æ“ä½œ
 */
Future<BudgetOperationResult> processBudgetCRUD(
  BudgetCRUDType operation,
  Map<String, dynamic> data,
  UserMode userMode
);
```

**åŠŸèƒ½è¨­è¨ˆ**ï¼š
- çµ±ä¸€çš„CRUDæ“ä½œè·¯ç”±
- æ ¹æ“šæ“ä½œé¡å‹èª¿ç”¨å°æ‡‰çš„APL.dartæ–¹æ³•
- å››æ¨¡å¼å·®ç•°åŒ–è™•ç†
- çµ±ä¸€éŒ¯èª¤è™•ç†èˆ‡å›æ‡‰æ ¼å¼

#### 3.1.2 é ç®—åŸ·è¡Œç‹€æ³è¨ˆç®—
```dart
/**
 * 02. é ç®—åŸ·è¡Œç‹€æ³è¨ˆç®—
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description è¨ˆç®—é ç®—åŸ·è¡Œé€²åº¦ã€ä½¿ç”¨ç‡ã€å‰©é¤˜é‡‘é¡ç­‰æ ¸å¿ƒæŒ‡æ¨™
 */
Future<BudgetExecutionResult> calculateBudgetExecution(
  String budgetId,
  {DateTime? asOfDate}
);
```

**åŠŸèƒ½è¨­è¨ˆ**ï¼š
- èª¿ç”¨APL.dartçš„getBudgetDetail()ç²å–æ•¸æ“š
- æœ¬åœ°è¨ˆç®—åŸ·è¡Œç‡ã€å‰©é¤˜é‡‘é¡ã€é è­¦ç‹€æ…‹
- æ”¯æ´æ­·å²æ™‚é»æŸ¥è©¢
- å››æ¨¡å¼å·®ç•°åŒ–æŒ‡æ¨™å±•ç¤º

#### 3.1.3 é ç®—è­¦ç¤ºæª¢æŸ¥èˆ‡è§¸ç™¼
```dart
/**
 * 03. é ç®—è­¦ç¤ºæª¢æŸ¥
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description æª¢æŸ¥é ç®—è­¦ç¤ºæ¢ä»¶ä¸¦è§¸ç™¼ç›¸æ‡‰é€šçŸ¥
 */
Future<List<BudgetAlert>> checkBudgetAlerts(
  String budgetId,
  {bool triggerNotification = true}
);
```

**åŠŸèƒ½è¨­è¨ˆ**ï¼š
- åŸºæ–¼é ç®—ç‹€æ³åˆ¤æ–·è­¦ç¤ºæ¢ä»¶
- å››æ¨¡å¼å·®ç•°åŒ–è­¦ç¤ºç­–ç•¥
- æ•´åˆé€šçŸ¥è§¸ç™¼æ©Ÿåˆ¶
- é˜²æ­¢é‡è¤‡è­¦ç¤ºé‚è¼¯

### 3.2 é ç®—è³‡æ–™é©—è­‰èˆ‡è½‰æ›å‡½æ•¸

#### 3.2.1 çµ±ä¸€è³‡æ–™é©—è­‰
```dart
/**
 * 04. é ç®—è³‡æ–™é©—è­‰
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description çµ±ä¸€é©—è­‰é ç®—å»ºç«‹å’Œæ›´æ–°çš„è³‡æ–™å®Œæ•´æ€§èˆ‡é‚è¼¯æ€§
 */
ValidationResult validateBudgetData(
  Map<String, dynamic> budgetData,
  BudgetValidationType validationType
);
```

#### 3.2.2 APIè³‡æ–™è½‰æ›
```dart
/**
 * 05. APIè³‡æ–™è½‰æ›
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description çµ±ä¸€è™•ç†APIå›æ‡‰è³‡æ–™èˆ‡UIéœ€æ±‚æ ¼å¼çš„è½‰æ›
 */
Map<String, dynamic> transformBudgetData(
  dynamic apiResponse,
  BudgetTransformType transformType,
  UserMode userMode
);
```

---

## 4.0 APIæ¶ˆè²»ç«¯å‡½æ•¸è¨­è¨ˆï¼ˆAPI Consumer Function Designï¼‰

### 4.1 APL.dartæœå‹™æ¶ˆè²»å°è£

#### 4.1.1 é ç®—åˆ—è¡¨æŸ¥è©¢å°è£
```dart
/**
 * 06. é ç®—åˆ—è¡¨æŸ¥è©¢
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description å°è£APL.dartçš„getBudgets()æ–¹æ³•ï¼Œæä¾›é ç®—åˆ—è¡¨æŸ¥è©¢
 */
Future<List<Budget>> getBudgetList({
  String? ledgerId,
  String? type,
  String? status,
  UserMode? userMode
});
```

**APIæ¶ˆè²»è¨­è¨ˆ**ï¼š
```dart
// èª¿ç”¨APL.dartçµ±ä¸€Gateway
final response = await APL.instance.budget.getBudgets(
  ledgerId: ledgerId,
  type: type,
  status: status,
  userMode: userMode?.name
);
```

#### 4.1.2 é ç®—å»ºç«‹å°è£
```dart
/**
 * 07. å»ºç«‹é ç®—
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description å°è£APL.dartçš„createBudget()æ–¹æ³•ï¼Œæä¾›é ç®—å»ºç«‹åŠŸèƒ½
 */
Future<Budget> createBudget(
  Map<String, dynamic> budgetData,
  UserMode userMode
);
```

#### 4.1.3 é ç®—ç‹€æ³æŸ¥è©¢å°è£
```dart
/**
 * 08. é ç®—ç‹€æ³æŸ¥è©¢
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description å°è£APL.dartçš„getBudgetStatus()æ–¹æ³•ï¼Œæä¾›é ç®—åŸ·è¡Œç‹€æ³
 */
Future<BudgetStatusOverview> getBudgetStatus({
  String? ledgerId,
  UserMode? userMode
});
```

### 4.2 éŒ¯èª¤è™•ç†çµ±ä¸€å°è£

#### 4.2.1 APIéŒ¯èª¤è™•ç†
```dart
/**
 * 09. APIéŒ¯èª¤è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description çµ±ä¸€è™•ç†APL.dartå›å‚³çš„éŒ¯èª¤ï¼Œè½‰æ›ç‚ºç”¨æˆ¶å‹å–„è¨Šæ¯
 */
BudgetError handleAPIError(
  dynamic apiError,
  UserMode userMode,
  {String? context}
);
```

#### 4.2.2 ç¶²è·¯ç•°å¸¸è™•ç†
```dart
/**
 * 10. ç¶²è·¯ç•°å¸¸è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description è™•ç†ç¶²è·¯é€£ç·šç•°å¸¸ï¼Œæä¾›é›¢ç·šæ¨¡å¼æˆ–é‡è©¦æ©Ÿåˆ¶
 */
Future<BudgetOperationResult> handleNetworkError(
  Function apiCall,
  {int maxRetries = 3}
);
```

---

## 5.0 å››æ¨¡å¼é©é…å‡½æ•¸è¨­è¨ˆï¼ˆFour Mode Adaptation Designï¼‰

### 5.1 æ¨¡å¼ç‰¹å®šè™•ç†é‚è¼¯

#### 5.1.1 Expertæ¨¡å¼è™•ç†
```dart
/**
 * 11. Expertæ¨¡å¼é ç®—è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description ç‚ºExpertæ¨¡å¼æä¾›è©³ç´°çš„é ç®—åˆ†æèˆ‡é€²éšåŠŸèƒ½
 */
Map<String, dynamic> processExpertModeBudget(
  Map<String, dynamic> budgetData
);
```

**Expertæ¨¡å¼ç‰¹æ€§**ï¼š
- å®Œæ•´é ç®—åˆ†ææ•¸æ“š
- é€²éšçµ±è¨ˆåœ–è¡¨
- è©³ç´°åŸ·è¡Œå ±å‘Š
- è¤‡é›œé ç®—è¦å‰‡æ”¯æ´

#### 5.1.2 Cultivationæ¨¡å¼è™•ç†
```dart
/**
 * 12. Cultivationæ¨¡å¼é ç®—è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description ç‚ºCultivationæ¨¡å¼æä¾›ç¿’æ…£é¤Šæˆå°å‘çš„é ç®—åŠŸèƒ½
 */
Map<String, dynamic> processCultivationModeBudget(
  Map<String, dynamic> budgetData
);
```

**Cultivationæ¨¡å¼ç‰¹æ€§**ï¼š
- æˆå°±è¿½è¹¤ç³»çµ±
- ç¿’æ…£é¤Šæˆæé†’
- æ¿€å‹µè¨Šæ¯æ•´åˆ
- é€²æ­¥è¦–è¦ºåŒ–

#### 5.1.3 Guidingæ¨¡å¼è™•ç†
```dart
/**
 * 13. Guidingæ¨¡å¼é ç®—è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description ç‚ºGuidingæ¨¡å¼æä¾›ç°¡åŒ–çš„é ç®—å¼•å°åŠŸèƒ½
 */
Map<String, dynamic> processGuidingModeBudget(
  Map<String, dynamic> budgetData
);
```

**Guidingæ¨¡å¼ç‰¹æ€§**ï¼š
- æ¥µç°¡é ç®—è¨­å®š
- è‡ªå‹•å»ºè­°é‚è¼¯
- æ™ºæ…§é è¨­å€¼
- æ­¥é©Ÿå¼å¼•å°

### 5.2 æ¨¡å¼åˆ‡æ›èˆ‡é…ç½®ç®¡ç†

#### 5.2.1 æ¨¡å¼é…ç½®ç®¡ç†
```dart
/**
 * 14. é ç®—æ¨¡å¼é…ç½®
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description ç®¡ç†ä¸åŒç”¨æˆ¶æ¨¡å¼çš„é ç®—åŠŸèƒ½é…ç½®
 */
BudgetModeConfig getBudgetModeConfig(UserMode userMode);
```

#### 5.2.2 å‹•æ…‹æ¨¡å¼åˆ‡æ›
```dart
/**
 * 15. å‹•æ…‹æ¨¡å¼åˆ‡æ›
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description è™•ç†ç”¨æˆ¶æ¨¡å¼åˆ‡æ›æ™‚çš„é ç®—è³‡æ–™é©é…
 */
Future<void> switchBudgetMode(
  UserMode fromMode,
  UserMode toMode,
  List<Budget> budgets
);
```

---

## 6.0 å‡½æ•¸ä»‹é¢è¦æ ¼ï¼ˆFunction Interface Specificationsï¼‰

### 6.1 æ ¸å¿ƒæ¥­å‹™é‚è¼¯å‡½æ•¸ï¼ˆ5å€‹ï¼‰

```dart
/**
 * 01. çµ±ä¸€é ç®—CRUDè™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description çµ±ä¸€è™•ç†é ç®—çš„å»ºç«‹ã€æŸ¥è©¢ã€æ›´æ–°ã€åˆªé™¤æ“ä½œ
 */
Future<BudgetOperationResult> processBudgetCRUD(
  BudgetCRUDType operation,
  Map<String, dynamic> data,
  UserMode userMode
);

/**
 * 02. é ç®—åŸ·è¡Œç‹€æ³è¨ˆç®—
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description è¨ˆç®—é ç®—åŸ·è¡Œé€²åº¦ã€ä½¿ç”¨ç‡ã€å‰©é¤˜é‡‘é¡ç­‰æ ¸å¿ƒæŒ‡æ¨™
 */
Future<BudgetExecutionResult> calculateBudgetExecution(
  String budgetId,
  {DateTime? asOfDate}
);

/**
 * 03. é ç®—è­¦ç¤ºæª¢æŸ¥
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description æª¢æŸ¥é ç®—è­¦ç¤ºæ¢ä»¶ä¸¦è§¸ç™¼ç›¸æ‡‰é€šçŸ¥
 */
Future<List<BudgetAlert>> checkBudgetAlerts(
  String budgetId,
  {bool triggerNotification = true}
);

/**
 * 04. é ç®—è³‡æ–™é©—è­‰
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description çµ±ä¸€é©—è­‰é ç®—å»ºç«‹å’Œæ›´æ–°çš„è³‡æ–™å®Œæ•´æ€§èˆ‡é‚è¼¯æ€§
 */
ValidationResult validateBudgetData(
  Map<String, dynamic> budgetData,
  BudgetValidationType validationType
);

/**
 * 05. APIè³‡æ–™è½‰æ›
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description çµ±ä¸€è™•ç†APIå›æ‡‰è³‡æ–™èˆ‡UIéœ€æ±‚æ ¼å¼çš„è½‰æ›
 */
Map<String, dynamic> transformBudgetData(
  dynamic apiResponse,
  BudgetTransformType transformType,
  UserMode userMode
);
```

### 6.2 APIæ¶ˆè²»ç«¯å‡½æ•¸ï¼ˆ5å€‹ï¼‰

```dart
/**
 * 06. é ç®—åˆ—è¡¨æŸ¥è©¢
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description å°è£APL.dartçš„getBudgets()æ–¹æ³•ï¼Œæä¾›é ç®—åˆ—è¡¨æŸ¥è©¢
 */
Future<List<Budget>> getBudgetList({
  String? ledgerId,
  String? type,
  String? status,
  UserMode? userMode
});

/**
 * 07. å»ºç«‹é ç®—
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description å°è£APL.dartçš„createBudget()æ–¹æ³•ï¼Œæä¾›é ç®—å»ºç«‹åŠŸèƒ½
 */
Future<Budget> createBudget(
  Map<String, dynamic> budgetData,
  UserMode userMode
);

/**
 * 08. é ç®—ç‹€æ³æŸ¥è©¢
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description å°è£APL.dartçš„getBudgetStatus()æ–¹æ³•ï¼Œæä¾›é ç®—åŸ·è¡Œç‹€æ³
 */
Future<BudgetStatusOverview> getBudgetStatus({
  String? ledgerId,
  UserMode? userMode
});

/**
 * 09. APIéŒ¯èª¤è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description çµ±ä¸€è™•ç†APL.dartå›å‚³çš„éŒ¯èª¤ï¼Œè½‰æ›ç‚ºç”¨æˆ¶å‹å–„è¨Šæ¯
 */
BudgetError handleAPIError(
  dynamic apiError,
  UserMode userMode,
  {String? context}
);

/**
 * 10. ç¶²è·¯ç•°å¸¸è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description è™•ç†ç¶²è·¯é€£ç·šç•°å¸¸ï¼Œæä¾›é›¢ç·šæ¨¡å¼æˆ–é‡è©¦æ©Ÿåˆ¶
 */
Future<BudgetOperationResult> handleNetworkError(
  Function apiCall,
  {int maxRetries = 3}
);
```

### 6.3 å››æ¨¡å¼é©é…å‡½æ•¸ï¼ˆ5å€‹ï¼‰

```dart
/**
 * 11. Expertæ¨¡å¼é ç®—è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description ç‚ºExpertæ¨¡å¼æä¾›è©³ç´°çš„é ç®—åˆ†æèˆ‡é€²éšåŠŸèƒ½
 */
Map<String, dynamic> processExpertModeBudget(
  Map<String, dynamic> budgetData
);

/**
 * 12. Cultivationæ¨¡å¼é ç®—è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description ç‚ºCultivationæ¨¡å¼æä¾›ç¿’æ…£é¤Šæˆå°å‘çš„é ç®—åŠŸèƒ½
 */
Map<String, dynamic> processCultivationModeBudget(
  Map<String, dynamic> budgetData
);

/**
 * 13. Guidingæ¨¡å¼é ç®—è™•ç†
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description ç‚ºGuidingæ¨¡å¼æä¾›ç°¡åŒ–çš„é ç®—å¼•å°åŠŸèƒ½
 */
Map<String, dynamic> processGuidingModeBudget(
  Map<String, dynamic> budgetData
);

/**
 * 14. é ç®—æ¨¡å¼é…ç½®
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description ç®¡ç†ä¸åŒç”¨æˆ¶æ¨¡å¼çš„é ç®—åŠŸèƒ½é…ç½®
 */
BudgetModeConfig getBudgetModeConfig(UserMode userMode);

/**
 * 15. å‹•æ…‹æ¨¡å¼åˆ‡æ›
 * @version 2025-10-22-V2.0.0
 * @date 2025-10-22
 * @description è™•ç†ç”¨æˆ¶æ¨¡å¼åˆ‡æ›æ™‚çš„é ç®—è³‡æ–™é©é…
 */
Future<void> switchBudgetMode(
  UserMode fromMode,
  UserMode toMode,
  List<Budget> budgets
);
```

---

## ğŸ“Š éšæ®µäºŒå®Œæˆç¸½çµ

### é‡æ–°è¨­è¨ˆæˆæœ

| é …ç›® | éšæ®µäºŒè¨­è¨ˆçµæœ |
|------|----------------|
| ç¸½å‡½æ•¸æ•¸ | 15å€‹æ ¸å¿ƒå‡½æ•¸ |
| æ ¸å¿ƒæ¥­å‹™é‚è¼¯ | 5å€‹å‡½æ•¸ |
| APIæ¶ˆè²»ç«¯ | 5å€‹å‡½æ•¸ |
| å››æ¨¡å¼é©é… | 5å€‹å‡½æ•¸ |
| APIä¾è³´ä¿®æ­£ | âœ… å®Œæˆ |
| æ¶æ§‹ç°¡åŒ– | âœ… å®Œæˆ |

### MVPèšç„¦æ•ˆç›Š

1. **æ¶æ§‹æ¸…æ™°åŒ–**ï¼šå»ºç«‹æ­£ç¢ºçš„APL.dartä¾è³´é—œä¿‚
2. **åŠŸèƒ½èšç„¦åŒ–**ï¼šå°ˆæ³¨S-307ã€S-308æ ¸å¿ƒç•«é¢æ¥­å‹™é‚è¼¯  
3. **APIæ¶ˆè²»æ¨™æº–åŒ–**ï¼šçµ±ä¸€é€éAPL.dart Gateway
4. **å››æ¨¡å¼æ”¯æ´å®Œæ•´æ€§**ï¼šæ¶µè“‹å››ç¨®ç”¨æˆ¶æ¨¡å¼çš„å·®ç•°åŒ–è™•ç†

---

**æ–‡ä»¶ç‰ˆæœ¬**: v2.0.0  
**éšæ®µäºŒå®Œæˆæ—¥æœŸ**: 2025-10-22  
**é‡æ–°è¨­è¨ˆæˆæœ**: åŸºæ–¼æ­£ç¢ºAPIæ¶æ§‹çš„15å€‹æ ¸å¿ƒå‡½æ•¸è¨­è¨ˆ  
**MVPåŸå‰‡**: å°ˆæ³¨Phase 2é ç®—ç®¡ç†æ ¸å¿ƒåŠŸèƒ½ï¼Œç§»é™¤éåº¦å·¥ç¨‹  
**APIæ•´åˆ**: çµ±ä¸€é€éAPL.darté€²è¡ŒAPIæ¶ˆè²»  
**éµå¾ªè¦ç¯„**: åš´æ ¼éµå¾ª0090ã€7104ã€8088æ–‡ä»¶è¦ç¯„
