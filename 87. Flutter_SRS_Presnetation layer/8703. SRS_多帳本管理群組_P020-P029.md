
# SRS_多帳本管理群組_P020-P029

**文件編號**: 8703  
**版本**: 1.0.0  
**建立日期**: 2025-08-02  
**建立者**: LCAS SA Team  
**最後更新**: 2025-08-02 11:45:00 UTC+8

---

## 📑 目次

1. [群組概述](#10-群組概述)
2. [功能需求規格](#20-功能需求規格)
3. [非功能需求](#30-非功能需求)
4. [API整合需求](#40-api整合需求)
5. [四模式適應性](#50-四模式適應性)
6. [測試驗收標準](#60-測試驗收標準)

---

## 1.0 群組概述

### 1.1 業務目標與價值
多帳本管理群組是 LCAS 2.0 的核心進階功能，提供專案、分類、共享三種帳本類型的完整生命週期管理，滿足用戶從個人記帐到團隊協作的不同需求場景。

### 1.2 包含頁面清單
- **P020**: 帳本管理中心 (Ledger Management Center)
- **P021**: 專案帳本建立 (Create Project Ledger)
- **P022**: 分類帳本建立 (Create Category Ledger)
- **P023**: 專案帳本詳情 (Project Ledger Details)
- **P024**: 分類帳本詳情 (Category Ledger Details)
- **P025**: 帳本設定管理 (Ledger Settings)
- **P026**: 帳本成員管理 (Member Management)
- **P027**: 帳本權限設定 (Permission Settings)
- **P028**: 帳本歸檔管理 (Archive Management)
- **P029**: 帳本複製遷移 (Copy & Migration)

### 1.3 使用者流程概述
```
P020 帳本中心 → P021/P022 建立帳本 → P023/P024 帳本詳情 
     ↓
P025 設定管理 → P026 成員管理 → P027 權限設定
     ↓
P028 歸檔管理 ← P029 複製遷移
```

---

## 2.0 功能需求規格

### 2.1 P020 - 帳本管理中心

#### 2.1.1 功能描述
提供所有帳本的統一管理介面，支援快速切換、檢視、管理不同類型的帳本。

#### 2.1.2 輸入/輸出規格
**輸入**:
- 使用者身份驗證 Token
- 帳本篩選條件（類型、狀態、時間）
- 排序方式選擇

**輸出**:
- 帳本清單（含統計資訊）
- 快速操作選單
- 新建帳本入口

#### 2.1.3 業務規則
- 依權限顯示可存取的帳本
- 支援帳本狀態篩選（活躍、歸檔、共享）
- 提供帳本統計概覽

#### 2.1.4 四模式差異
- **精準控制者**: 顯示完整統計數據、進階篩選選項
- **紀錄習慣者**: 美觀卡片佈局、簡潔視覺設計
- **轉型挑戰者**: 突出預算狀態、進度提醒
- **潛在覺醒者**: 簡化介面、引導式操作

### 2.2 P021 - 專案帳本建立

#### 2.2.1 功能描述
建立專案導向的帳本，支援時間範圍、預算設定、成員邀請等進階功能。

#### 2.2.2 輸入/輸出規格
**輸入**:
```dart
class CreateProjectLedgerInput {
  String projectName;        // 專案名稱（必填）
  String? description;       // 專案描述
  DateTime startDate;        // 開始日期（必填）
  DateTime endDate;          // 結束日期（必填）
  double? totalBudget;       // 總預算
  String currency;           // 幣別
  List<String>? memberIds;   // 初始成員
  ProjectType projectType;   // 專案類型
}
```

**輸出**:
```dart
class CreateProjectLedgerOutput {
  bool success;
  String projectId;
  String ledgerId;
  DateTime createdAt;
  String redirectUrl;        // 導向專案詳情頁面
}
```

#### 2.2.3 業務規則
- 專案名稱不可重複
- 結束日期須晚於開始日期
- 預算金額須為正數
- 初始成員自動獲得「成員」權限

#### 2.2.4 四模式差異
- **精準控制者**: 提供詳細預算分類、時程規劃工具
- **紀錄習慣者**: 美觀的表單設計、流暢動畫效果
- **轉型挑戰者**: 智能預算建議、目標設定引導
- **潛在覺醒者**: 簡化為必填欄位、範本快速建立

### 2.3 P022 - 分類帳本建立

#### 2.3.1 功能描述
建立主題分類的帳本，支援智慧分類規則、標籤系統、自動歸類功能。

#### 2.3.2 輸入/輸出規格
**輸入**:
```dart
class CreateCategoryLedgerInput {
  String categoryName;         // 分類名稱（必填）
  CategoryType categoryType;   // 分類類型
  String? description;         // 分類描述
  List<String> tags;          // 標籤列表
  List<String>? defaultSubjects; // 預設科目
  String colorTheme;          // 顏色主題
  String? iconUrl;            // 圖示URL
  bool enableAutoClassify;    // 啟用自動分類
}
```

**輸出**:
```dart
class CreateCategoryLedgerOutput {
  bool success;
  String categoryId;
  String ledgerId;
  int rulesConfigured;        // 配置的規則數量
  String redirectUrl;
}
```

#### 2.3.3 業務規則
- 分類名稱在使用者範圍內不可重複
- 標籤數量限制 1-10 個
- 支援預設科目自動配置
- 自動分類規則可後續編輯

#### 2.3.4 四模式差異
- **精準控制者**: 進階規則編輯器、複雜分類邏輯
- **紀錄習慣者**: 視覺化顏色選擇、美觀圖示庫
- **轉型挑戰者**: 推薦常用分類、成功案例參考
- **潛在覺醒者**: 預設範本選擇、一鍵快速建立

### 2.4 P023 - 專案帳本詳情

#### 2.4.1 功能描述
顯示專案帳本的完整資訊，包含進度追蹤、預算執行、成員活動等。

#### 2.4.2 輸入/輸出規格
**輸入**:
- 專案 ID
- 檢視時間範圍
- 資料詳細度設定

**輸出**:
- 專案基本資訊
- 預算執行狀況
- 時程進度追蹤
- 成員活動統計
- 快速操作選單

#### 2.4.3 業務規則
- 根據使用者權限顯示不同資訊詳細度
- 即時更新預算與進度資訊
- 支援資料匯出功能

#### 2.4.4 四模式差異
- **精準控制者**: 完整數據儀表板、深度分析圖表
- **紀錄習慣者**: 美觀進度視覺化、優雅資訊呈現
- **轉型挑戰者**: 目標達成進度、激勵性回饋
- **潛在覺醒者**: 簡化關鍵指標、直觀進度顯示

### 2.5 P024 - 分類帳本詳情

#### 2.5.1 功能描述
顯示分類帳本的統計分析、自動分類效果、規則效能等資訊。

#### 2.5.2 輸入/輸出規格
**輸入**:
- 分類 ID
- 分析時間範圍
- 統計維度選擇

**輸出**:
- 分類統計資訊
- 自動分類準確率
- 規則效能分析
- 標籤使用統計
- 優化建議

#### 2.5.3 業務規則
- 分類準確率計算基於使用者確認
- 提供規則優化建議
- 支援分類效果評估

#### 2.5.4 四模式差異
- **精準控制者**: 詳細效能指標、規則調優介面
- **紀錄習慣者**: 視覺化統計圖表、美觀數據呈現
- **轉型挑戰者**: 改善建議提醒、效率提升追蹤
- **潛在覺醒者**: 簡化關鍵成效、易懂視覺呈現

### 2.6 P025 - 帳本設定管理

#### 2.6.1 功能描述
管理帳本的基本設定、顯示選項、通知偏好等個人化配置。

#### 2.6.2 輸入/輸出規格
**輸入**:
- 帳本 ID
- 設定類別選擇
- 新設定值

**輸出**:
- 當前設定狀態
- 設定變更確認
- 影響範圍說明

#### 2.6.3 業務規則
- 僅帳本擁有者與管理員可修改設定
- 設定變更即時生效
- 關鍵設定需二次確認

#### 2.6.4 四模式差異
- **精準控制者**: 完整設定選項、進階配置功能
- **紀錄習慣者**: 優雅設定介面、直觀開關設計
- **轉型挑戰者**: 推薦最佳實踐、設定影響說明
- **潛在覺醒者**: 簡化核心設定、智能預設值

### 2.7 P026 - 帳本成員管理

#### 2.7.1 功能描述
管理帳本協作成員，包含邀請、移除、權限調整等功能。

#### 2.7.2 輸入/輸出規格
**輸入**:
```dart
class MemberManagementInput {
  String ledgerId;
  MemberAction action;      // add, remove, update_permission
  String? targetUserId;     // 目標使用者ID
  String? inviteEmail;      // 邀請Email
  ProjectRole? newRole;     // 新角色
  String? inviteMessage;    // 邀請訊息
}
```

**輸出**:
```dart
class MemberManagementOutput {
  bool success;
  List<MemberInfo> currentMembers;
  String? inviteLink;       // 邀請連結
  List<String>? notifications; // 通知訊息
}
```

#### 2.7.3 業務規則
- 僅擁有者與管理員可管理成員
- 不可移除帳本擁有者
- 邀請連結 7 天有效期
- 成員變更需通知相關人員

#### 2.7.4 四模式差異
- **精準控制者**: 詳細權限矩陣、批次成員操作
- **紀錄習慣者**: 美觀成員卡片、流暢邀請流程
- **轉型挑戰者**: 協作效益說明、團隊建議
- **潛在覺醒者**: 簡化邀請流程、基本權限設定

### 2.8 P027 - 帳本權限設定

#### 2.8.1 功能描述
詳細設定帳本的存取權限、功能權限、資料可見性等安全控制。

#### 2.8.2 輸入/輸出規格
**輸入**:
- 帳本 ID  
- 權限類型（檢視、編輯、管理、匯出）
- 角色權限矩陣
- 特殊權限設定

**輸出**:
- 權限設定確認
- 權限影響範圍
- 安全風險警告
- 變更生效時間

#### 2.8.3 業務規則
- 權限設定即時生效
- 降低權限需再次確認
- 擁有者權限不可變更
- 記錄權限變更日誌

#### 2.8.4 四模式差異
- **精準控制者**: 細顆粒權限控制、進階安全設定
- **紀錄習慣者**: 視覺化權限矩陣、清晰權限說明
- **轉型挑戰者**: 權限最佳實踐、安全建議
- **潛在覺醒者**: 簡化權限等級、預設安全配置

### 2.9 P028 - 帳本歸檔管理

#### 2.9.1 功能描述
管理帳本的歸檔狀態，包含歸檔、還原、永久刪除等生命週期操作。

#### 2.9.2 輸入/輸出規格
**輸入**:
- 帳本 ID
- 歸檔動作（歸檔、還原、刪除）
- 確認資訊
- 歸檔原因

**輸出**:
- 操作執行狀態
- 歸檔資訊摘要
- 還原時間限制
- 備份狀態確認

#### 2.9.3 業務規則
- 歸檔帳本保留 90 天可還原期
- 永久刪除需雙重確認
- 自動建立歸檔前備份
- 通知所有相關成員

#### 2.9.4 四模式差異
- **精準控制者**: 詳細歸檔選項、自訂保留政策
- **紀錄習慣者**: 友善歸檔介面、清楚流程指引
- **轉型挑戰者**: 歸檔影響說明、資料整理建議
- **潛在覺醒者**: 簡化歸檔流程、明確安全提示

### 2.10 P029 - 帳本複製遷移

#### 2.10.1 功能描述
支援帳本資料的複製與遷移，包含範本建立、資料轉移、結構調整等功能。

#### 2.10.2 輸入/輸出規格
**輸入**:
```dart
class CopyMigrationInput {
  String sourceLedgerId;     // 來源帳本ID
  CopyOption copyOption;     // 複製選項
  String newLedgerName;      // 新帳本名稱
  DateRange? dateRange;      // 複製日期範圍
  bool includeMembers;       // 是否包含成員
  bool includeSettings;      // 是否包含設定
}
```

**輸出**:
```dart
class CopyMigrationOutput {
  bool success;
  String newLedgerId;
  int copiedRecords;         // 複製記錄數
  List<String> warnings;     // 警告訊息
  String migrationReport;    // 遷移報告
}
```

#### 2.10.3 業務規則
- 複製操作需來源帳本讀取權限
- 支援部分資料複製
- 成員權限需重新設定
- 提供遷移完整性檢查

#### 2.10.4 四模式差異
- **精準控制者**: 細顆粒複製控制、進階遷移選項
- **紀錄習慣者**: 視覺化複製流程、美觀進度呈現
- **轉型挑戰者**: 複製範本建議、最佳實踐指引
- **潛在覺醒者**: 一鍵複製功能、簡化選項設定

---

## 3.0 非功能需求

### 3.1 效能需求
- 帳本清單載入時間 < 1 秒
- 帳本切換響應時間 < 500ms
- 大型帳本（>10000筆記錄）操作不超過 3 秒
- 支援 100 個帳本的並行管理

### 3.2 安全需求
- 所有帳本操作需身份驗證
- 權限變更即時生效
- 敏感操作（刪除、權限變更）需二次確認
- 完整的操作日誌記錄

### 3.3 相容性需求
- 支援 iOS 14.0+ / Android 8.0+
- 響應式設計適應不同螢幕尺寸
- 支援深色/淺色模式切換
- 無障礙功能支援

---

## 4.0 API整合需求

### 4.1 對應API端點
- **F010**: `/projects/create` - 專案帳本建立
- **F011**: `/projects/manage` - 專案帳本管理  
- **F012**: `/projects/delete` - 專案帳本刪除
- **F013**: `/categories/create` - 分類帳本建立
- **F014**: `/categories/manage` - 分類帳本管理
- **F015**: `/ledgers/switch` - 多帳本切換

### 4.2 資料格式規格
所有 API 請求需包含：
```json
{
  "timestamp": "2025-08-02T11:45:00+08:00",
  "user_id": "string",
  "ledger_id": "string",
  "action": "string",
  "data": {}
}
```

### 4.3 錯誤處理
- 網路錯誤：顯示重試選項
- 權限錯誤：顯示權限不足提示
- 資料衝突：提供衝突解決選項
- 系統錯誤：記錄錯誤並通知管理員

---

## 5.0 四模式適應性

### 5.1 視覺差異需求

#### 5.1.1 精準控制者模式
- **配色方案**: 深藍主色調，專業商務風格
- **資訊密度**: 高密度資訊呈現，多欄位資料表格
- **互動方式**: 快捷鍵支援，批次操作功能
- **特色元件**: 進階篩選器、統計儀表板、專業圖表

#### 5.1.2 紀錄習慣者模式  
- **配色方案**: 溫和紫色系，優雅質感設計
- **資訊密度**: 中等密度，美觀卡片佈局
- **互動方式**: 流暢動畫效果，直觀手勢操作
- **特色元件**: 美觀進度條、優雅按鈕、柔和陰影

#### 5.1.3 轉型挑戰者模式
- **配色方案**: 活力橙色系，激勵性設計語言
- **資訊密度**: 重點突出，目標導向資訊架構
- **互動方式**: 成就系統、進度追蹤、提醒通知
- **特色元件**: 進度徽章、挑戰任務、激勵文案

#### 5.1.4 潛在覺醒者模式
- **配色方案**: 清新綠色系，友善親和風格
- **資訊密度**: 低密度呈現，重點資訊突出
- **互動方式**: 引導式操作，簡化流程設計
- **特色元件**: 引導提示、簡化按鈕、清晰標籤

### 5.2 功能複雜度調整

#### 5.2.1 功能可見性矩陣
| 功能模組 | 精準控制者 | 紀錄習慣者 | 轉型挑戰者 | 潛在覺醒者 |
|----------|------------|------------|------------|------------|
| 進階權限設定 | ✅ | ⚡ | ⚡ | ❌ |
| 批次成員管理 | ✅ | ❌ | ⚡ | ❌ |
| 自動分類規則 | ✅ | ✅ | ⚡ | ❌ |
| 帳本複製遷移 | ✅ | ✅ | ✅ | ⚡ |
| 基本帳本管理 | ✅ | ✅ | ✅ | ✅ |

註: ✅完整功能 ⚡簡化版本 ❌隱藏功能

### 5.3 使用者體驗差異

#### 5.3.1 操作流程差異
- **精準控制者**: 支援快捷操作、批次處理、進階設定
- **紀錄習慣者**: 注重視覺美感、流暢動畫、優雅互動
- **轉型挑戰者**: 強調目標達成、進度追蹤、激勵回饋
- **潛在覺醒者**: 簡化操作步驟、智能預設、引導提示

---

## 6.0 測試驗收標準

### 6.1 功能測試Cases

#### 6.1.1 帳本建立測試
- **TC-MLS-001**: 專案帳本建立流程完整性
- **TC-MLS-002**: 分類帳本建立與規則配置
- **TC-MLS-003**: 帳本名稱重複檢查機制
- **TC-MLS-004**: 預算設定與驗證規則

#### 6.1.2 權限管理測試
- **TC-MLS-005**: 成員邀請與權限分配
- **TC-MLS-006**: 權限變更即時生效驗證
- **TC-MLS-007**: 權限矩陣正確性檢查
- **TC-MLS-008**: 非授權操作阻擋機制

#### 6.1.3 歸檔與複製測試
- **TC-MLS-009**: 帳本歸檔與還原流程
- **TC-MLS-010**: 資料複製完整性驗證
- **TC-MLS-011**: 大量資料遷移效能測試
- **TC-MLS-012**: 歸檔帳本資料保護機制

### 6.2 整合測試Scenarios

#### 6.2.1 跨模組整合
- **TS-MLS-001**: 與預算管理模組整合測試
- **TS-MLS-002**: 與協作功能模組整合測試  
- **TS-MLS-003**: 與報表功能模組整合測試
- **TS-MLS-004**: 與備份服務模組整合測試

#### 6.2.2 四模式切換
- **TS-MLS-005**: 模式切換時介面調整測試
- **TS-MLS-006**: 功能可見性變更測試
- **TS-MLS-007**: 使用者偏好保存測試
- **TS-MLS-008**: 跨模式資料一致性測試

### 6.3 使用者驗收Criteria

#### 6.3.1 可用性標準
- 新用戶可在 3 分鐘內建立第一個帳本
- 帳本切換操作不超過 2 次點擊
- 權限設定介面直觀易懂，錯誤率 < 5%
- 四種模式下使用者滿意度 > 4.0/5.0

#### 6.3.2 效能標準
- 帳本清單載入時間 < 1 秒
- 大型帳本（>5000筆記錄）操作響應 < 3 秒
- 成員管理操作即時反應（< 500ms）
- 系統支援並行 50+ 帳本無效能衰減

#### 6.3.3 穩定性標準
- 帳本資料零遺失率
- 權限變更成功率 > 99.9%
- 7x24 小時連續運行無重大錯誤
- 異常情況下資料回滾成功率 100%

---

## 文件維護記錄

| 版本 | 日期 | 修改者 | 修改內容 |
|------|------|--------|----------|
| **v1.0.0** | **2025-08-02** | **LCAS SA Team** | **初版建立：完整的多帳本管理群組SRS，涵蓋P020-P029全部頁面功能需求與四模式適應性設計** |

---

## 備註

- **版本1.0.0特色**: 首個完整的多帳本管理SRS，整合專案、分類、共享帳本的完整生命週期
- **10個頁面覆蓋**: P020-P029 完整涵蓋帳本管理的所有核心場景
- **四模式深度整合**: 每個功能都針對四種使用者模式進行差異化設計
- **企業級權限控制**: 完整的成員管理與權限矩陣設計
- **進階功能支援**: 歸檔管理、複製遷移、智慧分類等企業級功能
- **對應模組**: 整合 MLS 模組 v1.0.0、CM 模組 v1.0.0、BM 模組等核心模組
