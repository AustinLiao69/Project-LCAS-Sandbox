# P057_用戶管理頁面_SRS

**文件編號**: P057-SRS

**版本**: v1.0.0  
**建立日期**: 2025-01-24  
**更新日期**: 2025-01-24

---

## 目次
1. [功能目的](#1-功能目的purpose)
2. [使用者故事](#2-使用者故事user-story)
3. [前置條件](#3-前置條件preconditions)
4. [功能流程](#4-功能流程user-flow--functional-flow)
5. [輸入項目](#5-輸入項目inputs)
6. [輸出項目](#6-輸出項目outputs--responses)
7. [驗證規則](#7-驗證規則validation-rules)
8. [錯誤處理](#8-錯誤處理error-handling)
9. [UI元件與排版需求](#9-ui元件與排版需求ui-requirements)
10. [API規格](#10-api規格如有api-specification)
11. [狀態與畫面切換](#11-狀態與畫面切換state-handling)
12. [安全性與權限檢查](#12-安全性與權限檢查security--access-control)
13. [其他補充需求](#13-其他補充需求others)

---

## 1. 功能目的（Purpose）

提供**超級管理員**管理所有系統用戶帳號的完整介面，包括用戶建立、編輯、停用、角色權限設定等功能，確保系統用戶帳號的集中管理和安全控制。

**重要說明**: 此頁面為**系統管理員專用功能**，不適用於一般記帳用戶，需要企業級權限管理架構支援。

---

## 2. 使用者故事（User Story）

- 作為一位**超級管理員**，我希望能查看所有系統用戶的帳號資訊，以便了解用戶使用狀況
- 作為一位**超級管理員**，我希望能建立新的用戶帳號，以便為企業用戶開通系統存取權限
- 作為一位**超級管理員**，我希望能修改用戶的基本資料和權限設定，以便維護帳號安全
- 作為一位**超級管理員**，我希望能停用或刪除用戶帳號，以便管理離職或不當使用的情況

**注意**: 此功能不適用於四模式差異化設計，僅為超級管理員提供統一的管理介面。

---

## 3. 前置條件（Preconditions）

- 用戶必須已完成登入驗證
- 用戶必須具備系統管理員權限
- 系統必須連接至用戶管理服務
- 必須通過管理者身份驗證檢查

---

## 4. 功能流程（User Flow / Functional Flow）

1. **進入用戶管理頁面**
   - 驗證管理員權限
   - 載入用戶清單資料
   - 顯示搜尋和篩選選項

2. **檢視用戶清單**
   - 分頁顯示用戶資料
   - 支援搜尋和篩選功能
   - 顯示用戶狀態和基本資訊

3. **用戶帳號操作**
   - 建立新用戶帳號
   - 編輯現有用戶資料
   - 重設用戶密碼
   - 停用/啟用用戶帳號

4. **權限管理**
   - 設定用戶角色權限
   - 管理功能存取權限
   - 設定資料存取範圍

---

## 5. 輸入項目（Inputs）

| 欄位名稱 | 型別 | 限制條件 | UI 顯示 | 備註 |
|----------|------|----------|---------|------|
| 搜尋關鍵字 | String | 最多50字元 | 搜尋輸入框 | 支援姓名、Email搜尋 |
| 用戶狀態篩選 | Enum | active/inactive/suspended | 下拉選單 | 篩選條件 |
| 角色篩選 | Enum | admin/user/viewer | 下拉選單 | 權限篩選 |
| 用戶姓名 | String | 必填，2-50字元 | 文字輸入框 | 建立/編輯用戶 |
| 電子郵件 | String | 必填，有效Email格式 | 文字輸入框 | 登入帳號 |
| 手機號碼 | String | 選填，10-15位數字 | 文字輸入框 | 聯絡方式 |
| 用戶角色 | Enum | 必填 | 單選按鈕 | 權限設定 |

---

## 6. 輸出項目（Outputs / Responses）

### 用戶清單顯示
- 用戶頭像和基本資訊
- 帳號狀態標示（啟用/停用/暫停）
- 最後登入時間
- 權限角色標籤
- 操作按鈕（編輯/停用/刪除）

### 用戶詳情資訊
- 完整個人資料
- 帳號建立和最後異動時間
- 登入歷史記錄
- 權限設定詳情
- 使用統計資料

### 系統通知訊息
- 操作成功確認訊息
- 錯誤和警告提示
- 權限不足提醒
- 資料驗證錯誤說明

---

## 7. 驗證規則（Validation Rules）

### 用戶資料驗證
- 姓名不可為空，長度2-50字元
- Email格式必須正確且不可重複
- 手機號碼格式驗證（如有填寫）
- 用戶角色必須選擇

### 權限驗證
- 驗證操作者管理員權限
- 檢查是否可編輯目標用戶
- 確認角色權限變更合理性

### 安全性驗證
- 密碼重設需要二次確認
- 帳號停用需要確認理由
- 刪除操作需要特殊確認

---

## 8. 錯誤處理（Error Handling）

### 權限錯誤
- 顯示：「您沒有權限執行此操作」
- 自動導向到適當頁面
- 記錄安全日誌

### 資料驗證錯誤
- 即時顯示欄位錯誤訊息
- 標示問題欄位
- 提供修正建議

### 系統錯誤
- 顯示：「系統暫時無法處理請求，請稍後再試」
- 提供重試選項
- 記錄錯誤日誌

---

## 9. UI 元件與排版需求（UI Requirements）

| 元件名稱 | 類型 | 功能 | 互動說明 |
|----------|------|------|----------|
| 用戶清單表格 | DataTable | 顯示用戶資料 | 支援排序、分頁、搜尋 |
| 搜尋篩選欄 | SearchBar + Filters | 資料篩選 | 即時搜尋和篩選 |
| 新增用戶按鈕 | FloatingActionButton | 開啟建立表單 | 點擊後顯示建立表單 |
| 用戶操作選單 | PopupMenu | 用戶操作選項 | 編輯、停用、刪除等 |
| 用戶表單對話框 | Dialog | 建立/編輯用戶 | 模態對話框形式 |
| 狀態標籤 | Chip | 顯示用戶狀態 | 不同顏色表示狀態 |
| 確認對話框 | AlertDialog | 危險操作確認 | 停用/刪除確認 |

### 排版需求
- 響應式設計，支援不同螢幕尺寸
- 清單和卡片佈局可切換
- 重要操作使用對比色強調
- 遵循Material Design規範

---

## 10. API 規格（如有）（API Specification）

### 10.1 取得用戶清單

#### 請求（Request）
- **URL**: `/api/admin/users`
- **方法**: GET
- **對應9006文件**: 需要補充相應的**系統管理API端點**
- **建議API分類**: 新增F033-F036系統管理員功能API群組
- **參數**:
```json
{
  "page": 1,
  "limit": 20,
  "search": "搜尋關鍵字",
  "status": "active|inactive|suspended",
  "role": "admin|user|viewer"
}
```

#### 回應（Response）
- **成功範例**:
```json
{
  "success": true,
  "data": {
    "users": [
      {
        "id": "user123",
        "name": "張三",
        "email": "zhang@example.com",
        "phone": "0912345678",
        "role": "user",
        "status": "active",
        "lastLogin": "2025-01-24T10:30:00Z",
        "createdAt": "2025-01-01T00:00:00Z"
      }
    ],
    "totalCount": 150,
    "currentPage": 1,
    "totalPages": 8
  }
}
```

### 10.2 建立用戶

#### 請求（Request）
- **URL**: `/api/admin/users`
- **方法**: POST
- **Body**:
```json
{
  "name": "新用戶姓名",
  "email": "user@example.com",
  "phone": "0912345678",
  "role": "user",
  "sendWelcomeEmail": true
}
```

### 10.3 更新用戶資料

#### 請求（Request）
- **URL**: `/api/admin/users/{id}`
- **方法**: PUT
- **Body**:
```json
{
  "name": "更新後姓名",
  "phone": "0987654321",
  "role": "admin",
  "status": "active"
}
```

---

## 11. 狀態與畫面切換（State Handling）

### 載入狀態
- 顯示用戶清單載入指示器
- 分頁載入時的佔位符顯示
- 操作處理中的按鈕狀態

### 資料狀態
- 空資料狀態：顯示「暫無用戶資料」
- 搜尋無結果：顯示「找不到符合條件的用戶」
- 錯誤狀態：顯示錯誤訊息和重試選項

### 表單狀態
- 建立模式：空白表單
- 編輯模式：預填用戶資料
- 提交中：禁用表單和顯示處理指示器

---

## 12. 安全性與權限檢查（Security / Access Control）

### 權限檢查
- 頁面載入時驗證管理員權限
- 每個操作前都進行權限檢查
- 超級管理員和一般管理員權限區分

### 資料保護
- 敏感資料脫敏顯示
- 密碼相關資料不可見
- 操作日誌記錄

### 安全措施
- 批量操作需要二次確認
- 關鍵操作需要當前密碼驗證
- 異常操作自動記錄和告警

---

## 13. 其他補充需求（Others）

### 國際化需求
- 支援多語言介面
- 日期時間格式本地化
- 數字格式本地化

### 無障礙設計
- 支援鍵盤導航
- 螢幕閱讀器相容
- 色彩對比度符合標準

### 效能需求
- 用戶清單分頁載入
- 搜尋結果即時更新
- 大量資料時的虛擬滾動

### 稽核需求
- 所有用戶管理操作記錄
- 權限變更歷史追蹤
- 異常活動監控和告警

### 匯出功能
- 支援用戶清單匯出CSV/Excel
- 包含篩選和搜尋結果
- 考慮資料隱私保護

---

## 版本記錄

| 版本 | 日期 | 異動說明 | 修改者 |
|------|------|----------|--------|
| v1.0.0 | 2025-01-24 | 初始版本建立 | SA團隊 |