
## P067 提醒設定頁面（Reminder Settings Page）

**版本**: v1.0.0  
**建立日期**: 2025-01-26  
**建立者**: LCAS PM Team  
**最後更新**: 2025-01-26 17:20:00 UTC+8  

---

### 📑 目次 (Table of Contents)

1. [功能目的 (Purpose)](#1-功能目的-purpose)
2. [使用者故事 (User Story)](#2-使用者故事-user-story)
3. [前置條件 (Preconditions)](#3-前置條件-preconditions)
4. [功能流程 (Functional Flow)](#4-功能流程-functional-flow)
5. [輸入項目 (Inputs)](#5-輸入項目-inputs)
6. [輸出項目 (Outputs)](#6-輸出項目-outputs)
7. [驗證規則 (Validation Rules)](#7-驗證規則-validation-rules)
8. [錯誤處理 (Error Handling)](#8-錯誤處理-error-handling)
9. [UI 元件與排版需求 (UI Requirements)](#9-ui-元件與排版需求-ui-requirements)
10. [API 規格 (API Specification)](#10-api-規格-api-specification)
11. [狀態與畫面切換 (State Handling)](#11-狀態與畫面切換-state-handling)
12. [安全性與權限檢查 (Security)](#12-安全性與權限檢查-security)
13. [其他補充需求 (Others)](#13-其他補充需求-others)

---

### 1. 功能目的 (Purpose)

提醒設定頁面提供使用者完整的通知和提醒配置功能，包含記帳提醒、預算警示、報表通知和系統通知的個人化設定，確保使用者能夠及時接收重要資訊。

---

### 2. 使用者故事 (User Story)

**主要使用者故事**：
- 作為一位用戶，我希望能設定記帳提醒，幫助養成記帳習慣
- 作為一位用戶，我希望能自訂預算警示，及時控制支出
- 作為一位用戶，我希望能選擇通知方式，方便接收提醒

**次要使用者故事**：
- 作為一位用戶，我希望能設定靜音時段，避免不適當時間的打擾
- 作為一位用戶，我希望能預覽提醒效果，確認設定正確

---

### 3. 前置條件 (Preconditions)

- 使用者已成功登入系統
- 系統已載入用戶偏好設定
- 裝置已授權通知權限
- 網路連線正常

---

### 4. 功能流程 (Functional Flow)

#### 4.1 主要流程
1. 用戶進入提醒設定頁面
2. 檢視當前提醒配置
3. 選擇提醒類型和條件
4. 設定提醒時間和頻率
5. 選擇通知方式和格式
6. 設定靜音時段和例外
7. 測試提醒設定
8. 儲存提醒配置

#### 4.2 分支流程
- **智慧提醒流程**：系統自動建議提醒設定
- **批次設定流程**：快速設定多項提醒
- **提醒測試流程**：發送測試通知驗證設定

---

### 5. 輸入項目 (Inputs)

| 欄位名稱 | 型別 | 限制條件 | UI 顯示 | 備註 |
|----------|------|----------|---------|------|
| 記帳提醒頻率 | Select | 每日/每週/自訂 | 下拉選單 | 記帳提醒間隔 |
| 提醒時間 | Time | 00:00-23:59 | 時間選擇器 | 每日提醒時間 |
| 預算警示閾值 | Number | 50-100% | 滑桿輸入 | 預算使用率警示點 |
| 通知方式 | Array | 推播/Email/簡訊 | 複選框群組 | 通知傳送方式 |
| 靜音開始時間 | Time | 必填 | 時間選擇器 | 勿擾時段開始 |
| 靜音結束時間 | Time | 必填 | 時間選擇器 | 勿擾時段結束 |
| 週末提醒 | Boolean | 可選 | 開關按鈕 | 週末是否提醒 |
| 節日提醒 | Boolean | 可選 | 開關按鈕 | 節假日是否提醒 |
| 提醒內容自訂 | String | 可選，最多200字元 | 文字區域 | 個人化提醒訊息 |
| 重複次數 | Number | 1-5次 | 數字輸入 | 提醒重複發送次數 |

---

### 6. 輸出項目 (Outputs)

#### 6.1 提醒設定狀態
- 當前啟用的提醒清單
- 提醒規則和條件摘要
- 下次提醒時間預告
- 提醒發送統計

#### 6.2 測試結果
- 測試通知發送狀態
- 通知到達確認
- 設定驗證結果
- 建議優化設定

---

### 7. 驗證規則 (Validation Rules)

#### 7.1 時間設定驗證
- **時間邏輯**：靜音結束時間必須晚於開始時間
- **頻率合理性**：提醒頻率不可過於密集
- **時區一致性**：確保時間設定符合用戶時區

#### 7.2 通知方式驗證
- **權限檢查**：確認選擇的通知方式已授權
- **聯絡資訊**：驗證Email和電話號碼有效性
- **設備相容性**：檢查通知方式與設備相容性

---

### 8. 錯誤處理 (Error Handling)

#### 8.1 常見錯誤情境
- **權限不足**：通知權限未授權或被撤銷
- **聯絡資訊錯誤**：Email或電話號碼格式不正確
- **時間衝突**：提醒時間設定邏輯錯誤
- **服務異常**：通知服務暫時無法使用

#### 8.2 錯誤訊息設計
```
成功訊息：
- "提醒設定已成功儲存"
- "測試通知已發送"
- "提醒規則已啟用"

錯誤訊息：
- "請先開啟通知權限，才能接收提醒"
- "Email格式不正確，請重新輸入"
- "靜音時段設定有誤，結束時間不可早於開始時間"
- "通知服務暫時無法使用，請稍後重試"
```

---

### 9. UI 元件與排版需求 (UI Requirements)

#### 9.1 主要UI元件

| 元件名稱 | 類型 | 功能 | 互動說明 |
|----------|------|------|----------|
| 提醒分類標籤 | TabBar | 切換提醒類型 | 點擊切換不同提醒設定 |
| 時間選擇器 | TimePicker | 設定提醒時間 | 滾輪或時鐘選擇 |
| 通知方式選擇 | CheckboxGroup | 選擇通知方式 | 多選通知管道 |
| 頻率設定滑桿 | Slider | 調整提醒頻率 | 拖拽調整數值 |
| 測試按鈕 | TestButton | 發送測試通知 | 點擊發送測試 |
| 靜音時段設定 | TimeRangeSelector | 設定勿擾時間 | 範圍選擇器 |

#### 9.2 提醒設定分類
```
🔔 提醒設定中心
├── 📝 記帳提醒
│   ├── 每日記帳提醒
│   ├── 忘記記帳提醒
│   ├── 週期性提醒
│   └── 自訂提醒內容
├── 💰 預算提醒
│   ├── 預算警示閾值
│   ├── 超支警告
│   ├── 月底總結提醒
│   └── 預算建議提醒
├── 📊 報表提醒
│   ├── 月報產生通知
│   ├── 重要趨勢警示
│   ├── 異常支出提醒
│   └── 自訂報表提醒
├── 🔧 系統提醒
│   ├── 更新通知
│   ├── 安全警示
│   ├── 備份完成通知
│   └── 維護通知
└── ⚙️ 通知設定
    ├── 通知方式選擇
    ├── 靜音時段設定
    ├── 通知頻率控制
    └── 測試通知功能
```

---

### 10. API 規格 (API Specification)

#### 10.1 獲取提醒設定
- **URL**：`GET /api/user/reminder-settings`
- **方法**：GET

#### 10.2 更新提醒設定
- **URL**：`PUT /api/user/reminder-settings`
- **方法**：PUT
- **Body 範例**：
```json
{
  "entryReminders": {
    "enabled": true,
    "frequency": "daily",
    "time": "20:00",
    "weekends": true,
    "holidays": false,
    "customMessage": "記得記錄今天的花費哦！"
  },
  "budgetReminders": {
    "enabled": true,
    "warningThreshold": 80,
    "criticalThreshold": 95,
    "monthlyReport": true,
    "anomalyDetection": true
  },
  "notificationMethods": {
    "push": true,
    "email": true,
    "sms": false
  },
  "quietHours": {
    "enabled": true,
    "startTime": "22:00",
    "endTime": "08:00",
    "weekendsOnly": false
  },
  "repeatSettings": {
    "maxRetries": 3,
    "retryInterval": 30
  }
}
```

#### 10.3 發送測試通知
- **URL**：`POST /api/user/reminder-settings/test`
- **方法**：POST
- **Body 範例**：
```json
{
  "type": "entry_reminder|budget_alert|report_notification",
  "method": "push|email|sms",
  "message": "這是一則測試提醒訊息"
}
```

#### 10.4 回應範例
**提醒設定回應**：
```json
{
  "status": "success",
  "data": {
    "reminders": {
      "entryReminders": {
        "enabled": true,
        "nextReminder": "2025-01-27T20:00:00Z",
        "successRate": 95.5
      },
      "budgetReminders": {
        "enabled": true,
        "activeAlerts": 2,
        "lastTriggered": "2025-01-25T14:30:00Z"
      }
    },
    "preferences": {
      "timezone": "Asia/Taipei",
      "language": "zh-TW",
      "notificationPermissions": {
        "push": true,
        "email": true,
        "sms": false
      }
    },
    "statistics": {
      "totalReminders": 156,
      "successfulDeliveries": 149,
      "deliveryRate": 95.5
    }
  }
}
```

---

### 11. 狀態與畫面切換 (State Handling)

#### 11.1 頁面狀態
- **載入中**：提醒設定載入中
- **正常顯示**：設定介面可操作
- **測試中**：測試通知發送中
- **儲存中**：設定儲存處理中

#### 11.2 提醒狀態
- **已啟用**：提醒功能正常運作
- **已停用**：用戶關閉提醒功能
- **權限不足**：缺少必要的通知權限
- **服務異常**：通知服務無法使用

---

### 12. 安全性與權限檢查 (Security)

#### 12.1 權限管理
- 通知權限狀態檢查
- 個人資料存取權限
- 設定變更權限驗證
- 敏感操作確認

#### 12.2 隱私保護
- 個人聯絡資訊加密儲存
- 提醒內容隱私保護
- 通知記錄定期清理
- 第三方服務資料保護

---

### 13. 其他補充需求 (Others)

#### 13.1 多語言支援
- 繁體中文（預設）
- 英文界面
- 提醒訊息多語言化
- 時間格式本地化

#### 13.2 無障礙設計
- 時間選擇器無障礙支援
- 通知狀態語音提示
- 高對比度模式支援
- 鍵盤導航優化

#### 13.3 智慧功能
- 基於使用習慣的智慧提醒
- 提醒頻率自動調整
- 個人化提醒內容建議
- 提醒效果分析和優化

#### 13.4 跨平台同步
- 多設備提醒設定同步
- 通知狀態跨平台同步
- 設定變更即時同步
- 離線設定快取機制

---

**版本記錄**

| 版本 | 日期 | 修改者 | 修改內容 |
|------|------|--------|----------|
| v1.0.0 | 2025-01-26 | LCAS PM Team | 初版建立，完整的提醒設定功能規格 |
