
# 0071. LINE記帳輸入辨識

**版本**: 1.0.0  
**建立日期**: 2025-12-15  
**建立者**: LCAS Team  
**文件描述**: LINE記帳模式的簡化科目辨識流程設計

---

## 📑 目次 (Table of Contents)

1. [設計理念](#1-設計理念)
2. [功能分層策略](#2-功能分層策略)
3. [流程設計](#3-流程設計)

---

## 1. 設計理念

### 1.1 核心概念
LINE記帳模式採用**簡化科目分類**策略，將複雜的子科目管理功能轉移至APP端的Expert模式，讓LINE記帳專注於快速、直覺的記帳體驗。

### 1.2 設計原則
- **簡化優先**: LINE端只處理主要科目分類（categoryName）
- **功能分層**: 子科目管理（subcategoryName）專屬於APP端Expert模式
- **使用者自主**: 新科目歸類由使用者主動選擇
- **資料保留**: 資料庫結構保持完整，僅在介面層簡化

---

## 2. 功能分層策略

### 2.1 LINE記帳模式
- **功能範圍**: 僅處理主科目分類（categoryName）
- **操作流程**: 文字輸入 → 主科目識別 → 快速記帳
- **新科目處理**: 引導使用者選擇主科目歸類

### 2.2 APP Expert模式
- **功能範圍**: 完整的主科目與子科目管理
- **操作權限**: 可編輯、創建、刪除子科目
- **管理功能**: 同義詞管理、科目階層調整

### 2.3 資料庫設計
- **欄位保留**: subcategoryName欄位完全保留
- **預設值**: LINE記帳時自動設定為預設子科目
- **編輯權限**: 僅APP端可修改subcategoryName

---

## 3. 流程設計

### 3.1 標準記帳流程
```
使用者輸入 → 科目識別 → 直接記帳完成
例：「午餐150」→ 識別為「餐飲費用」→ 記帳成功
```

### 3.2 新科目辨識流程

#### 步驟1: 使用者輸入
```
使用者在LINE輸入: "飯糰28"
```

#### 步驟2: 科目識別失敗處理
```
系統檢測：預設科目庫中無「飯糰」科目
觸發：新科目歸類流程
```

#### 步驟3: 主科目選擇介面
```
系統回覆：
"您的科目庫無此科目，請問這是屬於什麼科目？"
101 生鮮雜貨
102 生活家用
103 交通費用  
104 餐飲費用
105 娛樂消遣
106 運動嗜好
107 寵物生活
201 財務收入
301 財務支出
000 不歸類"
```

#### 步驟4: 使用者選擇主科目
```
使用者輸入: "104"
系統識別：選擇「餐飲費用」類別
```

#### 步驟5: 完成歸類確認並顯示記帳成功訊息
```
系統回覆：
"已將飯糰歸類至 104 餐飲費用"
記帳成功！
金額：28元(支出)
支付方式：
時間：2025/12/15 下午02:00
科目：餐飲費用
備註：飯糰
收支ID：xxxxxxxxxxxxx
```

### 3.3 關於000 不歸類之處理

```
若使用者輸入000 不歸類，則將此輸入計入000 不歸類的同義詞下。

系統回覆：
"已將飯糰歸類至 000 不歸類！
後續若需變更，請至Sophr APP端編輯"
```

---
