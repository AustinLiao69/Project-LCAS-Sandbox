------------------------------------------
20251114. 建立WCM(Wallet and category management)模組

不要寫code，請根據我的回覆更新提案。現在是MVP階段，提案時請專注解決當前發生的問題就好，不需要優化、強化、驗證、監測、測試等手段，除了列出原因之外也請你提出insight。

根據9909 SA角色文件要求，我將以資深SA視角深入分析您提出的WCM模組整合方案。
問題分析與深入思考
1. 現況問題識別
核心問題：目前帳戶(Wallet)和科目(Category)管理功能分散在不同模組中
•	帳戶管理：主要在BK.js中處理
•	科目管理：根據代碼分析，在DD1.js負責，但DD1已計劃移除(DCN-0022)
•	功能職責邊界不清晰，維護複雜度高
簡單概念解釋：就像公司裡財務部門的「現金管理」和「會計科目管理」原本分別由出納組和會計組負責，但發現這兩個功能經常需要協作，不如整合成一個「財務基礎管理組」來統一處理。
2. 業務邏輯層面影響分析

優勢分析
1.	職責統一：帳戶和科目都是記帳的基礎主數據，整合管理符合業務邏輯
2.	減少跨模組調用：BK記帳時需要同時驗證帳戶和科目，整合後可簡化調用
3.	資料一致性提升：統一的驗證邏輯和處理流程

風險評估
1.	模組職責過重：WCM可能承擔過多責任，違反單一職責原則
2.	耦合度增加：將兩個相對獨立的功能強耦合
3. 資料流(DataFlow)影響

現行資料流：
BK記帳 → 驗證帳戶(BK) + 驗證科目(DD1) → 寫入交易
整合後資料流：
BK記帳 → WCM(統一驗證帳戶+科目) → 寫入交易

影響評估：
•	✅ 簡化：減少BK對多個模組的依賴
•	⚠️ 集中化風險：WCM成為單點故障風險
•	✅ 符合0098憲法：嚴格遵守資料流，禁止隔層呼叫

4. 文件影響分析
需要更新的文件：
1.	1001. PRD_BL.md：更新模組架構圖
2.	8020. API list.md：部分API端點歸屬需調整
3.	8025. API-BL mapping.md：更新API對應的BL模組
4.	DCN文件：需撰寫新的DCN文件記錄此變更

5. 代碼影響分析

需要重構的模組
1.	1301. BK.js：移除帳戶管理相關函數
2.	1331. DD1.js：移除科目管理函數(已計劃移除)
3.	ASL.js：更新API端點轉發目標
4.	新建WCM.js：整合帳戶+科目管理功能

API端點重新分配
•	/accounts/* → WCM模組
•	/categories/* → WCM模組

6. 依賴關係影響

新的依賴結構：
WCM → FS(資料存取) + DL(日誌) + AM(權限驗證)
BK → WCM(帳戶科目驗證) + FS + DL + AM
風險：增加了BK對WCM的依賴，需要確保不形成循環依賴

SA Insight
核心洞察
1.	架構合理性：從業務邏輯角度，帳戶和科目確實是記帳的基礎元素，整合管理有其合理性
2.	MVP聚焦原則：符合當前MVP階段的簡化架構需求
3.	維護效率：統一管理可降低維護複雜度，但需要謹慎設計避免模組過於龐大

建議方案
推薦採用，但需要分階段實施
解決方案與實施計畫

階段一：架構設計與文件更新
目標：完成WCM模組設計規格，可進行設計驗證
修改內容：
1.	撰寫DCN-0023 整合帳戶與科目管理為WCM模組
2.	更新1001. PRD_BL.md模組架構
3.	撰寫WCM模組的SRS和LLD文件
4.	更新8025. API-BL mapping.md
影響範圍：文件層面，不影響代碼運行
Before/After：
•	Before: 帳戶和科目功能分散在不同文件描述
•	After: 統一在WCM模組文件中描述

階段二：WCM模組實作
目標：完成WCM.js模組開發，可進行功能驗證
修改內容：
1.	新建1350. WCM.js模組
2.	實作帳戶管理功能(從BK.js遷移)
3.	實作科目管理功能(從DD1.js遷移)
4.	模組版次：v1.0.0
影響範圍：新增模組，不影響現有功能
Before/After：
•	Before: 無WCM模組
•	After: 新增WCM模組，提供統一的帳戶科目管理功能

階段三：API端點轉發更新
目標：更新ASL.js轉發邏輯，可進行API呼叫驗證
修改內容：
1.	更新ASL.js中accounts和categories相關端點
2.	將轉發目標從BK/DD1改為WCM
3.	ASL版次升級：v2.1.7
影響範圍：API轉發邏輯
Before/After：
•	Before: accounts端點轉發至BK，categories端點轉發至DD1
•	After: accounts和categories端點都轉發至WCM

階段四：BL模組依賴清理
目標：清理BK.js中的帳戶管理代碼，可進行完整功能驗證
修改內容：
1.	更新BK.js，移除帳戶管理相關函數
2.	更新BK.js對WCM的依賴調用
3.	BK模組版次升級：v3.2.4
影響範圍：BK模組功能
Before/After：
•	Before: BK包含帳戶管理功能
•	After: BK專注記帳核心邏輯，帳戶驗證委託給WCM

風險控制措施
1.	向下相容：確保API端點路徑不變，只改變內部轉發
2.	逐步切換：先建立WCM，再逐步遷移功能
3.	測試驗證：每個階段都有明確的測試驗證點

總結建議
建議採用此方案，因為：
1.	符合業務邏輯的自然分組
2.	有助於簡化MVP階段的架構複雜度
3.	減少跨模組依賴，提高維護效率
4.	符合0098憲法的架構設計原則
等待您的Approve後，我將按階段開始實施此方案。

