
------------------------------------------
20251117. 撰寫DCN-0022

不要寫code，請根據我的回覆更新提案。現在是MVP階段，提案時請專注解決當前發生的問題就好，不需要優化、強化、驗證、監測、測試等手段，除了列出原因之外也請你提出insight。

請參照9909文件，以資深SA深入思考、分析原因。並提出解決方案。
提案時請注意以下方向：
1. 必須等我Approve之後才能開始編修代碼。
2. 模組板次與函數版次都要升版。
3. 現在是MVP階段，提案時請專注解決當前發生的問題就好，不需要優化、強化、驗證、監測、加強穩定性、測試等手段。
4. 將任務切分成數個階段處理，切分的依據以每階段結束都能執行一次測試驗證為主，並且要附上實施計畫，包含修改內容以及修改檔案。
5. 請提出你的insight
6. 請列出問題、詳細說明並提出你的看法
7. 所有的文件與模組代碼編寫務必遵守0098文件
8. 分析原因及提出解決方案時，除了列出真實原因外，也必須用簡單的概念解釋(例如公司部門的概念)
9. 若無修改文件或代碼的action，請勿寫在解決方案中
10. 若有修改代碼，務必解釋每次code改動都必須解釋用途、影響範圍、Before/After行為差異

=>請根據我的回覆修改DCN-0022

1. 如有在1350模組新建帳戶管理函數，帳戶的英文要叫做wallet，而不是sccount，請修改DCN-0022
2. 請檢查DCN-0022到底要轉移哪些API端點到1350？是多少支？
你的計劃寫16個，但從BK和DD1轉移的API端點有14個，請確認數量。

3.2 API端點重新分配
3.2.1 從BK模組轉移的API端點
根據8020.md API list文件，以下帳戶相關端點將轉移至WCM：
•	GET /api/v1/accounts - 取得帳戶列表
•	POST /api/v1/accounts - 創建帳戶
•	GET /api/v1/accounts/{id} - 取得帳戶詳情
•	PUT /api/v1/accounts/{id} - 更新帳戶
•	DELETE /api/v1/accounts/{id} - 刪除帳戶
•	GET /api/v1/accounts/{id}/balance - 取得帳戶餘額
•	GET /api/v1/accounts/types - 取得帳戶類型
•	POST /api/v1/accounts/transfer - 帳戶轉帳
3.2.2 從DD1模組轉移的API端點
根據8020.md API list文件，以下科目相關端點將轉移至WCM：
•	GET /api/v1/categories - 取得科目列表
•	POST /api/v1/categories - 創建科目
•	GET /api/v1/categories/{id} - 取得科目詳情
•	PUT /api/v1/categories/{id} - 更新科目
•	DELETE /api/v1/categories/{id} - 刪除科目
•	GET /api/v1/categories/tree - 取得科目樹狀結構

=> 3. 從BK和DD1遷移過來的函數，名稱要從account改為wallet

3.3 模組功能整合
3.3.1 從BK.js遷移功能
// 從BK.js遷移至WCM.js的功能
- createAccount() // 帳戶創建邏輯
- validateAccountExists() // 帳戶存在驗證
- getAccountBalance() // 餘額查詢
- updateAccountBalance() // 餘額更新（保留給BK調用）
3.3.2 從DD1.js遷移功能
// 從DD1.js遷移至WCM.js的功能
- createCategory() // 科目創建邏輯
- validateCategoryExists() // 科目存在驗證  
- getCategoryTree() // 科目樹狀結構
- categorySuggestion() // 科目建議邏輯






------------------------------------------
20251114. 撰寫DCN-0022

你的觀察非常準確！根據代碼分析，DD1.js 確實存在職責重疊的問題。
當前問題分析
1. ASL.js 已實現 DD1 的核心功能
從 ASL.js 代碼可以看到，它已經直接處理 DD1 負責的 6 個核心 API 端點：
// ASL.js 中已實現的功能
app.post('/api/v1/transactions', async (req, res) => {
  // 直接調用 BK.BK_createTransaction
});
app.post('/api/v1/transactions/quick', async (req, res) => {
  // 直接調用 BK.BK_processBookkeeping  
});
app.get('/api/v1/transactions', async (req, res) => {
  // 直接調用 BK.BK_getTransactions
});
// 其他端點...
2. 數據流不經過 DD1
實際的數據流為：
APL → ASL → BL層模組(BK/AM等) → Firebase
而不是原設計的：
APL → ASL → DD1 → BL層模組 → Firebase
3. DD1 功能重複性分析
DD1.js 的 6 個核心函數與現有模組功能重疊：
DD1 函數	對應的現有功能	重疊程度
DD_processCreateTransaction	BK.BK_createTransaction	100%
DD_processQuickBookkeeping	BK.BK_processBookkeeping	100%
DD_processGetTransactions	BK.BK_getTransactions	100%
DD_processGetDashboard	BK.BK_processAPIGetDashboard	100%
DD_processUpdateTransaction	BK.BK_processAPIUpdateTransaction	100%
DD_processDeleteTransaction	BK.BK_processAPIDeleteTransaction	100%
建議方案
方案一：移除 DD1.js（推薦）
理由：
•	ASL 已實現所有 DD1 功能
•	減少架構複雜度
•	符合 0098憲法 第6條：嚴格遵守資料流
•	避免維護重複代碼
方案二：重新定義 DD1 職責
如果要保留 DD1，可以將其職責調整為：
•	跨模組協調邏輯
•	複雜業務流程編排
•	批次處理優化
實際影響評估
1.	移除 DD1 的影響：
•	✅ 簡化架構
•	✅ 減少代碼維護負擔
•	✅ 提升系統性能（減少一層調用）
•	⚠️ 需要確認其他模組是否依賴 DD1
2.	符合設計原則：
•	符合 0081技術架構v2備忘錄 的簡化架構原則
•	符合 DCN-0015 的統一回應格式設計
•	符合 8025 API-BL mapping 的直接映射關係
結論
DD1.js 確實已失去存在必要性。建議移除 DD1.js，保持當前的 ASL → BL 直接調用架構，這樣既符合實際數據流向，也能簡化系統複雜度，提升維護效率。
這個決定完全符合你在 0081備忘錄 中提到的「簡化架構層級、提升開發效率」的設計理念。


