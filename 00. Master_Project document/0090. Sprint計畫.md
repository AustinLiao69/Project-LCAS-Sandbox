
# 0090. Sprint計畫

**文件版本：** v1.0.4  
**建立日期：** 2025-09-11  
**最後更新：** 2025-10-22  
**負責人：** LCAS PM Team  

---

## 目次

1. [計畫概覽](#1-計畫概覽)
2. [Sprint架構說明](#2-sprint架構說明)  
3. [Phase 1: 核心進入流程](#3-phase-1-核心進入流程)
4. [Phase 2: 預算管理功能](#4-phase-2-預算管理功能)
5. [Phase 3: 進階記帳與科目管理](#5-phase-3-進階記帳與科目管理)
6. [Phase 4: 多帳本與協作功能](#6-phase-4-多帳本與協作功能)
7. [Phase 5: 報表分析功能](#7-phase-5-報表分析功能)
8. [Phase 6: AI助理與激勵系統](#8-phase-6-ai助理與激勵系統)
9. [Phase 7: 系統管理與優化](#9-phase-7-系統管理與優化)

---

## I. 計畫概覽

### I.1 技術架構
- **PL層（展示層）：** Flutter (APP) + LINE OA
- **APL層（應用邏輯層）：** RESTful API服務
- **BL層（商業邏輯層）：** Node.js模組
- **DL層（資料層）：** Firebase Authentication + Firestore + Cloud Storage

### I.2 開發策略
採用敏捷開發方式，以7個Phase漸進式交付，每個Phase專注於特定功能領域，確保用戶價值最大化與技術風險控制。

---

## II. Sprint架構說明

### II.1 五層架構對應
每個Phase均包含完整的五層實作：
- **PL層：** 用戶介面與互動體驗、API規格設計與實作
- **APL層：** API轉發
- **ASL層：** API轉發
- **BL層：** 核心商業邏輯模組
- **DL層：** 資料結構與儲存配置

---

## 1. Phase 1: 核心進入流程 (雙軌並行策略)

### 1.1 Phase目標
建立使用者可以成功註冊、登入、進行基本記帳的完整流程，確保系統核心價值鏈可運行。

### 1.2 雙軌並行策略說明

基於技術風險分散與開發效率最大化考量，Phase 1採用雙軌並行開發模式：

#### **P1-1: APP UI到DL的完整垂直切片**
**目標：** 用戶端完整體驗實作
**範圍：** PL商業邏輯 APP UI → PL商業邏輯 → APL API服務 → ASL API服務 → BL商業邏輯 → DL資料服務

#### **P1-2: PL到DL的服務端整合** 
**目標：** 服務端四層架構完整串接
**範圍：** PL商業邏輯 → APL API服務 → ASL API服務 → BL商業邏輯 → DL資料服務

### 1.3 P1-1功能範圍（APP垂直切片）

#### 1.3.1 PL層（Flutter APP完整實作）
- **S-102:** APP 啟動頁
- **S-103:** APP 註冊頁（含四模式評估）
- **S-104:** APP 登入頁
- **S-105:** 忘記密碼頁
- **S-106:** 模式評估問卷頁
- **S-107:** 歡迎完成頁
- **S-108:** 主頁（四模式差異化首頁）
- **S-202:** APP 記帳主頁
- **S-203:** APP 記帳表單頁（核心記帳功能）

#### 1.3.2 刪除

#### 1.3.3 DL層（直接Firebase整合）
- Firebase Authentication直接整合
- Firestore基本操作（不經過BL層）
- 本地資料同步機制

### 1.4 P1-2功能範圍（服務端整合）

#### 1.4.1 PL層（函數邏輯實作）
- **7301.系統進入功能群.dart**：核心函數邏輯
- **7302.記帳核心功能群.dart**：記帳函數邏輯
- PL→APL呼叫介面

#### 1.4.2 APL層（API服務完整實作）
- **8101:** 認證服務 API（註冊、登入、模式評估、密碼重設）
- **8102:** 用戶管理服務 API（個人資料、模式切換、偏好設定）
- **8103:** 記帳交易服務 API（基本記帳CRUD、統計查詢）
- **8301、8302、8303:** 對應路由代碼實作

#### 1.4.3 BL層（商業邏輯層完整實作）
- **1320. WH.js:** Webhook模組（LINE OA記帳）
- **1309. AM.js:** 帳號管理模組（認證、模式管理）
- **1301. BK.js:** 記帳核心模組（基本記帳功能）
- **1331. DD1.js:** 核心協調模組（科目管理）
- **1311. FS.js:** Firestore操作模組優化

#### 1.4.4 DL層（資料層完整配置）
- Firebase Authentication設定
- Firestore完整資料結構：users、ledgers、transactions集合
- 四層架構資料流優化

### 1.5 刪除
### 1.6 刪除
### 1.7 LINE OA功能（獨立開發）

#### 1.7.1 PL層
- **S-101:** LINE OA 歡迎頁（統一四模式入口）
- **S-201:** LINE OA 記帳對話（基本文字記帳）

#### 1.7.2 整合點
- LINE OA可獨立使用P1-2的API服務
- 與APP共享相同的後端服務架構

---
## 2. Phase 2: 預算管理與多帳本協作功能

### 2.1 Phase目標

此次測試為P2-2功能測試，純粹測試功能而不測試UI。
完整實作預算管理功能與多帳本協作功能，提供完整的個人與團體財務管理解決方案。採用並行開發策略，最大化開發效率並確保功能完整性。

### 2.2 功能範圍

#### 2.2.1 PL層
**預算管理功能：**
- **S-307:** 預算管理主頁
- **S-308:** 建立預算頁
- **7303. 預算管理功能群.dart** - 處理S-307、S-308的業務邏輯

**多帳本與協作功能：**
- **S-301:** 帳本管理主頁
- **S-302:** 建立帳本頁
- **S-303:** 協作管理頁
- **S-304:** 帳戶管理主頁
- **S-305:** 建立帳戶頁
- **7304. 帳本協作管理功能群.dart** - 處理S-301、S-302、S-303的業務邏輯
- **7305. 帳戶管理功能群.dart** - 處理S-304、S-305的業務邏輯

#### 2.2.2 APL層
- **APL.dart:** 轉發API窗口

#### 2.2.3 BL層
- **1312. BM.js:** 預算管理模組（完整實作）
- **1351. MLS.js:** 多帳本管理模組（完整實作，包含協作功能）
- **1301. BK.js:** 記帳核心模組擴展（支援多帳本、多帳戶整合預算管理）

#### 2.2.4 DL層
- 預算資料結構與追蹤
- 預算警示資料模型
- 協作帳本資料結構
- 權限管理資料模型
- 帳戶類型與餘額管理

---

## 3. Phase 3: 進階記帳與科目管理

### 3.1 Phase目標
完整實作進階記帳功能與科目管理，提升記帳效率與準確性。

### 3.2 功能範圍

#### 3.2.1 PL層
- **S-204:** 科目選擇頁
- **S-205:** 帳戶選擇頁
- **S-206:** 帳本選擇頁
- **S-207:** 圖片附加頁
- **S-208:** 重複設定頁
- **S-209:** 記錄管理頁
- **S-210:** 記錄編輯頁
- **S-306:** 科目管理主頁

#### 3.2.2 APL層
- **8106:** 科目管理服務 API 規格（完整實作）

#### 3.2.3 BL層
- **1301. BK.js:** 記帳核心模組完善（附件、重複交易功能完整實作）
- **1331. DD1.js:** 核心協調模組擴展（完整科目管理）
- **1305. SR.js:** 排程提醒模組（重複交易完整實作）

#### 3.2.4 DL層
- 科目階層資料結構
- 附件儲存Cloud Storage配置
- 重複交易排程資料模型

---

## 4. Phase 4: 報表分析功能

### 4.1 Phase目標
完整實作報表分析功能，提供多維度財務分析與視覺化呈現。

### 4.2 功能範圍

#### 4.2.1 PL層
- **S-211:** 統計圖表頁
- **S-401:** 報表分析主頁
- **S-402:** 報表設定頁
- **S-403:** 圖表展示頁

#### 4.2.2 APL層
- **8108:** 報表分析服務 API 規格（完整實作）

#### 4.2.3 BL層
- **1341. MRA.js:** 報表合併及分析模組（完整實作）

#### 4.2.4 DL層
- 報表快取與效能優化
- 分析維度資料模型

---

## 5. Phase 5: AI助理與激勵系統

### 5.1 Phase目標
整合AI助理提供智慧記帳建議，並建立激勵系統增加用戶黏性。

### 5.2 功能範圍

#### 5.2.1 PL層
- **S-404:** AI分析頁
- **S-501:** 激勵系統主頁
- **S-502:** 成就獎勵頁

#### 5.2.2 APL層
- **8109:** AI 助理服務 API 規格（完整實作）
- **8110:** 激勵系統服務 API 規格（完整實作）

#### 5.2.3 BL層
- **1332. DD2.js:** 智慧處理模組（AI整合）
- **激勵系統模組：** 成就系統、積分機制

#### 5.2.4 DL層
- AI學習資料結構
- 用戶行為追蹤資料模型

---

## 6. Phase 6: 系統管理與優化

### 6.1 Phase目標
完善系統管理功能，優化效能與用戶體驗，準備正式上線。

### 6.2 功能範圍

#### 6.2.1 PL層
- **S-503:** 系統設定頁
- **S-601:** 備份管理頁
- **S-602:** 帳戶安全頁

#### 6.2.2 APL層
- **8111:** 系統服務 API 規格（完整實作）
- **8112:** 備份與資料管理服務 API 規格（完整實作）
- **8113:** 通知管理服務 API 規格（完整實作）

#### 6.2.3 BL層
- **1314. BS.js:** 備份服務模組（完整實作）
- **1310. DL.js:** 診斷與日誌模組優化
- **效能優化模組**

#### 6.2.4 DL層
- 系統監控與日誌
- 備份與災難恢復
- 效能優化配置
