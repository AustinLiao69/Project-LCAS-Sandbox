# 文件及代碼設計原則（v1.3）

## 文件階層架構

本系統的文件與程式碼開發流程應遵循以下階層結構，自上而下建立並維持一致性：

Product Spec → PRD → SRS → TDD → Code → Test Plan

各層文件應明確對應上一層級的內容，並提供下一層級的設計依據。

---

## 設計與撰寫原則

1. **遵循階層架構邏輯**  
   每一層文件或程式碼撰寫，皆應基於上一層級內容。不得在未經明確定義的情況下擅自擴充功能需求或流程。  
   例如：TDD 僅能根據 SRS 所定義的功能條目設計測試案例，Code 僅能實作 TDD 所列之邏輯。

2. **考量同層級間之依賴關係**  
   撰寫 TDD、Code 或 Test Plan 時，若與其他模組具有相互依賴關係，應主動參考相關文件與邏輯，確保輸入輸出格式與異常處理機制一致。避免設計衝突、資源重工或測試失敗。

3. **文件異動需同步調整相依內容**  
   上層文件（如 PRD、SRS）若發生修改，應立即檢查並同步修訂對應之下層文件與程式碼實作內容，並更新版本號與紀錄變更內容。

4. **代碼應標註對應文件節點編號（不加前綴）**  
   所有功能實作代碼，應以註解標示其對應的設計文件節點編號（例如 `1.3.2`），以利測試、除錯與維運對照。  
   例如：

   ```dart
   // 對應 1.3.2：用戶建立帳本功能

5. 測試案例需可回溯至原始需求
Test Plan 中每一筆測試案例，皆需明確對應至 SRS 或 PRD 之功能節點，並依照 TDD 所定義的邏輯、流程與邊界條件進行驗證。


6. 禁止跳階撰寫或實作
在上層文件未完成前，不得進行下層內容的撰寫與實作。
例如：SRS 尚未完成前，不可撰寫 TDD 或 Code；TDD 尚未確認前，不得開始程式實作。


7. 維持命名一致性
所有功能名稱、變數名稱、模組名稱與文件標題應保持一致，並盡可能與使用者介面及操作流程的名稱同步，避免開發與測試溝通混淆。


8. 版本控管明確
文件與程式碼的每次修改皆應建立版本紀錄，記載修改人員、修改時間、版本號與修改內容摘要。版本號建議採用 v主次修 格式，例如：v1.0.0 → v1.0.1。


9. 設計須具備可讀性、可擴充性與可測試性
文件與代碼應採模組化設計，遵循低耦合、高內聚原則。必要時可引入依賴注入（DI）、策略模式等架構模式，以利後續功能擴充與單元測試撰寫。


10. Debug 機制需可控與一致
開發期間可於代碼中保留 debug 輸出訊息，但應以統一機制（如 logger 或 debug flag）控制，避免上線時殘留干擾生產環境。
