# 在 Replit 上跑 Dart 自動化測試計畫

## 目標
在不安裝 Dart 到本機的情況下，於 Replit 的 Node.js 專案中執行 Dart 自動化測試，且保持 `index.js` 專注於啟動 Express Server。

---

## 步驟概覽

1. **安裝 Dart SDK（在 Replit 環境內）**  
   - 在專案根目錄新增 `replit.nix`。
   - 在 `replit.nix` 中加入 Dart SDK 套件，Replit 會依此建立 Nix 環境。

2. **撰寫 Dart 測試程式**  
   - 建立 Dart 模組和對應測試檔案（例如 `my_module_test.dart`）。
   - 使用 Dart 的 `test` 套件撰寫測試案例。

3. **撰寫 Node.js 專用的測試啟動腳本**  
   - 新增 `run_tests.js`，透過 Node.js 的 child process 執行 Dart 測試：
     ```javascript
     const { exec } = require("child_process");

     exec("dart test my_module_test.dart", (err, stdout, stderr) => {
       if (err) {
         console.error("測試錯誤:", err);
         return;
       }
       console.log(stdout);
       console.error(stderr);
     });
     ```
   - 這樣 `index.js` 不受影響，專注於啟動 Express Server。

4. **執行測試**  
   - 打開 Replit 的 Shell，執行：
     ```bash
     node run_tests.js
     ```
   - 可選：將測試命令加入 `package.json` 的 scripts：
     ```json
     "scripts": {
       "test-dart": "node run_tests.js"
     }
     ```
     後續只需：
     ```bash
     npm run test-dart
     ```

---

## 優點
- 不干擾現有 Node.js 專案結構。
- Dart SDK 只安裝於 Replit 的 Nix 環境中，不需要本機安裝。
- 保持 `index.js` 專注於 Express Server。
- 可以搭配 Replit 的 Run Button 或 npm script 一鍵執行。

---

## 後續擴充
- 可整合 CI/CD Pipeline（如 Jenkins、CircleCI）自動執行 `node run_tests.js`。
- 可依需求加入更多 Dart 測試檔案並在 `run_tests.js` 中迭代執行。
