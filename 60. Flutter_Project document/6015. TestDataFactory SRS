
# TestDataFactory 軟體需求規格書 (SRS)

**文件版次**: v1.0.0  
**建立日期**: 2025-09-03  
**作者**: LCAS 2.0 SQA Team  
**專案**: LCAS 2.0 APL層測試資料工廠  

---

## 1. 專案概述

### 1.1 專案背景
TestDataFactory是LCAS 2.0應用邏輯層(APL)測試框架的核心組件，專門負責為單元測試生成標準化、可重複使用的測試資料。本專案採用TDD(Test Driven Development)開發方法論，確保測試資料的品質與一致性。

### 1.2 專案目標
- 建立統一的測試資料生成機制
- 支援四模式差異化測試資料(Expert/Inertial/Cultivation/Guiding)
- 提供可擴展的架構以支援未來11個測試計劃
- 確保測試資料100%符合API規格要求
- 實現測試環境的自動化資料管理

### 1.3 專案範圍
- **包含**: APL層單元測試資料生成、驗證、清理機制
- **不包含**: SIT測試資料生成、E2E測試資料生成(後續階段)
- **限制**: 僅支援靜態資料集，不包含動態資料生成

---

## 2. 功能需求

### 2.1 核心功能需求

#### FR-001: 測試資料工廠核心類別
**優先級**: 高  
**描述**: 實現TestDataFactory核心類別，提供統一的測試資料生成介面
**驗收標準**:
- 支援8401/8402測試計劃的所有測試案例
- 每個測試案例最少提供3筆測試資料
- 支援四模式差異化資料生成
- 提供清晰的API介面供測試代碼調用

#### FR-002: 靜態資料集管理
**優先級**: 高  
**描述**: 建立預定義的靜態測試資料集，確保測試的一致性和可重複性
**驗收標準**:
- 建立auth_test_data.dart (認證服務測試資料)
- 建立user_mgmt_test_data.dart (用戶管理服務測試資料)
- 建立common_test_data.dart (共用測試資料)
- 所有資料格式100%符合8101/8102 API規格

#### FR-003: 資料驗證機制
**優先級**: 中  
**描述**: 實現TestDataValidator，確保生成的測試資料符合API規格要求
**驗收標準**:
- 驗證資料格式符合8101認證服務API規格
- 驗證資料格式符合8102用戶管理服務API規格
- 提供詳細的驗證錯誤報告
- 支援自動化驗證流程

#### FR-004: 資料清理機制
**優先級**: 中  
**描述**: 實現TestDataCleaner，提供測試前後的資料清理功能
**驗收標準**:
- 測試前自動準備乾淨的測試環境
- 測試後自動清理測試資料
- 避免測試間的資料污染
- 支援選擇性清理機制

### 2.2 四模式差異化需求

#### FR-005: Expert模式資料支援
**優先級**: 高  
**描述**: 提供Expert模式專用的測試資料集
**驗收標準**:
- userMode欄位設定為"Expert"
- 包含完整的進階功能測試資料
- 支援複雜場景的測試案例

#### FR-006: Inertial模式資料支援
**優先級**: 高  
**描述**: 提供Inertial模式專用的測試資料集
**驗收標準**:
- userMode欄位設定為"Inertial"
- 提供標準化的測試資料
- 支援穩定性測試案例

#### FR-007: Cultivation模式資料支援
**優先級**: 高  
**描述**: 提供Cultivation模式專用的測試資料集
**驗收標準**:
- userMode欄位設定為"Cultivation"
- 包含激勵機制相關測試資料
- 支援習慣養成功能測試

#### FR-008: Guiding模式資料支援
**優先級**: 高  
**描述**: 提供Guiding模式專用的測試資料集
**驗收標準**:
- userMode欄位設定為"Guiding"
- 提供簡化的測試資料集
- 支援最小化功能測試

### 2.3 可擴展性需求

#### FR-009: 架構可擴展性
**優先級**: 高  
**描述**: 設計可擴展的架構以支援後續11個測試計劃的加入
**驗收標準**:
- 模組化設計，易於新增測試資料類型
- 統一的介面規範
- 最小化對現有代碼的影響
- 支援配置化的資料生成

---

## 3. 非功能需求

### 3.1 效能需求
- **NFR-001**: 測試資料生成時間 < 100ms
- **NFR-002**: 記憶體使用量 < 50MB
- **NFR-003**: 支援100個並發測試案例

### 3.2 可靠性需求
- **NFR-004**: 測試資料正確性 = 100%
- **NFR-005**: 系統可用性 ≥ 99.9%
- **NFR-006**: 錯誤恢復時間 < 1秒

### 3.3 可維護性需求
- **NFR-007**: 代碼覆蓋率 ≥ 90%
- **NFR-008**: 文件完整性 = 100%
- **NFR-009**: 新增測試資料類型時間 < 1小時

### 3.4 可用性需求
- **NFR-010**: API學習曲線 < 30分鐘
- **NFR-011**: 錯誤訊息清晰度 = 100%
- **NFR-012**: 測試案例設定時間 < 5分鐘

---

## 4. 系統架構需求

### 4.1 檔案結構需求
```
85. Flutter_Test_code_APL/
├── 8590. TestDataFactory.dart      // 核心工廠類別
├── 8591. TestDataValidator.dart    // 資料驗證器
├── 8592. TestDataCleaner.dart      // 資料清理器
├── test_data/                      // 靜態資料資料夾
│   ├── auth_test_data.dart         // 認證服務測試資料
│   ├── user_mgmt_test_data.dart    // 用戶管理服務測試資料
│   └── common_test_data.dart       // 共用測試資料
├── 8501. 認證服務_test.dart        // 整合TestDataFactory
├── 8502. 用戶管理服務_test.dart    // 整合TestDataFactory
└── 8599. Fake_service_switch.dart  // 現有開關控制
```

### 4.2 技術架構需求
- **程式語言**: Dart 3.5+
- **測試框架**: Dart Test Framework
- **設計模式**: Factory Pattern + Builder Pattern
- **相依性管理**: 最小化外部相依性

---

## 5. 介面需求

### 5.1 API介面規格

#### TestDataFactory主要介面
```dart
class TestDataFactory {
  // 取得認證服務測試資料
  static List<Map<String, dynamic>> getAuthTestData(String testCase, String userMode);
  
  // 取得用戶管理服務測試資料
  static List<Map<String, dynamic>> getUserMgmtTestData(String testCase, String userMode);
  
  // 取得共用測試資料
  static Map<String, dynamic> getCommonTestData(String dataType);
  
  // 清理測試資料
  static void cleanTestData();
  
  // 驗證測試資料
  static bool validateTestData(Map<String, dynamic> data, String apiSpec);
}
```

### 5.2 資料格式規格
- 完全遵循8101認證服務API規格
- 完全遵循8102用戶管理服務API規格
- 支援JSON格式的資料交換
- 包含完整的metadata資訊

---

## 6. 品質需求

### 6.1 測試需求
- 單元測試覆蓋率 ≥ 95%
- 整合測試覆蓋率 ≥ 90%
- 效能測試通過率 = 100%
- 安全性測試通過率 = 100%

### 6.2 代碼品質需求
- 遵循Dart代碼規範
- 函數複雜度 ≤ 10
- 代碼重複率 ≤ 5%
- 文件註解覆蓋率 = 100%

### 6.3 版本管理需求
- 遵循語義化版本控制(Semantic Versioning)
- 每次功能更新必須升級版本號
- 保持與測試代碼版本同步

---

## 7. 安全需求

### 7.1 資料安全
- 測試資料不包含真實用戶資訊
- 敏感資料必須脫敏處理
- 測試環境與生產環境完全隔離

### 7.2 存取控制
- 測試資料僅限測試環境使用
- 實施最小權限原則
- 支援資料存取審計

---

## 8. 實施計劃

### 8.1 第一階段：基礎架構建立 (第1-2週)
- 建立TestDataFactory核心類別
- 實現四模式用戶資料生成
- 建立基本的資料清理機制
- 建立靜態資料檔案結構

### 8.2 第二階段：資料完整化 (第3-4週)
- 對應84號資料夾測試計劃，生成完整測試資料
- 整合到85號資料夾測試代碼
- 驗證所有測試案例都有足夠的測試資料
- 實施資料驗證機制

### 8.3 驗收標準
- 所有功能需求100%實現
- 非功能需求達到指定標準
- 通過完整的測試驗證
- 文件完整且準確

---

## 9. 風險評估

### 9.1 技術風險
- **風險**: API規格變更影響測試資料格式
- **緩解措施**: 建立版本控制機制，支援多版本API規格

### 9.2 時程風險
- **風險**: 開發時程延遲影響整體測試進度
- **緩解措施**: 採用分階段實施，優先實現核心功能

### 9.3 品質風險
- **風險**: 測試資料品質不符合要求
- **緩解措施**: 建立嚴格的驗證機制和同儕代碼審查

---

## 10. 成功指標

### 10.1 交付指標
- TestDataFactory核心功能100%完成
- 支援8401/8402測試計劃的所有測試案例
- 測試代碼整合成功率 = 100%
- 文件完整性 = 100%

### 10.2 品質指標
- 缺陷密度 < 1 defect/KLOC
- 客戶滿意度 ≥ 90%
- 維護效率提升 ≥ 50%
- 測試執行時間減少 ≥ 30%

---

**文件狀態**: 已批准  
**下次審查日期**: 2025-09-10  
**聯絡人**: LCAS 2.0 SQA Team

---

*本文件遵循IEEE 830-1998軟體需求規格標準撰寫*
