
# 7101. 系統進入功能群_SRS.md

**文件編號**: 7101  
**版本**: v1.0.0  
**建立日期**: 2025-09-11  
**建立者**: LCAS PM Team  
**最後更新**: 2025-09-11  

---

## 📑 目次 (Table of Contents)

1. [模組概述 (Module Overview)](#10-模組概述module-overview)

2. [功能需求 (Functional Requirements)](#20-功能需求functional-requirements)
   - 2.1 APP啟動與初始化
   - 2.2 使用者註冊功能
   - 2.3 使用者登入功能
   - 2.4 密碼重設功能
   - 2.5 模式評估與設定
   - 2.6 跨平台綁定功能
   - 2.7 APP推廣展示
   - 2.8 錯誤處理與重試機制

3. [輸入/輸出規格 (Input & Output Specifications)](#30-輸入輸出規格input--output-specifications)
   - 3.1 輸入
   - 3.2 輸出

4. [錯誤處理與例外狀況 (Error Handling & Edge Cases)](#40-錯誤處理與例外狀況error-handling--edge-cases)
   - 4.1 認證相關錯誤
   - 4.2 網路連線錯誤
   - 4.3 輸入驗證錯誤
   - 4.4 系統異常處理

---

## 1.0 模組概述（Module Overview）

### 1.1 模組定位與職責

**系統進入功能群**是LCAS 2.0專案Presentation Layer的核心入口模組群，負責處理使用者從首次接觸系統到成功進入主要功能的完整流程。本功能群對應0090 Sprint計畫的**Phase 1**範圍，確保使用者能夠順利完成註冊、登入、模式評估與跨平台整合。

**核心職責範圍**：
- 🚀 **APP啟動管理**：品牌展示、版本檢查、載入狀態
- 👤 **身份認證流程**：註冊、登入、密碼重設完整體驗
- 🎯 **模式評估機制**：四模式理論的實際應用與設定
- 🔗 **跨平台整合**：LINE OA與APP的無縫連接體驗
- 📱 **使用引導**：首次使用者的完整引導流程

### 1.2 功能群範圍定義

基於6021 Screen list文件，本功能群涵蓋以下8個核心畫面：

| 畫面編號 | 畫面名稱 | Phase | 核心功能 | 四模式支援 |
|----------|----------|-------|----------|------------|
| **S-102** | APP啟動頁 | Phase 1 | 品牌展示、載入進度 | 統一體驗 |
| **S-103** | APP註冊頁 | Phase 1 | Email註冊、密碼設定 | ✅ 差異化 |
| **S-104** | APP登入頁 | Phase 1 | 帳號密碼、第三方登入 | ✅ 差異化 |
| **S-105** | 忘記密碼頁 | Phase 1 | Email重設、驗證流程 | ✅ 差異化 |
| **S-106** | 模式評估問卷頁 | Phase 1 | 5題評估、模式推薦 | ✅ 核心功能 |
| **S-107** | 跨平台綁定頁 | Phase 1 | LINE OA綁定、QR Code | 統一體驗 |
| **S-108** | APP下載推廣頁 | Phase 1 | 功能介紹、下載引導 | 統一體驗 |

**備註**：S-101 LINE OA歡迎頁屬於LINE OA平台，不在Flutter APP範圍內。

### 1.3 四模式差異化策略

基於0015文件的四模式理論，本功能群實現以下差異化策略：

#### 1.3.1 Expert模式（專家模式）
- **註冊/登入**：提供完整選項、進階安全設定、批次匯入功能
- **模式評估**：顯示詳細評估邏輯、支援手動調整、提供專業建議
- **視覺風格**：專業藍色調、豐富資訊密度、多層次導航

#### 1.3.2 Inertial模式（慣性模式）
- **註冊/登入**：固定步驟流程、一致性介面佈局、可預測操作
- **模式評估**：標準化問卷、清晰的步驟指示、穩定的進度展示
- **視覺風格**：穩定灰藍色調、簡潔佈局、邏輯清晰

#### 1.3.3 Cultivation模式（養成模式）
- **註冊/登入**：引導式流程、進度追蹤、激勵性訊息
- **模式評估**：互動式問卷、即時回饋、成長建議
- **視覺風格**：活力綠色調、動態效果、成就感設計

#### 1.3.4 Guiding模式（引導模式）
- **註冊/登入**：極簡流程、自動填入、一鍵完成
- **模式評估**：簡化問卷、智慧推薦、最少決策
- **視覺風格**：溫和橘色調、大按鈕設計、清晰指引

### 1.4 技術架構整合

#### 1.4.1 API整合規範
本功能群**嚴格遵循0026文件PL-APL-BL三層架構對應**，僅消費以下API服務：

- **8101 認證服務API**：完整的註冊、登入、密碼重設功能
- **8102 用戶管理服務API**：模式評估、個人資料、偏好設定
- **8111 系統服務API**：APP版本檢查、系統狀態、設定同步

#### 1.4.2 狀態管理架構
```dart
// 進入階段狀態管理結構
EntryFlowStateManager/
├── AuthState          // 認證狀態管理
├── ModeAssessmentState // 模式評估狀態
├── OnboardingState     // 引導流程狀態
└── PlatformBindingState // 跨平台綁定狀態
```

#### 1.4.3 本地資料儲存
- **認證Token**：使用FlutterSecureStorage安全儲存
- **模式設定**：SharedPreferences持久化
- **引導進度**：本地快取機制

### 1.5 品質與安全要求

#### 1.5.1 效能要求
- **APP啟動時間**：≤ 3秒（冷啟動）、≤ 1秒（熱啟動）
- **頁面載入時間**：≤ 1秒（本地頁面）、≤ 3秒（API依賴頁面）
- **記憶體使用**：≤ 50MB（完整進入流程）

#### 1.5.2 安全要求
- **密碼安全**：8位數以上、包含大小寫字母與數字
- **Token管理**：自動更新、安全儲存、過期檢查
- **輸入驗證**：前端驗證 + 後端驗證雙重保護

#### 1.5.3 可用性要求
- **離線支援**：基本功能可離線使用、自動同步機制
- **錯誤復原**：友善錯誤訊息、自動重試、替代方案
- **無障礙支援**：Screen Reader支援、鍵盤導航、對比度符合標準

### 1.6 與其他功能群的協作

#### 1.6.1 功能群介面
- **→ 記帳核心功能群**：完成認證後直接進入記帳主頁（S-202）
- **→ 系統功能群**：模式設定同步至個人設定頁（S-505）
- **↔ LINE OA平台**：跨平台綁定與資料同步

#### 1.6.2 資料流向
```
進入階段 → 認證完成 → 模式設定 → 主要功能群
    ↓
本地儲存 ← API同步 ← 雲端資料
```

---

## 2.0 功能需求（Functional Requirements）

### 2.1 APP啟動與初始化
**對應畫面**：S-102 APP啟動頁
**開發優先級**：P1（Phase 1 必須完成）

#### 2.1.1 基本功能需求
- **FR-101-001**：應用程式啟動時顯示LCAS品牌Logo與載入動畫
- **FR-101-002**：自動檢查應用程式版本，提示更新資訊
- **FR-101-003**：載入用戶認證狀態，判斷是否需要登入
- **FR-101-004**：初始化四模式設定，載入用戶偏好配置
- **FR-101-005**：檢查網路連線狀態，處理離線模式切換

### 2.2 使用者註冊功能
**對應畫面**：S-103 APP註冊頁
**開發優先級**：P1（Phase 1 必須完成）

#### 2.2.1 基本功能需求
- **FR-102-001**：提供Email地址註冊輸入框與格式驗證
- **FR-102-002**：提供密碼設定輸入框與強度檢查
- **FR-102-003**：提供密碼確認輸入框與一致性驗證
- **FR-102-004**：整合Google OAuth註冊選項
- **FR-102-005**：註冊成功後自動導向模式評估頁面

### 2.3 使用者登入功能
**對應畫面**：S-104 APP登入頁
**開發優先級**：P1（Phase 1 必須完成）

#### 2.3.1 基本功能需求
- **FR-103-001**：提供Email/密碼登入表單與驗證
- **FR-103-002**：整合Google OAuth登入選項
- **FR-103-003**：提供「記住我」選項與自動登入功能
- **FR-103-004**：登入成功後導向對應的主要功能頁面
- **FR-103-005**：提供忘記密碼連結導向重設頁面

### 2.4 密碼重設功能
**對應畫面**：S-105 忘記密碼頁
**開發優先級**：P1（Phase 1 必須完成）

#### 2.4.1 基本功能需求
- **FR-104-001**：提供Email輸入框發送重設連結
- **FR-104-002**：顯示重設郵件發送狀態與確認訊息
- **FR-104-003**：提供返回登入頁面的導航選項
- **FR-104-004**：處理重設連結點擊與密碼更新流程

### 2.5 模式評估與設定
**對應畫面**：S-106 模式評估問卷頁
**開發優先級**：P1（Phase 1 必須完成）

#### 2.5.1 基本功能需求
- **FR-105-001**：提供5題標準化評估問卷介面
- **FR-105-002**：根據評估結果推薦最適合的使用模式
- **FR-105-003**：提供四模式詳細說明與比較資訊
- **FR-105-004**：支援手動模式選擇與確認機制
- **FR-105-005**：完成評估後保存模式設定至用戶資料

### 2.6 跨平台綁定功能
**對應畫面**：S-107 跨平台綁定頁
**開發優先級**：P1（Phase 1 必須完成）

#### 2.6.1 基本功能需求
- **FR-106-001**：顯示LINE OA介紹與功能說明
- **FR-106-002**：提供QR Code掃描功能加入LINE OA
- **FR-106-003**：檢測LINE OA綁定狀態與帳號確認
- **FR-106-004**：完成綁定後同步用戶資料與設定
- **FR-106-005**：提供跳過綁定選項與後續設定提醒

### 2.7 APP推廣展示
**對應畫面**：S-108 APP下載推廣頁
**開發優先級**：P2（Phase 1 選擇性完成）

#### 2.7.1 基本功能需求
- **FR-107-001**：展示APP核心功能與四模式特色
- **FR-107-002**：提供APP Store與Google Play下載連結
- **FR-107-003**：顯示用戶評價與使用統計資訊
- **FR-107-004**：提供社群分享功能與推薦機制

### 2.8 錯誤處理與重試機制
**跨畫面通用功能**
**開發優先級**：P1（Phase 1 必須完成）

#### 2.8.1 基本功能需求
- **FR-108-001**：網路連線中斷時提供離線模式與重試機制
- **FR-108-002**：API調用失敗時顯示友善錯誤訊息與建議
- **FR-108-003**：輸入驗證錯誤時提供即時回饋與修正建議
- **FR-108-004**：系統異常時提供錯誤回報與客服聯繫方式

---

## 3.0 輸入/輸出規格（Input & Output Specifications）

### 3.1 輸入

#### 3.1.1 使用者輸入規格

**註冊頁面輸入（S-103）**：
```yaml
email:
  type: string
  format: email
  required: true
  max_length: 255
  validation: RFC 5322 standard

password:
  type: string
  required: true
  min_length: 8
  max_length: 128
  pattern: "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)[a-zA-Z\\d@$!%*?&]{8,}$"
  description: "至少8位數，包含大小寫字母與數字"

password_confirm:
  type: string
  required: true
  validation: "必須與password欄位一致"
```

**登入頁面輸入（S-104）**：
```yaml
email:
  type: string
  format: email
  required: true
  max_length: 255

password:
  type: string
  required: true
  max_length: 128

remember_me:
  type: boolean
  required: false
  default: false
```

**模式評估輸入（S-106）**：
```yaml
assessment_answers:
  type: array
  required: true
  length: 5
  items:
    type: integer
    range: [1, 4]
    description: "1=完全不同意, 2=不同意, 3=同意, 4=完全同意"

manual_mode_selection:
  type: string
  required: false
  enum: ["expert", "inertial", "cultivation", "guiding"]
```

#### 3.1.2 系統輸入規格

**網路狀態檢測**：
```yaml
network_status:
  type: object
  properties:
    is_connected:
      type: boolean
    connection_type:
      type: string
      enum: ["wifi", "cellular", "none"]
    signal_strength:
      type: integer
      range: [0, 100]
```

### 3.2 輸出

#### 3.2.1 使用者介面輸出

**啟動頁面輸出（S-102）**：
```yaml
brand_display:
  logo: "LCAS主要Logo圖片"
  loading_animation: "載入進度動畫"
  version_info: "應用程式版本資訊"
  loading_progress:
    type: integer
    range: [0, 100]
    description: "載入進度百分比"
```

**認證結果輸出（S-103, S-104）**：
```yaml
auth_success:
  type: object
  properties:
    user_id:
      type: string
      description: "用戶唯一識別碼"
    access_token:
      type: string
      description: "認證授權令牌"
    refresh_token:
      type: string
      description: "令牌更新用密鑰"
    user_mode:
      type: string
      enum: ["expert", "inertial", "cultivation", "guiding"]
    navigation_target:
      type: string
      description: "登入後導向的目標頁面"

auth_error:
  type: object
  properties:
    error_code:
      type: string
      enum: ["INVALID_CREDENTIALS", "EMAIL_NOT_VERIFIED", "ACCOUNT_LOCKED"]
    error_message:
      type: string
      description: "使用者友善的錯誤訊息"
    retry_action:
      type: string
      description: "建議的重試操作"
```

**模式評估結果輸出（S-106）**：
```yaml
assessment_result:
  type: object
  properties:
    recommended_mode:
      type: string
      enum: ["expert", "inertial", "cultivation", "guiding"]
    confidence_score:
      type: number
      range: [0.0, 1.0]
      description: "推薦信心度分數"
    mode_descriptions:
      type: object
      properties:
        expert:
          type: string
          description: "專家模式特色說明"
        inertial:
          type: string
          description: "慣性模式特色說明"
        cultivation:
          type: string
          description: "養成模式特色說明"
        guiding:
          type: string
          description: "引導模式特色說明"
    personalized_suggestions:
      type: array
      items:
        type: string
      description: "個人化使用建議"
```

#### 3.2.2 系統狀態輸出

**應用程式狀態**：
```yaml
app_state:
  type: object
  properties:
    initialization_status:
      type: string
      enum: ["loading", "ready", "error"]
    user_authentication_status:
      type: string
      enum: ["authenticated", "unauthenticated", "expired"]
    network_connectivity:
      type: string
      enum: ["online", "offline", "limited"]
    feature_flags:
      type: object
      description: "功能開關狀態"
```

---

## 4.0 錯誤處理與例外狀況（Error Handling & Edge Cases）

### 4.1 認證相關錯誤

#### 4.1.1 註冊錯誤處理
```yaml
registration_errors:
  EMAIL_ALREADY_EXISTS:
    code: "REG_001"
    message: "此電子郵件已被註冊，請使用其他信箱或直接登入"
    action: "導向登入頁面"
    
  WEAK_PASSWORD:
    code: "REG_002"
    message: "密碼強度不足，請包含大小寫字母與數字，至少8位數"
    action: "重新輸入密碼"
    
  EMAIL_VERIFICATION_FAILED:
    code: "REG_003"
    message: "郵件驗證失敗，請檢查您的信箱並點擊驗證連結"
    action: "重新發送驗證郵件"
```

#### 4.1.2 登入錯誤處理
```yaml
login_errors:
  INVALID_CREDENTIALS:
    code: "AUTH_001"
    message: "帳號或密碼錯誤，請重新輸入"
    action: "重新輸入或重設密碼"
    
  ACCOUNT_LOCKED:
    code: "AUTH_002"
    message: "帳號已被鎖定，請聯繫客服或稍後再試"
    action: "聯繫客服或等待解鎖"
    
  EMAIL_NOT_VERIFIED:
    code: "AUTH_003"
    message: "電子郵件尚未驗證，請先完成郵件驗證"
    action: "重新發送驗證郵件"
```

### 4.2 網路連線錯誤

#### 4.2.1 連線中斷處理
```yaml
network_errors:
  CONNECTION_TIMEOUT:
    code: "NET_001"
    message: "網路連線逾時，請檢查您的網路設定"
    action: "重試連線或啟用離線模式"
    
  NO_INTERNET:
    code: "NET_002"
    message: "無法連接網路，某些功能將暫時無法使用"
    action: "啟用離線模式或檢查網路"
    
  SERVER_UNAVAILABLE:
    code: "NET_003"
    message: "伺服器暫時無法使用，請稍後再試"
    action: "自動重試或通知系統管理員"
```

### 4.3 輸入驗證錯誤

#### 4.3.1 表單驗證錯誤
```yaml
validation_errors:
  INVALID_EMAIL_FORMAT:
    code: "VAL_001"
    message: "電子郵件格式不正確，請輸入有效的信箱地址"
    field: "email"
    
  PASSWORD_TOO_SHORT:
    code: "VAL_002"
    message: "密碼長度不足，請輸入至少8位數"
    field: "password"
    
  PASSWORD_MISMATCH:
    code: "VAL_003"
    message: "密碼確認不一致，請重新輸入"
    field: "password_confirm"
```

### 4.4 系統異常處理

#### 4.4.1 應用程式異常
```yaml
system_errors:
  MEMORY_INSUFFICIENT:
    code: "SYS_001"
    message: "記憶體不足，請關閉其他應用程式後重試"
    action: "釋放記憶體或重啟應用程式"
    
  STORAGE_FULL:
    code: "SYS_002"
    message: "儲存空間不足，請清理裝置空間"
    action: "清理儲存空間"
    
  UNEXPECTED_ERROR:
    code: "SYS_999"
    message: "發生未預期的錯誤，我們已記錄此問題"
    action: "重啟應用程式或聯繫客服"
```
