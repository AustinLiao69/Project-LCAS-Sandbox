
# 7103. å¸³æœ¬å”ä½œåŠŸèƒ½ç¾¤_SRS.md

**æ–‡ä»¶ç·¨è™Ÿ**: 7103  
**ç‰ˆæœ¬**: v1.0.0  
**å»ºç«‹æ—¥æœŸ**: 2025-10-22  
**å»ºç«‹è€…**: LCAS PM Team  
**æœ€å¾Œæ›´æ–°**: 2025-10-22  

---

## ğŸ“‘ ç›®æ¬¡ (Table of Contents)

1. [æ¨¡çµ„æ¦‚è¿° (Module Overview)](#10-æ¨¡çµ„æ¦‚è¿°module-overview)

2. [åŠŸèƒ½éœ€æ±‚ (Functional Requirements)](#20-åŠŸèƒ½éœ€æ±‚functional-requirements)
   - 2.1 å¸³æœ¬ç®¡ç†ä¸»é åŠŸèƒ½
   - 2.2 å»ºç«‹å¸³æœ¬é åŠŸèƒ½
   - 2.3 å”ä½œç®¡ç†é åŠŸèƒ½

3. [è¼¸å…¥/è¼¸å‡ºè¦æ ¼ (Input & Output Specifications)](#30-è¼¸å…¥è¼¸å‡ºè¦æ ¼input--output-specifications)
   - 3.1 è¼¸å…¥
   - 3.2 è¼¸å‡º

4. [éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³ (Error Handling & Edge Cases)](#40-éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³error-handling--edge-cases)
   - 4.1 å¸³æœ¬ç®¡ç†ç›¸é—œéŒ¯èª¤
   - 4.2 å”ä½œæ¬Šé™éŒ¯èª¤
   - 4.3 ç¶²è·¯é€£ç·šéŒ¯èª¤
   - 4.4 ç³»çµ±ç•°å¸¸è™•ç†

---

## 1.0 æ¨¡çµ„æ¦‚è¿°ï¼ˆModule Overviewï¼‰

### 1.1 æ¨¡çµ„å®šä½èˆ‡è·è²¬

**å¸³æœ¬å”ä½œåŠŸèƒ½ç¾¤**æ˜¯LCAS 2.0å°ˆæ¡ˆPresentation Layerçš„å¤šå¸³æœ¬ç®¡ç†æ¨¡çµ„ç¾¤ï¼Œè² è²¬è™•ç†ä½¿ç”¨è€…å¤šå¸³æœ¬ç®¡ç†èˆ‡å”ä½œè¨˜å¸³çš„å®Œæ•´æµç¨‹ã€‚æœ¬åŠŸèƒ½ç¾¤å°æ‡‰0090 Sprintè¨ˆç•«çš„**Phase 2**ç¯„åœï¼Œæä¾›å€‹äººå¸³æœ¬ç®¡ç†èˆ‡åœ˜éšŠå”ä½œè¨˜å¸³çš„å®Œæ•´è§£æ±ºæ–¹æ¡ˆã€‚

**æ ¸å¿ƒè·è²¬ç¯„åœ**ï¼š
- ğŸ“š **å¸³æœ¬ç®¡ç†**ï¼šå€‹äººèˆ‡å”ä½œå¸³æœ¬çš„å»ºç«‹ã€æŸ¥è©¢ã€ç·¨è¼¯ã€åˆªé™¤
- ğŸ‘¥ **å”ä½œç®¡ç†**ï¼šåœ˜éšŠæˆå“¡é‚€è«‹ã€æ¬Šé™æ§åˆ¶ã€å”ä½œè¡çªè™•ç†
- ğŸ” **æ¬Šé™æ§åˆ¶**ï¼šå¤šå±¤ç´šæ¬Šé™ç®¡ç†ã€æ“ä½œæ¬Šé™é©—è­‰
- ğŸ“Š **å¸³æœ¬çµ±è¨ˆ**ï¼šå¤šå¸³æœ¬æ•¸æ“šçµ±è¨ˆã€ä½¿ç”¨åˆ†æ
- ğŸ”„ **è³‡æ–™åŒæ­¥**ï¼šè·¨ç”¨æˆ¶è³‡æ–™åŒæ­¥ã€è¡çªè§£æ±ºæ©Ÿåˆ¶

### 1.2 åŠŸèƒ½ç¾¤ç¯„åœå®šç¾©

åŸºæ–¼7021 Screen listæ–‡ä»¶ï¼Œæœ¬åŠŸèƒ½ç¾¤æ¶µè“‹ä»¥ä¸‹3å€‹æ ¸å¿ƒç•«é¢ï¼š

| ç•«é¢ç·¨è™Ÿ | ç•«é¢åç¨± | Phase | æ ¸å¿ƒåŠŸèƒ½ | å››æ¨¡å¼æ”¯æ´ |
|----------|----------|-------|----------|------------|
| **S-301** | å¸³æœ¬ç®¡ç†ä¸»é  | Phase 2 | å¸³æœ¬åˆ—è¡¨å±•ç¤ºèˆ‡ç®¡ç† | âœ… å·®ç•°åŒ– |
| **S-302** | å»ºç«‹å¸³æœ¬é  | Phase 2 | æ–°å¸³æœ¬å»ºç«‹èˆ‡è¨­å®š | âœ… å·®ç•°åŒ– |
| **S-303** | å”ä½œç®¡ç†é  | Phase 2 | å”ä½œè€…èˆ‡æ¬Šé™ç®¡ç† | âœ… å·®ç•°åŒ– |

### 1.3 å››æ¨¡å¼å·®ç•°åŒ–ç­–ç•¥

åŸºæ–¼0015æ–‡ä»¶çš„å››æ¨¡å¼ç†è«–ï¼Œæœ¬åŠŸèƒ½ç¾¤å¯¦ç¾ä»¥ä¸‹å·®ç•°åŒ–ç­–ç•¥ï¼š

#### 1.3.1 Expertæ¨¡å¼ï¼ˆå°ˆå®¶æ¨¡å¼ï¼‰
- **å¸³æœ¬ç®¡ç†**ï¼šå®Œæ•´ç®¡ç†å·¥å…·ã€æ‰¹æ¬¡æ“ä½œã€é€²éšç¯©é¸ã€è©³ç´°çµ±è¨ˆ
- **å”ä½œåŠŸèƒ½**ï¼šç´°ç²’åº¦æ¬Šé™æ§åˆ¶ã€å”ä½œå¯©è¨ˆã€è¡çªç®¡ç†ã€é€²éšåˆ†æ
- **è¦–è¦ºé¢¨æ ¼**ï¼šå°ˆæ¥­è—è‰²èª¿ã€é«˜è³‡è¨Šå¯†åº¦ã€å¤šåŠŸèƒ½é¢æ¿

#### 1.3.2 Inertialæ¨¡å¼ï¼ˆæ…£æ€§æ¨¡å¼ï¼‰
- **å¸³æœ¬ç®¡ç†**ï¼šæ¨™æº–åˆ—è¡¨ã€åŸºæœ¬æ“ä½œã€ç°¡æ½”ä»‹é¢ã€ç©©å®šä½ˆå±€
- **å”ä½œåŠŸèƒ½**ï¼šæ¨™æº–æ¬Šé™è¨­å®šã€åŸºæœ¬é‚€è«‹ã€ç°¡åŒ–ç®¡ç†
- **è¦–è¦ºé¢¨æ ¼**ï¼šç©©å®šç°è—è‰²èª¿ã€æ¸…æ™°çµæ§‹ã€ä¸€è‡´æ€§æ“ä½œ

#### 1.3.3 Cultivationæ¨¡å¼ï¼ˆé¤Šæˆæ¨¡å¼ï¼‰
- **å¸³æœ¬ç®¡ç†**ï¼šå¼•å°å¼å»ºç«‹ã€æ¨è–¦è¨­å®šã€ä½¿ç”¨æç¤ºã€æˆé•·è¿½è¹¤
- **å”ä½œåŠŸèƒ½**ï¼šå”ä½œå¼•å°ã€åœ˜éšŠå»ºç«‹å»ºè­°ã€ç¿’æ…£åŸ¹é¤Š
- **è¦–è¦ºé¢¨æ ¼**ï¼šæ´»åŠ›ç¶ è‰²èª¿ã€å‹•æ…‹åé¥‹ã€æ¿€å‹µå…ƒç´ 

#### 1.3.4 Guidingæ¨¡å¼ï¼ˆå¼•å°æ¨¡å¼ï¼‰
- **å¸³æœ¬ç®¡ç†**ï¼šæ¥µç°¡æ“ä½œã€é è¨­è¨­å®šã€è‡ªå‹•å»ºè­°ã€æœ€å°‘æ±ºç­–
- **å”ä½œåŠŸèƒ½**ï¼šç°¡åŒ–é‚€è«‹ã€åŸºæœ¬æ¬Šé™ã€è‡ªå‹•åŒ–ç®¡ç†
- **è¦–è¦ºé¢¨æ ¼**ï¼šæº«å’Œæ©˜è‰²èª¿ã€å¤§æŒ‰éˆ•è¨­è¨ˆã€ç›´è§€å¼•å°

### 1.4 æŠ€è¡“æ¶æ§‹æ•´åˆ

#### 1.4.1 APIæ•´åˆè¦ç¯„
æœ¬åŠŸèƒ½ç¾¤**åš´æ ¼éµå¾ª0026æ–‡ä»¶PL-APL-BLä¸‰å±¤æ¶æ§‹å°æ‡‰**ï¼Œåƒ…æ¶ˆè²»ä»¥ä¸‹APIæœå‹™ï¼š

- **8104 å¸³æœ¬ç®¡ç†æœå‹™API**ï¼šå®Œæ•´çš„å¸³æœ¬CRUDã€å”ä½œç®¡ç†ã€æ¬Šé™æ§åˆ¶ï¼ˆ13å€‹ç«¯é»ï¼‰

#### 1.4.2 ç‹€æ…‹ç®¡ç†æ¶æ§‹
```dart
// å¸³æœ¬å”ä½œç‹€æ…‹ç®¡ç†çµæ§‹
LedgerCollaborationStateManager/
â”œâ”€â”€ LedgerState              // å¸³æœ¬åˆ—è¡¨ç‹€æ…‹
â”œâ”€â”€ CollaborationState       // å”ä½œç‹€æ…‹ç®¡ç†
â”œâ”€â”€ PermissionState          // æ¬Šé™æ§åˆ¶ç‹€æ…‹
â”œâ”€â”€ InvitationState          // é‚€è«‹ç®¡ç†ç‹€æ…‹
â””â”€â”€ ConflictState           // è¡çªè™•ç†ç‹€æ…‹
```

### 1.5 å“è³ªèˆ‡å®‰å…¨è¦æ±‚

#### 1.5.1 æ•ˆèƒ½è¦æ±‚
- **å¸³æœ¬åˆ—è¡¨è¼‰å…¥æ™‚é–“**ï¼šâ‰¤ 2ç§’ï¼ˆ20å€‹å¸³æœ¬ä»¥å…§ï¼‰
- **å”ä½œè€…é‚€è«‹éŸ¿æ‡‰æ™‚é–“**ï¼šâ‰¤ 3ç§’ï¼ˆæ‰¹æ¬¡é‚€è«‹â‰¤5äººï¼‰
- **æ¬Šé™æ›´æ–°éŸ¿æ‡‰æ™‚é–“**ï¼šâ‰¤ 1ç§’ï¼ˆå–®ä¸€æ¬Šé™æ“ä½œï¼‰

#### 1.5.2 å®‰å…¨è¦æ±‚
- **æ¬Šé™é©—è­‰**ï¼šæ¯æ¬¡æ“ä½œå‰é©—è­‰ç”¨æˆ¶æ¬Šé™
- **è³‡æ–™éš”é›¢**ï¼šä¸åŒå¸³æœ¬è³‡æ–™åš´æ ¼éš”é›¢
- **å”ä½œå®‰å…¨**ï¼šé‚€è«‹é©—è­‰ã€æ“ä½œè¿½è¹¤ã€æ¬Šé™æœ€å°åŒ–åŸå‰‡

### 1.6 èˆ‡å…¶ä»–åŠŸèƒ½ç¾¤çš„å”ä½œ

#### 1.6.1 åŠŸèƒ½ç¾¤ä»‹é¢
- **â† ç³»çµ±é€²å…¥åŠŸèƒ½ç¾¤**ï¼šæ¥æ”¶èªè­‰ç‹€æ…‹ï¼Œç²å–ç”¨æˆ¶è³‡è¨Š
- **â†’ è¨˜å¸³æ ¸å¿ƒåŠŸèƒ½ç¾¤**ï¼šæä¾›å¸³æœ¬é¸æ“‡ã€åˆ‡æ›å¸³æœ¬è¨˜å¸³
- **â†’ é ç®—ç®¡ç†åŠŸèƒ½ç¾¤**ï¼šå¤šå¸³æœ¬é ç®—ç®¡ç†ã€è·¨å¸³æœ¬é ç®—çµ±è¨ˆ
- **â†’ å ±è¡¨åˆ†æåŠŸèƒ½ç¾¤**ï¼šå¤šå¸³æœ¬å ±è¡¨åˆä½µã€å”ä½œæ•¸æ“šåˆ†æ

---

## 2.0 åŠŸèƒ½éœ€æ±‚ï¼ˆFunctional Requirementsï¼‰

### 2.1 å¸³æœ¬ç®¡ç†ä¸»é åŠŸèƒ½
**å°æ‡‰ç•«é¢**ï¼šS-301 å¸³æœ¬ç®¡ç†ä¸»é   
**é–‹ç™¼å„ªå…ˆç´š**ï¼šP1ï¼ˆPhase 2 å¿…é ˆå®Œæˆï¼‰  
**APIå°æ‡‰**ï¼š8104å¸³æœ¬ç®¡ç†æœå‹™API `/ledgers`

#### 2.1.1 åŸºæœ¬åŠŸèƒ½éœ€æ±‚
- **FR-301-001**ï¼šé¡¯ç¤ºç”¨æˆ¶æœ‰æ¬Šé™å­˜å–çš„æ‰€æœ‰å¸³æœ¬åˆ—è¡¨ï¼ŒåŒ…å«å€‹äººèˆ‡å”ä½œå¸³æœ¬
- **FR-301-002**ï¼šæä¾›å¸³æœ¬é¡å‹ç¯©é¸åŠŸèƒ½ï¼ˆå€‹äººã€å®¶åº­ã€åœ˜é«”ã€å•†æ¥­ï¼‰
- **FR-301-003**ï¼šé¡¯ç¤ºå¸³æœ¬åŸºæœ¬è³‡è¨Šï¼šåç¨±ã€é¡å‹ã€æ“æœ‰è€…ã€æˆå“¡æ•¸ã€æœ€å¾Œæ›´æ–°æ™‚é–“
- **FR-301-004**ï¼šæä¾›å¸³æœ¬æœå°‹åŠŸèƒ½ï¼Œæ”¯æ´åç¨±èˆ‡æè¿°é—œéµå­—æœå°‹
- **FR-301-005**ï¼šé¡¯ç¤ºç”¨æˆ¶åœ¨å„å¸³æœ¬ä¸­çš„æ¬Šé™ç‹€æ…‹æ¨™ç¤ºï¼ˆæ“æœ‰è€…ã€ç®¡ç†å“¡ã€ç·¨è¼¯è€…ã€æª¢è¦–è€…ï¼‰

#### 2.1.2 å››æ¨¡å¼å·®ç•°åŒ–éœ€æ±‚
- **Expertæ¨¡å¼**ï¼šå®Œæ•´å¸³æœ¬è³‡è¨Šã€é€²éšç¯©é¸é¸é …ã€æ‰¹æ¬¡æ“ä½œå·¥å…·ã€è©³ç´°çµ±è¨ˆæ•¸æ“š
- **Inertialæ¨¡å¼**ï¼šæ¨™æº–å¸³æœ¬åˆ—è¡¨ã€åŸºæœ¬ç¯©é¸ã€ç°¡æ½”è³‡è¨Šå±•ç¤º
- **Cultivationæ¨¡å¼**ï¼šæ¨è–¦å¸³æœ¬é¡å‹ã€ä½¿ç”¨å¼•å°æç¤ºã€æˆé•·é€²åº¦å±•ç¤º
- **Guidingæ¨¡å¼**ï¼šæœ€å¸¸ç”¨å¸³æœ¬å„ªå…ˆã€ç°¡åŒ–è³‡è¨Šã€è‡ªå‹•æ¨è–¦è¨­å®š

#### 2.1.3 é€²éšåŠŸèƒ½éœ€æ±‚
- **FR-301-006**ï¼šæ”¯æ´å¸³æœ¬æ’åºåŠŸèƒ½ï¼ˆåç¨±ã€å»ºç«‹æ™‚é–“ã€æœ€å¾Œä½¿ç”¨ã€æˆå“¡æ•¸ï¼‰
- **FR-301-007**ï¼šæä¾›å¸³æœ¬çµ±è¨ˆæ‘˜è¦ï¼šç¸½äº¤æ˜“æ•¸ã€æˆå“¡æ•¸ã€æœ€å¾Œæ´»å‹•æ™‚é–“
- **FR-301-008**ï¼šæ”¯æ´å¸³æœ¬ç‹€æ…‹ç®¡ç†ï¼šå•Ÿç”¨ã€å°å­˜ã€åˆªé™¤æ¢å¾©
- **FR-301-009**ï¼šæä¾›å¿«é€Ÿæ“ä½œé¸å–®ï¼šç·¨è¼¯ã€åˆ†äº«ã€è¤‡è£½ã€åˆªé™¤
- **FR-301-010**ï¼šæ”¯æ´å¸³æœ¬æ¨™ç±¤èˆ‡åˆ†é¡ç®¡ç†åŠŸèƒ½

### 2.2 å»ºç«‹å¸³æœ¬é åŠŸèƒ½
**å°æ‡‰ç•«é¢**ï¼šS-302 å»ºç«‹å¸³æœ¬é   
**é–‹ç™¼å„ªå…ˆç´š**ï¼šP1ï¼ˆPhase 2 å¿…é ˆå®Œæˆï¼‰  
**APIå°æ‡‰**ï¼š8104å¸³æœ¬ç®¡ç†æœå‹™API `/ledgers` POST

#### 2.2.1 åŸºæœ¬åŠŸèƒ½éœ€æ±‚
- **FR-302-001**ï¼šæä¾›å¸³æœ¬åŸºæœ¬è³‡è¨Šè¼¸å…¥ï¼šåç¨±ã€æè¿°ã€é¡å‹é¸æ“‡
- **FR-302-002**ï¼šæ”¯æ´å¸³æœ¬é¡å‹é¸æ“‡ï¼šå€‹äººå¸³æœ¬ã€å”ä½œå¸³æœ¬
- **FR-302-003**ï¼šæä¾›å¸³æœ¬å€‹äººåŒ–è¨­å®šï¼šé¡è‰²ä¸»é¡Œã€åœ–ç¤ºé¸æ“‡ã€è²¨å¹£è¨­å®š
- **FR-302-004**ï¼šæ”¯æ´å¸³æœ¬åˆå§‹è¨­å®šï¼šæ™‚å€ã€é è¨­ç§‘ç›®ã€åˆå§‹å¸³æˆ¶
- **FR-302-005**ï¼šæä¾›è¡¨å–®é©—è­‰èˆ‡éŒ¯èª¤æç¤ºåŠŸèƒ½

#### 2.2.2 å››æ¨¡å¼å·®ç•°åŒ–éœ€æ±‚
- **Expertæ¨¡å¼**ï¼šå®Œæ•´è¨­å®šé¸é …ã€é€²éšé…ç½®ã€æ¨¡æ¿åŒ¯å…¥ã€æ‰¹æ¬¡å»ºç«‹
- **Inertialæ¨¡å¼**ï¼šæ¨™æº–å»ºç«‹æµç¨‹ã€åŸºæœ¬è¨­å®šé¸é …ã€æ¸…æ™°æ­¥é©Ÿå¼•å°
- **Cultivationæ¨¡å¼**ï¼šå¼•å°å¼å»ºç«‹ã€æ¨è–¦è¨­å®šã€ç›®æ¨™è¨­å®šå¼•å°
- **Guidingæ¨¡å¼**ï¼šæœ€ç°¡åŒ–å»ºç«‹ã€é è¨­è¨­å®šã€ä¸€éµå»ºç«‹

#### 2.2.3 å”ä½œè¨­å®šéœ€æ±‚
- **FR-302-006**ï¼šå”ä½œå¸³æœ¬æ”¯æ´åˆå§‹æˆå“¡é‚€è«‹è¨­å®š
- **FR-302-007**ï¼šæä¾›é è¨­æ¬Šé™é…ç½®é¸é …
- **FR-302-008**ï¼šæ”¯æ´å¸³æœ¬å…¬é–‹æ€§è¨­å®šï¼ˆç§äººã€åœ˜éšŠã€çµ„ç¹”ï¼‰
- **FR-302-009**ï¼šæä¾›å¸³æœ¬ç¯„æœ¬é¸æ“‡åŠŸèƒ½
- **FR-302-010**ï¼šæ”¯æ´å¾ç¾æœ‰å¸³æœ¬è¤‡è£½è¨­å®šåŠŸèƒ½

### 2.3 å”ä½œç®¡ç†é åŠŸèƒ½
**å°æ‡‰ç•«é¢**ï¼šS-303 å”ä½œç®¡ç†é   
**é–‹ç™¼å„ªå…ˆç´š**ï¼šP1ï¼ˆPhase 2 å¿…é ˆå®Œæˆï¼‰  
**APIå°æ‡‰**ï¼š8104å¸³æœ¬ç®¡ç†æœå‹™API `/ledgers/{id}/collaborators`

#### 2.3.1 åŸºæœ¬åŠŸèƒ½éœ€æ±‚
- **FR-303-001**ï¼šé¡¯ç¤ºå”ä½œå¸³æœ¬çš„æ‰€æœ‰æˆå“¡åˆ—è¡¨ï¼ŒåŒ…å«è§’è‰²èˆ‡ç‹€æ…‹è³‡è¨Š
- **FR-303-002**ï¼šæä¾›æˆå“¡é‚€è«‹åŠŸèƒ½ï¼Œæ”¯æ´Emailé‚€è«‹èˆ‡æ‰¹æ¬¡é‚€è«‹
- **FR-303-003**ï¼šæ”¯æ´æˆå“¡æ¬Šé™ç®¡ç†ï¼šæª¢è¦–ã€ç·¨è¼¯ã€ç®¡ç†ã€åˆªé™¤æ¬Šé™è¨­å®š
- **FR-303-004**ï¼šæä¾›æˆå“¡ç§»é™¤åŠŸèƒ½ï¼ŒåŒ…å«è³‡æ–™æ­¸å±¬è™•ç†
- **FR-303-005**ï¼šæ”¯æ´é‚€è«‹ç‹€æ…‹è¿½è¹¤ï¼šå·²ç™¼é€ã€å·²æ¥å—ã€å·²æ‹’çµ•ã€å·²éæœŸ

#### 2.3.2 å››æ¨¡å¼å·®ç•°åŒ–éœ€æ±‚
- **Expertæ¨¡å¼**ï¼šç´°ç²’åº¦æ¬Šé™æ§åˆ¶ã€å”ä½œå¯©è¨ˆæ—¥èªŒã€è¡çªç®¡ç†å·¥å…·ã€é€²éšçµ±è¨ˆ
- **Inertialæ¨¡å¼**ï¼šæ¨™æº–æ¬Šé™è¨­å®šã€ç°¡æ½”æˆå“¡ç®¡ç†ã€åŸºæœ¬é‚€è«‹åŠŸèƒ½
- **Cultivationæ¨¡å¼**ï¼šå”ä½œå¼•å°æ•™å­¸ã€åœ˜éšŠå»ºç«‹å»ºè­°ã€å”ä½œæŠ€å·§æç¤º
- **Guidingæ¨¡å¼**ï¼šç°¡åŒ–æ¬Šé™é¸é …ã€ä¸€éµé‚€è«‹ã€åŸºæœ¬æˆå“¡ç®¡ç†

#### 2.3.3 é€²éšå”ä½œåŠŸèƒ½
- **FR-303-006**ï¼šæ”¯æ´å”ä½œè¡çªæª¢æ¸¬èˆ‡è§£æ±ºæ©Ÿåˆ¶
- **FR-303-007**ï¼šæä¾›æˆå“¡æ´»å‹•çµ±è¨ˆèˆ‡è²¢ç»åˆ†æ
- **FR-303-008**ï¼šæ”¯æ´å”ä½œè¦å‰‡è¨­å®šï¼šæ“ä½œé™åˆ¶ã€å¯©æ‰¹æµç¨‹
- **FR-303-009**ï¼šæä¾›å”ä½œé€šçŸ¥è¨­å®šï¼šæˆå“¡åŠ å…¥ã€æ¬Šé™è®Šæ›´ã€é‡è¦æ“ä½œ
- **FR-303-010**ï¼šæ”¯æ´å”ä½œæ­·å²è¨˜éŒ„èˆ‡æ“ä½œå¯©è¨ˆåŠŸèƒ½

---

## 3.0 è¼¸å…¥/è¼¸å‡ºè¦æ ¼ï¼ˆInput & Output Specificationsï¼‰

### 3.1 è¼¸å…¥è¦æ ¼å¼•ç”¨

#### 3.1.1 å¸³æœ¬åˆ—è¡¨æŸ¥è©¢è¼¸å…¥è¦æ ¼ï¼ˆS-301ï¼‰
**APIç«¯é»**ï¼š`GET /ledgers`  
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8104å¸³æœ¬ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/ledgers` ç«¯é»  
**å››æ¨¡å¼å·®ç•°**ï¼š
- **Expertæ¨¡å¼**ï¼šæ”¯æ´å®Œæ•´ç¯©é¸åƒæ•¸ã€é€²éšæ’åºã€æ‰¹æ¬¡æ“ä½œ
- **å…¶ä»–æ¨¡å¼**ï¼šéµå¾ª8104è¦æ ¼çš„æ¨™æº–æŸ¥è©¢åŠŸèƒ½

#### 3.1.2 å»ºç«‹å¸³æœ¬è¼¸å…¥è¦æ ¼ï¼ˆS-302ï¼‰
**APIç«¯é»**ï¼š`POST /ledgers`  
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8104å¸³æœ¬ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/ledgers` ç«¯é»  
**PLå±¤é—œæ³¨**ï¼šè¡¨å–®é©—è­‰ã€å¿…å¡«æ¬„ä½ã€å››æ¨¡å¼å·®ç•°åŒ–è™•ç†

#### 3.1.3 å”ä½œè€…ç®¡ç†è¼¸å…¥è¦æ ¼ï¼ˆS-303ï¼‰
**APIç«¯é»**ï¼š`GET/POST /ledgers/{id}/collaborators`  
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8104å¸³æœ¬ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/ledgers/{id}/collaborators` ç«¯é»  
**PLå±¤é—œæ³¨**ï¼šæ¬Šé™é©—è­‰ã€æ‰¹æ¬¡é‚€è«‹ã€å››æ¨¡å¼æ“ä½œå·®ç•°

### 3.2 è¼¸å‡ºè¦æ ¼å¼•ç”¨

#### 3.2.1 å¸³æœ¬åˆ—è¡¨è¼¸å‡ºè¦æ ¼ï¼ˆS-301ï¼‰
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8104å¸³æœ¬ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/ledgers` æˆåŠŸå›æ‡‰  
**å››æ¨¡å¼å·®ç•°åŒ–è™•ç†**ï¼š
- **Expertæ¨¡å¼**ï¼šé¡¯ç¤ºå®Œæ•´å¸³æœ¬è³‡è¨Šã€è©³ç´°çµ±è¨ˆã€é€²éšåŠŸèƒ½é¸é …
- **Cultivationæ¨¡å¼**ï¼šé¡¯ç¤ºä½¿ç”¨å¼•å°ã€æ¨è–¦æ“ä½œã€æˆé•·æŒ‡æ¨™
- **Inertial/Guidingæ¨¡å¼**ï¼šç°¡åŒ–è³‡è¨Šå±•ç¤ºã€åŸºæœ¬æ“ä½œé¸é …

#### 3.2.2 å»ºç«‹å¸³æœ¬è¼¸å‡ºè¦æ ¼ï¼ˆS-302ï¼‰
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8104å¸³æœ¬ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/ledgers` æˆåŠŸå›æ‡‰  
**PLå±¤è™•ç†é‡é»**ï¼š
- å»ºç«‹æˆåŠŸå¾Œçš„åé¥‹å±•ç¤º
- å››æ¨¡å¼å·®ç•°åŒ–çš„å¾ŒçºŒæ“ä½œå»ºè­°
- å¸³æœ¬åˆå§‹åŒ–å®Œæˆæç¤º

#### 3.2.3 å”ä½œç®¡ç†è¼¸å‡ºè¦æ ¼ï¼ˆS-303ï¼‰
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8104å¸³æœ¬ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/ledgers/{id}/collaborators` æˆåŠŸå›æ‡‰  
**å››æ¨¡å¼å·®ç•°åŒ–è™•ç†**ï¼š
- **Expertæ¨¡å¼**ï¼šå®Œæ•´æˆå“¡è³‡è¨Šã€æ¬Šé™è©³æƒ…ã€æ“ä½œæ­·å²
- **Cultivationæ¨¡å¼**ï¼šå”ä½œå¼•å°æç¤ºã€åœ˜éšŠå»ºç«‹å»ºè­°
- **Inertial/Guidingæ¨¡å¼**ï¼šç°¡åŒ–æˆå“¡åˆ—è¡¨ã€åŸºæœ¬æ¬Šé™ç‹€æ…‹

### 3.3 PLå±¤ç‰¹æ®Šè™•ç†éœ€æ±‚

#### 3.3.1 å››æ¨¡å¼éŸ¿æ‡‰å¼è™•ç†
PLå±¤éœ€æ ¹æ“šç”¨æˆ¶æ¨¡å¼èª¿æ•´APIå›æ‡‰çš„è™•ç†æ–¹å¼ï¼š
- **åŠŸèƒ½å¯è¦‹æ€§**ï¼šä¾æ“šæ¨¡å¼èª¿æ•´å¯è¦‹çš„åŠŸèƒ½é¸é …
- **è³‡è¨Šå±•ç¤ºæ·±åº¦**ï¼šExpert > Inertial > Cultivation > Guiding
- **æ“ä½œå¼•å°ç¨‹åº¦**ï¼šGuiding > Cultivation > Inertial > Expert

#### 3.3.2 æ¬Šé™ç‹€æ…‹æœ¬åœ°å¿«å–
- **æ¬Šé™è³‡è¨Š**ï¼šå¿«å–ç”¨æˆ¶åœ¨å„å¸³æœ¬ä¸­çš„æ¬Šé™ç‹€æ…‹
- **æˆå“¡è³‡è¨Š**ï¼šå¸¸ç”¨å”ä½œè€…è³‡è¨Šæœ¬åœ°å„²å­˜
- **å¸³æœ¬è¨­å®š**ï¼šå¸³æœ¬åå¥½è¨­å®šæœ¬åœ°å‚™ä»½

---

## 4.0 éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³ï¼ˆError Handling & Edge Casesï¼‰

### 4.1 å¸³æœ¬ç®¡ç†ç›¸é—œéŒ¯èª¤ï¼ˆåŸºæ–¼8104 APIè¦æ ¼ï¼‰

#### 4.1.1 å¸³æœ¬å»ºç«‹éŒ¯èª¤ï¼ˆPOST /ledgersï¼‰
```yaml
LEDGER_NAME_DUPLICATE:
  http_status: 409
  code: "DUPLICATE_RESOURCE"
  message: "å¸³æœ¬åç¨±å·²å­˜åœ¨"
  field: "name"
  ui_action: "æç¤ºä¿®æ”¹å¸³æœ¬åç¨±"
  retry_allowed: true
  
LEDGER_LIMIT_EXCEEDED:
  http_status: 422
  code: "BUSINESS_LOGIC_ERROR" 
  message: "å·²é”åˆ°å¸³æœ¬æ•¸é‡ä¸Šé™"
  field: "count"
  ui_action: "æç¤ºå‡ç´šæ–¹æ¡ˆæˆ–åˆªé™¤èˆŠå¸³æœ¬"
  retry_allowed: false
```

#### 4.1.2 å¸³æœ¬å­˜å–éŒ¯èª¤ï¼ˆGET /ledgers/{id}ï¼‰
```yaml
LEDGER_NOT_FOUND:
  http_status: 404
  code: "RESOURCE_NOT_FOUND"
  message: "å¸³æœ¬ä¸å­˜åœ¨æˆ–å·²è¢«åˆªé™¤"
  field: "ledgerId"
  ui_action: "è¿”å›å¸³æœ¬åˆ—è¡¨ä¸¦æ›´æ–°"
  retry_allowed: true

LEDGER_ACCESS_DENIED:
  http_status: 403
  code: "FORBIDDEN"
  message: "ç„¡æ¬Šé™å­˜å–æ­¤å¸³æœ¬"
  field: "permissions"
  ui_action: "éš±è—å¸³æœ¬æˆ–ç”³è«‹æ¬Šé™"
  retry_allowed: false
```

### 4.2 å”ä½œæ¬Šé™éŒ¯èª¤

#### 4.2.1 é‚€è«‹å”ä½œè€…éŒ¯èª¤ï¼ˆPOST /ledgers/{id}/invitationsï¼‰
```yaml
INVITATION_EMAIL_INVALID:
  http_status: 400
  code: "VALIDATION_ERROR"
  message: "é‚€è«‹ä¿¡ç®±æ ¼å¼ä¸æ­£ç¢º"
  field: "email"
  ui_action: "é‡æ–°è¼¸å…¥æ­£ç¢ºä¿¡ç®±æ ¼å¼"
  retry_allowed: true

COLLABORATOR_LIMIT_EXCEEDED:
  http_status: 422
  code: "BUSINESS_LOGIC_ERROR"
  message: "å”ä½œè€…æ•¸é‡å·²é”ä¸Šé™"
  field: "collaboratorCount"
  ui_action: "æç¤ºå‡ç´šæ–¹æ¡ˆæˆ–ç§»é™¤ç¾æœ‰æˆå“¡"
  retry_allowed: false
  details:
    current_count: 5
    max_allowed: 5
```

#### 4.2.2 æ¬Šé™ç®¡ç†éŒ¯èª¤ï¼ˆPUT /ledgers/{id}/collaborators/{userId}ï¼‰
```yaml
PERMISSION_DENIED:
  http_status: 403
  code: "FORBIDDEN"
  message: "ç„¡æ¬Šé™ä¿®æ”¹æ­¤æˆå“¡æ¬Šé™"
  field: "role"
  ui_action: "è¯ç¹«å¸³æœ¬ç®¡ç†å“¡"
  retry_allowed: false

OWNER_ROLE_PROTECTED:
  http_status: 422
  code: "BUSINESS_LOGIC_ERROR"
  message: "ç„¡æ³•ä¿®æ”¹å¸³æœ¬æ“æœ‰è€…çš„æ¬Šé™"
  field: "role"
  ui_action: "èªªæ˜æ“æœ‰è€…æ¬Šé™ç„¡æ³•è®Šæ›´"
  retry_allowed: false
```

### 4.3 ç¶²è·¯é€£ç·šéŒ¯èª¤

#### 4.3.1 å”ä½œåŒæ­¥éŒ¯èª¤
```yaml
COLLABORATION_SYNC_FAILED:
  http_status: null
  code: "SYNC_FAILED"
  message: "å”ä½œè³‡æ–™åŒæ­¥å¤±æ•—"
  ui_action: "æç¤ºæª¢æŸ¥ç¶²è·¯ä¸¦é‡è©¦åŒæ­¥"
  retry_allowed: true
  auto_retry: true

CONFLICT_DETECTED:
  http_status: 409
  code: "CONFLICT_DETECTED"
  message: "æª¢æ¸¬åˆ°è³‡æ–™è¡çªï¼Œéœ€è¦æ‰‹å‹•è§£æ±º"
  ui_action: "é¡¯ç¤ºè¡çªè§£æ±ºä»‹é¢"
  retry_allowed: false
  details:
    conflict_type: "concurrent_modification"
    affected_resources: ["member_permissions"]
```

### 4.4 ç³»çµ±ç•°å¸¸è™•ç†

#### 4.4.1 å¸³æœ¬æœå‹™ç•°å¸¸
```yaml
LEDGER_SERVICE_UNAVAILABLE:
  http_status: 503
  code: "SERVICE_UNAVAILABLE"
  message: "å¸³æœ¬æœå‹™æš«æ™‚ç„¡æ³•ä½¿ç”¨"
  ui_action: "å•Ÿç”¨é›¢ç·šæ¨¡å¼æˆ–ç¨å¾Œå†è©¦"
  retry_allowed: true
  offline_fallback: true

COLLABORATION_SERVICE_ERROR:
  http_status: 500
  code: "INTERNAL_SERVER_ERROR"
  message: "å”ä½œæœå‹™ç•°å¸¸"
  ui_action: "é¡¯ç¤ºåŸºæœ¬å¸³æœ¬åŠŸèƒ½ï¼Œå”ä½œåŠŸèƒ½æš«æ™‚åœç”¨"
  retry_allowed: true
  graceful_degradation: true
```

### 4.5 éŒ¯èª¤å›é¥‹èˆ‡å¾©åŸæ©Ÿåˆ¶

#### 4.5.1 å››æ¨¡å¼å·®ç•°åŒ–éŒ¯èª¤è™•ç†
```yaml
error_handling_by_mode:
  Expert:
    show_technical_details: true
    provide_advanced_recovery: true
    show_alternative_solutions: true
  Inertial:
    show_clear_message: true
    provide_standard_actions: true
    maintain_consistent_flow: true
  Cultivation:
    show_supportive_message: true
    provide_learning_guidance: true
    encourage_retry: true
  Guiding:
    show_simple_message: true
    provide_one_step_solution: true
    minimize_user_decision: true
```

#### 4.5.2 å”ä½œè¡çªè™•ç†ç­–ç•¥
```yaml
conflict_resolution_strategy:
  automatic_resolution:
    - "simple_permission_conflicts"
    - "member_status_updates"
    - "basic_setting_changes"

  manual_resolution_required:
    - "concurrent_member_removal"
    - "permission_escalation_conflicts"
    - "ownership_transfer_disputes"

  fallback_mechanisms:
    - "temporary_read_only_mode"
    - "conflict_notification_to_admin"
    - "automatic_backup_creation"
```
