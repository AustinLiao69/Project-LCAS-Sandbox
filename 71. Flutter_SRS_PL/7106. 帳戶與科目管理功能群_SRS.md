# 7106. å¸³æˆ¶èˆ‡ç§‘ç›®ç®¡ç†åŠŸèƒ½ç¾¤_SRS.md

**æ–‡ä»¶ç·¨è™Ÿ**: 7106
**ç‰ˆæœ¬**: v1.0.0
**å»ºç«‹æ—¥æœŸ**: 2025-11-17
**å»ºç«‹è€…**: LCAS PM Team
**æœ€å¾Œæ›´æ–°**: 2025-11-17

---

## ğŸ“‘ ç›®æ¬¡ (Table of Contents)

1. [æ¨¡çµ„æ¦‚è¿° (Module Overview)](#10-æ¨¡çµ„æ¦‚è¿°module-overview)

2. [åŠŸèƒ½éœ€æ±‚ (Functional Requirements)](#20-åŠŸèƒ½éœ€æ±‚functional-requirements)
   - 2.1 å¸³æˆ¶è³‡æ–™ç®¡ç†é‚è¼¯
   - 2.2 ç§‘ç›®éšå±¤ç®¡ç†é‚è¼¯
   - 2.3 å¸³æˆ¶é¤˜é¡è¨ˆç®—é‚è¼¯
   - 2.4 ç§‘ç›®ä½¿ç”¨çµ±è¨ˆé‚è¼¯
   - 2.5 å››æ¨¡å¼å·®ç•°åŒ–æ¥­å‹™é‚è¼¯è™•ç†
   - 2.6 æœ¬åœ°è³‡æ–™å¿«å–èˆ‡åŒæ­¥é‚è¼¯

3. [è¼¸å…¥/è¼¸å‡ºè¦æ ¼ (Input & Output Specifications)](#30-è¼¸å…¥è¼¸å‡ºè¦æ ¼input--output-specifications)
   - 3.1 APL Gatewayè¼¸å…¥è¦æ ¼
   - 3.2 APL Gatewayè¼¸å‡ºè¦æ ¼
   - 3.3 WCM.jsæ¨¡çµ„ä»‹é¢è¦æ ¼
   - 3.4 å››æ¨¡å¼å·®ç•°åŒ–è™•ç†è¦æ ¼
   - 3.5 æœ¬åœ°å¿«å–èˆ‡åŒæ­¥è¦æ ¼

4. [éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³ (Error Handling & Edge Cases)](#40-éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³error-handling--edge-cases)
   - 4.1 çµ±ä¸€éŒ¯èª¤è™•ç†æ¶æ§‹
   - 4.2 å¸³æˆ¶ç®¡ç†ç›¸é—œéŒ¯èª¤
   - 4.3 ç§‘ç›®ç®¡ç†ç›¸é—œéŒ¯èª¤
   - 4.4 ç¶²è·¯é€£ç·šéŒ¯èª¤
   - 4.5 æ¥­å‹™é‚è¼¯å±¤ç‰¹æ®Šè™•ç†

---

## 1.0 æ¨¡çµ„æ¦‚è¿°ï¼ˆModule Overviewï¼‰

### 1.1 æ¨¡çµ„å®šä½èˆ‡è·è²¬

**å¸³æˆ¶èˆ‡ç§‘ç›®ç®¡ç†åŠŸèƒ½ç¾¤**æ˜¯LCAS 2.0å°ˆæ¡ˆPresentation Layerçš„é—œéµæ¥­å‹™é‚è¼¯æ¨¡çµ„ç¾¤ï¼Œè² è²¬è™•ç†å¸³æˆ¶èˆ‡ç§‘ç›®ç®¡ç†çš„å®Œæ•´æ¥­å‹™é‚è¼¯æµç¨‹ã€‚æœ¬åŠŸèƒ½ç¾¤å°æ‡‰0090 Sprintè¨ˆç•«çš„**Phase 3**ç¯„åœï¼Œå°ˆæ³¨æ–¼PLå±¤çš„**åŠŸèƒ½ç¾¤æ¥­å‹™é‚è¼¯**ï¼Œè€ŒéUIé é¢ç¾¤ã€‚

**æ ¸å¿ƒè·è²¬ç¯„åœ**ï¼š
- ğŸ¦ **å¸³æˆ¶ç®¡ç†é‚è¼¯**ï¼šAPIèª¿ç”¨ã€è³‡æ–™é©—è­‰ã€ç‹€æ…‹ç®¡ç†
- ğŸ“‚ **ç§‘ç›®ç®¡ç†é‚è¼¯**ï¼šéšå±¤çµæ§‹è™•ç†ã€æ¨¹ç‹€åŒæ­¥
- ğŸ’° **é¤˜é¡è¨ˆç®—é‚è¼¯**ï¼šå³æ™‚è¨ˆç®—ã€å¿«å–æ›´æ–°
- ğŸ“Š **ä½¿ç”¨çµ±è¨ˆé‚è¼¯**ï¼šé »ç‡åˆ†æã€æ™ºæ…§æ¨è–¦
- ğŸ¯ **å››æ¨¡å¼é©é…**ï¼šå·®ç•°åŒ–æ¥­å‹™é‚è¼¯è™•ç†
- ğŸ’¾ **è³‡æ–™åŒæ­¥**ï¼šæœ¬åœ°å¿«å–èˆ‡APIåŒæ­¥æ©Ÿåˆ¶

### 1.2 åŠŸèƒ½ç¾¤ç¯„åœå®šç¾©

æœ¬åŠŸèƒ½ç¾¤å°ˆæ³¨æ–¼**æ¥­å‹™é‚è¼¯å±¤**ï¼Œä¸æ¶‰åŠUIé é¢ç¾¤ï¼Œå°æ‡‰7302è¨˜å¸³æ ¸å¿ƒåŠŸèƒ½ç¾¤çš„æ¶æ§‹æ¨¡å¼ï¼š

| è·è²¬å±¤ç´š | åŠŸèƒ½ç¯„åœ | å°æ‡‰æ¨¡çµ„ | å‚™è¨» |
|----------|----------|----------|------|
| **æ¥­å‹™é‚è¼¯è™•ç†** | APIèª¿ç”¨ã€ç‹€æ…‹ç®¡ç†ã€è³‡æ–™è½‰æ› | 7106 | æœ¬æ¨¡çµ„æ ¸å¿ƒ |
| **APIæœå‹™å°æ¥** | 8105å¸³æˆ¶ç®¡ç†ã€8106ç§‘ç›®ç®¡ç†æœå‹™ | APLå±¤ | ä»‹é¢ä¾è³´ |
| **BLå±¤æ•´åˆ** | 1350. WCM.jsæ¨¡çµ„ | BLå±¤ | å¾Œç«¯æœå‹™ |
| **UIé é¢ç¾¤** | S-304ã€S-305ã€S-306é é¢ | é é¢ç¾¤æ¨¡çµ„ | éæœ¬æ¨¡çµ„ç¯„åœ |

### 1.3 å››æ¨¡å¼å·®ç•°åŒ–ç­–ç•¥

åŸºæ–¼0015æ–‡ä»¶çš„å››æ¨¡å¼ç†è«–ï¼Œæœ¬åŠŸèƒ½ç¾¤å¯¦ç¾ä»¥ä¸‹**æ¥­å‹™é‚è¼¯å±¤**å·®ç•°åŒ–ç­–ç•¥ï¼š

#### 1.3.1 Expertæ¨¡å¼ï¼ˆå°ˆå®¶æ¨¡å¼ï¼‰æ¥­å‹™é‚è¼¯
- **è³‡æ–™è™•ç†**ï¼šå®Œæ•´APIåƒæ•¸ã€è©³ç´°é©—è­‰é‚è¼¯ã€é€²éšç¯©é¸æ¢ä»¶
- **å¿«å–ç­–ç•¥**ï¼šå…¨é‡è³‡æ–™å¿«å–ã€è¤‡é›œæŸ¥è©¢ç·©å­˜ã€å³æ™‚åŒæ­¥
- **ç‹€æ…‹ç®¡ç†**ï¼šå¤šç¶­åº¦ç‹€æ…‹è¿½è¹¤ã€æ“ä½œæ­·å²è¨˜éŒ„

#### 1.3.2 Inertialæ¨¡å¼ï¼ˆæ…£æ€§æ¨¡å¼ï¼‰æ¥­å‹™é‚è¼¯
- **è³‡æ–™è™•ç†**ï¼šæ¨™æº–åŒ–APIèª¿ç”¨ã€åŸºæœ¬é©—è­‰é‚è¼¯ã€å›ºå®šç¯©é¸
- **å¿«å–ç­–ç•¥**ï¼šæ¨™æº–å¿«å–æ©Ÿåˆ¶ã€å®šæœŸåŒæ­¥
- **ç‹€æ…‹ç®¡ç†**ï¼šç©©å®šç‹€æ…‹ç¶­è­·ã€ä¸€è‡´æ€§å„ªå…ˆ

#### 1.3.3 Cultivationæ¨¡å¼ï¼ˆé¤Šæˆæ¨¡å¼ï¼‰æ¥­å‹™é‚è¼¯
- **è³‡æ–™è™•ç†**ï¼šå¼•å°å¼è³‡æ–™æº–å‚™ã€æ™ºæ…§æ¨è–¦é‚è¼¯ã€è¡Œç‚ºåˆ†æ
- **å¿«å–ç­–ç•¥**ï¼šç¿’æ…£è³‡æ–™å„ªå…ˆã€ä½¿ç”¨é »ç‡åˆ†æ
- **ç‹€æ…‹ç®¡ç†**ï¼šæˆé•·è¿½è¹¤ç‹€æ…‹ã€é€²åº¦è¨ˆç®—

#### 1.3.4 Guidingæ¨¡å¼ï¼ˆå¼•å°æ¨¡å¼ï¼‰æ¥­å‹™é‚è¼¯
- **è³‡æ–™è™•ç†**ï¼šæ¥µç°¡è³‡æ–™è™•ç†ã€è‡ªå‹•é è¨­å€¼ã€æœ€å°‘é¸é …
- **å¿«å–ç­–ç•¥**ï¼šé è¨­è³‡æ–™å¿«å–ã€ç°¡åŒ–åŒæ­¥
- **ç‹€æ…‹ç®¡ç†**ï¼šç°¡åŒ–ç‹€æ…‹çµæ§‹ã€è‡ªå‹•åŒ–è™•ç†

### 1.4 æŠ€è¡“æ¶æ§‹æ•´åˆ

#### 1.4.1 èˆ‡APL.dart GatewayåŠWCM.jsæ¨¡çµ„æ•´åˆé—œä¿‚

æœ¬åŠŸèƒ½ç¾¤ä½œç‚ºPLå±¤æ¥­å‹™é‚è¼¯ï¼Œé€éAPL.dartçµ±ä¸€Gatewayèˆ‡BLå±¤1350. WCM.jsæ¨¡çµ„å»ºç«‹æ¸…æ™°çš„æ•´åˆæ¶æ§‹ï¼š

```
7106åŠŸèƒ½ç¾¤ (PLæ¥­å‹™é‚è¼¯å±¤)
    â†“ çµ±ä¸€APIèª¿ç”¨
APL.dart Gateway (çµ±ä¸€APIè½‰ç™¼çª—å£)
    â†“ RESTfulè½‰ç™¼
ASL.js (APIæœå‹™å±¤)
    â†“ æ¥­å‹™é‚è¼¯èª¿ç”¨
1350. WCM.js (BLå±¤æ¨¡çµ„)
    â†“ è³‡æ–™å­˜å–
Firebase (DLå±¤)
```

**æ ¸å¿ƒæ•´åˆé»**ï¼š
- **å¸³æˆ¶ç®¡ç†**ï¼š7106 â†’ APL.account â†’ ASL.js â†’ WCM_createWalletã€WCM_getWalletListç­‰å‡½æ•¸
- **ç§‘ç›®ç®¡ç†**ï¼š7106 â†’ APL.categoryï¼ˆP3ï¼‰ â†’ ASL.js â†’ WCM_createCategoryã€WCM_getCategoryListç­‰å‡½æ•¸
- **é¤˜é¡æŸ¥è©¢**ï¼š7106 â†’ APL.account â†’ ASL.js â†’ WCM_getWalletBalanceå‡½æ•¸
- **è³‡æ–™é©—è­‰**ï¼š7106 â†’ APLçµ±ä¸€Gateway â†’ ASL.js â†’ WCM_validateWalletExistsã€WCM_validateCategoryExistså‡½æ•¸

**æ¶æ§‹å„ªå‹¢**ï¼š
- **çµ±ä¸€ç®¡ç†**ï¼šé€éAPL.dartå–®ä¸€çª—å£ç®¡ç†æ‰€æœ‰APIè«‹æ±‚
- **æ¨™æº–åŒ–**ï¼šéµå¾ªRESTful APIæ¨™æº–ï¼Œæä¾›ä¸€è‡´çš„ä»‹é¢è¦ç¯„
- **å¯æ“´å±•æ€§**ï¼šAPL Gatewayç‚ºP3-P7éšæ®µé ç•™æ“´å±•åŸºç¤

#### 1.4.2 APIæœå‹™å°æ‡‰è¦ç¯„

åŸºæ–¼8020æ–‡ä»¶APIè¦æ ¼èˆ‡APL.dartçµ±ä¸€Gatewayæ¶æ§‹ï¼Œæœ¬åŠŸèƒ½ç¾¤**åš´æ ¼å°æ‡‰**ä»¥ä¸‹APIæœå‹™ï¼š

| æ¥­å‹™é‚è¼¯åŠŸèƒ½ | APL.dart Gatewayæœå‹™ | APIç«¯é»è·¯å¾‘ | WCM.jså‡½æ•¸ |
|-------------|---------------------|------------|------------|
| å¸³æˆ¶è³‡æ–™ç®¡ç† | APL.accountæœå‹™ | `/api/v1/accounts` | WCM_createWallet, WCM_getWalletList |
| ç§‘ç›®éšå±¤ç®¡ç† | APL.categoryæœå‹™ï¼ˆP3é ç•™ï¼‰ | `/api/v1/categories` | WCM_createCategory, WCM_getCategoryList |
| å¸³æˆ¶é¤˜é¡è¨ˆç®— | APL.accountæœå‹™ | `/api/v1/accounts/{id}/balance` | WCM_getWalletBalance |
| å¸³æˆ¶é©—è­‰é‚è¼¯ | APL.accountæœå‹™ | `/api/v1/accounts/{id}` | WCM_validateWalletExists |
| ç§‘ç›®é©—è­‰é‚è¼¯ | APL.categoryæœå‹™ï¼ˆP3é ç•™ï¼‰ | `/api/v1/categories/{id}` | WCM_validateCategoryExists |

**APL Gatewayæ•´åˆèªªæ˜**ï¼š
- **çµ±ä¸€å…¥å£**ï¼šæ‰€æœ‰APIè«‹æ±‚é€éAPL.dartçµ±ä¸€Gatewayè™•ç†
- **æœå‹™åˆ†çµ„**ï¼šAPL.accountã€APL.categoryç­‰æœå‹™é¡åˆ¥å°è£ç›¸é—œAPI
- **æ¨™æº–åŒ–è·¯å¾‘**ï¼šéµå¾ª`/api/v1/*`æ¨™æº–RESTfulè·¯å¾‘è¦ç¯„
- **P3éšæ®µé ç•™**ï¼šç§‘ç›®ç®¡ç†æœå‹™å°‡åœ¨Phase 3éšæ®µå®Œæ•´å¯¦ç¾

#### 1.4.3 ç‹€æ…‹ç®¡ç†æ¶æ§‹

```dart
// å¸³æˆ¶èˆ‡ç§‘ç›®ç®¡ç†ç‹€æ…‹çµæ§‹
AccountCategoryStateManager/
â”œâ”€â”€ AccountState           // å¸³æˆ¶è³‡æ–™ç‹€æ…‹
â”‚   â”œâ”€â”€ accountList        // å¸³æˆ¶åˆ—è¡¨
â”‚   â”œâ”€â”€ selectedAccount    // é¸ä¸­å¸³æˆ¶
â”‚   â”œâ”€â”€ accountBalance     // é¤˜é¡å¿«å–
â”‚   â””â”€â”€ loadingState       // è¼‰å…¥ç‹€æ…‹
â”œâ”€â”€ CategoryState          // ç§‘ç›®è³‡æ–™ç‹€æ…‹
â”‚   â”œâ”€â”€ categoryTree       // ç§‘ç›®æ¨¹ç‹€çµæ§‹
â”‚   â”œâ”€â”€ selectedCategory   // é¸ä¸­ç§‘ç›®
â”‚   â”œâ”€â”€ frequentCategories // å¸¸ç”¨ç§‘ç›®å¿«å–
â”‚   â””â”€â”€ syncState          // åŒæ­¥ç‹€æ…‹
â”œâ”€â”€ CacheState            // å¿«å–ç®¡ç†ç‹€æ…‹
â”‚   â”œâ”€â”€ cacheTimestamp     // å¿«å–æ™‚é–“æˆ³
â”‚   â”œâ”€â”€ syncStatus         // åŒæ­¥ç‹€æ…‹
â”‚   â””â”€â”€ offlineData        // é›¢ç·šè³‡æ–™
â””â”€â”€ ModeState             // å››æ¨¡å¼ç‹€æ…‹
    â”œâ”€â”€ currentMode        // ç•¶å‰æ¨¡å¼
    â”œâ”€â”€ modeConfig         // æ¨¡å¼é…ç½®
    â””â”€â”€ adaptiveData       // é©é…è³‡æ–™
```

### 1.5 å“è³ªèˆ‡å®‰å…¨è¦æ±‚

#### 1.5.1 æ¥­å‹™é‚è¼¯æ•ˆèƒ½è¦æ±‚
- **APIéŸ¿æ‡‰è™•ç†**ï¼šâ‰¤ 500msï¼ˆAPIèª¿ç”¨è™•ç†ï¼‰ã€â‰¤ 200msï¼ˆæœ¬åœ°ç‹€æ…‹æ›´æ–°ï¼‰
- **å¿«å–æ©Ÿåˆ¶**ï¼šâ‰¤ 100msï¼ˆå¿«å–è®€å–ï¼‰ã€â‰¤ 300msï¼ˆå¿«å–æ›´æ–°ï¼‰
- **å››æ¨¡å¼åˆ‡æ›**ï¼šâ‰¤ 200msï¼ˆæ¨¡å¼é©é…é‚è¼¯ï¼‰

#### 1.5.2 è³‡æ–™ä¸€è‡´æ€§è¦æ±‚
- **ç‹€æ…‹åŒæ­¥**ï¼šAPIå›æ‡‰èˆ‡æœ¬åœ°ç‹€æ…‹å³æ™‚åŒæ­¥
- **å¿«å–ä¸€è‡´æ€§**ï¼šå®šæœŸæ ¡é©—æœ¬åœ°å¿«å–èˆ‡é ç«¯è³‡æ–™ä¸€è‡´æ€§
- **æ¨¡å¼é©é…**ï¼šç¢ºä¿å››æ¨¡å¼é–“è³‡æ–™çµæ§‹ä¸€è‡´

#### 1.5.3 éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- **APIç•°å¸¸è™•ç†**ï¼šç¶²è·¯ä¸­æ–·ã€æœå‹™ç•°å¸¸çš„å„ªé›…é™ç´š
- **è³‡æ–™é©—è­‰**ï¼šå‰ç«¯æ¥­å‹™é‚è¼¯é©—è­‰ï¼Œé˜²æ­¢ç„¡æ•ˆè³‡æ–™å‚³é€
- **é‡è©¦æ©Ÿåˆ¶**ï¼šå¤±æ•—æ“ä½œçš„è‡ªå‹•é‡è©¦èˆ‡æ‰‹å‹•é‡è©¦é¸é …

### 1.6 èˆ‡å…¶ä»–åŠŸèƒ½ç¾¤çš„å”ä½œ

#### 1.6.1 åŠŸèƒ½ç¾¤ä»‹é¢ä¾è³´
- **â† ç³»çµ±é€²å…¥åŠŸèƒ½ç¾¤**ï¼šæ¥æ”¶èªè­‰ç‹€æ…‹ã€ç”¨æˆ¶æ¨¡å¼é…ç½®
- **â†’ è¨˜å¸³æ ¸å¿ƒåŠŸèƒ½ç¾¤**ï¼šæä¾›å¸³æˆ¶èˆ‡ç§‘ç›®é¸æ“‡é‚è¼¯ã€é©—è­‰æœå‹™
- **â†’ å¸³æœ¬å”ä½œåŠŸèƒ½ç¾¤**ï¼šå¸³æœ¬æ¬Šé™é©—è­‰ã€å”ä½œç‹€æ…‹ç®¡ç†
- **â†’ é ç®—ç®¡ç†åŠŸèƒ½ç¾¤**ï¼šå¸³æˆ¶ç§‘ç›®é—œè¯ã€é ç®—åŸ·è¡Œé‚è¼¯

#### 1.6.2 æ¥­å‹™é‚è¼¯è³‡æ–™æµ
```
APIè«‹æ±‚æº–å‚™ â†’ å››æ¨¡å¼é©é… â†’ APIèª¿ç”¨ â†’ å›æ‡‰è™•ç† â†’ ç‹€æ…‹æ›´æ–° â†’ å¿«å–åŒæ­¥
    â†“                                                              â†‘
éŒ¯èª¤è™•ç† â†  è³‡æ–™é©—è­‰  â†  æ¥­å‹™é‚è¼¯è™•ç†  â†  æ¨¡å¼å·®ç•°åŒ–  â†  æœ¬åœ°å¿«å–
```

---

## 2.0 åŠŸèƒ½éœ€æ±‚ï¼ˆFunctional Requirementsï¼‰

### 2.1 å¸³æˆ¶è³‡æ–™ç®¡ç†é‚è¼¯

#### 2.1.1 å¸³æˆ¶è³‡æ–™å‰µå»ºé‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šè™•ç†å¸³æˆ¶å‰µå»ºçš„å®Œæ•´æ¥­å‹™æµç¨‹ï¼ŒåŒ…å«APIèª¿ç”¨ã€è³‡æ–™é©—è­‰èˆ‡ç‹€æ…‹ç®¡ç†ã€‚

**æ ¸å¿ƒè™•ç†æµç¨‹**ï¼š
```
ç”¨æˆ¶è¼¸å…¥ â†’ å‰ç«¯é©—è­‰ â†’ æ ¼å¼åŒ–è™•ç† â†’ APL.accountèª¿ç”¨ â†’ BLå±¤è™•ç† â†’ å›æ‡‰è§£æ â†’ ç‹€æ…‹æ›´æ–° â†’ UIåé¥‹
```

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.1.1-01**ï¼šæ¥æ”¶ä½¿ç”¨è€…è¼¸å…¥çš„å¸³æˆ¶åŸºæœ¬è³‡è¨Šï¼ˆåç¨±ã€é¡å‹ã€åˆå§‹é¤˜é¡ã€å¹£åˆ¥ã€æè¿°ï¼‰
- **FR-2.1.1-02**ï¼šåŸ·è¡Œå‰ç«¯æ¥­å‹™é‚è¼¯é©—è­‰ï¼š
  - å¸³æˆ¶åç¨±ï¼š1-50å­—å…ƒï¼Œä¸å¯é‡è¤‡
  - å¸³æˆ¶é¡å‹ï¼šå¾é å®šç¾©æ¸…å–®é¸æ“‡ï¼ˆç¾é‡‘ã€éŠ€è¡Œå¡ã€ä¿¡ç”¨å¡ã€é›»å­éŒ¢åŒ…ï¼‰
  - åˆå§‹é¤˜é¡ï¼šæ•¸å€¼æ ¼å¼é©—è­‰ï¼Œå…è¨±è² å€¼ï¼ˆä¿¡ç”¨å¡ï¼‰
  - å¹£åˆ¥ï¼šæ”¯æ´å¤šå¹£åˆ¥é¸æ“‡ï¼Œé è¨­TWD
- **FR-2.1.1-03**ï¼šèª¿ç”¨APL.account.createAccount()é€²è¡Œå¾Œç«¯å‰µå»º
- **FR-2.1.1-04**ï¼šè™•ç†å‰µå»ºå›æ‡‰ä¸¦æ›´æ–°æœ¬åœ°ç‹€æ…‹ï¼š
  - æˆåŠŸï¼šæ›´æ–°å¸³æˆ¶æ¸…å–®ã€é¡¯ç¤ºæˆåŠŸè¨Šæ¯ã€è·³è½‰è‡³å¸³æˆ¶è©³æƒ…é 
  - å¤±æ•—ï¼šé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ã€ä¿ç•™è¡¨å–®è³‡æ–™ã€æä¾›é‡è©¦é¸é …

**å››æ¨¡å¼å·®ç•°åŒ–è™•ç†**ï¼š
- **Expertæ¨¡å¼**ï¼šå®Œæ•´è¡¨å–®æ¬„ä½ã€é€²éšè¨­å®šé¸é …ã€å¤šå¹£åˆ¥æ”¯æ´
- **Inertialæ¨¡å¼**ï¼šæ¨™æº–æ¬„ä½çµ„åˆã€é è¨­å€¼å¡«å……ã€å›ºå®šå¹£åˆ¥
- **Cultivationæ¨¡å¼**ï¼šå¼•å°å¼å¡«å¯«ã€é è¨­å»ºè­°ã€é€²åº¦æç¤º
- **Guidingæ¨¡å¼**ï¼šæ¥µç°¡æ¬„ä½ï¼ˆåƒ…åç¨±èˆ‡é¡å‹ï¼‰ã€è‡ªå‹•é è¨­å€¼

#### 2.1.2 å¸³æˆ¶è³‡æ–™æ›´æ–°é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šè™•ç†å¸³æˆ¶è³‡è¨Šä¿®æ”¹çš„æ¥­å‹™æµç¨‹ï¼Œç¢ºä¿è³‡æ–™ä¸€è‡´æ€§èˆ‡åŒæ­¥ã€‚

**æ ¸å¿ƒè™•ç†æµç¨‹**ï¼š
```
ç·¨è¼¯è§¸ç™¼ â†’ è¼‰å…¥ç¾æœ‰è³‡æ–™ â†’ ä¿®æ”¹è™•ç† â†’ è®Šæ›´é©—è­‰ â†’ APLèª¿ç”¨ â†’ ç‹€æ…‹åŒæ­¥ â†’ å¿«å–æ›´æ–°
```

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.1.2-01**ï¼šè¼‰å…¥ç¾æœ‰å¸³æˆ¶è³‡æ–™ä¸¦å¡«å…¥ç·¨è¼¯è¡¨å–®
- **FR-2.1.2-02**ï¼šåµæ¸¬è³‡æ–™è®Šæ›´ä¸¦åŸ·è¡Œå·®ç•°é©—è­‰
- **FR-2.1.2-03**ï¼šèª¿ç”¨APL.account.updateAccount()åŸ·è¡Œæ›´æ–°
- **FR-2.1.2-04**ï¼šè™•ç†æ›´æ–°çµæœä¸¦åŒæ­¥ç›¸é—œç‹€æ…‹ï¼š
  - å¸³æˆ¶æ¸…å–®ç‹€æ…‹æ›´æ–°
  - ç›¸é—œäº¤æ˜“è¨˜éŒ„çš„å¸³æˆ¶è³‡è¨Šæ›´æ–°
  - å¿«å–è³‡æ–™åŒæ­¥

#### 2.1.3 å¸³æˆ¶è³‡æ–™é©—è­‰é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç¢ºä¿å¸³æˆ¶è³‡æ–™çš„æ­£ç¢ºæ€§èˆ‡å®Œæ•´æ€§ï¼Œé˜²æ­¢ç„¡æ•ˆè³‡æ–™é€²å…¥ç³»çµ±ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.1.3-01**ï¼šå³æ™‚é©—è­‰æ©Ÿåˆ¶ï¼š
  - å¸³æˆ¶åç¨±é‡è¤‡æ€§æª¢æŸ¥ï¼ˆæœ¬åœ°å¿«å– + APIé©—è­‰ï¼‰
  - é¤˜é¡æ ¼å¼èˆ‡ç¯„åœé©—è­‰
  - å¿…å¡«æ¬„ä½å®Œæ•´æ€§æª¢æŸ¥
- **FR-2.1.3-02**ï¼šèª¿ç”¨APL.accountæœå‹™é€²è¡Œå¾Œç«¯é©—è­‰
- **FR-2.1.3-03**ï¼šé©—è­‰éŒ¯èª¤è™•ç†ï¼š
  - å³æ™‚é¡¯ç¤ºé©—è­‰éŒ¯èª¤è¨Šæ¯
  - é˜»æ­¢ç„¡æ•ˆè³‡æ–™æäº¤
  - æä¾›ä¿®æ­£å»ºè­°

#### 2.1.4 å¸³æˆ¶è³‡æ–™å¿«å–é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç®¡ç†å¸³æˆ¶è³‡æ–™çš„æœ¬åœ°å¿«å–ï¼Œæå‡ä½¿ç”¨è€…é«”é©—èˆ‡é›¢ç·šèƒ½åŠ›ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.1.4-01**ï¼šå¿«å–ç­–ç•¥å¯¦æ–½ï¼š
  - å¸³æˆ¶æ¸…å–®ï¼šè¼‰å…¥å¾Œå¿«å–60åˆ†é˜
  - å¸³æˆ¶è©³æƒ…ï¼šè¼‰å…¥å¾Œå¿«å–30åˆ†é˜
  - é¤˜é¡è³‡è¨Šï¼šè¼‰å…¥å¾Œå¿«å–10åˆ†é˜ï¼ˆé«˜é »æ›´æ–°ï¼‰
- **FR-2.1.4-02**ï¼šå¿«å–æ›´æ–°è§¸ç™¼æ¢ä»¶ï¼š
  - ä¸»å‹•åˆ·æ–°ï¼šä½¿ç”¨è€…ä¸‹æ‹‰åˆ·æ–°
  - è‡ªå‹•æ›´æ–°ï¼šèƒŒæ™¯å®šæ™‚åŒæ­¥ï¼ˆ15åˆ†é˜ï¼‰
  - äº‹ä»¶æ›´æ–°ï¼šå¸³æˆ¶ç›¸é—œæ“ä½œå¾Œç«‹å³æ›´æ–°
- **FR-2.1.4-03**ï¼šé›¢ç·šæ”¯æ´ï¼š
  - é›¢ç·šæ¨¡å¼ä¸‹é¡¯ç¤ºå¿«å–è³‡æ–™
  - é›¢ç·šæ“ä½œä½‡åˆ—æ©Ÿåˆ¶
  - ç¶²è·¯æ¢å¾©å¾Œè‡ªå‹•åŒæ­¥

#### 2.1.5 å¸³æˆ¶è³‡æ–™åŒæ­¥é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç¢ºä¿æœ¬åœ°è³‡æ–™èˆ‡é ç«¯è³‡æ–™çš„ä¸€è‡´æ€§ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.1.5-01**ï¼šåŒæ­¥è§¸ç™¼æ©Ÿåˆ¶ï¼š
  - APPå‰æ™¯æ™‚è‡ªå‹•æª¢æŸ¥æ›´æ–°
  - ä½¿ç”¨è€…ä¸»å‹•åˆ·æ–°
  - é‡è¦æ“ä½œå¾Œå¼·åˆ¶åŒæ­¥
- **FR-2.1.5-02**ï¼šè¡çªè§£æ±ºç­–ç•¥ï¼š
  - é ç«¯å„ªå…ˆï¼šä¸€èˆ¬è³‡æ–™æ›´æ–°
  - æœ¬åœ°å„ªå…ˆï¼šä½¿ç”¨è€…æ­£åœ¨ç·¨è¼¯çš„è³‡æ–™
  - åˆä½µç­–ç•¥ï¼šéè¡çªæ¬„ä½å€‹åˆ¥è™•ç†
- **FR-2.1.5-03**ï¼šåŒæ­¥ç‹€æ…‹ç®¡ç†ï¼š
  - åŒæ­¥é€²åº¦æŒ‡ç¤ºå™¨
  - åŒæ­¥ç‹€æ…‹è³‡è¨Šé¡¯ç¤º
  - åŒæ­¥å¤±æ•—é‡è©¦æ©Ÿåˆ¶

### 2.2 ç§‘ç›®éšå±¤ç®¡ç†é‚è¼¯

#### 2.2.1 ç§‘ç›®æ¨¹ç‹€çµæ§‹è™•ç†é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šè™•ç†ç§‘ç›®çš„éšå±¤é—œä¿‚ï¼Œç¶­è­·æ¨¹ç‹€çµæ§‹çš„å®Œæ•´æ€§èˆ‡ä¸€è‡´æ€§ã€‚

**æ ¸å¿ƒè™•ç†æµç¨‹**ï¼š
```
ç§‘ç›®è³‡æ–™è¼‰å…¥ â†’ éšå±¤é—œä¿‚è§£æ â†’ æ¨¹ç‹€çµæ§‹å»ºæ§‹ â†’ å±•é–‹/æ”¶åˆé‚è¼¯ â†’ æœå°‹/ç¯©é¸è™•ç†
```

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.2.1-01**ï¼šæ¨¹ç‹€çµæ§‹å»ºæ§‹ï¼š
  - å¾å¹³é¢ç§‘ç›®è³‡æ–™å»ºç«‹çˆ¶å­é—œä¿‚
  - æ”¯æ´æœ€å¤š3å±¤éšå±¤æ·±åº¦
  - è‡ªå‹•æ’åºï¼šé è¨­ç§‘ç›®å„ªå…ˆï¼Œè‡ªè¨‚ç§‘ç›®å…¶æ¬¡ï¼ŒæŒ‰ä½¿ç”¨é »ç‡æ’åº
- **FR-2.2.1-02**ï¼šæ¨¹ç‹€äº’å‹•é‚è¼¯ï¼š
  - å±•é–‹/æ”¶åˆç‹€æ…‹è¨˜æ†¶
  - çˆ¶ç¯€é»é¸æ“‡æ™‚é¡¯ç¤ºå­ç§‘ç›®é¸é …
  - å­ç§‘ç›®åå‘å°èˆªè‡³çˆ¶ç§‘ç›®
- **FR-2.2.1-03**ï¼šæœå°‹èˆ‡ç¯©é¸ï¼š
  - ç§‘ç›®åç¨±æ¨¡ç³Šæœå°‹
  - æ”¶æ”¯é¡å‹ç¯©é¸
  - ä½¿ç”¨é »ç‡ç¯©é¸
  - æœå°‹çµæœéšå±¤è·¯å¾‘é¡¯ç¤º

**å››æ¨¡å¼å·®ç•°åŒ–è™•ç†**ï¼š
- **Expertæ¨¡å¼**ï¼šå®Œæ•´æ¨¹ç‹€çµæ§‹ã€è‡ªè¨‚æ’åºã€é€²éšç¯©é¸
- **Inertialæ¨¡å¼**ï¼šå¸¸ç”¨ç§‘ç›®å¹³é‹ªé¡¯ç¤ºã€å›ºå®šæ’åº
- **Cultivationæ¨¡å¼**ï¼šæ™ºæ…§æ¨è–¦å„ªå…ˆã€ä½¿ç”¨å¼•å°
- **Guidingæ¨¡å¼**ï¼šåŸºæœ¬ç§‘ç›®æ¸…å–®ã€æœ€ç°¡é¸æ“‡

#### 2.2.2 ç§‘ç›®éšå±¤åŒæ­¥é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç¢ºä¿ç§‘ç›®éšå±¤è³‡æ–™çš„åŒæ­¥æ€§ï¼Œè™•ç†éšå±¤é—œä¿‚è®Šæ›´ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.2.2-01**ï¼šéšå±¤åŒæ­¥ç­–ç•¥ï¼š
  - å®Œæ•´æ¨¹ç‹€çµæ§‹é‡å»ºï¼šåˆæ¬¡è¼‰å…¥æˆ–é‡å¤§è®Šæ›´
  - å¢é‡æ›´æ–°ï¼šå–®ä¸€ç§‘ç›®è®Šæ›´
  - é—œä¿‚ä¿®å¾©ï¼šç™¼ç¾è³‡æ–™ä¸ä¸€è‡´æ™‚çš„è‡ªå‹•ä¿®å¾©
- **FR-2.2.2-02**ï¼šåŒæ­¥è¡çªè™•ç†ï¼š
  - éšå±¤è¿´åœˆæª¢æ¸¬èˆ‡ä¿®å¾©
  - å­¤å…’ç§‘ç›®çš„é‡æ–°æ­¸é¡
  - é‡è¤‡ç§‘ç›®çš„åˆä½µè™•ç†
- **FR-2.2.2-03**ï¼šåŒæ­¥æ•ˆèƒ½å„ªåŒ–ï¼š
  - å·®ç•°æ¯”è¼ƒæ¼”ç®—æ³•
  - æ‰¹é‡æ›´æ–°è™•ç†
  - èƒŒæ™¯åŒæ­¥æ©Ÿåˆ¶

#### 2.2.3 ç§‘ç›®é—œä¿‚é©—è­‰é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šé©—è­‰ç§‘ç›®éšå±¤é—œä¿‚çš„é‚è¼¯æ­£ç¢ºæ€§ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.2.3-01**ï¼šéšå±¤é—œä¿‚é©—è­‰ï¼š
  - çˆ¶å­é—œä¿‚åˆç†æ€§æª¢æŸ¥
  - è¿´åœˆå¼•ç”¨æª¢æ¸¬
  - æ·±åº¦é™åˆ¶é©—è­‰ï¼ˆæœ€å¤š3å±¤ï¼‰
- **FR-2.2.3-02**ï¼šæ¥­å‹™é‚è¼¯é©—è­‰ï¼š
  - æ”¶æ”¯é¡å‹ä¸€è‡´æ€§ï¼šå­ç§‘ç›®å¿…é ˆèˆ‡çˆ¶ç§‘ç›®é¡å‹ç›¸åŒ
  - ç§‘ç›®åç¨±å”¯ä¸€æ€§ï¼šåŒå±¤ç´šç§‘ç›®åç¨±ä¸å¯é‡è¤‡
  - é è¨­ç§‘ç›®ä¿è­·ï¼šç³»çµ±é è¨­ç§‘ç›®ä¸å¯åˆªé™¤æˆ–ä¿®æ”¹éšå±¤

#### 2.2.4 ç§‘ç›®è³‡æ–™å¿«å–é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç®¡ç†ç§‘ç›®æ¨¹ç‹€çµæ§‹çš„å¿«å–èˆ‡æ›´æ–°ç­–ç•¥ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.2.4-01**ï¼šåˆ†å±¤å¿«å–ç­–ç•¥ï¼š
  - å®Œæ•´ç§‘ç›®æ¨¹ï¼šå¿«å–120åˆ†é˜
  - å¸¸ç”¨ç§‘ç›®æ¸…å–®ï¼šå¿«å–60åˆ†é˜
  - ä½¿ç”¨çµ±è¨ˆè³‡æ–™ï¼šå¿«å–30åˆ†é˜
- **FR-2.2.4-02**ï¼šæ™ºæ…§é è¼‰æ©Ÿåˆ¶ï¼š
  - è¨˜å¸³é é¢é è¼‰å¸¸ç”¨ç§‘ç›®
  - èƒŒæ™¯é è¼‰å®Œæ•´ç§‘ç›®æ¨¹
  - é æ¸¬æ€§è¼‰å…¥ï¼šåŸºæ–¼ä½¿ç”¨ç¿’æ…£é è¼‰å¯èƒ½ä½¿ç”¨çš„ç§‘ç›®

### 2.3 å¸³æˆ¶é¤˜é¡è¨ˆç®—é‚è¼¯

#### 2.3.1 å³æ™‚é¤˜é¡è¨ˆç®—é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šæä¾›æº–ç¢ºçš„å¸³æˆ¶é¤˜é¡è¨ˆç®—èˆ‡é¡¯ç¤ºåŠŸèƒ½ã€‚

**æ ¸å¿ƒè™•ç†æµç¨‹**ï¼š
```
é¤˜é¡æŸ¥è©¢è§¸ç™¼ â†’ å¿«å–æª¢æŸ¥ â†’ APLèª¿ç”¨ â†’ è¨ˆç®—è™•ç† â†’ æ ¼å¼åŒ–é¡¯ç¤º â†’ å¿«å–æ›´æ–°
```

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.3.1-01**ï¼šé¤˜é¡è¨ˆç®—æ¨¡å¼ï¼š
  - å³æ™‚è¨ˆç®—ï¼šèª¿ç”¨APL.account.getAccountBalance()å–å¾—æœ€æ–°é¤˜é¡
  - å¿«é€Ÿé¡¯ç¤ºï¼šå„ªå…ˆé¡¯ç¤ºå¿«å–é¤˜é¡ï¼ŒèƒŒæ™¯æ›´æ–°æœ€æ–°å€¼
  - å·®ç•°æç¤ºï¼šå¿«å–èˆ‡æœ€æ–°å€¼å·®ç•°è¶…éé–¾å€¼æ™‚çš„æç¤ºæ©Ÿåˆ¶
- **FR-2.3.1-02**ï¼šå¤šå¹£åˆ¥è™•ç†ï¼š
  - åŸå¹£åˆ¥é¡¯ç¤ºï¼šé¡¯ç¤ºå¸³æˆ¶åŸå§‹å¹£åˆ¥é¤˜é¡
  - æ›ç®—é¡¯ç¤ºï¼šæä¾›ä¸»è¦å¹£åˆ¥ï¼ˆTWDï¼‰æ›ç®—é‡‘é¡
  - åŒ¯ç‡æ›´æ–°ï¼šå®šæœŸæ›´æ–°åŒ¯ç‡è³‡æ–™
- **FR-2.3.1-03**ï¼šé¤˜é¡é¡¯ç¤ºé‚è¼¯ï¼š
  - æ ¼å¼åŒ–é¡¯ç¤ºï¼šåƒåˆ†ä½ç¬¦è™Ÿã€å°æ•¸é»è™•ç†
  - è² å€¼é¡¯ç¤ºï¼šç´…è‰²é¡¯ç¤ºè² é¤˜é¡ï¼Œç‰¹æ®Šæ¨™ç¤º
  - éš±ç§æ¨¡å¼ï¼šæ”¯æ´é¤˜é¡éš±è—åŠŸèƒ½

#### 2.3.2 é¤˜é¡å¿«å–æ›´æ–°é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç®¡ç†å¸³æˆ¶é¤˜é¡çš„å¿«å–ç­–ç•¥ï¼Œå¹³è¡¡æº–ç¢ºæ€§èˆ‡æ•ˆèƒ½ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.3.2-01**ï¼šå¿«å–æ›´æ–°è§¸ç™¼ï¼š
  - äº¤æ˜“å®Œæˆå¾Œç«‹å³æ›´æ–°ç›¸é—œå¸³æˆ¶é¤˜é¡
  - å®šæ™‚èƒŒæ™¯æ›´æ–°ï¼ˆæ¯10åˆ†é˜ï¼‰
  - ä½¿ç”¨è€…ä¸»å‹•åˆ·æ–°
- **FR-2.3.2-02**ï¼šå¿«å–ç­–ç•¥ï¼š
  - çŸ­æœŸå¿«å–ï¼š5åˆ†é˜å…§ç›´æ¥ä½¿ç”¨å¿«å–å€¼
  - ä¸­æœŸå¿«å–ï¼š5-15åˆ†é˜é¡¯ç¤ºå¿«å–å€¼ä½†èƒŒæ™¯æ›´æ–°
  - é•·æœŸå¿«å–ï¼šè¶…é15åˆ†é˜å¼·åˆ¶é‡æ–°è¼‰å…¥
- **FR-2.3.2-03**ï¼šæ›´æ–°å„ªå…ˆç´šï¼š
  - é«˜å„ªå…ˆç´šï¼šç•¶å‰æª¢è¦–çš„å¸³æˆ¶
  - ä¸­å„ªå…ˆç´šï¼šæœ€è¿‘ä½¿ç”¨çš„å¸³æˆ¶
  - ä½å„ªå…ˆç´šï¼šå…¶ä»–æ‰€æœ‰å¸³æˆ¶

#### 2.3.3 é¤˜é¡ä¸€è‡´æ€§æª¢æŸ¥é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç¢ºä¿é¤˜é¡è³‡æ–™çš„æº–ç¢ºæ€§èˆ‡ä¸€è‡´æ€§ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.3.3-01**ï¼šä¸€è‡´æ€§æª¢æŸ¥æ©Ÿåˆ¶ï¼š
  - å®šæœŸæ ¡é©—ï¼šæ¯æ—¥èƒŒæ™¯æª¢æŸ¥é¤˜é¡ä¸€è‡´æ€§
  - å³æ™‚æª¢æŸ¥ï¼šé‡è¦æ“ä½œå¾Œçš„å³æ™‚æ ¡é©—
  - ç•°å¸¸åµæ¸¬ï¼šé¤˜é¡ç•°å¸¸è®Šå‹•çš„è‡ªå‹•åµæ¸¬
- **FR-2.3.3-02**ï¼šä¸ä¸€è‡´è™•ç†ï¼š
  - è‡ªå‹•ä¿®å¾©ï¼šå°é¡å·®ç•°çš„è‡ªå‹•èª¿æ•´
  - è­¦ç¤ºæé†’ï¼šå¤§é¡å·®ç•°çš„ä½¿ç”¨è€…æé†’
  - æ‰‹å‹•ç¢ºèªï¼šé‡å¤§ä¸ä¸€è‡´çš„æ‰‹å‹•ç¢ºèªæ©Ÿåˆ¶

### 2.4 ç§‘ç›®ä½¿ç”¨çµ±è¨ˆé‚è¼¯

#### 2.4.1 ä½¿ç”¨é »ç‡åˆ†æé‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šåˆ†æä½¿ç”¨è€…çš„ç§‘ç›®ä½¿ç”¨æ¨¡å¼ï¼Œæä¾›å€‹äººåŒ–é«”é©—ã€‚

**æ ¸å¿ƒè™•ç†æµç¨‹**ï¼š
```
äº¤æ˜“è¨˜éŒ„ â†’ ç§‘ç›®ä½¿ç”¨è¿½è¹¤ â†’ é »ç‡çµ±è¨ˆè¨ˆç®— â†’ æ’åºæ’å â†’ æ¨è–¦é‚è¼¯ â†’ é¡¯ç¤ºå„ªåŒ–
```

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.4.1-01**ï¼šçµ±è¨ˆè³‡æ–™æ”¶é›†ï¼š
  - è¨˜éŒ„æ¯æ¬¡ç§‘ç›®é¸æ“‡è¡Œç‚º
  - è¿½è¹¤ç§‘ç›®ä½¿ç”¨çš„æ™‚é–“åˆ†å¸ƒ
  - çµ±è¨ˆç§‘ç›®èˆ‡é‡‘é¡çš„é—œè¯æ€§
- **FR-2.4.1-02**ï¼šé »ç‡è¨ˆç®—æ¼”ç®—æ³•ï¼š
  - æ™‚é–“åŠ æ¬Šï¼šè¿‘æœŸä½¿ç”¨çµ¦äºˆæ›´é«˜æ¬Šé‡
  - é »æ¬¡çµ±è¨ˆï¼šè¨ˆç®—çµ•å°ä½¿ç”¨æ¬¡æ•¸
  - é‡‘é¡æ¬Šé‡ï¼šé«˜é‡‘é¡äº¤æ˜“çµ¦äºˆé¡å¤–æ¬Šé‡
- **FR-2.4.1-03**ï¼šçµ±è¨ˆé€±æœŸç®¡ç†ï¼š
  - çŸ­æœŸçµ±è¨ˆï¼šæœ€è¿‘7å¤©çš„ä½¿ç”¨æ¨¡å¼
  - ä¸­æœŸçµ±è¨ˆï¼šæœ€è¿‘30å¤©çš„ä½¿ç”¨æ¨¡å¼
  - é•·æœŸçµ±è¨ˆï¼šæœ€è¿‘180å¤©çš„ä½¿ç”¨æ¨¡å¼

#### 2.4.2 æ™ºæ…§æ¨è–¦é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šåŸºæ–¼ä½¿ç”¨çµ±è¨ˆæä¾›æ™ºæ…§ç§‘ç›®æ¨è–¦åŠŸèƒ½ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.4.2-01**ï¼šæ¨è–¦æ¼”ç®—æ³•ï¼š
  - æ™‚é–“æ¨¡å¼ï¼šåŸºæ–¼è¨˜å¸³æ™‚é–“æ¨è–¦å¸¸ç”¨ç§‘ç›®
  - é‡‘é¡æ¨¡å¼ï¼šåŸºæ–¼äº¤æ˜“é‡‘é¡æ¨è–¦ç›¸ä¼¼ç§‘ç›®
  - çµ„åˆæ¨¡å¼ï¼šåŸºæ–¼ç§‘ç›®çµ„åˆä½¿ç”¨æ¨¡å¼æ¨è–¦
- **FR-2.4.2-02**ï¼šæ¨è–¦é¡¯ç¤ºé‚è¼¯ï¼š
  - å¿«é€Ÿé¸æ“‡ï¼šåœ¨ç§‘ç›®é¸æ“‡é é¢é ‚éƒ¨é¡¯ç¤ºæ¨è–¦ç§‘ç›®
  - æ™ºæ…§é å¡«ï¼šåŸºæ–¼é‡‘é¡æˆ–æè¿°è‡ªå‹•æ¨è–¦ç§‘ç›®
  - å­¸ç¿’é©æ‡‰ï¼šæ ¹æ“šä½¿ç”¨è€…æ¥å—åº¦èª¿æ•´æ¨è–¦ç­–ç•¥
- **FR-2.4.2-03**ï¼šå››æ¨¡å¼å·®ç•°åŒ–æ¨è–¦ï¼š
  - **Expertæ¨¡å¼**ï¼šè¤‡é›œæ¨è–¦æ¼”ç®—æ³•ã€å¤šç¶­åº¦åˆ†æ
  - **Inertialæ¨¡å¼**ï¼šå›ºå®šæ¨è–¦æ¸…å–®ã€ç©©å®šæ’åº
  - **Cultivationæ¨¡å¼**ï¼šå¼•å°å¼æ¨è–¦ã€ç¿’æ…£é¤Šæˆå»ºè­°
  - **Guidingæ¨¡å¼**ï¼šå–®ä¸€æœ€ä½³æ¨è–¦ã€æ¥µç°¡é¸æ“‡

#### 2.4.3 çµ±è¨ˆè³‡æ–™å¿«å–é‚è¼¯
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç®¡ç†çµ±è¨ˆè³‡æ–™çš„å¿«å–èˆ‡æ›´æ–°ç­–ç•¥ã€‚

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.4.3-01**ï¼šçµ±è¨ˆå¿«å–ç­–ç•¥ï¼š
  - é »ç‡çµ±è¨ˆï¼šå¿«å–30åˆ†é˜ï¼ŒèƒŒæ™¯æ›´æ–°
  - æ¨è–¦çµæœï¼šå¿«å–60åˆ†é˜ï¼Œäº¤æ˜“å¾Œæ›´æ–°
  - ä½¿ç”¨æ¨¡å¼ï¼šå¿«å–24å°æ™‚ï¼Œå®šæ™‚æ›´æ–°
- **FR-2.4.3-02**ï¼šå¢é‡æ›´æ–°æ©Ÿåˆ¶ï¼š
  - æ–°äº¤æ˜“è¨˜éŒ„æ™‚å¢é‡æ›´æ–°çµ±è¨ˆ
  - é¿å…å…¨é‡é‡ç®—ï¼Œæå‡æ•ˆèƒ½
  - æ‰¹é‡è™•ç†å¤šç­†äº¤æ˜“çš„çµ±è¨ˆæ›´æ–°

### 2.5 å››æ¨¡å¼å·®ç•°åŒ–æ¥­å‹™é‚è¼¯è™•ç†

#### 2.5.1 Expertæ¨¡å¼æ¥­å‹™é‚è¼¯
**ç›®æ¨™ä½¿ç”¨è€…**ï¼šéœ€è¦å®Œæ•´åŠŸèƒ½æ§åˆ¶çš„é€²éšä½¿ç”¨è€…
**æ¥­å‹™é‚è¼¯ç‰¹è‰²**ï¼šå®Œæ•´åŠŸèƒ½ã€æ·±åº¦è¨­å®šã€å°ˆæ¥­åˆ†æ

**å…·é«”æ¥­å‹™é‚è¼¯éœ€æ±‚**ï¼š
- **FR-2.5.1-01**ï¼šå®Œæ•´è³‡æ–™è™•ç†ï¼š
  - å¸³æˆ¶ç®¡ç†ï¼šæ”¯æ´æ‰€æœ‰å¸³æˆ¶é¡å‹ã€å¤šå¹£åˆ¥ã€è©³ç´°è¨­å®š
  - ç§‘ç›®ç®¡ç†ï¼šå®Œæ•´éšå±¤çµæ§‹ã€è‡ªè¨‚åˆ†é¡ã€é€²éšç¯©é¸
  - çµ±è¨ˆåˆ†æï¼šè©³ç´°ä½¿ç”¨çµ±è¨ˆã€è¶¨å‹¢åˆ†æã€å€‹äººåŒ–æ´å¯Ÿ
- **FR-2.5.1-02**ï¼šé€²éšåŠŸèƒ½å•Ÿç”¨ï¼š
  - æ‰¹é‡æ“ä½œï¼šæ‰¹é‡å»ºç«‹ã€ç·¨è¼¯ã€åˆªé™¤åŠŸèƒ½
  - åŒ¯å…¥åŒ¯å‡ºï¼šæ”¯æ´è³‡æ–™åŒ¯å…¥åŒ¯å‡ºåŠŸèƒ½
  - è‡ªè¨‚è¦å‰‡ï¼šè‡ªè¨‚åˆ†é¡è¦å‰‡ã€è‡ªå‹•åŒ–é‚è¼¯
- **FR-2.5.1-03**ï¼šæ•ˆèƒ½æœ€ä½³åŒ–ï¼š
  - é è¼‰æ©Ÿåˆ¶ï¼šé è¼‰æ‰€æœ‰ç›¸é—œè³‡æ–™
  - ä¸¦è¡Œè™•ç†ï¼šæ”¯æ´å¤šå·¥è™•ç†è¤‡é›œæ“ä½œ
  - å¿«å–ç­–ç•¥ï¼šé•·æ™‚é–“å¿«å–ä»¥æ”¯æ´å¿«é€Ÿå­˜å–

#### 2.5.2 Inertialæ¨¡å¼æ¥­å‹™é‚è¼¯
**ç›®æ¨™ä½¿ç”¨è€…**ï¼šç¿’æ…£å›ºå®šæµç¨‹çš„ç©©å®šä½¿ç”¨è€…
**æ¥­å‹™é‚è¼¯ç‰¹è‰²**ï¼šå›ºå®šæµç¨‹ã€ä¸€è‡´é«”é©—ã€ç©©å®šä»‹é¢

**å…·é«”æ¥­å‹™é‚è¼¯éœ€æ±‚**ï¼š
- **FR-2.5.2-01**ï¼šæ¨™æº–åŒ–è™•ç†æµç¨‹ï¼š
  - å›ºå®šæ“ä½œæµç¨‹ï¼šæ¨™æº–åŒ–çš„æ“ä½œæ­¥é©Ÿï¼Œé¿å…è®ŠåŒ–
  - é è¨­å€¼å„ªå…ˆï¼šå¤§é‡ä½¿ç”¨é è¨­å€¼ï¼Œæ¸›å°‘é¸æ“‡
  - ä¸€è‡´æ€§ä¿è­‰ï¼šä»‹é¢èˆ‡æµç¨‹ä¿æŒé«˜åº¦ä¸€è‡´æ€§
- **FR-2.5.2-02**ï¼šç©©å®šåŠŸèƒ½é›†åˆï¼š
  - æ ¸å¿ƒåŠŸèƒ½ï¼šåƒ…æä¾›æ ¸å¿ƒå¸³æˆ¶èˆ‡ç§‘ç›®ç®¡ç†åŠŸèƒ½
  - ç°¡åŒ–é¸é …ï¼šæ¸›å°‘è¨­å®šé¸é …ï¼Œæä¾›æ¨™æº–é…ç½®
  - ç¶“å…¸ä»‹é¢ï¼šä½¿ç”¨å‚³çµ±ã€ç©©å®šçš„ä»‹é¢è¨­è¨ˆ
- **FR-2.5.2-03**ï¼šå¯é æ¸¬è¡Œç‚ºï¼š
  - å›ºå®šæ’åºï¼šå¸³æˆ¶èˆ‡ç§‘ç›®ä½¿ç”¨å›ºå®šæ’åºé‚è¼¯
  - ç©©å®šæ¨è–¦ï¼šæ¨è–¦çµæœä¿æŒç©©å®šï¼Œé¿å…é »ç¹è®ŠåŒ–
  - ä¸€è‡´å›é¥‹ï¼šæ“ä½œå›é¥‹ä¿æŒä¸€è‡´çš„æ ¼å¼èˆ‡å…§å®¹

#### 2.5.3 Cultivationæ¨¡å¼æ¥­å‹™é‚è¼¯
**ç›®æ¨™ä½¿ç”¨è€…**ï¼šéœ€è¦ç¿’æ…£é¤Šæˆèˆ‡æ¿€å‹µæ©Ÿåˆ¶çš„æˆé•·ä½¿ç”¨è€…
**æ¥­å‹™é‚è¼¯ç‰¹è‰²**ï¼šå¼•å°å­¸ç¿’ã€é€²åº¦è¿½è¹¤ã€æ¿€å‹µå›é¥‹

**å…·é«”æ¥­å‹™é‚è¼¯éœ€æ±‚**ï¼š
- **FR-2.5.3-01**ï¼šå¼•å°å¼å­¸ç¿’é‚è¼¯ï¼š
  - æ­¥é©Ÿå¼•å°ï¼šåˆ†æ­¥é©Ÿå¼•å°è¤‡é›œæ“ä½œ
  - æç¤ºç³»çµ±ï¼šé©æ™‚æä¾›æ“ä½œæç¤ºèˆ‡å»ºè­°
  - å­¸ç¿’è¿½è¹¤ï¼šè¿½è¹¤ä½¿ç”¨è€…å­¸ç¿’é€²åº¦èˆ‡ç†Ÿç·´åº¦
- **FR-2.5.3-02**ï¼šç¿’æ…£é¤Šæˆæ©Ÿåˆ¶ï¼š
  - ç›®æ¨™è¨­å®šï¼šè¨­å®šå¸³æˆ¶èˆ‡ç§‘ç›®ç®¡ç†ç›®æ¨™
  - é€²åº¦è¿½è¹¤ï¼šè¦–è¦ºåŒ–é¡¯ç¤ºç›®æ¨™é”æˆé€²åº¦
  - æˆå°±ç³»çµ±ï¼šå®Œæˆç‰¹å®šä»»å‹™ç²å¾—æˆå°±çå‹µ
- **FR-2.5.3-03**ï¼šæ™ºæ…§å»ºè­°ç³»çµ±ï¼š
  - å€‹äººåŒ–å»ºè­°ï¼šåŸºæ–¼ä½¿ç”¨ç¿’æ…£æä¾›æ”¹å–„å»ºè­°
  - æœ€ä½³å¯¦å‹™ï¼šæ¨è–¦æ¥­ç•Œæœ€ä½³å¯¦å‹™åšæ³•
  - é€±æœŸå›é¡§ï¼šå®šæœŸæä¾›ä½¿ç”¨æƒ…æ³å›é¡§èˆ‡å»ºè­°

#### 2.5.4 Guidingæ¨¡å¼æ¥­å‹™é‚è¼¯
**ç›®æ¨™ä½¿ç”¨è€…**ï¼šéœ€è¦æ¥µç°¡ä»‹é¢èˆ‡è‡ªå‹•åŒ–è™•ç†çš„å…¥é–€ä½¿ç”¨è€…
**æ¥­å‹™é‚è¼¯ç‰¹è‰²**ï¼šæ¥µç°¡æ“ä½œã€è‡ªå‹•è™•ç†ã€è¢«å‹•å¼•å°

**å…·é«”æ¥­å‹™é‚è¼¯éœ€æ±‚**ï¼š
- **FR-2.5.4-01**ï¼šæ¥µç°¡æ“ä½œé‚è¼¯ï¼š
  - æœ€å°‘è¼¸å…¥ï¼šåƒ…è¦æ±‚å¿…è¦è³‡è¨Šè¼¸å…¥
  - è‡ªå‹•é è¨­ï¼šå¤§é‡ä½¿ç”¨æ™ºæ…§é è¨­å€¼
  - å–®æ­¥æ“ä½œï¼šé¿å…è¤‡é›œçš„å¤šæ­¥é©Ÿæ“ä½œæµç¨‹
- **FR-2.5.4-02**ï¼šè‡ªå‹•åŒ–è™•ç†ï¼š
  - æ™ºæ…§åˆ†é¡ï¼šè‡ªå‹•æ¨è–¦æœ€ä½³ç§‘ç›®é¸æ“‡
  - é è¨­å¸³æˆ¶ï¼šè‡ªå‹•é¸æ“‡æœ€å¸¸ç”¨å¸³æˆ¶
  - è‡ªå‹•å®Œæˆï¼šè‡ªå‹•å®Œæˆé‡è¤‡æ€§æ“ä½œ
- **FR-2.5.4-03**ï¼šè¢«å‹•å¼•å°ç³»çµ±ï¼š
  - ä¸Šä¸‹æ–‡æç¤ºï¼šåœ¨é©ç•¶æ™‚æ©Ÿæä¾›å¿…è¦æç¤º
  - éŒ¯èª¤é é˜²ï¼šé é˜²æ€§æª¢æŸ¥é¿å…ä½¿ç”¨è€…çŠ¯éŒ¯
  - ç°¡åŒ–å›é¥‹ï¼šæä¾›ç°¡æ½”æ˜ç¢ºçš„æ“ä½œå›é¥‹

### 2.6 æœ¬åœ°è³‡æ–™å¿«å–èˆ‡åŒæ­¥é‚è¼¯

#### 2.6.1 æœ¬åœ°å¿«å–æ©Ÿåˆ¶
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šæä¾›é«˜æ•ˆçš„æœ¬åœ°è³‡æ–™å¿«å–ç­–ç•¥ï¼Œç¢ºä¿è‰¯å¥½çš„ä½¿ç”¨è€…é«”é©—ã€‚

**æ ¸å¿ƒå¿«å–æ¶æ§‹**ï¼š
```
è¨˜æ†¶é«”å¿«å–å±¤ (Hot Cache) â†’ æŒä¹…åŒ–å¿«å–å±¤ (Warm Cache) â†’ é ç«¯è³‡æ–™å±¤ (Cold Data)
```

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.6.1-01**ï¼šå¤šå±¤å¿«å–ç­–ç•¥ï¼š
  - **L1è¨˜æ†¶é«”å¿«å–**ï¼šå­˜æ”¾ç•¶å‰é é¢è³‡æ–™ï¼ŒAPPç”Ÿå‘½é€±æœŸå…§æœ‰æ•ˆ
  - **L2æœ¬åœ°å„²å­˜å¿«å–**ï¼šå­˜æ”¾å¸¸ç”¨è³‡æ–™ï¼Œè·¨APPå•Ÿå‹•æœ‰æ•ˆ
  - **L3é›¢ç·šå¿«å–**ï¼šå­˜æ”¾é—œéµè³‡æ–™ï¼Œæ”¯æ´é›¢ç·šæ“ä½œ
- **FR-2.6.1-02**ï¼šå¿«å–è³‡æ–™åˆ†ç´šï¼š
  - **ç†±é»è³‡æ–™**ï¼šå¸³æˆ¶æ¸…å–®ã€å¸¸ç”¨ç§‘ç›®ï¼ˆè¨˜æ†¶é«”å¿«å–ï¼‰
  - **æº«è³‡æ–™**ï¼šå®Œæ•´ç§‘ç›®æ¨¹ã€é¤˜é¡è³‡è¨Šï¼ˆæœ¬åœ°å„²å­˜å¿«å–ï¼‰
  - **å†·è³‡æ–™**ï¼šæ­·å²çµ±è¨ˆã€è©³ç´°è¨­å®šï¼ˆé›¢ç·šå¿«å–ï¼‰
- **FR-2.6.1-03**ï¼šå¿«å–ç”Ÿå‘½é€±æœŸç®¡ç†ï¼š
  - è‡ªå‹•éæœŸï¼šæ ¹æ“šè³‡æ–™é¡å‹è¨­å®šä¸åŒéæœŸæ™‚é–“
  - ä¸»å‹•æ¸…ç†ï¼šè¨˜æ†¶é«”ä¸è¶³æ™‚çš„å¿«å–æ¸…ç†æ©Ÿåˆ¶
  - æ‰‹å‹•åˆ·æ–°ï¼šä½¿ç”¨è€…è§¸ç™¼çš„å¼·åˆ¶æ›´æ–°æ©Ÿåˆ¶

#### 2.6.2 è³‡æ–™åŒæ­¥ç­–ç•¥
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šç¢ºä¿æœ¬åœ°è³‡æ–™èˆ‡é ç«¯è³‡æ–™çš„ä¸€è‡´æ€§èˆ‡åŒæ­¥æ€§ã€‚

**åŒæ­¥è§¸ç™¼æ©Ÿåˆ¶**ï¼š
- **å³æ™‚åŒæ­¥**ï¼šé—œéµæ“ä½œï¼ˆå»ºç«‹ã€ä¿®æ”¹ã€åˆªé™¤ï¼‰å¾Œç«‹å³åŒæ­¥
- **å®šæ™‚åŒæ­¥**ï¼šèƒŒæ™¯å®šæ™‚æª¢æŸ¥èˆ‡åŒæ­¥ï¼ˆ15åˆ†é˜é–“éš”ï¼‰
- **äº‹ä»¶åŒæ­¥**ï¼šAPPå•Ÿå‹•ã€ç¶²è·¯æ¢å¾©ã€ä½¿ç”¨è€…ä¸»å‹•åˆ·æ–°è§¸ç™¼

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.6.2-01**ï¼šåŒæ­¥ç­–ç•¥åˆ†é¡ï¼š
  - **å¼·ä¸€è‡´æ€§åŒæ­¥**ï¼šå¸³æˆ¶é¤˜é¡ã€é‡è¦è¨­å®šè®Šæ›´
  - **æœ€çµ‚ä¸€è‡´æ€§åŒæ­¥**ï¼šä½¿ç”¨çµ±è¨ˆã€ç§‘ç›®æ’åº
  - **è¡çªè§£æ±ºåŒæ­¥**ï¼šä½µç™¼ä¿®æ”¹æ™‚çš„è¡çªè™•ç†
- **FR-2.6.2-02**ï¼šå¢é‡åŒæ­¥æ©Ÿåˆ¶ï¼š
  - è®Šæ›´è¿½è¹¤ï¼šè¿½è¹¤æœ¬åœ°è³‡æ–™è®Šæ›´è¨˜éŒ„
  - å·®ç•°æ¯”è¼ƒï¼šæ¯”è¼ƒæœ¬åœ°èˆ‡é ç«¯è³‡æ–™å·®ç•°
  - æœ€å°åŒ–å‚³è¼¸ï¼šåƒ…åŒæ­¥è®Šæ›´çš„è³‡æ–™æ¬„ä½
- **FR-2.6.2-03**ï¼šåŒæ­¥ç‹€æ…‹ç®¡ç†ï¼š
  - åŒæ­¥é€²åº¦è¿½è¹¤ï¼šé¡¯ç¤ºåŒæ­¥é€²åº¦èˆ‡ç‹€æ…‹
  - å¤±æ•—é‡è©¦æ©Ÿåˆ¶ï¼šç¶²è·¯å¤±æ•—æ™‚çš„è‡ªå‹•é‡è©¦
  - è¡çªé€šçŸ¥ï¼šè³‡æ–™è¡çªæ™‚çš„ä½¿ç”¨è€…é€šçŸ¥

#### 2.6.3 è¡çªè§£æ±ºæ©Ÿåˆ¶
**æ¥­å‹™é‚è¼¯è·è²¬**ï¼šè™•ç†æœ¬åœ°èˆ‡é ç«¯è³‡æ–™è¡çªï¼Œç¢ºä¿è³‡æ–™å®Œæ•´æ€§ã€‚

**è¡çªåµæ¸¬æ©Ÿåˆ¶**ï¼š
- **æ™‚é–“æˆ³æ¯”è¼ƒ**ï¼šåŸºæ–¼æœ€å¾Œä¿®æ”¹æ™‚é–“åˆ¤æ–·è³‡æ–™æ–°èˆŠ
- **ç‰ˆæœ¬è™Ÿæ§åˆ¶**ï¼šä½¿ç”¨ç‰ˆæœ¬è™Ÿè¿½è¹¤è³‡æ–™è®Šæ›´
- **é›œæ¹Šæ¯”è¼ƒ**ï¼šæ¯”è¼ƒè³‡æ–™å…§å®¹é›œæ¹Šå€¼åµæ¸¬è®Šæ›´

**å…·é«”åŠŸèƒ½éœ€æ±‚**ï¼š
- **FR-2.6.3-01**ï¼šè‡ªå‹•è¡çªè§£æ±ºï¼š
  - **é ç«¯å„ªå…ˆ**ï¼šç³»çµ±è¨­å®šã€å¸³æˆ¶åŸºæœ¬è³‡è¨Šå„ªå…ˆä½¿ç”¨é ç«¯ç‰ˆæœ¬
  - **æœ¬åœ°å„ªå…ˆ**ï¼šä½¿ç”¨è€…æ­£åœ¨ç·¨è¼¯çš„è³‡æ–™å„ªå…ˆä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬
  - **æ™‚é–“å„ªå…ˆ**ï¼šæ ¹æ“šæœ€å¾Œä¿®æ”¹æ™‚é–“é¸æ“‡è¼ƒæ–°ç‰ˆæœ¬
- **FR-2.6.3-02**ï¼šæ‰‹å‹•è¡çªè§£æ±ºï¼š
  - **è¡çªæé†’**ï¼šåµæ¸¬åˆ°è¡çªæ™‚æé†’ä½¿ç”¨è€…é¸æ“‡
  - **ç‰ˆæœ¬æ¯”è¼ƒ**ï¼šä¸¦åˆ—é¡¯ç¤ºè¡çªç‰ˆæœ¬ä¾›ä½¿ç”¨è€…æ¯”è¼ƒ
  - **åˆä½µé¸é …**ï¼šæä¾›æ¬„ä½ç´šåˆ¥çš„åˆä½µé¸æ“‡
- **FR-2.6.3-03**ï¼šè¡çªé é˜²æ©Ÿåˆ¶ï¼š
  - **æ¨‚è§€é–å®š**ï¼šä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶é é˜²ä½µç™¼è¡çª
  - **æ“ä½œåºåˆ—åŒ–**ï¼šé—œéµæ“ä½œæ¡ç”¨åºåˆ—åŒ–è™•ç†
  - **è¡çªå‘Šè­¦**ï¼šé è­¦å¯èƒ½ç™¼ç”Ÿè¡çªçš„æ“ä½œ

---

## 3.0 è¼¸å…¥/è¼¸å‡ºè¦æ ¼ï¼ˆInput & Output Specificationsï¼‰

### 3.1 APL Gatewayè¼¸å…¥è¦æ ¼

#### 3.1.1 å¸³æˆ¶ç®¡ç†è¼¸å…¥è¦æ ¼
åŸºæ–¼APL.dart Gatewayçµ±ä¸€ä»‹é¢ï¼Œæœ¬åŠŸèƒ½ç¾¤è™•ç†ä»¥ä¸‹è¼¸å…¥æ ¼å¼ï¼š

**FR-3.1.1-01 å¸³æˆ¶å‰µå»ºè¼¸å…¥è¦æ ¼**
```dart
// PLå±¤æ¥æ”¶æ ¼å¼ï¼ˆéµå¾ª1311.FS.jsè¦ç¯„ï¼‰
class AccountCreationInput {
  String name;                    // å¸³æˆ¶åç¨± (1-50å­—å…ƒ)
  String type;                   // å¸³æˆ¶é¡å‹ (cash|bank|credit|ewallet)
  double initialBalance;         // åˆå§‹é¤˜é¡ (-999999.99 ~ 999999.99)
  String currency;              // å¹£åˆ¥ (TWD|USD|CNYç­‰)
  String? description;          // æè¿° (0-255å­—å…ƒ)
  String userId;               // ç”¨æˆ¶ID (ç¬¦åˆ1311.FS.jsè¦ç¯„)
  String? ledgerId;            // å¸³æœ¬IDï¼ˆé¸å¡«ï¼Œä½¿ç”¨é è¨­å¸³æœ¬ï¼‰
  
  // 1311.FS.jsæ¨™æº–æ¬„ä½
  DateTime? createdAt;         // å»ºç«‹æ™‚é–“ (timestampæ ¼å¼)
  DateTime? updatedAt;         // æ›´æ–°æ™‚é–“ (timestampæ ¼å¼)
  String status;               // ç‹€æ…‹ (active|inactive|archived)
  String? createdBy;           // å»ºç«‹è€…ID
}

// æ¥­å‹™é‚è¼¯é©—è­‰è¦å‰‡ï¼ˆç¬¦åˆ1311.FS.jsè¦ç¯„ï¼‰
ValidationRules accountValidation = {
  'name': {
    'required': true,
    'minLength': 1,
    'maxLength': 50,
    'pattern': r'^[a-zA-Z0-9\u4e00-\u9fff\s\-_]+$'
  },
  'type': {
    'required': true,
    'enum': ['cash', 'bank', 'credit', 'ewallet']
  },
  'initialBalance': {
    'required': true,
    'type': 'double',
    'min': -999999.99,
    'max': 999999.99
  },
  'currency': {
    'required': true,
    'enum': ['TWD', 'USD', 'CNY', 'EUR', 'JPY']
  },
  'userId': {
    'required': true,
    'pattern': r'^[a-zA-Z0-9@._-]+$'
  },
  'status': {
    'required': true,
    'enum': ['active', 'inactive', 'archived'],
    'default': 'active'
  },
  'createdAt': {
    'type': 'timestamp',
    'auto_generate': true
  },
  'updatedAt': {
    'type': 'timestamp',
    'auto_generate': true
  }
};
```

**FR-3.1.1-02 å¸³æˆ¶æŸ¥è©¢è¼¸å…¥è¦æ ¼**
```dart
// å¸³æˆ¶æŸ¥è©¢è¼¸å…¥ï¼ˆéµå¾ª1311.FS.jsæŸ¥è©¢è¦ç¯„ï¼‰
class AccountQueryInput {
  String userId;               // ç”¨æˆ¶IDï¼ˆå¿…å¡«ï¼Œç¬¦åˆ1311.FS.jsè¦ç¯„ï¼‰
  String? ledgerId;           // å¸³æœ¬IDç¯©é¸
  List<String>? types;        // å¸³æˆ¶é¡å‹ç¯©é¸
  String? currency;           // å¹£åˆ¥ç¯©é¸
  List<String>? status;       // ç‹€æ…‹ç¯©é¸ (active|inactive|archived)
  
  // åˆ†é åƒæ•¸ï¼ˆç¬¦åˆ1311.FS.jsæŸ¥è©¢è¦ç¯„ï¼‰
  int? limit;                 // é™åˆ¶ç­†æ•¸ (1-100, default: 20)
  int? offset;               // åˆ†é åç§» (default: 0)
  
  // æ’åºåƒæ•¸
  String? orderBy;           // æ’åºæ¬„ä½ (name|createdAt|updatedAt|type)
  String? orderDirection;    // æ’åºæ–¹å‘ (asc|desc, default: asc)
  
  // æ™‚é–“ç¯„åœç¯©é¸
  DateTime? createdAfter;    // å»ºç«‹æ™‚é–“èµ·å§‹
  DateTime? createdBefore;   // å»ºç«‹æ™‚é–“çµæŸ
  DateTime? updatedAfter;    // æ›´æ–°æ™‚é–“èµ·å§‹
  DateTime? updatedBefore;   // æ›´æ–°æ™‚é–“çµæŸ
  
  // æœå°‹åƒæ•¸
  String? searchKeyword;     // åç¨±æ¨¡ç³Šæœå°‹
}

// æŸ¥è©¢é©—è­‰è¦å‰‡
ValidationRules queryValidation = {
  'userId': {
    'required': true,
    'pattern': r'^[a-zA-Z0-9@._-]+$'
  },
  'limit': {
    'type': 'int',
    'min': 1,
    'max': 100,
    'default': 20
  },
  'offset': {
    'type': 'int',
    'min': 0,
    'default': 0
  },
  'orderBy': {
    'enum': ['name', 'createdAt', 'updatedAt', 'type', 'balance']
  },
  'orderDirection': {
    'enum': ['asc', 'desc'],
    'default': 'asc'
  },
  'status': {
    'enum': ['active', 'inactive', 'archived']
  }
};
```

#### 3.1.2 ç§‘ç›®ç®¡ç†è¼¸å…¥è¦æ ¼

**FR-3.1.2-01 ç§‘ç›®å‰µå»ºè¼¸å…¥è¦æ ¼**
```dart
// ç§‘ç›®å‰µå»ºè¼¸å…¥ï¼ˆéµå¾ª1311.FS.jsè¦ç¯„ï¼‰
class CategoryCreationInput {
  String name;                 // ç§‘ç›®åç¨± (1-30å­—å…ƒ)
  String type;                // ç§‘ç›®é¡å‹ (income|expense)
  String? parentId;           // çˆ¶ç§‘ç›®IDï¼ˆé¸å¡«ï¼Œç¬¦åˆ1311.FS.jsè¦ç¯„ï¼‰
  String userId;              // ç”¨æˆ¶IDï¼ˆå¿…å¡«ï¼‰
  String? ledgerId;           // å¸³æœ¬IDï¼ˆé¸å¡«ï¼Œä½¿ç”¨é è¨­å¸³æœ¬ï¼‰
  String? description;        // æè¿°
  String? color;              // é¡è‰²ä»£ç¢¼ (#RRGGBB)
  String? icon;               // åœ–ç¤ºåç¨±
  int? sortOrder;             // æ’åºé †åº
  
  // 1311.FS.jsæ¨™æº–æ¬„ä½
  DateTime? createdAt;        // å»ºç«‹æ™‚é–“ (timestampæ ¼å¼)
  DateTime? updatedAt;        // æ›´æ–°æ™‚é–“ (timestampæ ¼å¼)
  String status;              // ç‹€æ…‹ (active|inactive|archived)
  String? createdBy;          // å»ºç«‹è€…ID
  int level;                  // éšå±¤æ·±åº¦ (1-3)
  bool isDefault;             // æ˜¯å¦ç‚ºé è¨­ç§‘ç›®
}

// æ¥­å‹™é‚è¼¯é©—è­‰è¦å‰‡ï¼ˆç¬¦åˆ1311.FS.jsè¦ç¯„ï¼‰
ValidationRules categoryValidation = {
  'name': {
    'required': true,
    'minLength': 1,
    'maxLength': 30,
    'pattern': r'^[a-zA-Z0-9\u4e00-\u9fff\s\-_]+$'
  },
  'type': {
    'required': true,
    'enum': ['income', 'expense']
  },
  'userId': {
    'required': true,
    'pattern': r'^[a-zA-Z0-9@._-]+$'
  },
  'parentId': {
    'pattern': r'^[a-zA-Z0-9_-]+$'
  },
  'color': {
    'pattern': r'^#[0-9A-Fa-f]{6}$',
    'default': '#757575'
  },
  'level': {
    'type': 'int',
    'min': 1,
    'max': 3,
    'required': true
  },
  'status': {
    'required': true,
    'enum': ['active', 'inactive', 'archived'],
    'default': 'active'
  },
  'sortOrder': {
    'type': 'int',
    'min': 0,
    'default': 0
  },
  'isDefault': {
    'type': 'bool',
    'default': false
  },
  'createdAt': {
    'type': 'timestamp',
    'auto_generate': true
  },
  'updatedAt': {
    'type': 'timestamp',
    'auto_generate': true
  }
};

**FR-3.1.2-02 ç§‘ç›®æŸ¥è©¢è¼¸å…¥è¦æ ¼**
```dart
// ç§‘ç›®æŸ¥è©¢è¼¸å…¥ï¼ˆéµå¾ª1311.FS.jsæŸ¥è©¢è¦ç¯„ï¼‰
class CategoryQueryInput {
  String userId;               // ç”¨æˆ¶IDï¼ˆå¿…å¡«ï¼‰
  String? ledgerId;           // å¸³æœ¬IDç¯©é¸
  String? type;               // ç§‘ç›®é¡å‹ç¯©é¸ (income|expense)
  String? parentId;           // çˆ¶ç§‘ç›®IDç¯©é¸
  List<String>? status;       // ç‹€æ…‹ç¯©é¸
  int? level;                 // éšå±¤æ·±åº¦ç¯©é¸
  bool? isDefault;            // æ˜¯å¦ç‚ºé è¨­ç§‘ç›®
  
  // åˆ†é åƒæ•¸
  int? limit;                 // é™åˆ¶ç­†æ•¸ (1-100, default: 50)
  int? offset;               // åˆ†é åç§»
  
  // æ’åºåƒæ•¸
  String? orderBy;           // æ’åºæ¬„ä½ (name|sortOrder|createdAt|type)
  String? orderDirection;    // æ’åºæ–¹å‘ (asc|desc)
  
  // æœå°‹åƒæ•¸
  String? searchKeyword;     // åç¨±æ¨¡ç³Šæœå°‹
  bool? includeChildren;     // æ˜¯å¦åŒ…å«å­ç§‘ç›®
}
```

#### 3.1.3 å››æ¨¡å¼å·®ç•°åŒ–è¼¸å…¥è™•ç†

**Expertæ¨¡å¼è¼¸å…¥æ“´å±•**
```dart
class ExpertModeInput extends BaseInput {
  Map<String, dynamic>? advancedSettings;
  List<String>? customFields;
  Map<String, String>? metadata;
  bool? enableAdvancedValidation;
}
```

**Guidingæ¨¡å¼è¼¸å…¥ç°¡åŒ–**
```dart
class GuidingModeInput {
  String name;                 // åƒ…å¿…è¦æ¬„ä½
  String type;
  String userId;
  // å…¶ä»–æ¬„ä½è‡ªå‹•å¡«å…¥é è¨­å€¼
}
```

### 3.2 APL Gatewayè¼¸å‡ºè¦æ ¼

#### 3.2.1 æ¨™æº–æˆåŠŸå›æ‡‰æ ¼å¼
åŸºæ–¼8088 APIè¨­è¨ˆè¦ç¯„ï¼Œæ¥­å‹™é‚è¼¯å±¤çµ±ä¸€è™•ç†ä»¥ä¸‹è¼¸å‡ºæ ¼å¼ï¼š

```dart
class StandardResponse<T> {
  bool success;                // æ“ä½œæˆåŠŸæ¨™è­˜
  T? data;                    // å¯¦éš›è³‡æ–™å…§å®¹
  ResponseMetadata metadata;   // å›æ‡‰å…ƒè³‡æ–™
  PaginationInfo? pagination; // åˆ†é è³‡è¨Šï¼ˆåˆ—è¡¨æŸ¥è©¢ï¼‰

  // å››æ¨¡å¼å·®ç•°åŒ–å…§å®¹
  ModeSpecificData? modeData; // æ¨¡å¼ç‰¹å®šè³‡æ–™
}

class ResponseMetadata {
  String timestamp;           // å›æ‡‰æ™‚é–“æˆ³ (ISO 8601)
  String requestId;          // è«‹æ±‚è¿½è¹¤ID
  String userMode;           // ä½¿ç”¨è€…æ¨¡å¼
  double processingTime;     // è™•ç†æ™‚é–“ (æ¯«ç§’)
}

class ModeSpecificData {
  // Expertæ¨¡å¼ï¼šè©³ç´°åˆ†æè³‡æ–™
  Map<String, dynamic>? analytics;
  List<String>? availableActions;

  // Cultivationæ¨¡å¼ï¼šé€²åº¦èˆ‡æˆå°±
  ProgressInfo? progress;
  List<Achievement>? achievements;

  // Guidingæ¨¡å¼ï¼šç°¡åŒ–è¨Šæ¯
  String? simpleMessage;
  List<SimpleAction>? quickActions;
}
```

#### 3.2.2 å¸³æˆ¶ç®¡ç†è¼¸å‡ºè¦æ ¼

**FR-3.2.2-01 å¸³æˆ¶å‰µå»ºæˆåŠŸå›æ‡‰**
```dart
class AccountCreationResponse {
  bool success = true;
  AccountData data;
  ResponseMetadata metadata;

  // å››æ¨¡å¼å·®ç•°åŒ–å…§å®¹
  ExpertModeData? expertData;      // Expert: è©³ç´°è¨­å®šé¸é …
  CultivationModeData? cultData;   // Cultivation: å»ºè­°èˆ‡é€²åº¦
  String? guidingMessage;          // Guiding: ç°¡åŒ–ç¢ºèªè¨Šæ¯
}

class AccountData {
  String accountId;            // å¸³æˆ¶ID
  String name;                // å¸³æˆ¶åç¨±
  String type;                // å¸³æˆ¶é¡å‹
  double balance;             // ç•¶å‰é¤˜é¡
  String currency;            // å¹£åˆ¥
  DateTime createdAt;         // å»ºç«‹æ™‚é–“
  DateTime updatedAt;         // æ›´æ–°æ™‚é–“

  // é—œè¯è³‡æ–™
  LedgerInfo? ledgerInfo;     // æ‰€å±¬å¸³æœ¬è³‡è¨Š
  List<RecentTransaction>? recentTransactions; // æœ€è¿‘äº¤æ˜“ï¼ˆExpertæ¨¡å¼ï¼‰
}
```

**FR-3.2.2-02 å¸³æˆ¶åˆ—è¡¨æŸ¥è©¢å›æ‡‰**
```dart
class AccountListResponse {
  bool success = true;
  AccountListData data;
  PaginationInfo pagination;
  ResponseMetadata metadata;
}

class AccountListData {
  List<AccountSummary> accounts;
  AccountStatistics? statistics;  // Expertæ¨¡å¼çµ±è¨ˆè³‡æ–™
  List<String>? recommendations;   // Cultivationæ¨¡å¼æ¨è–¦
}

class AccountSummary {
  String accountId;
  String name;
  String type;
  double balance;
  String currency;
  bool isDefault;
  DateTime lastUsed;

  // å››æ¨¡å¼å·®ç•°åŒ–å…§å®¹
  Map<String, dynamic>? expertDetails;    // Expert: å®Œæ•´è©³ç´°è³‡è¨Š
  String? cultivationTip;                  // Cultivation: ä½¿ç”¨å»ºè­°
  String? guidingLabel;                    // Guiding: ç°¡åŒ–æ¨™ç±¤
}
```

#### 3.2.3 ç§‘ç›®ç®¡ç†è¼¸å‡ºè¦æ ¼

**FR-3.2.3-01 ç§‘ç›®æ¨¹ç‹€çµæ§‹å›æ‡‰**
```dart
class CategoryTreeResponse {
  bool success = true;
  CategoryTreeData data;
  ResponseMetadata metadata;
}

class CategoryTreeData {
  List<CategoryNode> incomeCategories;   // æ”¶å…¥ç§‘ç›®æ¨¹
  List<CategoryNode> expenseCategories;  // æ”¯å‡ºç§‘ç›®æ¨¹
  CategoryStatistics? statistics;        // Expertæ¨¡å¼çµ±è¨ˆ
  List<CategoryRecommendation>? recommendations; // æ¨è–¦ç§‘ç›®
}

class CategoryNode {
  String categoryId;
  String name;
  String type;
  int level;                    // éšå±¤æ·±åº¦ (1-3)
  String? parentId;
  List<CategoryNode>? children; // å­ç§‘ç›®

  // ä½¿ç”¨çµ±è¨ˆ
  int usageCount;              // ä½¿ç”¨æ¬¡æ•¸
  DateTime? lastUsed;          // æœ€å¾Œä½¿ç”¨æ™‚é–“
  double? totalAmount;         // ç¸½äº¤æ˜“é‡‘é¡ï¼ˆExpertæ¨¡å¼ï¼‰

  // é¡¯ç¤ºå±¬æ€§
  String color;                // é¡è‰²ä»£ç¢¼
  String icon;                 // åœ–ç¤º
  int sortOrder;              // æ’åºé †åº

  // å››æ¨¡å¼å·®ç•°åŒ–
  bool isFrequent;            // å¸¸ç”¨ç§‘ç›®æ¨™è¨˜
  String? cultivationTip;     // Cultivationæ¨¡å¼æç¤º
}
```

#### 3.2.4 å¿«å–èˆ‡ç‹€æ…‹ç®¡ç†è¼¸å‡º

**FR-3.2.4-01 å¿«å–ç‹€æ…‹è³‡è¨Š**
```dart
class CacheStateInfo {
  Map<String, CacheStatus> cacheStatus;
  DateTime lastSyncTime;
  bool isOnline;
  List<PendingOperation>? pendingOperations;
}

class CacheStatus {
  String resourceType;        // è³‡æºé¡å‹ (accounts|categories|etc)
  DateTime cacheTime;         // å¿«å–æ™‚é–“
  DateTime expireTime;        // éæœŸæ™‚é–“
  bool isValid;              // æ˜¯å¦æœ‰æ•ˆ
  int itemCount;             // å¿«å–é …ç›®æ•¸é‡
}
```

### 3.3 WCM.jsæ¨¡çµ„ä»‹é¢è¦æ ¼

#### 3.3.1 BLå±¤å‡½æ•¸èª¿ç”¨ä»‹é¢
åŸºæ–¼WCM.jsæ¨¡çµ„æä¾›çš„å‡½æ•¸ï¼Œæ¥­å‹™é‚è¼¯å±¤å»ºç«‹ä»¥ä¸‹ä»‹é¢è¦ç¯„ï¼š

**FR-3.3.1-01 å¸³æˆ¶ç®¡ç†BLä»‹é¢**
```dart
// PLå±¤èª¿ç”¨APL Gatewayï¼ŒAPL Gatewayèª¿ç”¨WCM.js
class WCMAccountInterface {
  // å°æ‡‰WCM_createWalletå‡½æ•¸
  Future<StandardResponse<AccountData>> createAccount(
    AccountCreationInput input
  ) async {
    // æ¥­å‹™é‚è¼¯è™•ç†
    final processedInput = _preprocessAccountInput(input);

    // APL Gatewayèª¿ç”¨
    final aplResponse = await aplGateway.post(
      '/api/v1/accounts',
      body: processedInput
    );

    // å›æ‡‰è™•ç†èˆ‡å››æ¨¡å¼é©é…
    return _processAccountResponse(aplResponse, input.userMode);
  }

  // å°æ‡‰WCM_getWalletListå‡½æ•¸
  Future<StandardResponse<AccountListData>> getAccountList(
    AccountQueryInput input
  );

  // å°æ‡‰WCM_validateWalletExistså‡½æ•¸
  Future<StandardResponse<ValidationResult>> validateAccountExists(
    String accountId, String userId
  );

  // å°æ‡‰WCM_getWalletBalanceå‡½æ•¸
  Future<StandardResponse<BalanceData>> getAccountBalance(
    String accountId, String userId
  );
}
```

**FR-3.3.1-02 ç§‘ç›®ç®¡ç†BLä»‹é¢**
```dart
class WCMCategoryInterface {
  // å°æ‡‰WCM_createCategoryå‡½æ•¸
  Future<StandardResponse<CategoryData>> createCategory(
    CategoryCreationInput input
  );

  // å°æ‡‰WCM_getCategoryListå‡½æ•¸
  Future<StandardResponse<CategoryTreeData>> getCategoryTree(
    CategoryQueryInput input
  );

  // å°æ‡‰WCM_validateCategoryExistså‡½æ•¸
  Future<StandardResponse<ValidationResult>> validateCategoryExists(
    String categoryId, String userId
  );
}
```

#### 3.3.2 è³‡æ–™æ ¼å¼è½‰æ›è¦ç¯„

**FR-3.3.2-01 PL â†’ APLè³‡æ–™è½‰æ›**
```dart
class DataTransformer {
  // å¸³æˆ¶è³‡æ–™è½‰æ›
  Map<String, dynamic> transformAccountInput(AccountCreationInput input) {
    return {
      'name': input.name.trim(),
      'type': input.type,
      'balance': input.initialBalance,
      'currency': input.currency,
      'description': input.description?.trim() ?? '',
      'userId': input.userId,
      'ledgerId': input.ledgerId,
      // æ¥­å‹™é‚è¼¯æ“´å±•æ¬„ä½
      'source': 'app',
      'version': '1.0.0',
      'userMode': getCurrentUserMode(),
      'timestamp': DateTime.now().toIso8601String()
    };
  }

  // APL â†’ PLè³‡æ–™è½‰æ›
  AccountData transformAccountResponse(Map<String, dynamic> response) {
    return AccountData(
      accountId: response['walletId'] ?? response['accountId'],
      name: response['name'],
      type: response['type'],
      balance: response['balance']?.toDouble() ?? 0.0,
      currency: response['currency'] ?? 'TWD',
      createdAt: DateTime.parse(response['createdAt']),
      updatedAt: DateTime.parse(response['updatedAt'])
    );
  }
}
```

### 3.4 å››æ¨¡å¼å·®ç•°åŒ–è™•ç†è¦æ ¼

#### 3.4.1 è¼¸å…¥è™•ç†å·®ç•°åŒ–

**FR-3.4.1-01 æ¨¡å¼åˆ¥è¼¸å…¥é è™•ç†**
```dart
class ModeInputProcessor {
  AccountCreationInput processExpertMode(AccountCreationInput input) {
    // Expertæ¨¡å¼ï¼šå®Œæ•´é©—è­‰ï¼Œä¿ç•™æ‰€æœ‰æ¬„ä½
    return input..validate(strictMode: true);
  }

  AccountCreationInput processInertialMode(AccountCreationInput input) {
    // Inertialæ¨¡å¼ï¼šæ¨™æº–åŒ–è™•ç†ï¼Œå¡«å…¥å›ºå®šé è¨­å€¼
    return input
      ..currency ??= 'TWD'
      ..type = _standardizeAccountType(input.type);
  }

  AccountCreationInput processCultivationMode(AccountCreationInput input) {
    // Cultivationæ¨¡å¼ï¼šå¼•å°å¼å¡«å……ï¼Œæ™ºæ…§é è¨­å€¼
    return input
      ..description ??= _generateSmartDescription(input)
      ..type = _recommendAccountType(input);
  }

  AccountCreationInput processGuidingMode(AccountCreationInput input) {
    // Guidingæ¨¡å¼ï¼šæ¥µç°¡è™•ç†ï¼Œå¤§é‡é è¨­å€¼
    return AccountCreationInput(
      name: input.name,
      type: input.type ?? 'cash',
      initialBalance: input.initialBalance ?? 0.0,
      currency: 'TWD',
      description: '',
      userId: input.userId
    );
  }
}
```

#### 3.4.2 è¼¸å‡ºæ ¼å¼å·®ç•°åŒ–

**FR-3.4.2-01 æ¨¡å¼åˆ¥è¼¸å‡ºå¾Œè™•ç†**
```dart
class ModeOutputProcessor {
  AccountCreationResponse processExpertOutput(
    AccountCreationResponse base
  ) {
    return base..expertData = ExpertModeData(
      detailedAnalytics: _generateAccountAnalytics(base.data),
      availableActions: _getAdvancedAccountActions(),
      relatedAccounts: _findRelatedAccounts(base.data),
      budgetImpact: _calculateBudgetImpact(base.data)
    );
  }

  AccountCreationResponse processCultivationOutput(
    AccountCreationResponse base
  ) {
    return base..cultData = CultivationModeData(
      achievement: _checkAchievements(base.data),
      progress: _calculateProgress(base.data),
      nextGoal: _suggestNextGoal(base.data),
      motivationalMessage: _generateMotivation()
    );
  }

  AccountCreationResponse processGuidingOutput(
    AccountCreationResponse base
  ) {
    return base..guidingMessage = _generateSimpleMessage(base.data);
  }
}
```

### 3.5 æœ¬åœ°å¿«å–èˆ‡åŒæ­¥è¦æ ¼

#### 3.5.1 å¿«å–è³‡æ–™çµæ§‹

**FR-3.5.1-01 å¸³æˆ¶å¿«å–çµæ§‹**
```dart
class AccountCache {
  Map<String, AccountData> accounts;      // å¸³æˆ¶è³‡æ–™å¿«å–
  Map<String, double> balances;           // é¤˜é¡å¿«å–
  Map<String, DateTime> lastUpdated;      // æœ€å¾Œæ›´æ–°æ™‚é–“
  Set<String> dirtyIds;                   // å¾…åŒæ­¥IDé›†åˆ

  // å¿«å–ç­–ç•¥é…ç½®
  Duration accountCacheExpiry = Duration(hours: 1);
  Duration balanceCacheExpiry = Duration(minutes: 10);
}

class CategoryCache {
  Map<String, CategoryNode> categories;   // ç§‘ç›®è³‡æ–™å¿«å–
  List<CategoryNode> treeStructure;       // æ¨¹ç‹€çµæ§‹å¿«å–
  Map<String, int> usageStats;           // ä½¿ç”¨çµ±è¨ˆå¿«å–
  DateTime treeLastBuilt;                 // æ¨¹ç‹€çµæ§‹å»ºç«‹æ™‚é–“

  // å¿«å–ç­–ç•¥é…ç½®
  Duration categoryCacheExpiry = Duration(hours: 2);
  Duration usageStatsCacheExpiry = Duration(minutes: 30);
}
```

#### 3.5.2 åŒæ­¥ç­–ç•¥è¦æ ¼

**FR-3.5.2-01 åŒæ­¥è§¸ç™¼æ©Ÿåˆ¶**
```dart
class SyncStrategy {
  // è‡ªå‹•åŒæ­¥è§¸ç™¼æ¢ä»¶
  List<SyncTrigger> autoSyncTriggers = [
    SyncTrigger.appForeground,      // APPé€²å…¥å‰æ™¯
    SyncTrigger.networkReconnect,   // ç¶²è·¯é‡é€£
    SyncTrigger.cacheExpired,       // å¿«å–éæœŸ
    SyncTrigger.userAction,         // ä½¿ç”¨è€…æ“ä½œ
    SyncTrigger.scheduled           // å®šæ™‚åŒæ­¥ï¼ˆ15åˆ†é˜ï¼‰
  ];

  // åŒæ­¥å„ªå…ˆç´š
  Map<String, SyncPriority> syncPriority = {
    'account_balance': SyncPriority.high,
    'account_list': SyncPriority.medium,
    'category_tree': SyncPriority.medium,
    'usage_stats': SyncPriority.low
  };
}
```

---

## 4.0 éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³ï¼ˆError Handling & Edge Casesï¼‰

### 4.1 çµ±ä¸€éŒ¯èª¤è™•ç†æ¶æ§‹

#### 4.1.1 éŒ¯èª¤åˆ†é¡é«”ç³»
åŸºæ–¼8088 APIè¨­è¨ˆè¦ç¯„ï¼Œæ¥­å‹™é‚è¼¯å±¤å»ºç«‹å®Œæ•´çš„éŒ¯èª¤è™•ç†é«”ç³»ï¼š

```dart
enum ErrorCategory {
  validation,        // è³‡æ–™é©—è­‰éŒ¯èª¤
  business,         // æ¥­å‹™é‚è¼¯éŒ¯èª¤
  network,          // ç¶²è·¯é€£ç·šéŒ¯èª¤
  authentication,   // èªè­‰æˆæ¬ŠéŒ¯èª¤
  system,          // ç³»çµ±ç´šéŒ¯èª¤
  cache,           // å¿«å–ç›¸é—œéŒ¯èª¤
  sync             // åŒæ­¥éŒ¯èª¤
}

enum ErrorSeverity {
  low,             // å¯å¿½ç•¥ï¼Œä¸å½±éŸ¿ä¸»è¦åŠŸèƒ½
  medium,          // éƒ¨åˆ†åŠŸèƒ½å—å½±éŸ¿ï¼Œå¯é™ç´šè™•ç†
  high,            // ä¸»è¦åŠŸèƒ½å—å½±éŸ¿ï¼Œéœ€è¦è™•ç†
  critical         // ç³»çµ±ç„¡æ³•æ­£å¸¸é‹ä½œ
}
```

#### 4.1.2 æ¨™æº–éŒ¯èª¤æ ¼å¼

**FR-4.1.2-01 çµ±ä¸€éŒ¯èª¤å›æ‡‰æ ¼å¼**
```dart
class ErrorResponse {
  bool success = false;
  ErrorData error;
  ResponseMetadata metadata;

  // å››æ¨¡å¼å·®ç•°åŒ–éŒ¯èª¤è™•ç†
  ModeSpecificError? modeError;
}

class ErrorData {
  String code;                 // éŒ¯èª¤ä»£ç¢¼
  String message;              // éŒ¯èª¤è¨Šæ¯
  String? field;               // ç›¸é—œæ¬„ä½ï¼ˆé©—è­‰éŒ¯èª¤ï¼‰
  ErrorCategory category;      // éŒ¯èª¤åˆ†é¡
  ErrorSeverity severity;      // éŒ¯èª¤åš´é‡ç¨‹åº¦
  DateTime timestamp;          // éŒ¯èª¤ç™¼ç”Ÿæ™‚é–“
  String requestId;            // è«‹æ±‚è¿½è¹¤ID
  Map<String, dynamic>? details; // è©³ç´°éŒ¯èª¤è³‡è¨Š

  // éŒ¯èª¤è™•ç†å»ºè­°
  List<ErrorAction>? suggestedActions;
  String? userFriendlyMessage;
}

class ErrorAction {
  String actionType;           // retry|fallback|navigate|contact
  String label;               // ä½¿ç”¨è€…çœ‹åˆ°çš„æŒ‰éˆ•æ–‡å­—
  Map<String, dynamic>? parameters; // å‹•ä½œåƒæ•¸
}
```

#### 4.1.3 å››æ¨¡å¼å·®ç•°åŒ–éŒ¯èª¤è™•ç†

**FR-4.1.3-01 æ¨¡å¼åˆ¥éŒ¯èª¤å›æ‡‰ç­–ç•¥**
```dart
class ModeSpecificError {
  // Expertæ¨¡å¼ï¼šè©³ç´°æŠ€è¡“è³‡è¨Š
  ExpertErrorData? expertData;
  // Cultivationæ¨¡å¼ï¼šå¼•å°å¼éŒ¯èª¤è™•ç†
  CultivationErrorData? cultivationData;
  // Guidingæ¨¡å¼ï¼šæ¥µç°¡éŒ¯èª¤è¨Šæ¯
  String? simpleMessage;
}

class ExpertErrorData {
  String? stackTrace;          // éŒ¯èª¤å †ç–Šï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰
  Map<String, dynamic>? debugInfo; // é™¤éŒ¯è³‡è¨Š
  List<String>? technicalSolutions; // æŠ€è¡“è§£æ±ºæ–¹æ¡ˆ
  ErrorStatistics? errorStats; // éŒ¯èª¤çµ±è¨ˆ
}

class CultivationErrorData {
  String? guidanceMessage;     // å¼•å°è¨Šæ¯
  List<LearningTip>? tips;     // å­¸ç¿’æç¤º
  String? preventionAdvice;    // é é˜²å»ºè­°
  bool? showTutorial;         // æ˜¯å¦é¡¯ç¤ºæ•™å­¸
}
```

### 4.2 å¸³æˆ¶ç®¡ç†ç›¸é—œéŒ¯èª¤

#### 4.2.1 å¸³æˆ¶é©—è­‰éŒ¯èª¤

**FR-4.2.1-01 å¸³æˆ¶åç¨±é©—è­‰éŒ¯èª¤**
```dart
class AccountValidationErrors {
  static const String ACCOUNT_NAME_REQUIRED = 'ACCOUNT_NAME_REQUIRED';
  static const String ACCOUNT_NAME_TOO_SHORT = 'ACCOUNT_NAME_TOO_SHORT';
  static const String ACCOUNT_NAME_TOO_LONG = 'ACCOUNT_NAME_TOO_LONG';
  static const String ACCOUNT_NAME_INVALID_CHARS = 'ACCOUNT_NAME_INVALID_CHARS';
  static const String ACCOUNT_NAME_DUPLICATE = 'ACCOUNT_NAME_DUPLICATE';

  // éŒ¯èª¤è™•ç†é‚è¼¯
  static ErrorResponse handleNameValidation(
    String? name,
    String userMode,
    List<String>? existingNames
  ) {
    if (name == null || name.trim().isEmpty) {
      return _createValidationError(
        ACCOUNT_NAME_REQUIRED,
        _getLocalizedMessage('å¸³æˆ¶åç¨±ä¸èƒ½ç‚ºç©º', userMode),
        'name',
        _getSuggestedActions(userMode, 'name_required')
      );
    }

    if (name.trim().length > 50) {
      return _createValidationError(
        ACCOUNT_NAME_TOO_LONG,
        _getLocalizedMessage('å¸³æˆ¶åç¨±ä¸èƒ½è¶…é50å­—å…ƒ', userMode),
        'name',
        _getSuggestedActions(userMode, 'name_too_long')
      );
    }

    if (existingNames?.contains(name.trim()) == true) {
      return _createValidationError(
        ACCOUNT_NAME_DUPLICATE,
        _getLocalizedMessage('å¸³æˆ¶åç¨±å·²å­˜åœ¨', userMode),
        'name',
        _getSuggestedActions(userMode, 'name_duplicate')
      );
    }

    return ErrorResponse.noError();
  }
}
```

**FR-4.2.1-02 å¸³æˆ¶é¤˜é¡é©—è­‰éŒ¯èª¤**
```dart
class BalanceValidationErrors {
  static const String BALANCE_INVALID_FORMAT = 'BALANCE_INVALID_FORMAT';
  static const String BALANCE_OUT_OF_RANGE = 'BALANCE_OUT_OF_RANGE';
  static const String BALANCE_NEGATIVE_NOT_ALLOWED = 'BALANCE_NEGATIVE_NOT_ALLOWED';

  static ErrorResponse validateBalance(
    dynamic balance,
    String accountType,
    String userMode
  ) {
    if (balance == null) {
      return _createValidationError(
        'BALANCE_REQUIRED',
        _getModeMessage(userMode, {
          'Expert': 'è«‹è¼¸å…¥å¸³æˆ¶åˆå§‹é¤˜é¡',
          'Inertial': 'é¤˜é¡ç‚ºå¿…å¡«é …ç›®',
          'Cultivation': 'è¨­å®šåˆå§‹é¤˜é¡æœ‰åŠ©æ–¼é ç®—è¦åŠƒ',
          'Guiding': 'è«‹å¡«å…¥é¤˜é¡'
        }),
        'initialBalance'
      );
    }

    double? numBalance = _parseBalance(balance);
    if (numBalance == null) {
      return _createValidationError(
        BALANCE_INVALID_FORMAT,
        _getModeMessage(userMode, {
          'Expert': 'é¤˜é¡æ ¼å¼ç„¡æ•ˆï¼Œè«‹è¼¸å…¥æœ‰æ•ˆæ•¸å­—',
          'Guiding': 'è«‹è¼¸å…¥æ­£ç¢ºçš„é‡‘é¡'
        }),
        'initialBalance'
      );
    }

    // ä¿¡ç”¨å¡å¸³æˆ¶å…è¨±è² å€¼
    if (accountType != 'credit' && numBalance < 0) {
      return _createValidationError(
        BALANCE_NEGATIVE_NOT_ALLOWED,
        _getModeMessage(userMode, {
          'Expert': 'æ­¤å¸³æˆ¶é¡å‹ä¸å…è¨±è² é¤˜é¡',
          'Guiding': 'é¤˜é¡ä¸èƒ½æ˜¯è² æ•¸'
        }),
        'initialBalance'
      );
    }

    return ErrorResponse.noError();
  }
}
```

#### 4.2.2 å¸³æˆ¶æ¥­å‹™é‚è¼¯éŒ¯èª¤

**FR-4.2.2-01 å¸³æˆ¶å­˜å–æ¬Šé™éŒ¯èª¤**
```dart
class AccountAccessErrors {
  static const String ACCOUNT_NOT_FOUND = 'ACCOUNT_NOT_FOUND';
  static const String ACCOUNT_ACCESS_DENIED = 'ACCOUNT_ACCESS_DENIED';
  static const String ACCOUNT_INACTIVE = 'ACCOUNT_INACTIVE';
  static const String ACCOUNT_LEDGER_MISMATCH = 'ACCOUNT_LEDGER_MISMATCH';

  static ErrorResponse handleAccountAccess(
    String? accountId,
    String userId,
    String? ledgerId,
    String userMode
  ) {
    final account = _findAccount(accountId);

    if (account == null) {
      return ErrorResponse(
        success: false,
        error: ErrorData(
          code: ACCOUNT_NOT_FOUND,
          message: _getModeMessage(userMode, {
            'Expert': 'æŒ‡å®šçš„å¸³æˆ¶ä¸å­˜åœ¨ (ID: $accountId)',
            'Inertial': 'æ‰¾ä¸åˆ°è©²å¸³æˆ¶',
            'Cultivation': 'è©²å¸³æˆ¶å¯èƒ½å·²è¢«åˆªé™¤ï¼Œè«‹æª¢æŸ¥å¸³æˆ¶æ¸…å–®',
            'Guiding': 'å¸³æˆ¶ä¸å­˜åœ¨'
          }),
          category: ErrorCategory.business,
          severity: ErrorSeverity.medium,
          suggestedActions: _getAccessErrorActions(userMode)
        )
      );
    }

    if (account.userId != userId) {
      return ErrorResponse(
        success: false,
        error: ErrorData(
          code: ACCOUNT_ACCESS_DENIED,
          message: _getModeMessage(userMode, {
            'Expert': 'ç„¡æ¬Šé™å­˜å–æ­¤å¸³æˆ¶',
            'Guiding': 'ç„¡æ³•å­˜å–è©²å¸³æˆ¶'
          }),
          category: ErrorCategory.authentication,
          severity: ErrorSeverity.high,
          suggestedActions: [
            ErrorAction(
              actionType: 'navigate',
              label: 'è¿”å›å¸³æˆ¶åˆ—è¡¨',
              parameters: {'route': '/accounts'}
            )
          ]
        )
      );
    }

    return ErrorResponse.noError();
  }
}
```

### 4.3 ç§‘ç›®ç®¡ç†ç›¸é—œéŒ¯èª¤

#### 4.3.1 ç§‘ç›®éšå±¤éŒ¯èª¤

**FR-4.3.1-01 ç§‘ç›®éšå±¤é‚è¼¯éŒ¯èª¤**
```dart
class CategoryHierarchyErrors {
  static const String CATEGORY_CIRCULAR_REFERENCE = 'CATEGORY_CIRCULAR_REFERENCE';
  static const String CATEGORY_MAX_DEPTH_EXCEEDED = 'CATEGORY_MAX_DEPTH_EXCEEDED';
  static const String CATEGORY_TYPE_MISMATCH = 'CATEGORY_TYPE_MISMATCH';
  static const String CATEGORY_PARENT_NOT_FOUND = 'CATEGORY_PARENT_NOT_FOUND';

  static ErrorResponse validateHierarchy(
    String? parentId,
    String categoryType,
    String userId,
    String userMode
  ) {
    if (parentId != null) {
      final parent = _findCategory(parentId, userId);

      if (parent == null) {
        return _createBusinessError(
          CATEGORY_PARENT_NOT_FOUND,
          _getModeMessage(userMode, {
            'Expert': 'æŒ‡å®šçš„çˆ¶ç§‘ç›®ä¸å­˜åœ¨',
            'Cultivation': 'æ‰€é¸çš„ä¸Šå±¤ç§‘ç›®å·²ä¸å­˜åœ¨ï¼Œè«‹é‡æ–°é¸æ“‡',
            'Guiding': 'è«‹é‡æ–°é¸æ“‡ç§‘ç›®åˆ†é¡'
          }),
          [
            ErrorAction(
              actionType: 'retry',
              label: 'é‡æ–°é¸æ“‡',
              parameters: {'action': 'select_parent'}
            )
          ]
        );
      }

      // æª¢æŸ¥æ”¶æ”¯é¡å‹ä¸€è‡´æ€§
      if (parent.type != categoryType) {
        return _createBusinessError(
          CATEGORY_TYPE_MISMATCH,
          _getModeMessage(userMode, {
            'Expert': 'å­ç§‘ç›®é¡å‹å¿…é ˆèˆ‡çˆ¶ç§‘ç›®ä¸€è‡´',
            'Cultivation': 'æ”¶å…¥å’Œæ”¯å‡ºç§‘ç›®ä¸èƒ½æ··åˆï¼Œè«‹é‡æ–°é¸æ“‡',
            'Guiding': 'é¡å‹ä¸ç¬¦ï¼Œè«‹é‡æ–°é¸æ“‡'
          }),
          _getTypeErrorActions(userMode)
        );
      }

      // æª¢æŸ¥éšå±¤æ·±åº¦ï¼ˆæœ€å¤š3å±¤ï¼‰
      if (_calculateDepth(parent) >= 3) {
        return _createBusinessError(
          CATEGORY_MAX_DEPTH_EXCEEDED,
          _getModeMessage(userMode, {
            'Expert': 'ç§‘ç›®éšå±¤æ·±åº¦ä¸èƒ½è¶…é3å±¤',
            'Cultivation': 'ç‚ºäº†æ¸…æ™°ç®¡ç†ï¼Œç§‘ç›®æœ€å¤šåªèƒ½æœ‰3å±¤',
            'Guiding': 'å±¤ç´šå¤ªæ·±ï¼Œè«‹é¸æ“‡ä¸Šå±¤ç§‘ç›®'
          }),
          _getDepthErrorActions(userMode)
        );
      }
    }

    return ErrorResponse.noError();
  }
}
```

#### 4.3.2 ç§‘ç›®ä½¿ç”¨çµ±è¨ˆéŒ¯èª¤

**FR-4.3.2-01 çµ±è¨ˆè³‡æ–™éŒ¯èª¤è™•ç†**
```dart
class CategoryStatisticsErrors {
  static ErrorResponse handleStatisticsError(
    Exception exception,
    String userMode,
    {bool isBackground = false}
  ) {
    if (isBackground && userMode == 'Guiding') {
      // Guidingæ¨¡å¼èƒŒæ™¯çµ±è¨ˆéŒ¯èª¤ä¸å½±éŸ¿ä¸»è¦åŠŸèƒ½
      return ErrorResponse.silent();
    }

    return ErrorResponse(
      success: false,
      error: ErrorData(
        code: 'STATISTICS_CALCULATION_ERROR',
        message: _getModeMessage(userMode, {
          'Expert': 'çµ±è¨ˆè³‡æ–™è¨ˆç®—å¤±æ•—ï¼š${exception.toString()}',
          'Inertial': 'çµ±è¨ˆè³‡æ–™æš«æ™‚ç„¡æ³•å–å¾—',
          'Cultivation': 'æ­£åœ¨é‡æ–°è¨ˆç®—ä½¿ç”¨çµ±è¨ˆï¼Œè«‹ç¨å€™',
          'Guiding': 'è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™'
        }),
        category: ErrorCategory.system,
        severity: isBackground ? ErrorSeverity.low : ErrorSeverity.medium,
        suggestedActions: _getStatisticsErrorActions(userMode, isBackground)
      )
    );
  }
}
```

### 4.4 ç¶²è·¯é€£ç·šéŒ¯èª¤

#### 4.4.1 é€£ç·šç‹€æ…‹è™•ç†

**FR-4.4.1-01 é€£ç·šç‹€æ…‹è™•ç†**
```dart
class NetworkErrorHandler {
  static const String NETWORK_UNAVAILABLE = 'NETWORK_UNAVAILABLE';
  static const String REQUEST_TIMEOUT = 'REQUEST_TIMEOUT';
  static const String SERVER_UNAVAILABLE = 'SERVER_UNAVAILABLE';
  static const String API_RATE_LIMIT = 'API_RATE_LIMIT';

  static ErrorResponse handleNetworkError(
    NetworkException exception,
    String userMode,
    {bool hasCache = false}
  ) {
    switch (exception.type) {
      case NetworkExceptionType.noConnection:
        return _handleOfflineMode(userMode, hasCache);

      case NetworkExceptionType.timeout:
        return _handleTimeout(userMode);

      case NetworkExceptionType.serverError:
        return _handleServerError(exception, userMode);

      case NetworkExceptionType.rateLimited:
        return _handleRateLimit(userMode);

      default:
        return _handleGenericNetworkError(exception, userMode);
    }
  }

  static ErrorResponse _handleOfflineMode(String userMode, bool hasCache) {
    if (hasCache) {
      return ErrorResponse.warning(
        code: 'OFFLINE_MODE_CACHED',
        message: _getModeMessage(userMode, {
          'Expert': 'é›¢ç·šæ¨¡å¼ï¼šé¡¯ç¤ºå¿«å–è³‡æ–™ï¼Œéƒ¨åˆ†åŠŸèƒ½å—é™',
          'Inertial': 'ç¶²è·¯æ–·ç·šï¼Œé¡¯ç¤ºå·²å„²å­˜çš„è³‡æ–™',
          'Cultivation': 'ç›®å‰é›¢ç·šä¸­ï¼Œé¡¯ç¤ºæœ€å¾ŒåŒæ­¥çš„è³‡æ–™',
          'Guiding': 'é›¢ç·šä¸­ï¼Œé¡¯ç¤ºä¹‹å‰çš„è³‡æ–™'
        }),
        actions: [
          ErrorAction(
            actionType: 'retry',
            label: 'é‡æ–°é€£ç·š',
            parameters: {'auto_retry': true}
          )
        ]
      );
    }

    return ErrorResponse(
      success: false,
      error: ErrorData(
        code: NETWORK_UNAVAILABLE,
        message: _getModeMessage(userMode, {
          'Expert': 'ç¶²è·¯é€£ç·šå¤±æ•—ï¼Œç„¡å¯ç”¨å¿«å–è³‡æ–™',
          'Inertial': 'ç¶²è·¯é€£ç·šæœ‰å•é¡Œ',
          'Cultivation': 'è«‹æª¢æŸ¥ç¶²è·¯é€£ç·šï¼Œç¢ºä¿èƒ½æ­£å¸¸ä½¿ç”¨åŠŸèƒ½',
          'Guiding': 'ç„¡æ³•é€£ç·šï¼Œè«‹æª¢æŸ¥ç¶²è·¯'
        }),
        category: ErrorCategory.network,
        severity: ErrorSeverity.high,
        suggestedActions: _getNetworkErrorActions(userMode)
      )
    );
  }
}
```

#### 4.4.2 é‡è©¦æ©Ÿåˆ¶

**FR-4.4.2-01 æ™ºæ…§é‡è©¦ç­–ç•¥**
```dart
class RetryStrategy {
  static const int MAX_RETRY_ATTEMPTS = 3;
  static const Duration INITIAL_BACKOFF = Duration(seconds: 1);
  static const Duration MAX_BACKOFF = Duration(seconds: 30);

  static Future<T> executeWithRetry<T>(
    Future<T> Function() operation,
    {
      int maxAttempts = MAX_RETRY_ATTEMPTS,
      Duration initialDelay = INITIAL_BACKOFF,
      String userMode = 'Expert'
    }
  ) async {
    int attempts = 0;
    Duration delay = initialDelay;

    while (attempts < maxAttempts) {
      try {
        return await operation();
      } catch (exception) {
        attempts++;

        if (attempts >= maxAttempts) {
          throw RetryExhaustedException(
            originalException: exception,
            attempts: attempts,
            userMode: userMode
          );
        }

        // å››æ¨¡å¼å·®ç•°åŒ–é‡è©¦å»¶é²
        final actualDelay = _getModeRetryDelay(delay, userMode);
        await Future.delayed(actualDelay);

        delay = Duration(
          milliseconds: (delay.inMilliseconds * 1.5).round()
        );
        if (delay > MAX_BACKOFF) delay = MAX_BACKOFF;
      }
    }

    throw StateError('Unexpected retry loop exit');
  }

  static Duration _getModeRetryDelay(Duration baseDelay, String mode) {
    switch (mode) {
      case 'Expert':
        return baseDelay; // æ¨™æº–é‡è©¦é–“éš”
      case 'Inertial':
        return baseDelay * 1.2; // ç¨é•·é–“éš”ï¼Œé¿å…é »ç¹é‡è©¦
      case 'Cultivation':
        return baseDelay * 0.8; // ç¨çŸ­é–“éš”ï¼Œå¿«é€Ÿå›é¥‹
      case 'Guiding':
        return baseDelay * 1.5; // è¼ƒé•·é–“éš”ï¼Œæ¸›å°‘å¹²æ“¾
      default:
        return baseDelay;
    }
  }
}
```

### 4.5 æ¥­å‹™é‚è¼¯å±¤ç‰¹æ®Šè™•ç†

#### 4.5.1 å¿«å–åŒæ­¥éŒ¯èª¤

**FR-4.5.1-01 å¿«å–ä¸€è‡´æ€§éŒ¯èª¤**
```dart
class CacheSyncErrors {
  static const String CACHE_CORRUPTED = 'CACHE_CORRUPTED';
  static const String SYNC_CONFLICT = 'SYNC_CONFLICT';
  static const String CACHE_FULL = 'CACHE_FULL';

  static ErrorResponse handleCacheError(
    CacheException exception,
    String userMode
  ) {
    switch (exception.type) {
      case CacheExceptionType.corrupted:
        return _handleCorruptedCache(userMode);

      case CacheExceptionType.syncConflict:
        return _handleSyncConflict(exception, userMode);

      case CacheExceptionType.storageFull:
        return _handleStorageFull(userMode);

      default:
        return _handleGenericCacheError(exception, userMode);
    }
  }

  static ErrorResponse _handleSyncConflict(
    CacheException exception,
    String userMode
  ) {
    return ErrorResponse(
      success: false,
      error: ErrorData(
        code: SYNC_CONFLICT,
        message: _getModeMessage(userMode, {
          'Expert': 'è³‡æ–™åŒæ­¥è¡çªï¼šæœ¬åœ°èˆ‡é ç«¯è³‡æ–™ä¸ä¸€è‡´',
          'Inertial': 'è³‡æ–™åŒæ­¥æœ‰å•é¡Œ',
          'Cultivation': 'ç™¼ç¾è³‡æ–™å·®ç•°ï¼Œæ­£åœ¨ç‚ºæ‚¨è™•ç†',
          'Guiding': 'æ­£åœ¨åŒæ­¥è³‡æ–™'
        }),
        category: ErrorCategory.sync,
        severity: ErrorSeverity.medium,
        details: {
          'conflictType': exception.details?['conflictType'],
          'affectedItems': exception.details?['affectedItems']
        },
        suggestedActions: _getSyncConflictActions(userMode, exception)
      )
    );
  }
}
```

#### 4.5.2 å››æ¨¡å¼éŒ¯èª¤æ¢å¾©ç­–ç•¥

**FR-4.5.2-01 æ¨¡å¼ç‰¹å®šæ¢å¾©æ©Ÿåˆ¶**
```dart
class ModeSpecificRecovery {
  static ErrorResponse processErrorForMode(
    ErrorResponse baseError,
    String userMode
  ) {
    switch (userMode) {
      case 'Expert':
        return _expertModeRecovery(baseError);
      case 'Inertial':
        return _inertialModeRecovery(baseError);
      case 'Cultivation':
        return _cultivationModeRecovery(baseError);
      case 'Guiding':
        return _guidingModeRecovery(baseError);
      default:
        return baseError;
    }
  }

  static ErrorResponse _expertModeRecovery(ErrorResponse error) {
    // Expertæ¨¡å¼ï¼šæä¾›è©³ç´°è³‡è¨Šèˆ‡å¤šç¨®è§£æ±ºæ–¹æ¡ˆ
    return error.copyWith(
      modeError: ModeSpecificError(
        expertData: ExpertErrorData(
          technicalSolutions: [
            'æª¢æŸ¥ç¶²è·¯é€£ç·šç‹€æ…‹',
            'æ¸…é™¤æ‡‰ç”¨ç¨‹å¼å¿«å–',
            'é‡æ–°ç™»å…¥ä»¥æ›´æ–°èªè­‰',
            'è¯ç¹«æŠ€è¡“æ”¯æ´'
          ],
          debugInfo: {
            'errorContext': _getErrorContext(),
            'systemInfo': _getSystemInfo()
          }
        )
      )
    );
  }

  static ErrorResponse _cultivationModeRecovery(ErrorResponse error) {
    // Cultivationæ¨¡å¼ï¼šè½‰åŒ–éŒ¯èª¤ç‚ºå­¸ç¿’æ©Ÿæœƒ
    return error.copyWith(
      modeError: ModeSpecificError(
        cultivationData: CultivationErrorData(
          guidanceMessage: 'é€™æ˜¯å­¸ç¿’å¦‚ä½•è™•ç†å•é¡Œçš„å¥½æ©Ÿæœƒï¼',
          tips: [
            LearningTip(
              title: 'éŒ¯èª¤è™•ç†å°æŠ€å·§',
              content: 'é‡åˆ°å•é¡Œæ™‚ï¼Œå…ˆæª¢æŸ¥ç¶²è·¯é€£ç·šæ˜¯å¸¸è¦‹çš„è§£æ±ºæ–¹æ³•'
            )
          ],
          preventionAdvice: 'å»ºè­°å®šæœŸæª¢æŸ¥APPæ›´æ–°ï¼Œå¯é é˜²é¡ä¼¼å•é¡Œ',
          showTutorial: _shouldShowTutorial(error)
        )
      )
    );
  }

  static ErrorResponse _guidingModeRecovery(ErrorResponse error) {
    // Guidingæ¨¡å¼ï¼šæ¥µç°¡éŒ¯èª¤è™•ç†ï¼Œè‡ªå‹•æ¢å¾©
    if (_canAutoRecover(error)) {
      _initiateAutoRecovery(error);
      return ErrorResponse.recoveryInProgress('æ­£åœ¨è‡ªå‹•ä¿®å¾©...');
    }

    return error.copyWith(
      modeError: ModeSpecificError(
        simpleMessage: _simplifyErrorMessage(error.error.message)
      )
    );
  }
}