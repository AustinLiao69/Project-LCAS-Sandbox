
# 7104. é ç®—ç®¡ç†åŠŸèƒ½ç¾¤_SRS.md

**æ–‡ä»¶ç·¨è™Ÿ**: 7104  
**ç‰ˆæœ¬**: v1.0.0  
**å»ºç«‹æ—¥æœŸ**: 2025-10-22  
**å»ºç«‹è€…**: LCAS PM Team  
**æœ€å¾Œæ›´æ–°**: 2025-10-22  

---

## ğŸ“‘ ç›®æ¬¡ (Table of Contents)

1. [æ¨¡çµ„æ¦‚è¿° (Module Overview)](#10-æ¨¡çµ„æ¦‚è¿°module-overview)

2. [åŠŸèƒ½éœ€æ±‚ (Functional Requirements)](#20-åŠŸèƒ½éœ€æ±‚functional-requirements)
   - 2.1 é ç®—ç®¡ç†ä¸»é åŠŸèƒ½
   - 2.2 å»ºç«‹é ç®—é åŠŸèƒ½
   - 2.3 é ç®—åŸ·è¡Œç›£æ§åŠŸèƒ½
   - 2.4 é ç®—è­¦ç¤ºæ©Ÿåˆ¶åŠŸèƒ½
   - 2.5 å››æ¨¡å¼å·®ç•°åŒ–åŠŸèƒ½

3. [è¼¸å…¥/è¼¸å‡ºè¦æ ¼ (Input & Output Specifications)](#30-è¼¸å…¥è¼¸å‡ºè¦æ ¼input--output-specifications)
   - 3.1 è¼¸å…¥
   - 3.2 è¼¸å‡º

4. [éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³ (Error Handling & Edge Cases)](#40-éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³error-handling--edge-cases)
   - 4.1 é ç®—è¨­å®šç›¸é—œéŒ¯èª¤
   - 4.2 é ç®—ç›£æ§ç›¸é—œéŒ¯èª¤
   - 4.3 è³‡æ–™é©—è­‰éŒ¯èª¤
   - 4.4 ç³»çµ±ç•°å¸¸è™•ç†

---

## 1.0 æ¨¡çµ„æ¦‚è¿°ï¼ˆModule Overviewï¼‰

### 1.1 æ¨¡çµ„å®šä½èˆ‡è·è²¬

**é ç®—ç®¡ç†åŠŸèƒ½ç¾¤**æ˜¯LCAS 2.0å°ˆæ¡ˆPresentation Layerçš„æ ¸å¿ƒè²¡å‹™ç®¡ç†æ¨¡çµ„ç¾¤ï¼Œè² è²¬æä¾›ä½¿ç”¨è€…å®Œæ•´çš„é ç®—è¨­å®šã€ç›£æ§èˆ‡è­¦ç¤ºåŠŸèƒ½ã€‚æœ¬åŠŸèƒ½ç¾¤å°æ‡‰0090 Sprintè¨ˆç•«çš„**Phase 2**ç¯„åœï¼Œç‚ºä½¿ç”¨è€…æä¾›ä¸»å‹•å¼çš„è²¡å‹™æ§åˆ¶å·¥å…·ã€‚

**æ ¸å¿ƒè·è²¬ç¯„åœ**ï¼š
- ğŸ’° **é ç®—è¨­å®š**ï¼šå¤šé¡å‹é ç®—å»ºç«‹ã€é€±æœŸè¨­å®šã€ç›®æ¨™ç®¡ç†
- ğŸ“Š **åŸ·è¡Œç›£æ§**ï¼šå³æ™‚ä½¿ç”¨ç‡è¿½è¹¤ã€é€²åº¦åˆ†æã€è¶¨å‹¢é æ¸¬
- âš ï¸ **æ™ºæ…§è­¦ç¤º**ï¼šè¶…æ”¯é è­¦ã€é”æˆæé†’ã€å€‹äººåŒ–é€šçŸ¥
- ğŸ“ˆ **åˆ†ææ´å¯Ÿ**ï¼šé ç®—è¡¨ç¾åˆ†æã€ä½¿ç”¨æ¨¡å¼è­˜åˆ¥ã€æœ€ä½³åŒ–å»ºè­°
- ğŸ¯ **å››æ¨¡å¼é©é…**ï¼šä¾æ“šä½¿ç”¨è€…æ¨¡å¼æä¾›å·®ç•°åŒ–é«”é©—

### 1.2 åŠŸèƒ½ç¾¤ç¯„åœå®šç¾©

åŸºæ–¼7021 Screen listæ–‡ä»¶ï¼Œæœ¬åŠŸèƒ½ç¾¤æ¶µè“‹ä»¥ä¸‹2å€‹æ ¸å¿ƒç•«é¢ï¼š

| ç•«é¢ç·¨è™Ÿ | ç•«é¢åç¨± | Phase | æ ¸å¿ƒåŠŸèƒ½ | å››æ¨¡å¼æ”¯æ´ |
|----------|----------|-------|----------|------------|
| **S-307** | é ç®—ç®¡ç†ä¸»é  | Phase 2 | é ç®—ç¸½è¦½ã€ç‹€æ…‹ç›£æ§ã€å¿«é€Ÿæ“ä½œ | âœ… å·®ç•°åŒ– |
| **S-308** | å»ºç«‹é ç®—é  | Phase 2 | é ç®—å»ºç«‹ã€è¨­å®šé…ç½®ã€æ¨¡æ¿å¥—ç”¨ | âœ… å·®ç•°åŒ– |

### 1.3 å››æ¨¡å¼å·®ç•°åŒ–ç­–ç•¥

åŸºæ–¼0015æ–‡ä»¶çš„å››æ¨¡å¼ç†è«–ï¼Œæœ¬åŠŸèƒ½ç¾¤å¯¦ç¾ä»¥ä¸‹å·®ç•°åŒ–ç­–ç•¥ï¼š

#### 1.3.1 Expertæ¨¡å¼ï¼ˆå°ˆå®¶æ¨¡å¼ï¼‰
- **é ç®—åŠŸèƒ½**ï¼šè¤‡é›œé ç®—è¦å‰‡ã€å¤šç¶­åº¦åˆ†æã€ç²¾ç´°åŒ–æ§åˆ¶ã€é€²éšçµ±è¨ˆ
- **ç›£æ§åŠŸèƒ½**ï¼šè©³ç´°åŸ·è¡Œå ±å‘Šã€è¶¨å‹¢åˆ†æã€é æ¸¬æ¨¡å‹ã€æ•ˆèƒ½æŒ‡æ¨™
- **è¦–è¦ºé¢¨æ ¼**ï¼šå°ˆæ¥­è—è‰²èª¿ã€é«˜è³‡è¨Šå¯†åº¦ã€å¤šå±¤æ¬¡åœ–è¡¨ã€é€²éšå·¥å…·

#### 1.3.2 Inertialæ¨¡å¼ï¼ˆæ…£æ€§æ¨¡å¼ï¼‰
- **é ç®—åŠŸèƒ½**ï¼šæ¨™æº–é ç®—ç®¡ç†ã€ç°¡æ½”è¨­å®šã€å›ºå®šé€±æœŸã€åŸºæœ¬ç›£æ§
- **ç›£æ§åŠŸèƒ½**ï¼šæ¸…æ™°é€²åº¦é¡¯ç¤ºã€æ¨™æº–è­¦ç¤ºã€åŸºæœ¬çµ±è¨ˆè³‡è¨Š
- **è¦–è¦ºé¢¨æ ¼**ï¼šç©©å®šç°è—è‰²èª¿ã€é©ä¸­è³‡è¨Šå¯†åº¦ã€ç›´è§€åœ–è¡¨

#### 1.3.3 Cultivationæ¨¡å¼ï¼ˆé¤Šæˆæ¨¡å¼ï¼‰
- **é ç®—åŠŸèƒ½**ï¼šé ç®—å¼•å°ã€ç¿’æ…£åŸ¹é¤Šã€ç›®æ¨™è¿½è¹¤ã€æ¿€å‹µæ©Ÿåˆ¶
- **ç›£æ§åŠŸèƒ½**ï¼šæˆå°±ç³»çµ±ã€é€²æ­¥æé†’ã€æŒ‘æˆ°è¨­å®šã€ç¿’æ…£å¼·åŒ–
- **è¦–è¦ºé¢¨æ ¼**ï¼šæ´»åŠ›ç¶ è‰²èª¿ã€å‹•æ…‹åé¥‹ã€æˆé•·è¦–è¦ºåŒ–ã€æ¿€å‹µè¨­è¨ˆ

#### 1.3.4 Guidingæ¨¡å¼ï¼ˆå¼•å°æ¨¡å¼ï¼‰
- **é ç®—åŠŸèƒ½**ï¼šæ¥µç°¡é ç®—ã€è‡ªå‹•å»ºè­°ã€é è¨­è¨­å®šã€æœ€å°‘æ±ºç­–
- **ç›£æ§åŠŸèƒ½**ï¼šç°¡åŒ–é€šçŸ¥ã€åŸºæœ¬æé†’ã€ä¸€éµæ“ä½œã€ç›´è§€æŒ‡å¼•
- **è¦–è¦ºé¢¨æ ¼**ï¼šæº«å’Œæ©˜è‰²èª¿ã€å¤§æŒ‰éˆ•è¨­è¨ˆã€ç°¡å–®åœ–ç¤ºã€æ¸…æ™°æŒ‡å¼•

### 1.4 æŠ€è¡“æ¶æ§‹æ•´åˆ

#### 1.4.1 APIæ•´åˆè¦ç¯„
æœ¬åŠŸèƒ½ç¾¤**åš´æ ¼éµå¾ª0026æ–‡ä»¶PL-APL-BLä¸‰å±¤æ¶æ§‹å°æ‡‰**ï¼Œåƒ…æ¶ˆè²»ä»¥ä¸‹APIæœå‹™ï¼š

- **8107 é ç®—ç®¡ç†æœå‹™API**ï¼šé ç®—CRUDã€ç›£æ§çµ±è¨ˆã€è­¦ç¤ºç®¡ç†ã€æ¨¡æ¿æœå‹™

#### 1.4.2 ç‹€æ…‹ç®¡ç†æ¶æ§‹
```dart
// é ç®—ç®¡ç†ç‹€æ…‹ç®¡ç†çµæ§‹
BudgetStateManager/
â”œâ”€â”€ BudgetListState          // é ç®—åˆ—è¡¨ç‹€æ…‹
â”œâ”€â”€ BudgetCreationState      // é ç®—å»ºç«‹ç‹€æ…‹
â”œâ”€â”€ BudgetMonitoringState    // ç›£æ§ç‹€æ…‹
â”œâ”€â”€ AlertState              // è­¦ç¤ºç‹€æ…‹
â””â”€â”€ TemplateState           // æ¨¡æ¿ç‹€æ…‹
```

#### 1.4.3 æœ¬åœ°è³‡æ–™å„²å­˜
- **è‰ç¨¿é ç®—**ï¼šSharedPreferencesæš«å­˜
- **å¸¸ç”¨æ¨¡æ¿**ï¼šæœ¬åœ°å¿«å–æ©Ÿåˆ¶
- **ç›£æ§è³‡æ–™**ï¼šSQLiteé›¢ç·šå„²å­˜

### 1.5 å“è³ªèˆ‡å®‰å…¨è¦æ±‚

#### 1.5.1 æ•ˆèƒ½è¦æ±‚
- **é ç®—è¼‰å…¥æ™‚é–“**ï¼šâ‰¤ 1ç§’ï¼ˆåˆ—è¡¨é ï¼‰ã€â‰¤ 2ç§’ï¼ˆè©³ç´°é ï¼‰
- **å»ºç«‹é ç®—æ™‚é–“**ï¼šâ‰¤ 3ç§’ï¼ˆå®Œæ•´æµç¨‹ï¼‰
- **ç›£æ§æ›´æ–°é »ç‡**ï¼šå³æ™‚ï¼ˆç”¨æˆ¶æ“ä½œï¼‰ã€æ¯5åˆ†é˜ï¼ˆè‡ªå‹•åŒæ­¥ï¼‰

#### 1.5.2 å®‰å…¨è¦æ±‚
- **è³‡æ–™é©—è­‰**ï¼šå‰ç«¯é©—è­‰ + å¾Œç«¯é©—è­‰é›™é‡ä¿è­·
- **éš±ç§ä¿è­·**ï¼šé ç®—è³‡æ–™åŠ å¯†å‚³è¼¸èˆ‡å„²å­˜
- **æ¬Šé™æ§åˆ¶**ï¼šå¤šå¸³æœ¬é ç®—æ¬Šé™é©—è­‰

#### 1.5.3 å¯ç”¨æ€§è¦æ±‚
- **é›¢ç·šæ”¯æ´**ï¼šé ç®—æŸ¥çœ‹ã€è‰ç¨¿å„²å­˜ã€åŸºæœ¬è¨ˆç®—
- **éŒ¯èª¤å¾©åŸ**ï¼šè‡ªå‹•é‡è©¦ã€è³‡æ–™åŒæ­¥ã€å‹å–„æç¤º
- **ç„¡éšœç¤™æ”¯æ´**ï¼šèªéŸ³æç¤ºã€å¤§å­—é«”ã€ç°¡åŒ–æ“ä½œ

### 1.6 èˆ‡å…¶ä»–åŠŸèƒ½ç¾¤çš„å”ä½œ

#### 1.6.1 åŠŸèƒ½ç¾¤ä»‹é¢
- **â† è¨˜å¸³æ ¸å¿ƒåŠŸèƒ½ç¾¤**ï¼šæ¥æ”¶äº¤æ˜“è³‡æ–™ï¼Œæä¾›é ç®—è¿½è¹¤åŸºç¤
- **â†’ å ±è¡¨åˆ†æåŠŸèƒ½ç¾¤**ï¼šæä¾›é ç®—åˆ†æè³‡æ–™ã€è¡¨ç¾å ±å‘Š
- **â†” å¸³æœ¬å”ä½œåŠŸèƒ½ç¾¤**ï¼šå¤šå¸³æœ¬é ç®—ç®¡ç†ã€æ¬Šé™æ§åˆ¶

#### 1.6.2 è³‡æ–™æµå‘
```
äº¤æ˜“è¨˜éŒ„ â†’ é ç®—è¨ˆç®— â†’ ç‹€æ…‹æ›´æ–° â†’ è­¦ç¤ºæª¢æŸ¥ â†’ é€šçŸ¥ç™¼é€
    â†“
é ç®—åˆ†æ â† ç‹€æ…‹ç®¡ç† â† ä½¿ç”¨è€…äº’å‹• â† å››æ¨¡å¼æ¸²æŸ“
```

---

## 2.0 åŠŸèƒ½éœ€æ±‚ï¼ˆFunctional Requirementsï¼‰

### 2.1 é ç®—ç®¡ç†ä¸»é åŠŸèƒ½
**å°æ‡‰ç•«é¢**ï¼šS-307 é ç®—ç®¡ç†ä¸»é 
**é–‹ç™¼å„ªå…ˆç´š**ï¼šP1ï¼ˆPhase 2 å¿…é ˆå®Œæˆï¼‰
**APIå°æ‡‰**ï¼š8107é ç®—ç®¡ç†æœå‹™API `/budgets`ã€`/budgets/status`

#### 2.1.1 åŸºæœ¬åŠŸèƒ½éœ€æ±‚
- **FR-307-001**ï¼šé¡¯ç¤ºæ‰€æœ‰æœ‰æ•ˆé ç®—çš„åŸ·è¡Œç‹€æ³ç¸½è¦½
- **FR-307-002**ï¼šæä¾›é ç®—ä½¿ç”¨ç‡çš„è¦–è¦ºåŒ–åœ–è¡¨å±•ç¤º
- **FR-307-003**ï¼šæ”¯æ´é ç®—ç¯©é¸åŠŸèƒ½ï¼ˆæŒ‰é¡å‹ã€ç‹€æ…‹ã€é€±æœŸï¼‰
- **FR-307-004**ï¼šæä¾›å¿«é€Ÿå»ºç«‹é ç®—çš„å…¥å£é»
- **FR-307-005**ï¼šæ•´åˆé ç®—è­¦ç¤ºèˆ‡é€šçŸ¥ä¸­å¿ƒ

#### 2.1.2 å››æ¨¡å¼å·®ç•°åŒ–éœ€æ±‚
- **Expertæ¨¡å¼**ï¼šå®Œæ•´é ç®—å„€è¡¨æ¿ã€é€²éšç¯©é¸ã€è©³ç´°çµ±è¨ˆã€æ‰¹æ¬¡æ“ä½œ
- **Inertialæ¨¡å¼**ï¼šç°¡æ½”é ç®—åˆ—è¡¨ã€åŸºæœ¬ç‹€æ…‹ã€æ¨™æº–æ“ä½œã€æ¸…æ™°å°èˆª
- **Cultivationæ¨¡å¼**ï¼šæˆå°±å±•ç¤ºã€é€²åº¦è¿½è¹¤ã€æ¿€å‹µè¨Šæ¯ã€ç¿’æ…£æé†’
- **Guidingæ¨¡å¼**ï¼šç°¡åŒ–é¡¯ç¤ºã€é‡é»æé†’ã€ä¸€éµæ“ä½œã€æ¸…æ™°æŒ‡å¼•

### 2.2 å»ºç«‹é ç®—é åŠŸèƒ½
**å°æ‡‰ç•«é¢**ï¼šS-308 å»ºç«‹é ç®—é 
**é–‹ç™¼å„ªå…ˆç´š**ï¼šP1ï¼ˆPhase 2 å¿…é ˆå®Œæˆï¼‰
**APIå°æ‡‰**ï¼š8107é ç®—ç®¡ç†æœå‹™API `/budgets`ã€`/budgets/templates`

#### 2.2.1 åŸºæœ¬åŠŸèƒ½éœ€æ±‚
- **FR-308-001**ï¼šæä¾›å®Œæ•´çš„é ç®—å»ºç«‹è¡¨å–®èˆ‡è¨­å®šé¸é …
- **FR-308-002**ï¼šæ”¯æ´å¤šç¨®é ç®—é¡å‹ï¼ˆç§‘ç›®ã€å¸³æˆ¶ã€æ¨™ç±¤ã€ç¸½é ç®—ï¼‰
- **FR-308-003**ï¼šæä¾›é ç®—é€±æœŸè¨­å®šï¼ˆæœˆåº¦ã€å­£åº¦ã€å¹´åº¦ã€è‡ªè¨‚ï¼‰
- **FR-308-004**ï¼šæ•´åˆé ç®—æ¨¡æ¿ç³»çµ±èˆ‡å¿«é€Ÿè¨­å®š
- **FR-308-005**ï¼šæ”¯æ´é ç®—è­¦ç¤ºæ¢ä»¶çš„è‡ªè¨‚è¨­å®š

#### 2.2.2 å››æ¨¡å¼å·®ç•°åŒ–éœ€æ±‚
- **Expertæ¨¡å¼**ï¼šå®Œæ•´è¨­å®šé¸é …ã€é€²éšè¦å‰‡ã€è‡ªè¨‚æ¨¡æ¿ã€è©³ç´°é…ç½®
- **Inertialæ¨¡å¼**ï¼šæ¨™æº–è¨­å®šæµç¨‹ã€å›ºå®šæ¨¡æ¿ã€æ¸…æ™°æ­¥é©Ÿã€ä¸€è‡´é«”é©—
- **Cultivationæ¨¡å¼**ï¼šå¼•å°å¼è¨­å®šã€å»ºè­°æ¨¡æ¿ã€ç›®æ¨™è¨­å®šã€ç¿’æ…£åŸ¹é¤Š
- **Guidingæ¨¡å¼**ï¼šæ¥µç°¡è¨­å®šã€è‡ªå‹•å»ºè­°ã€é è¨­å€¼ã€æœ€å°‘è¼¸å…¥

### 2.3 é ç®—åŸ·è¡Œç›£æ§åŠŸèƒ½
**è·¨ç•«é¢åŠŸèƒ½**ï¼šS-307ä¸»é ç›£æ§å€å¡Š
**é–‹ç™¼å„ªå…ˆç´š**ï¼šP1ï¼ˆPhase 2 å¿…é ˆå®Œæˆï¼‰
**APIå°æ‡‰**ï¼š8107é ç®—ç®¡ç†æœå‹™API `/budgets/{id}`

#### 2.3.1 åŸºæœ¬åŠŸèƒ½éœ€æ±‚
- **FR-MON-001**ï¼šå³æ™‚è¨ˆç®—é ç®—ä½¿ç”¨ç‡èˆ‡å‰©é¤˜é‡‘é¡
- **FR-MON-002**ï¼šæä¾›é ç®—åŸ·è¡Œé€²åº¦çš„è¦–è¦ºåŒ–å±•ç¤º
- **FR-MON-003**ï¼šæ”¯æ´å¤šç¶­åº¦çš„é ç®—åˆ†æï¼ˆæ™‚é–“ã€é¡åˆ¥ã€è¶¨å‹¢ï¼‰
- **FR-MON-004**ï¼šæ•´åˆé æ¸¬æ¨¡å‹ï¼Œé ä¼°é ç®—å®Œæˆæƒ…æ³
- **FR-MON-005**ï¼šæä¾›é ç®—è¡¨ç¾çš„æ­·å²æ¯”è¼ƒåŠŸèƒ½

#### 2.3.2 å››æ¨¡å¼å·®ç•°åŒ–éœ€æ±‚
- **Expertæ¨¡å¼**ï¼šè©³ç´°åˆ†æåœ–è¡¨ã€è¶¨å‹¢é æ¸¬ã€æ•ˆèƒ½æŒ‡æ¨™ã€æ¯”è¼ƒåˆ†æ
- **Inertialæ¨¡å¼**ï¼šåŸºæœ¬é€²åº¦æ¢ã€ç°¡å–®çµ±è¨ˆã€ç©©å®šé¡¯ç¤ºã€æ¸…æ™°è³‡è¨Š
- **Cultivationæ¨¡å¼**ï¼šé€²æ­¥å¯è¦–åŒ–ã€æˆå°±è¿½è¹¤ã€æ¿€å‹µåœ–è¡¨ã€ç¿’æ…£å¼·åŒ–
- **Guidingæ¨¡å¼**ï¼šç°¡å–®é€²åº¦ã€åŸºæœ¬æç¤ºã€ç›´è§€æŒ‡ç¤ºã€æœ€å°‘è³‡è¨Š

### 2.4 é ç®—è­¦ç¤ºæ©Ÿåˆ¶åŠŸèƒ½
**è·¨ç•«é¢åŠŸèƒ½**ï¼šæ•´åˆæ–¼S-307ä¸»é èˆ‡ç³»çµ±é€šçŸ¥
**é–‹ç™¼å„ªå…ˆç´š**ï¼šP1ï¼ˆPhase 2 å¿…é ˆå®Œæˆï¼‰
**APIå°æ‡‰**ï¼š8107é ç®—ç®¡ç†æœå‹™API `/budgets/alerts`

#### 2.4.1 åŸºæœ¬åŠŸèƒ½éœ€æ±‚
- **FR-ALERT-001**ï¼šæ”¯æ´å¤šå±¤ç´šé ç®—è­¦ç¤ºè¨­å®šï¼ˆæé†’ã€è­¦å‘Šã€åš´é‡ï¼‰
- **FR-ALERT-002**ï¼šæä¾›å¤šç¨®è§¸ç™¼æ¢ä»¶ï¼ˆç™¾åˆ†æ¯”ã€é‡‘é¡ã€æ™‚é–“ã€é æ¸¬ï¼‰
- **FR-ALERT-003**ï¼šæ•´åˆå¤šå…ƒé€šçŸ¥ç®¡é“ï¼ˆAPPã€LINEã€Emailï¼‰
- **FR-ALERT-004**ï¼šæ”¯æ´æ™ºæ…§è­¦ç¤ºé »ç‡æ§åˆ¶ï¼Œé¿å…éåº¦é€šçŸ¥
- **FR-ALERT-005**ï¼šæä¾›è­¦ç¤ºæ­·å²è¨˜éŒ„èˆ‡æ•ˆæœåˆ†æ

#### 2.4.2 å››æ¨¡å¼å·®ç•°åŒ–éœ€æ±‚
- **Expertæ¨¡å¼**ï¼šè¤‡é›œè­¦ç¤ºè¦å‰‡ã€å¤šæ¢ä»¶çµ„åˆã€è©³ç´°åˆ†æã€è‡ªè¨‚é€šçŸ¥
- **Inertialæ¨¡å¼**ï¼šæ¨™æº–è­¦ç¤ºè¨­å®šã€å›ºå®šæ¢ä»¶ã€åŸºæœ¬é€šçŸ¥ã€ç©©å®šè§¸ç™¼
- **Cultivationæ¨¡å¼**ï¼šæ¿€å‹µå¼è­¦ç¤ºã€ç¿’æ…£æé†’ã€æˆå°±é€šçŸ¥ã€æ­£å‘å›é¥‹
- **Guidingæ¨¡å¼**ï¼šç°¡å–®æé†’ã€é è¨­æ¢ä»¶ã€å‹å–„é€šçŸ¥ã€æ¸…æ™°æŒ‡å¼•

### 2.5 å››æ¨¡å¼å·®ç•°åŒ–åŠŸèƒ½
**è·¨ç•«é¢åŠŸèƒ½**ï¼šæ•´åˆæ–¼æ‰€æœ‰é ç®—ç®¡ç†ç•«é¢
**é–‹ç™¼å„ªå…ˆç´š**ï¼šP1ï¼ˆPhase 2 å¿…é ˆå®Œæˆï¼‰
**APIå°æ‡‰**ï¼šæ‰€æœ‰8107 APIç«¯é»çš„å››æ¨¡å¼åƒæ•¸

#### 2.5.1 æ¨¡å¼è­˜åˆ¥èˆ‡åˆ‡æ›
- **FR-MODE-001**ï¼šè‡ªå‹•è­˜åˆ¥ä½¿ç”¨è€…ç•¶å‰æ¨¡å¼è¨­å®š
- **FR-MODE-002**ï¼šå‹•æ…‹èª¿æ•´ä»‹é¢è¤‡é›œåº¦èˆ‡è³‡è¨Šå¯†åº¦
- **FR-MODE-003**ï¼šæä¾›æ¨¡å¼é–“çš„å¹³æ»‘åˆ‡æ›é«”é©—
- **FR-MODE-004**ï¼šä¿æŒæ¨¡å¼åˆ‡æ›å¾Œçš„è³‡æ–™ä¸€è‡´æ€§

#### 2.5.2 å€‹äººåŒ–é©é…æ©Ÿåˆ¶
- **FR-ADAPT-001**ï¼šæ ¹æ“šæ¨¡å¼èª¿æ•´åŠŸèƒ½å¯è¦‹æ€§èˆ‡æ“ä½œè¤‡é›œåº¦
- **FR-ADAPT-002**ï¼šæä¾›æ¨¡å¼å°ˆå±¬çš„é ç®—å»ºè­°èˆ‡æœ€ä½³å¯¦å‹™
- **FR-ADAPT-003**ï¼šå¯¦ç¾å·®ç•°åŒ–çš„è¦–è¦ºè¨­è¨ˆèˆ‡äº’å‹•é«”é©—
- **FR-ADAPT-004**ï¼šæ•´åˆæ¨¡å¼ç‰¹å®šçš„å¹«åŠ©å…§å®¹èˆ‡å¼•å°æµç¨‹

---

## 3.0 è¼¸å…¥/è¼¸å‡ºè¦æ ¼ï¼ˆInput & Output Specificationsï¼‰

### 3.1 è¼¸å…¥è¦æ ¼å¼•ç”¨

#### 3.1.1 é ç®—åˆ—è¡¨æŸ¥è©¢è¼¸å…¥è¦æ ¼ï¼ˆS-307ï¼‰
**APIç«¯é»**ï¼š`GET /budgets`  
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8107é ç®—ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/budgets` ç«¯é»  
**å››æ¨¡å¼å·®ç•°**ï¼š
- **Expertæ¨¡å¼**ï¼šæ”¯æ´å®Œæ•´ç¯©é¸åƒæ•¸èˆ‡æ’åºé¸é …
- **Guidingæ¨¡å¼**ï¼šåƒ…ä½¿ç”¨é è¨­åƒæ•¸èˆ‡ç°¡åŒ–æŸ¥è©¢

#### 3.1.2 å»ºç«‹é ç®—è¼¸å…¥è¦æ ¼ï¼ˆS-308ï¼‰
**APIç«¯é»**ï¼š`POST /budgets`  
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8107é ç®—ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/budgets` ç«¯é»  
**PLå±¤é—œæ³¨**ï¼šè¡¨å–®é©—è­‰ã€å¿…å¡«æ¬„ä½æª¢æŸ¥ã€å››æ¨¡å¼å·®ç•°åŒ–è™•ç†

#### 3.1.3 é ç®—ç‹€æ³æŸ¥è©¢è¼¸å…¥è¦æ ¼ï¼ˆS-307ï¼‰
**APIç«¯é»**ï¼š`GET /budgets/status`  
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8107é ç®—ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/budgets/status` ç«¯é»  
**PLå±¤é—œæ³¨**ï¼šå¸³æœ¬ç¯©é¸ã€ç‹€æ…‹æ›´æ–°é »ç‡ã€å››æ¨¡å¼é¡¯ç¤ºèª¿æ•´

### 3.2 è¼¸å‡ºè¦æ ¼å¼•ç”¨

#### 3.2.1 é ç®—åˆ—è¡¨è¼¸å‡ºè¦æ ¼ï¼ˆS-307ï¼‰
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8107é ç®—ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/budgets` æˆåŠŸå›æ‡‰  
**å››æ¨¡å¼å·®ç•°åŒ–è™•ç†**ï¼š
- **Expertæ¨¡å¼**ï¼šé¡¯ç¤ºå®Œæ•´é ç®—è³‡è¨Šã€é€²éšçµ±è¨ˆã€è©³ç´°åˆ†æ
- **Cultivationæ¨¡å¼**ï¼šé¡¯ç¤ºæˆå°±é€²åº¦ã€æ¿€å‹µè¨Šæ¯ã€ç¿’æ…£è¿½è¹¤
- **Inertial/Guidingæ¨¡å¼**ï¼šç°¡åŒ–é¡¯ç¤ºã€åŸºæœ¬è³‡è¨Šã€æ¸…æ™°ç‹€æ…‹

#### 3.2.2 å»ºç«‹é ç®—è¼¸å‡ºè¦æ ¼ï¼ˆS-308ï¼‰
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8107é ç®—ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/budgets` æˆåŠŸå›æ‡‰  
**PLå±¤è™•ç†é‡é»**ï¼š
- é ç®—å»ºç«‹æˆåŠŸå¾Œçš„ç¢ºèªå±•ç¤º
- å››æ¨¡å¼å·®ç•°åŒ–çš„å¾ŒçºŒæ“ä½œå»ºè­°
- é ç®—æ¨¡æ¿ä¿å­˜èˆ‡å¿«é€Ÿå¥—ç”¨

#### 3.2.3 é ç®—ç‹€æ³è¼¸å‡ºè¦æ ¼ï¼ˆS-307ï¼‰
**è¦æ ¼åƒç…§**ï¼š81è™Ÿè³‡æ–™å¤¾ â†’ 8107é ç®—ç®¡ç†æœå‹™APIè¦æ ¼ â†’ `/budgets/status` æˆåŠŸå›æ‡‰  
**å››æ¨¡å¼å·®ç•°åŒ–è™•ç†**ï¼š
- **Expertæ¨¡å¼**ï¼šå®Œæ•´ç›£æ§å„€è¡¨æ¿ã€è¶¨å‹¢åˆ†æã€æ•ˆèƒ½æŒ‡æ¨™
- **Cultivationæ¨¡å¼**ï¼šæˆå°±å±•ç¤ºã€é€²åº¦è¦–è¦ºåŒ–ã€æ¿€å‹µå…§å®¹
- **Inertial/Guidingæ¨¡å¼**ï¼šç°¡åŒ–ç›£æ§ã€åŸºæœ¬ç‹€æ…‹ã€æ¸…æ™°æç¤º

### 3.3 PLå±¤ç‰¹æ®Šè™•ç†éœ€æ±‚

#### 3.3.1 å››æ¨¡å¼éŸ¿æ‡‰å¼è™•ç†
PLå±¤éœ€æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼èª¿æ•´APIå›æ‡‰çš„è™•ç†æ–¹å¼ï¼š
- **è³‡æ–™éæ¿¾æ·±åº¦**ï¼šExpert > Inertial > Cultivation > Guiding
- **äº’å‹•è¤‡é›œåº¦**ï¼šä¾æ“šæ¨¡å¼èª¿æ•´é ç®—è¨­å®šé¸é …èˆ‡ç›£æ§åŠŸèƒ½
- **è¦–è¦ºå›é¥‹å¼·åº¦**ï¼šä¸åŒæ¨¡å¼æ¡ç”¨ä¸åŒçš„è­¦ç¤ºé¢¨æ ¼èˆ‡æ¿€å‹µæ©Ÿåˆ¶

#### 3.3.2 æœ¬åœ°å¿«å–ç­–ç•¥
- **é ç®—è‰ç¨¿**ï¼šå³æ™‚å„²å­˜ï¼Œæ”¯æ´é›¢ç·šç·¨è¼¯
- **æ¨¡æ¿è³‡æ–™**ï¼šé ç®—æ¨¡æ¿èˆ‡è¨­å®šæœ¬åœ°å¿«å–
- **ç›£æ§è³‡æ–™**ï¼šé—œéµé ç®—ç‹€æ…‹æœ¬åœ°å„²å­˜ï¼Œæ”¯æ´é›¢ç·šæª¢è¦–

#### 3.3.3 éŒ¯èª¤è™•ç†å°æ‡‰
æ‰€æœ‰APIéŒ¯èª¤è™•ç†åƒç…§ç¬¬4ç« è¦ç¯„ï¼ŒPLå±¤è² è²¬ï¼š
- é ç®—è¨­å®šéŒ¯èª¤çš„ä½¿ç”¨è€…å‹å–„åŒ–è½‰æ›
- ç›£æ§è³‡æ–™ç•°å¸¸æ™‚çš„å„ªé›…é™ç´šè™•ç†
- ç¶²è·¯ç•°å¸¸æ™‚çš„é›¢ç·šæ¨¡å¼æ”¯æ´

---

## 4.0 éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç‹€æ³ï¼ˆError Handling & Edge Casesï¼‰

### 4.1 é ç®—è¨­å®šç›¸é—œéŒ¯èª¤ï¼ˆåŸºæ–¼8107 APIè¦æ ¼ï¼‰

#### 4.1.1 é ç®—å»ºç«‹é©—è­‰éŒ¯èª¤ï¼ˆPOST /budgetsï¼‰
```yaml
VALIDATION_ERROR:
  http_status: 400
  code: "VALIDATION_ERROR"
  message: "é ç®—è¨­å®šåƒæ•¸ä¸æ­£ç¢º"
  field: "amount"
  ui_action: "æ¨™ç¤ºéŒ¯èª¤æ¬„ä½ä¸¦æä¾›ä¿®æ­£å»ºè­°"
  retry_allowed: true
  details:
    suggestions: ["è«‹è¼¸å…¥å¤§æ–¼0çš„é‡‘é¡", "å»ºè­°é‡‘é¡ç¯„åœï¼š100-999999", "å¯åƒè€ƒæ­·å²å¹³å‡æ”¯å‡º"]

DUPLICATE_BUDGET:
  http_status: 409
  code: "RESOURCE_CONFLICT"
  message: "è©²ç§‘ç›®å·²æœ‰ç›¸åŒé€±æœŸçš„é ç®—è¨­å®š"
  field: "target.categoryId"
  ui_action: "æç¤ºè¡çªä¸¦æä¾›è§£æ±ºæ–¹æ¡ˆ"
  retry_allowed: true
  details:
    conflicting_budget_id: "budget-uuid-existing"
    suggestions: ["ä¿®æ”¹ç¾æœ‰é ç®—", "é¸æ“‡ä¸åŒé€±æœŸ", "ä½¿ç”¨å­ç§‘ç›®é ç®—"]
```

#### 4.1.2 é ç®—æ¨¡æ¿è¼‰å…¥éŒ¯èª¤ï¼ˆGET /budgets/templatesï¼‰
```yaml
TEMPLATE_LOAD_FAILED:
  http_status: 500
  code: "SERVICE_UNAVAILABLE"
  message: "é ç®—æ¨¡æ¿æœå‹™æš«æ™‚ç„¡æ³•ä½¿ç”¨"
  ui_action: "æä¾›æ‰‹å‹•è¨­å®šé¸é …"
  retry_allowed: true
  fallback_available: true

TEMPLATE_NOT_COMPATIBLE:
  http_status: 422
  code: "BUSINESS_LOGIC_ERROR"
  message: "æ‰€é¸æ¨¡æ¿èˆ‡ç•¶å‰å¸³æœ¬è¨­å®šä¸ç›¸å®¹"
  field: "template_id"
  ui_action: "å»ºè­°ç›¸å®¹æ¨¡æ¿æˆ–æ‰‹å‹•è¨­å®š"
  retry_allowed: true
  details:
    compatibility_issues: ["ç§‘ç›®çµæ§‹ä¸åŒ¹é…", "å¹£åˆ¥ä¸æ”¯æ´"]
    alternative_templates: ["template-basic-001", "template-simple-002"]
```

### 4.2 é ç®—ç›£æ§ç›¸é—œéŒ¯èª¤

#### 4.2.1 é ç®—ç‹€æ³è¨ˆç®—éŒ¯èª¤ï¼ˆGET /budgets/statusï¼‰
```yaml
CALCULATION_ERROR:
  http_status: 500
  code: "INTERNAL_SERVER_ERROR"
  message: "é ç®—ä½¿ç”¨ç‡è¨ˆç®—ç•°å¸¸"
  ui_action: "é¡¯ç¤ºä¸Šæ¬¡æˆåŠŸè¨ˆç®—çµæœ"
  retry_allowed: true
  use_cached_data: true

DATA_SYNC_FAILED:
  http_status: 503
  code: "SERVICE_UNAVAILABLE"
  message: "é ç®—è³‡æ–™åŒæ­¥å¤±æ•—"
  ui_action: "ä½¿ç”¨æœ¬åœ°å¿«å–è³‡æ–™ä¸¦æç¤ºåŒæ­¥ç‹€æ…‹"
  retry_allowed: true
  offline_fallback: true
  details:
    last_sync_time: "2025-10-22T10:30:00Z"
    cached_data_age: "2å°æ™‚å‰"
```

#### 4.2.2 è­¦ç¤ºè¨­å®šéŒ¯èª¤ï¼ˆPOST /budgets/alertsï¼‰
```yaml
ALERT_SETUP_FAILED:
  http_status: 422
  code: "BUSINESS_LOGIC_ERROR"
  message: "è­¦ç¤ºæ¢ä»¶è¨­å®šç„¡æ•ˆ"
  field: "alerts.thresholds"
  ui_action: "é‡æ–°è¨­å®šè­¦ç¤ºæ¢ä»¶"
  retry_allowed: true
  details:
    invalid_thresholds: [150, -10]
    valid_range: "1-100"
    default_suggestions: [50, 80, 100]

NOTIFICATION_CHANNEL_ERROR:
  http_status: 400
  code: "VALIDATION_ERROR"
  message: "é€šçŸ¥ç®¡é“è¨­å®šéŒ¯èª¤"
  field: "alerts.notification_methods"
  ui_action: "æª¢æŸ¥ä¸¦é‡æ–°è¨­å®šé€šçŸ¥æ–¹å¼"
  retry_allowed: true
  details:
    unsupported_methods: ["sms"]
    available_methods: ["app", "email", "line"]
```

### 4.3 è³‡æ–™é©—è­‰éŒ¯èª¤

#### 4.3.1 é ç®—é‡‘é¡é©—è­‰éŒ¯èª¤
```yaml
AMOUNT_RANGE_ERROR:
  code: "VALIDATION_ERROR"
  message: "é ç®—é‡‘é¡è¶…å‡ºå…è¨±ç¯„åœ"
  ui_action: "èª¿æ•´é‡‘é¡è‡³åˆç†ç¯„åœ"
  retry_allowed: true
  details:
    min_amount: 1
    max_amount: 9999999
    suggested_amount: 5000
    based_on_history: true

AMOUNT_FORMAT_ERROR:
  code: "VALIDATION_ERROR"
  message: "é ç®—é‡‘é¡æ ¼å¼ä¸æ­£ç¢º"
  ui_action: "ä¿®æ­£é‡‘é¡æ ¼å¼"
  retry_allowed: true
  details:
    current_value: "abc"
    expected_format: "æ•¸å­—æ ¼å¼ï¼Œå¯å«å°æ•¸é»"
    examples: ["1000", "1500.50", "2000.00"]
```

#### 4.3.2 é€±æœŸè¨­å®šé©—è­‰éŒ¯èª¤
```yaml
PERIOD_INVALID:
  code: "VALIDATION_ERROR"
  message: "é ç®—é€±æœŸè¨­å®šç„¡æ•ˆ"
  ui_action: "é‡æ–°é¸æ“‡é€±æœŸè¨­å®š"
  retry_allowed: true
  details:
    invalid_period:
      start_date: "2025-10-22"
      end_date: "2025-10-20"
    error_reason: "çµæŸæ—¥æœŸä¸èƒ½æ—©æ–¼é–‹å§‹æ—¥æœŸ"
    min_duration: "1å¤©"
    max_duration: "5å¹´"

PERIOD_OVERLAP:
  code: "BUSINESS_LOGIC_ERROR"
  message: "é ç®—é€±æœŸèˆ‡ç¾æœ‰é ç®—é‡ç–Š"
  ui_action: "èª¿æ•´é€±æœŸæˆ–ä¿®æ”¹ç¾æœ‰é ç®—"
  retry_allowed: true
  details:
    overlapping_budget_id: "budget-uuid-002"
    overlapping_period: "2025-10-01 è‡³ 2025-10-31"
    suggestions: ["é¸æ“‡ä¸åŒé€±æœŸ", "åˆä½µé ç®—", "èª¿æ•´ç¾æœ‰é ç®—"]
```

### 4.4 ç³»çµ±ç•°å¸¸è™•ç†

#### 4.4.1 APIæœå‹™éŒ¯èª¤
```yaml
SERVICE_UNAVAILABLE:
  http_status: 503
  code: "SERVICE_UNAVAILABLE"
  message: "é ç®—ç®¡ç†æœå‹™æš«æ™‚ç„¡æ³•ä½¿ç”¨"
  ui_action: "å•Ÿç”¨é›¢ç·šæ¨¡å¼æˆ–ç¨å¾Œå†è©¦"
  retry_allowed: true
  offline_fallback: true
  estimated_recovery: "15åˆ†é˜"

RATE_LIMIT_EXCEEDED:
  http_status: 429
  code: "RATE_LIMIT_EXCEEDED"
  message: "è«‹æ±‚éæ–¼é »ç¹ï¼Œè«‹ç¨å¾Œå†è©¦"
  ui_action: "æš«åœæ“ä½œä¸¦é¡¯ç¤ºç­‰å¾…æç¤º"
  retry_allowed: true
  retry_after: 60
  details:
    current_limit: "100æ¬¡/åˆ†é˜"
    reset_time: "2025-10-22T11:00:00Z"
```

#### 4.4.2 æœ¬åœ°å„²å­˜éŒ¯èª¤
```yaml
LOCAL_STORAGE_ERROR:
  code: "LOCAL_STORAGE_ERROR"
  message: "æœ¬åœ°å„²å­˜ç©ºé–“ä¸è¶³ï¼Œç„¡æ³•ä¿å­˜é ç®—è‰ç¨¿"
  ui_action: "æ¸…ç†å¿«å–æˆ–é‡‹æ”¾ç©ºé–“"
  retry_allowed: true
  details:
    required_space: "2MB"
    available_space: "0.5MB"
    cleanup_options: ["æ¸…é™¤èˆŠå¿«å–", "ç§»é™¤æœªä½¿ç”¨æ¨¡æ¿"]

CACHE_CORRUPTION:
  code: "DATA_INTEGRITY_ERROR"
  message: "é ç®—å¿«å–è³‡æ–™æå£"
  ui_action: "é‡æ–°è¼‰å…¥é ç®—è³‡æ–™"
  retry_allowed: true
  auto_fix_attempted: true
  details:
    corrupted_files: ["budget_cache.json"]
    recovery_action: "é‡æ–°å¾æœå‹™å™¨è¼‰å…¥"
```

### 4.5 éŒ¯èª¤å›é¥‹èˆ‡å¾©åŸæ©Ÿåˆ¶

#### 4.5.1 å››æ¨¡å¼å·®ç•°åŒ–éŒ¯èª¤è™•ç†
```yaml
error_handling_by_mode:
  Expert:
    show_technical_details: true
    provide_debug_info: true
    show_advanced_recovery_options: true
    display_error_codes: true
  Inertial:
    show_standard_message: true
    provide_clear_actions: true
    maintain_interface_consistency: true
    focus_on_solution: true
  Cultivation:
    show_encouraging_message: true
    provide_learning_opportunity: true
    track_error_patterns: true
    offer_improvement_suggestions: true
  Guiding:
    show_simple_message: true
    provide_one_click_fix: true
    minimize_technical_complexity: true
    focus_on_guidance: true
```

#### 4.5.2 é›¢ç·šæ¨¡å¼æ”¯æ´
```yaml
offline_capabilities:
  supported_operations:
    - "é ç®—è‰ç¨¿ç·¨è¼¯èˆ‡å„²å­˜"
    - "æœ¬åœ°é ç®—ç‹€æ³æŸ¥çœ‹"
    - "å¿«å–é ç®—è³‡æ–™æª¢è¦–"
    - "è­¦ç¤ºè¨­å®šæš«å­˜"

  unsupported_operations:
    - "å³æ™‚é ç®—è¨ˆç®—"
    - "è·¨å¸³æœ¬é ç®—åŒæ­¥"
    - "é›²ç«¯æ¨¡æ¿è¼‰å…¥"

  sync_strategy:
    - "ç¶²è·¯æ¢å¾©å¾Œè‡ªå‹•åŒæ­¥"
    - "è¡çªæª¢æ¸¬èˆ‡è§£æ±º"
    - "åŒæ­¥ç‹€æ…‹å³æ™‚æç¤º"
    - "å¤±æ•—æ“ä½œé‡è©¦æ©Ÿåˆ¶"
```

#### 4.5.3 è‡ªå‹•é‡è©¦èˆ‡å¾©åŸ
```yaml
retry_strategies:
  budget_creation:
    max_attempts: 3
    backoff_strategy: "exponential"
    preserve_form_data: true
    show_progress_indicator: true

  status_monitoring:
    max_attempts: 5
    retry_interval: [2, 4, 8, 16, 32] # seconds
    use_cached_fallback: true
    update_frequency_adjustment: true

  alert_setup:
    max_attempts: 2
    immediate_feedback: true
    fallback_to_default: true
    preserve_user_preferences: true

graceful_degradation:
  monitoring_failure: "é¡¯ç¤ºä¸Šæ¬¡æ›´æ–°è³‡æ–™"
  calculation_error: "ä½¿ç”¨ç°¡åŒ–è¨ˆç®—é‚è¼¯"
  template_unavailable: "æä¾›åŸºæœ¬é ç®—é¸é …"
  notification_failure: "ä½¿ç”¨æœ¬åœ°æé†’"
  sync_interrupted: "ä¿æŒæœ¬åœ°è³‡æ–™å®Œæ•´æ€§"
```
