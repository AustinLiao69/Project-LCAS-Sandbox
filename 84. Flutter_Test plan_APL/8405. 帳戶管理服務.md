# 8405. 帳戶管理服務 

**版本**: 2.3.0  
**建立日期**: 2025-09-05  
**最後更新**: 2025-09-05  
**建立者**: SQA Team  
**來源文件**: 8205. 帳戶管理服務.md, 8105. 帳戶管理服務 API 規格.yaml  
**遵循規範**: 8020. API list.md, 8088. API設計規範.md

---

## 📑 目次 (Table of Contents)

1. [測試概覽](#1-測試概覽)
   - 1.1 [測試範圍](#11-測試範圍)
   - 1.2 [測試目標](#12-測試目標)
   - 1.3 [風險評估](#13-風險評估)

2. [測試環境與準備](#2-測試環境與準備)
   - 2.1 [系統環境需求](#21-系統環境需求)
   - 2.2 [測試資料準備](#22-測試資料準備)
   - 2.3 [相依模組狀態](#23-相依模組狀態)

3. [功能測試範圍](#3-功能測試範圍)
   - 3.1 [帳戶CRUD模組測試](#31-帳戶crud模組測試)
   - 3.2 [帳戶類型管理模組測試](#32-帳戶類型管理模組測試)
   - 3.3 [餘額管理模組測試](#33-餘額管理模組測試)
   - 3.4 [帳戶轉帳模組測試](#34-帳戶轉帳模組測試)
   - 3.5 [帳戶統計模組測試](#35-帳戶統計模組測試)

4. [詳細測試案例](#4-詳細測試案例)
   - 4.1 [核心功能測試案例](#41-核心功能測試案例)
   - 4.2 [帳戶類型測試案例](#42-帳戶類型測試案例)
   - 4.3 [四模式差異化測試案例](#43-四模式差異化測試案例)
   - 4.4 [API端點一致性測試案例](#44-api端點一致性測試案例)
   - 4.5 [異常處理測試案例](#45-異常處理測試案例)

5. [效能與壓力測試](#5-效能與壓力測試)
   - 5.1 [帳戶管理效能](#51-帳戶管理效能)
   - 5.2 [餘額查詢能力](#52-餘額查詢能力)
   - 5.3 [記憶體使用監控](#53-記憶體使用監控)

6. [安全性與權限測試](#6-安全性與權限測試)
   - 6.1 [輸入驗證測試](#61-輸入驗證測試)
   - 6.2 [資料保護測試](#62-資料保護測試)
   - 6.3 [API安全性測試](#63-api安全性測試)

---

## 1. 測試概覽

### 1.1 測試範圍

#### 1.1.1 帳戶管理服務核心功能測試
- **帳戶CRUD操作**：建立、查詢、修改、刪除帳戶（17個函數）
- **餘額管理**：即時餘額查詢、餘額歷史追蹤（4個函數）
- **帳戶轉帳**：帳戶間資金轉移處理（4個函數）
- **帳戶類型管理**：現金、銀行、信用卡、投資、借貸帳戶類型（1個函數）
- **回應適配**：四模式差異化回應處理（8個函數）

#### 1.1.2 API端點整合測試
- **8105 API規格對應**：8個標準API端點完整驗證
- **8088 API設計規範**：統一回應格式、錯誤處理、JWT認證
- **8020 API list映射**：S-205、S-304、S-305畫面功能支援
- **四模式差異化**：Expert、Inertial、Cultivation、Guiding模式測試

#### 1.1.3 Dart語言函數規格測試
- **函數簽名驗證**：34個核心函數版次v2.3.0規格檢查
- **類別設計驗證**：5個主要類別架構完整性
- **介面一致性**：Repository Pattern實作正確性
- **模式適配器**：UserModeAdapter四模式回應過濾

### 1.2 測試目標

#### 1.2.1 功能完整性目標
- 帳戶管理服務34個函數100%功能驗證通過
- 6種帳戶類型完整支援驗證100%相容性確認
- API端點與8105規格100%一致性驗證
- 四模式差異化回應100%準確性驗證

#### 1.2.2 效能指標目標
- 單次帳戶操作回應時間 < 1 秒
- 餘額查詢處理回應時間 < 500ms
- 支援1000+併發帳戶查詢處理
- 記憶體使用率維持 < 80%

#### 1.2.3 穩定性目標
- 系統連續運行24小時無故障
- 帳戶操作成功率 > 99.5%
- 餘額計算準確率 = 100%
- 轉帳事務一致性 = 100%

### 1.3 風險評估

#### 1.3.1 高風險項目
1. **餘額計算一致性**
   - 風險：併發交易導致餘額計算錯誤
   - 影響：帳戶餘額不準確，財務資料錯誤
   - 緩解：完整的並發控制與事務一致性測試

2. **帳戶轉帳事務處理**
   - 風險：轉帳過程中系統異常導致資金遺失或重複
   - 影響：資金安全問題，用戶信任度下降
   - 緩解：完整的事務回滾與重試機制測試

3. **多帳戶類型複雜性**
   - 風險：不同帳戶類型的特殊屬性處理錯誤
   - 影響：帳戶功能受限，資料結構不一致
   - 緩解：每種帳戶類型的完整測試覆蓋

#### 1.3.2 中風險項目
1. **帳戶軟刪除邏輯**
   - 風險：有交易記錄的帳戶刪除邏輯複雜
   - 影響：資料意外遺失或無法正確清理
   - 緩解：完整的刪除流程測試

2. **四模式回應過濾**
   - 風險：UserModeAdapter過濾邏輯錯誤
   - 影響：使用者看到不適合其模式的資訊
   - 緩解：每個模式的完整回應測試驗證

---

## 2. 測試環境與準備

### 2.1 系統環境需求

#### 2.1.1 核心環境
- **Dart SDK**: 3.0.0+ (Flutter 3.13.0+)
- **測試框架**: test ^1.24.0
- **HTTP客戶端**: dio ^5.3.0
- **JSON序列化**: json_annotation ^4.8.0
- **UUID生成**: uuid ^4.0.0
- **數學計算**: decimal ^2.3.3 (精準餘額計算)

#### 2.1.2 API測試環境
- **測試伺服器**: https://api-staging.lcas.app/v1
- **認證方式**: Bearer Token (JWT) + Firebase Auth
- **API版本**: v1.0.0
- **回應格式**: JSON (遵循8088規範)

#### 2.1.3 帳戶類型測試環境
- **現金帳戶**: 基本現金管理功能
- **銀行帳戶**: 銀行名稱、帳號末四碼
- **信用卡帳戶**: 信用額度、負餘額支援
- **投資帳戶**: 利率、投資回報計算
- **借貸帳戶**: 利率、還款計算
- **其他帳戶**: 自定義帳戶類型

### 2.2 測試資料準備

#### 2.2.1 使用者測試資料
```dart
// 測試用戶類型 - v2.3.0
const Map<String, TestUser> testUsers = {
  'expertUser': TestUser('test_expert_001', UserMode.Expert),
  'inertialUser': TestUser('test_inertial_001', UserMode.Inertial),
  'cultivationUser': TestUser('test_cultivation_001', UserMode.Cultivation),
  'guidingUser': TestUser('test_guiding_001', UserMode.Guiding),
};
```

#### 2.2.2 帳戶測試資料
```dart
// 帳戶測試案例 - v2.3.0
const Map<String, CreateAccountRequest> testAccounts = {
  'cashAccount': CreateAccountRequest(
    name: '現金錢包',
    type: AccountType.cash,
    initialBalance: 5000.0
  ),
  'bankAccount': CreateAccountRequest(
    name: '中信支票帳戶',
    type: AccountType.bank,
    bankName: '中國信託',
    accountNumber: '****1234',
    initialBalance: 50000.0
  ),
  'creditCardAccount': CreateAccountRequest(
    name: '信用卡',
    type: AccountType.creditCard,
    bankName: '台新銀行',
    creditLimit: 100000.0,
    initialBalance: -5000.0
  ),
  'investmentAccount': CreateAccountRequest(
    name: '股票投資',
    type: AccountType.investment,
    interestRate: 5.2,
    initialBalance: 200000.0
  ),
};
```

#### 2.2.3 錯誤測試資料
- **無效帳戶名稱**: 空字串、超長字串、特殊字元、重複名稱
- **無效帳戶類型**: 不支援的類型、空值、錯誤格式
- **無效餘額**: 負數(非信用卡)、超大數值、非數字
- **無效轉帳**: 相同帳戶轉帳、餘額不足、帳戶不存在

### 2.3 相依模組狀態

#### 2.3.1 必要依賴模組
- **帳本管理服務**: v2.3.0+ (帳戶所屬帳本驗證)
- **認證服務**: v2.3.0+ (JWT Token驗證)
- **記帳交易服務**: v2.3.0+ (餘額計算與交易記錄)

#### 2.3.2 選用依賴模組
- **報表分析服務**: v2.3.0+ (帳戶統計資料)
- **通知管理服務**: v2.3.0+ (餘額變動通知)

---

## 3. 功能測試範圍

### 3.1 帳戶CRUD模組測試

#### 3.1.1 AccountController.getAccounts 測試重點
- **查詢參數驗證**: ledgerId、type、active、includeBalance篩選
- **分頁處理**: page、limit參數驗證，最大限制100筆
- **排序邏輯**: sortBy(name/type/balance/createdAt)正確性
- **四模式回應**: Expert詳細統計、Guiding簡化顯示

#### 3.1.2 AccountController.createAccount 測試重點  
- **輸入資料驗證**: name必填、type枚舉驗證、ledgerId存在性
- **帳戶類型處理**: 6種類型的特殊欄位驗證
- **初始餘額**: 正數驗證(除信用卡外)、精確度計算
- **重複檢查**: 同一帳本內帳戶名稱唯一性

#### 3.1.3 AccountController.updateAccount 測試重點
- **部分更新**: 支援選擇性欄位更新
- **不可變欄位**: type、ledgerId、initialBalance不可修改
- **名稱重複**: 更新後名稱不與其他帳戶重複
- **審計記錄**: 更新操作完整記錄

#### 3.1.4 AccountController.deleteAccount 測試重點
- **刪除策略**: 無交易記錄永久刪除、有交易記錄軟刪除
- **轉移邏輯**: transferTo參數處理、交易記錄轉移
- **強制刪除**: force參數功能驗證
- **級聯處理**: 相關資料一致性保證

### 3.2 帳戶類型管理模組測試

#### 3.2.1 多帳戶類型支援測試
- **現金帳戶**: 基本餘額管理、簡單收支記錄
- **銀行帳戶**: bankName、accountNumber必填驗證
- **信用卡帳戶**: creditLimit設定、負餘額支援
- **投資帳戶**: interestRate設定、投資回報計算
- **借貸帳戶**: interestRate設定、借款管理
- **其他帳戶**: 自定義類型、靈活設定

#### 3.2.2 AccountController.getAccountTypes 測試重點
- **類型列表**: 回傳6種標準帳戶類型
- **類型資訊**: 每種類型的描述、必填欄位、特殊屬性
- **模式過濾**: Guiding模式簡化類型選項
- **快取機制**: 類型資料快取有效性

### 3.3 餘額管理模組測試

#### 3.3.1 BalanceService.getCurrentBalance 測試重點
- **即時計算**: 基於交易記錄即時計算餘額
- **精確度**: 使用Decimal避免浮點誤差
- **效能**: 大量交易帳戶餘額查詢效能
- **快取策略**: 餘額查詢快取機制

#### 3.3.2 BalanceService.getBalanceHistory 測試重點
- **歷史區間**: 支援1-365天歷史查詢
- **資料完整性**: 每日餘額記錄完整性
- **變動計算**: 日變動、周變動、月變動準確性
- **資料壓縮**: 長期歷史資料壓縮策略

#### 3.3.3 AccountController.getAccountBalance 測試重點
- **回應格式**: 符合8105 API規格格式
- **變動統計**: today/thisWeek/thisMonth變動計算
- **歷史圖表**: balanceHistory陣列格式
- **效能優化**: includeHistory參數效能影響

### 3.4 帳戶轉帳模組測試

#### 3.4.1 TransferService.processTransfer 測試重點
- **參數驗證**: 來源帳戶、目標帳戶、轉帳金額驗證
- **餘額檢查**: 來源帳戶餘額充足性檢查
- **事務處理**: 雙邊帳戶餘額原子性更新
- **記錄建立**: 建立對應的收支交易記錄

#### 3.4.2 TransferService.validateTransfer 測試重點
- **轉帳規則**: 相同帳戶、不同帳本、停用帳戶檢查
- **金額限制**: 最小轉帳金額、最大轉帳金額
- **權限檢查**: 使用者對兩個帳戶的操作權限
- **時間限制**: 轉帳頻率限制、每日限額

#### 3.4.3 AccountController.transferFunds 測試重點
- **API格式**: 遵循8105規格的請求回應格式
- **錯誤處理**: 各種轉帳失敗情況處理
- **通知機制**: 轉帳成功後通知發送
- **審計追蹤**: 轉帳操作完整審計記錄

### 3.5 帳戶統計模組測試

#### 3.5.1 帳戶使用統計測試
- **交易計數**: 各帳戶交易次數統計
- **使用頻率**: 最後使用時間、使用頻率計算
- **月平均**: 月平均收入、支出、變動計算
- **趨勢分析**: 餘額變動趨勢、使用模式分析

---

## 4. 詳細測試案例

### 4.1 核心功能測試案例

#### TC-001: 帳戶列表查詢API正常流程測試
**測試函數表頭**:
```dart
/**
 * TC-001: 帳戶列表查詢測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，新增帳戶類型篩選驗證
 */
Future<void> testGetAccountsNormalFlow();
```
- **目的**: 驗證GET /accounts端點正常查詢流程
- **前置條件**:
  - 測試用戶已建立多種類型帳戶
  - JWT token有效
  - 四種用戶模式設定完成
- **測試步驟**:
  1. Expert模式查詢帳戶列表
  2. 驗證回應包含完整統計摘要
  3. Guiding模式查詢相同帳戶
  4. 驗證回應為簡化版本(無統計摘要)
  5. 測試分頁、排序、類型篩選參數
- **驗證點**:
  - HTTP狀態碼200
  - 回應格式符合8088規範
  - 四模式回應內容差異正確
  - 帳戶類型統計準確

#### TC-002: 帳戶建立API多類型測試
**測試函數表頭**:
```dart
/**
 * TC-002: 多類型帳戶建立測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，支援6種帳戶類型
 */
Future<void> testCreateAccountMultipleTypes();
```
- **目的**: 驗證POST /accounts端點6種帳戶類型建立
- **前置條件**:
  - 用戶已認證
  - 帳本存在
  - 測試資料準備完成
- **測試步驟**:
  1. 建立現金帳戶(基本類型)
  2. 建立銀行帳戶(bankName必填)
  3. 建立信用卡帳戶(creditLimit、負餘額)
  4. 建立投資帳戶(interestRate)
  5. 建立借貸帳戶(interestRate)
  6. 建立其他類型帳戶
- **驗證點**:
  - HTTP狀態碼201
  - 各類型特殊欄位正確儲存
  - 初始餘額設定正確
  - 帳戶ID唯一性

#### TC-003: 帳戶餘額查詢API精確度測試
**測試函數表頭**:
```dart
/**
 * TC-003: 帳戶餘額精確度測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，加強精確度驗證
 */
Future<void> testAccountBalanceAccuracy();
```
- **目的**: 驗證GET /accounts/{id}/balance端點餘額計算精確度
- **前置條件**:
  - 帳戶有多筆交易記錄
  - 包含小數點運算案例
- **測試步驟**:
  1. 建立帳戶並設定初始餘額
  2. 執行多筆含小數點的收支交易
  3. 查詢帳戶餘額
  4. 驗證餘額計算精確度
  5. 測試餘額歷史查詢
- **驗證點**:
  - 餘額計算絕對精確(無浮點誤差)
  - 歷史餘額記錄完整
  - 變動計算正確
  - 效能在可接受範圍

### 4.2 帳戶類型測試案例

#### TC-004: 信用卡帳戶特殊邏輯測試
**測試函數表頭**:
```dart
/**
 * TC-004: 信用卡帳戶測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，完善信用卡邏輯
 */
Future<void> testCreditCardAccountLogic();
```
- **目的**: 驗證信用卡帳戶特殊邏輯處理
- **前置條件**:
  - 信用卡帳戶已建立
  - 設定信用額度
- **測試步驟**:
  1. 測試負餘額支援
  2. 測試信用額度檢查
  3. 測試超額提醒
  4. 測試還款處理
  5. 驗證可用額度計算
- **驗證點**:
  - 負餘額正常顯示
  - 信用額度限制有效
  - 可用額度 = 信用額度 + 當前餘額
  - 超額警告正確觸發

#### TC-005: 投資帳戶利率計算測試
**測試函數表頭**:
```dart
/**
 * TC-005: 投資帳戶利率計算測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，新增投資回報計算
 */
Future<void> testInvestmentAccountInterest();
```
- **目的**: 驗證投資帳戶利率相關功能
- **前置條件**:
  - 投資帳戶已建立
  - 設定利率參數
- **測試步驟**:
  1. 測試利率設定與顯示
  2. 測試預期收益計算
  3. 測試收益統計
  4. 測試複利計算
  5. 驗證收益歷史記錄
- **驗證點**:
  - 利率設定正確儲存
  - 收益計算公式準確
  - 複利計算正確
  - 收益統計完整

### 4.3 四模式差異化測試案例

#### TC-006: Expert模式完整功能測試
**測試函數表頭**:
```dart
/**
 * TC-006: Expert模式帳戶管理測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，新增進階統計功能
 */
Future<void> testExpertModeAccountFeatures();
```
- **目的**: 驗證Expert模式完整功能存取
- **前置條件**:
  - 用戶設定為Expert模式
  - 帳戶包含完整資料
- **測試步驟**:
  1. 查詢帳戶列表(Expert模式)
  2. 驗證詳細統計摘要顯示
  3. 檢查進階功能可用性
  4. 測試餘額歷史詳細資料
  5. 驗證所有帳戶類型支援
- **驗證點**:
  - 統計摘要包含totalAccounts、totalBalance、byType統計
  - 餘額歷史包含30天完整記錄
  - 所有6種帳戶類型可建立
  - 進階操作選項可用

#### TC-007: Guiding模式簡化體驗測試
**測試函數表頭**:
```dart
/**
 * TC-007: Guiding模式簡化測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，優化簡化邏輯
 */
Future<void> testGuidingModeSimplifiedExperience();
```
- **目的**: 驗證Guiding模式簡化使用者體驗
- **前置條件**:
  - 用戶設定為Guiding模式
  - 預設設定已配置
- **測試步驟**:
  1. 查詢帳戶列表(Guiding模式)
  2. 驗證簡化回應內容
  3. 檢查複雜功能隱藏
  4. 測試預設帳戶類型限制
  5. 驗證簡化建立流程
- **驗證點**:
  - 不包含statistics統計摘要
  - 帳戶類型限制為現金、銀行、信用卡
  - 建立表單欄位簡化
  - 預設值自動填充

#### TC-008: Cultivation模式引導功能測試
**測試函數表頭**:
```dart
/**
 * TC-008: Cultivation模式引導測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，新增理財建議功能
 */
Future<void> testCultivationModeGuidance();
```
- **目的**: 驗證Cultivation模式理財引導功能
- **前置條件**:
  - 用戶設定為Cultivation模式
  - 系統建議引擎啟用
- **測試步驟**:
  1. 建立帳戶(Cultivation模式)
  2. 驗證建議提示顯示
  3. 檢查理財引導內容
  4. 測試進度追蹤功能
  5. 驗證個人化建議
- **驗證點**:
  - 建立成功後顯示suggestions陣列
  - 建議內容符合用戶情況
  - 進度追蹤功能正常
  - 引導內容教育性

### 4.4 API端點一致性測試案例

#### TC-009: 8105規格一致性驗證測試
**測試函數表頭**:
```dart
/**
 * TC-009: API規格一致性測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，完整覆蓋8個端點
 */
Future<void> testAPISpecificationConsistency();
```
- **目的**: 驗證實作與8105 API規格完全一致
- **前置條件**:
  - API規格文件可存取
  - 自動化規格比對工具
- **測試步驟**:
  1. 驗證8個端點定義
  2. 檢查請求參數格式
  3. 驗證回應結構一致
  4. 測試錯誤碼對應
  5. 檢查HTTP狀態碼
- **驗證點**:
  - 端點路徑完全一致
  - 參數格式符合schema
  - 回應結構符合定義
  - 錯誤處理標準統一

### 4.5 異常處理測試案例

#### TC-010: 帳戶轉帳異常處理測試
**測試函數表頭**:
```dart
/**
 * TC-010: 帳戶轉帳異常處理測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，強化事務回滾機制
 */
Future<void> testTransferExceptionHandling();
```
- **目的**: 驗證帳戶轉帳各種異常情況處理
- **前置條件**:
  - 轉帳測試環境準備
  - 異常模擬工具
- **測試步驟**:
  1. 測試餘額不足轉帳
  2. 測試相同帳戶轉帳
  3. 測試帳戶不存在轉帳
  4. 測試並發轉帳衝突
  5. 驗證事務回滾機制
- **驗證點**:
  - HTTP狀態碼400/409正確
  - 錯誤訊息明確詳細
  - 事務完全回滾
  - 資料一致性保證

#### TC-011: 帳戶刪除複雜邏輯測試
**測試函數表頭**:
```dart
/**
 * TC-011: 帳戶刪除邏輯測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，完善刪除策略
 */
Future<void> testAccountDeletionComplexLogic();
```
- **目的**: 驗證帳戶刪除的複雜業務邏輯
- **前置條件**:
  - 有無交易記錄的帳戶
  - 轉移目標帳戶準備
- **測試步驟**:
  1. 刪除無交易記錄帳戶(永久刪除)
  2. 刪除有交易記錄帳戶(軟刪除)
  3. 測試交易記錄轉移功能
  4. 測試強制刪除功能
  5. 驗證級聯處理邏輯
- **驗證點**:
  - deleteType欄位正確(soft/hard/transferred)
  - 交易記錄正確轉移
  - 強制刪除完全清除
  - 相關資料一致性

---

## 5. 效能與壓力測試

### 5.1 帳戶管理效能

#### 5.1.1 單一帳戶操作效能測試
**測試函數表頭**:
```dart
/**
 * 帳戶操作效能測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，提升效能基準
 */
Future<void> testAccountOperationPerformance();
```
- **測試目標**: 單次帳戶操作回應時間 < 1 秒
- **測試方法**:
  - 執行1000次帳戶CRUD操作
  - 監控每次處理時間
  - 記錄系統資源使用
  - 分析效能瓶頸
- **監控指標**:
  - 平均回應時間
  - 95%百分位回應時間
  - CPU使用率
  - 記憶體使用量
  - 資料庫連線數

### 5.2 餘額查詢能力

#### 5.2.1 高頻餘額查詢測試
**測試函數表頭**:
```dart
/**
 * 高頻餘額查詢測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，加強查詢最佳化
 */
Future<void> testHighFrequencyBalanceQuery();
```
- **測試目標**: 餘額查詢回應時間 < 500ms
- **測試方法**:
  - 模擬1000個並發餘額查詢
  - 測試複雜帳戶(大量交易)
  - 監控快取命中率
- **驗收標準**:
  - 平均回應時間 < 500ms
  - 成功率 > 99.5%
  - 快取命中率 > 80%

#### 5.2.2 餘額歷史查詢效能測試
**測試函數表頭**:
```dart
/**
 * 餘額歷史查詢效能測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，最佳化歷史資料處理
 */
Future<void> testBalanceHistoryQueryPerformance();
```
- **測試目標**: 365天歷史查詢回應時間 < 2秒
- **測試方法**:
  - 測試1-365天不同區間查詢
  - 大量歷史資料帳戶測試
  - 記憶體使用監控
- **驗收標準**:
  - 30天歷史查詢 < 1秒
  - 365天歷史查詢 < 2秒
  - 記憶體增長合理

### 5.3 記憶體使用監控

#### 5.3.1 記憶體洩漏測試
**測試函數表頭**:
```dart
/**
 * 記憶體洩漏監控測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，強化監控機制
 */
Future<void> testMemoryLeakMonitoring();
```
- **測試目標**: 24小時運行無記憶體洩漏
- **測試方法**:
  - 啟動長時間帳戶操作測試
  - 每小時記錄記憶體使用量
  - 分析記憶體增長趨勢
- **驗收標準**:
  - 記憶體使用增長 < 5%/24小時
  - 無明顯記憶體洩漏模式

---

## 6. 安全性與權限測試

### 6.1 輸入驗證測試

#### 6.1.1 惡意輸入防護測試
**測試函數表頭**:
```dart
/**
 * 惡意輸入防護測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，加強安全檢查
 */
Future<void> testMaliciousInputProtection();
```
- **測試目標**: 防護各種惡意輸入攻擊
- **測試方法**:
  - SQL注入攻擊測試
  - XSS攻擊測試
  - 超長輸入測試
  - 特殊字元處理測試
  - JSON注入攻擊測試
- **安全要求**:
  - 所有惡意輸入被正確過濾
  - 輸入長度限制有效執行
  - 錯誤訊息不洩漏敏感資訊

### 6.2 資料保護測試

#### 6.2.1 敏感帳戶資料保護測試
**測試函數表頭**:
```dart
/**
 * 敏感帳戶資料保護測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，強化資料保護
 */
Future<void> testSensitiveAccountDataProtection();
```
- **測試目標**: 敏感帳戶資料得到適當保護
- **測試方法**:
  - 檢查日誌中的帳號資訊洩漏
  - 驗證帳號末四碼遮罩
  - 測試餘額資訊存取控制
- **保護要求**:
  - 完整帳號不出現在日誌中
  - 帳號顯示正確遮罩
  - 餘額資訊存取控制

### 6.3 API安全性測試

#### 6.3.1 帳戶存取權限測試
**測試函數表頭**:
```dart
/**
 * 帳戶存取權限測試
 * @version 2.3.0
 * @date 2025-09-05
 * @update: 升版至2.3.0，完善權限檢查
 */
Future<void> testAccountAccessPermissions();
```
- **測試目標**: 確保帳戶存取權限正確
- **測試方法**:
  - 測試跨使用者帳戶存取
  - 驗證帳本權限檢查
  - 測試停用帳戶存取
- **安全要求**:
  - 無法存取他人帳戶
  - 帳本權限正確檢查
  - 停用帳戶拒絕存取

---

## 附錄

### A. Dart函數版次對照表

| 函數編號 | 函數名稱 | 版次 | 更新日期 | 更新說明 |
|---------|----------|------|----------|----------|
| 01 | getAccounts | v2.3.0 | 2025-09-05 | 四模式差異化回應 |
| 02 | createAccount | v2.3.0 | 2025-09-05 | 6種帳戶類型支援 |
| 03 | getAccount | v2.3.0 | 2025-09-05 | 統計資訊強化 |
| ... | ... | v2.3.0 | 2025-09-05 | 版次統一升級 |

### B. 帳戶類型對照表

| 帳戶類型 | 英文代碼 | 必填欄位 | 特殊屬性 | 餘額特性 |
|----------|----------|----------|----------|----------|
| 現金 | cash | name, type | - | 非負數 |
| 銀行 | bank | name, type, bankName | accountNumber | 非負數 |
| 信用卡 | credit_card | name, type, bankName | creditLimit | 可負數 |
| 投資 | investment | name, type | interestRate | 非負數 |
| 借貸 | loan | name, type | interestRate | 可負數 |
| 其他 | other | name, type | - | 非負數 |

### C. 四模式功能對照表

| 功能項目 | Expert | Inertial | Cultivation | Guiding |
|----------|--------|----------|-------------|---------|
| 統計摘要 | 完整顯示 | 基本顯示 | 進度導向 | 隱藏 |
| 帳戶類型 | 全部6種 | 全部6種 | 推薦4種 | 基本3種 |
| 餘額歷史 | 365天 | 90天 | 30天 | 7天 |
| 建立選項 | 完整設定 | 標準設定 | 引導設定 | 簡化設定 |

---

**文件版本記錄**:
- v2.3.0 (2025-09-05): 升版建立，基於8205 LLD v1.0.0制定完整測試計畫，重點關注6種帳戶類型支援、餘額計算精確度、轉帳事務一致性、API規格一致性驗證，遵循8088 API設計規範統一回應格式