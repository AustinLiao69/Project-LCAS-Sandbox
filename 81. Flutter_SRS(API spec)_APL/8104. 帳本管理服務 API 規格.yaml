
openapi: 3.0.3
info:
  title: å¸³æœ¬ç®¡ç†æœå‹™ API è¦æ ¼
  description: LCAS 2.0 å¸³æœ¬ç®¡ç†æœå‹™ APIï¼Œç¬¦åˆ0020å’Œ0088è¨­è¨ˆè¦ç¯„
  version: 1.1.0
  contact:
    name: LCAS SA Team
    email: sa@lcas.app

servers:
  - url: https://api.lcas.app/v1
    description: Production server
  - url: https://api-dev.lcas.app/v1
    description: Development server

paths:
  /ledgers:
    get:
      summary: å–å¾—å¸³æœ¬åˆ—è¡¨
      description: æŸ¥è©¢ä½¿ç”¨è€…çš„å¸³æœ¬åˆ—è¡¨ï¼Œæ”¯æ´åˆ†é å’Œç¯©é¸ï¼ˆå°æ‡‰ç•«é¢ S-204ï¼‰
      operationId: getLedgers
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: é ç¢¼ï¼ˆå¾1é–‹å§‹ï¼‰
          example: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: æ¯é ç­†æ•¸
          example: 20
        - name: sort
          in: query
          schema:
            type: string
            default: "updatedAt:desc"
          description: æ’åºæ ¼å¼ {field}:{asc|desc}
          example: "name:asc"
        - name: filter
          in: query
          schema:
            type: string
          description: éæ¿¾æ¢ä»¶ {field}:{value}
          example: "status:active"
        - name: search
          in: query
          schema:
            type: string
          description: æœå°‹é—œéµå­—ï¼ˆå¸³æœ¬åç¨±ï¼‰
          example: "å®¶åº­"
        - name: type
          in: query
          schema:
            type: string
            enum: [personal, family, business, shared]
          description: å¸³æœ¬é¡å‹ç¯©é¸
          example: "personal"
      responses:
        '200':
          description: æŸ¥è©¢æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      items:
                        type: array
                        items:
                          $ref: '#/components/schemas/Ledger'
                      pagination:
                        $ref: '#/components/schemas/PaginationResponse'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '400':
          description: è«‹æ±‚åƒæ•¸éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæ¬Š
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: å»ºç«‹æ–°å¸³æœ¬
      description: å»ºç«‹æ–°çš„è¨˜å¸³å¸³æœ¬ï¼ˆå°æ‡‰ç•«é¢ S-205ï¼‰
      operationId: createLedger
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  type: object
                  properties:
                    name:
                      type: string
                      maxLength: 100
                      description: å¸³æœ¬åç¨±
                      example: "å®¶åº­è¨˜å¸³æœ¬"
                    description:
                      type: string
                      maxLength: 500
                      description: å¸³æœ¬æè¿°
                      example: "è¨˜éŒ„å®¶åº­æ—¥å¸¸é–‹æ”¯"
                    type:
                      type: string
                      enum: [personal, family, business, shared]
                      description: å¸³æœ¬é¡å‹
                      example: "family"
                    currency:
                      type: string
                      description: é è¨­è²¨å¹£
                      example: "TWD"
                    icon:
                      type: string
                      description: å¸³æœ¬åœ–ç¤º
                      example: "ğŸ "
                    color:
                      type: string
                      pattern: '^#[0-9A-Fa-f]{6}$'
                      description: ä¸»é¡Œé¡è‰²
                      example: "#4CAF50"
                    isDefault:
                      type: boolean
                      description: æ˜¯å¦ç‚ºé è¨­å¸³æœ¬
                      example: false
                    settings:
                      type: object
                      properties:
                        autoBackup:
                          type: boolean
                          example: true
                        allowCollaboration:
                          type: boolean
                          example: true
                        budgetAlert:
                          type: boolean
                          example: true
                  required:
                    - name
                    - type
                    - currency
      responses:
        '201':
          description: å¸³æœ¬å»ºç«‹æˆåŠŸï¼ˆå››æ¨¡å¼å·®ç•°åŒ–å›æ‡‰ï¼‰
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    oneOf:
                      - $ref: '#/components/schemas/LedgerResponseExpert'
                      - $ref: '#/components/schemas/LedgerResponseGuiding'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '400':
          description: è«‹æ±‚éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /ledgers/{ledgerId}:
    get:
      summary: å–å¾—å¸³æœ¬è©³æƒ…
      description: å–å¾—ç‰¹å®šå¸³æœ¬çš„è©³ç´°è³‡è¨Šï¼ˆå°æ‡‰ç•«é¢ S-206ï¼‰
      operationId: getLedger
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
          example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        '200':
          description: æŸ¥è©¢æˆåŠŸï¼ˆå››æ¨¡å¼å·®ç•°åŒ–å›æ‡‰ï¼‰
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    oneOf:
                      - $ref: '#/components/schemas/LedgerDetailExpert'
                      - $ref: '#/components/schemas/LedgerDetailGuiding'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '404':
          description: å¸³æœ¬ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: æ›´æ–°å¸³æœ¬è³‡æ–™
      description: å®Œæ•´æ›´æ–°å¸³æœ¬è³‡æ–™
      operationId: updateLedger
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  $ref: '#/components/schemas/LedgerUpdateData'
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Ledger'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'

    delete:
      summary: åˆªé™¤å¸³æœ¬
      description: åˆªé™¤æŒ‡å®šçš„å¸³æœ¬ï¼ˆéœ€è¦ç¢ºèªï¼‰
      operationId: deleteLedger
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
      responses:
        '204':
          description: åˆªé™¤æˆåŠŸ
        '400':
          description: ä¸èƒ½åˆªé™¤é è¨­å¸³æœ¬æˆ–æœ‰äº¤æ˜“è¨˜éŒ„çš„å¸³æœ¬
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸³æœ¬ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /ledgers/{ledgerId}/summary:
    get:
      summary: å–å¾—å¸³æœ¬æ‘˜è¦
      description: å–å¾—å¸³æœ¬çš„çµ±è¨ˆæ‘˜è¦è³‡è¨Šï¼ˆå°æ‡‰ç•«é¢ S-207ï¼‰
      operationId: getLedgerSummary
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
        - name: period
          in: query
          schema:
            type: string
            enum: [7d, 30d, 90d, 1y, all]
            default: "30d"
          description: çµ±è¨ˆé€±æœŸ
          example: "30d"
      responses:
        '200':
          description: å¸³æœ¬æ‘˜è¦ï¼ˆå››æ¨¡å¼å·®ç•°åŒ–ï¼‰
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    oneOf:
                      - $ref: '#/components/schemas/LedgerSummaryExpert'
                      - $ref: '#/components/schemas/LedgerSummaryGuiding'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'

  /ledgers/{ledgerId}/collaborators:
    get:
      summary: å–å¾—å”ä½œè€…åˆ—è¡¨
      description: å–å¾—å¸³æœ¬å”ä½œè€…åˆ—è¡¨ï¼ˆå°æ‡‰ç•«é¢ S-208ï¼‰
      operationId: getLedgerCollaborators
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: é ç¢¼
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: æ¯é ç­†æ•¸
      responses:
        '200':
          description: å”ä½œè€…åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      items:
                        type: array
                        items:
                          $ref: '#/components/schemas/LedgerCollaborator'
                      pagination:
                        $ref: '#/components/schemas/PaginationResponse'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'

    post:
      summary: é‚€è«‹å”ä½œè€…
      description: é‚€è«‹æ–°çš„å”ä½œè€…åŠ å…¥å¸³æœ¬
      operationId: inviteCollaborator
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  type: object
                  properties:
                    email:
                      type: string
                      format: email
                      description: å—é‚€è€…Email
                      example: "collaborator@example.com"
                    role:
                      type: string
                      enum: [viewer, editor, admin]
                      description: æ¬Šé™è§’è‰²
                      example: "editor"
                    message:
                      type: string
                      maxLength: 500
                      description: é‚€è«‹è¨Šæ¯
                      example: "æ­¡è¿åŠ å…¥æˆ‘å€‘çš„å®¶åº­è¨˜å¸³æœ¬"
                  required:
                    - email
                    - role
      responses:
        '201':
          description: é‚€è«‹ç™¼é€æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      invitationId:
                        type: string
                        format: uuid
                        example: "550e8400-e29b-41d4-a716-446655440001"
                      invitedEmail:
                        type: string
                        format: email
                        example: "collaborator@example.com"
                      expiresAt:
                        type: string
                        format: date-time
                        example: "2025-02-03T12:00:00Z"

  /ledgers/{ledgerId}/collaborators/{collaboratorId}:
    patch:
      summary: æ›´æ–°å”ä½œè€…æ¬Šé™
      description: æ›´æ–°å”ä½œè€…çš„æ¬Šé™è¨­å®š
      operationId: updateCollaboratorRole
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
        - name: collaboratorId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å”ä½œè€…ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  type: object
                  properties:
                    role:
                      type: string
                      enum: [viewer, editor, admin]
                      description: æ–°çš„æ¬Šé™è§’è‰²
                      example: "admin"
                  required:
                    - role
      responses:
        '200':
          description: æ¬Šé™æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/LedgerCollaborator'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'

    delete:
      summary: ç§»é™¤å”ä½œè€…
      description: å¾å¸³æœ¬ä¸­ç§»é™¤å”ä½œè€…
      operationId: removeCollaborator
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
        - name: collaboratorId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å”ä½œè€…ID
      responses:
        '204':
          description: ç§»é™¤æˆåŠŸ
        '404':
          description: å”ä½œè€…ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /ledgers/{ledgerId}/duplicate:
    post:
      summary: è¤‡è£½å¸³æœ¬
      description: è¤‡è£½ç¾æœ‰å¸³æœ¬å»ºç«‹æ–°çš„å¸³æœ¬
      operationId: duplicateLedger
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ä¾†æºå¸³æœ¬ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  type: object
                  properties:
                    name:
                      type: string
                      maxLength: 100
                      description: æ–°å¸³æœ¬åç¨±
                      example: "å®¶åº­è¨˜å¸³æœ¬ (å‰¯æœ¬)"
                    includeTransactions:
                      type: boolean
                      description: æ˜¯å¦åŒ…å«äº¤æ˜“è¨˜éŒ„
                      example: false
                    includeCategories:
                      type: boolean
                      description: æ˜¯å¦åŒ…å«ç§‘ç›®è¨­å®š
                      example: true
                    includeAccounts:
                      type: boolean
                      description: æ˜¯å¦åŒ…å«å¸³æˆ¶è¨­å®š
                      example: true
                  required:
                    - name
      responses:
        '201':
          description: è¤‡è£½æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Ledger'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'

  /ledgers/{ledgerId}/archive:
    post:
      summary: å°å­˜å¸³æœ¬
      description: å°‡å¸³æœ¬è¨­ç‚ºå°å­˜ç‹€æ…‹
      operationId: archiveLedger
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
      responses:
        '200':
          description: å°å­˜æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      ledgerId:
                        type: string
                        format: uuid
                        example: "550e8400-e29b-41d4-a716-446655440000"
                      status:
                        type: string
                        example: "archived"
                      archivedAt:
                        type: string
                        format: date-time
                        example: "2025-01-27T12:00:00Z"

    delete:
      summary: å–æ¶ˆå°å­˜å¸³æœ¬
      description: å°‡å°å­˜çš„å¸³æœ¬æ¢å¾©ç‚ºæ­£å¸¸ç‹€æ…‹
      operationId: unarchiveLedger
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: ledgerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: å¸³æœ¬ID
      responses:
        '200':
          description: å–æ¶ˆå°å­˜æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Ledger'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'

  /ledgers/invitations:
    get:
      summary: å–å¾—æˆ‘çš„é‚€è«‹åˆ—è¡¨
      description: å–å¾—æ”¶åˆ°çš„å¸³æœ¬é‚€è«‹åˆ—è¡¨
      operationId: getMyInvitations
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, accepted, declined, expired]
          description: é‚€è«‹ç‹€æ…‹ç¯©é¸
          example: "pending"
      responses:
        '200':
          description: é‚€è«‹åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      items:
                        type: array
                        items:
                          $ref: '#/components/schemas/LedgerInvitation'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'

  /ledgers/invitations/{invitationId}/accept:
    post:
      summary: æ¥å—å¸³æœ¬é‚€è«‹
      description: æ¥å—å¸³æœ¬å”ä½œé‚€è«‹
      operationId: acceptInvitation
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: invitationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: é‚€è«‹ID
      responses:
        '200':
          description: é‚€è«‹å·²æ¥å—
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      ledgerId:
                        type: string
                        format: uuid
                        example: "550e8400-e29b-41d4-a716-446655440000"
                      role:
                        type: string
                        example: "editor"
                      joinedAt:
                        type: string
                        format: date-time
                        example: "2025-01-27T12:00:00Z"

  /ledgers/invitations/{invitationId}/decline:
    post:
      summary: æ‹’çµ•å¸³æœ¬é‚€è«‹
      description: æ‹’çµ•å¸³æœ¬å”ä½œé‚€è«‹
      operationId: declineInvitation
      tags:
        - Ledgers
      security:
        - bearerAuth: []
      parameters:
        - name: invitationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: é‚€è«‹ID
      responses:
        '200':
          description: é‚€è«‹å·²æ‹’çµ•
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      invitationId:
                        type: string
                        format: uuid
                        example: "550e8400-e29b-41d4-a716-446655440001"
                      status:
                        type: string
                        example: "declined"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    Ledger:
      type: object
      properties:
        ledgerId:
          type: string
          format: uuid
          description: å¸³æœ¬å”¯ä¸€è­˜åˆ¥ç¬¦
          example: "550e8400-e29b-41d4-a716-446655440000"
        name:
          type: string
          description: å¸³æœ¬åç¨±
          example: "å®¶åº­è¨˜å¸³æœ¬"
        description:
          type: string
          description: å¸³æœ¬æè¿°
          example: "è¨˜éŒ„å®¶åº­æ—¥å¸¸é–‹æ”¯"
        type:
          type: string
          enum: [personal, family, business, shared]
          description: å¸³æœ¬é¡å‹
          example: "family"
        currency:
          type: string
          description: é è¨­è²¨å¹£
          example: "TWD"
        icon:
          type: string
          description: å¸³æœ¬åœ–ç¤º
          example: "ğŸ "
        color:
          type: string
          description: ä¸»é¡Œé¡è‰²
          example: "#4CAF50"
        status:
          type: string
          enum: [active, archived, deleted]
          description: å¸³æœ¬ç‹€æ…‹
          example: "active"
        isDefault:
          type: boolean
          description: æ˜¯å¦ç‚ºé è¨­å¸³æœ¬
          example: false
        ownerId:
          type: string
          format: uuid
          description: æ“æœ‰è€…ID
          example: "550e8400-e29b-41d4-a716-446655440001"
        settings:
          type: object
          properties:
            autoBackup:
              type: boolean
              example: true
            allowCollaboration:
              type: boolean
              example: true
            budgetAlert:
              type: boolean
              example: true
        collaboratorCount:
          type: integer
          description: å”ä½œè€…æ•¸é‡
          example: 3
        transactionCount:
          type: integer
          description: äº¤æ˜“ç­†æ•¸
          example: 156
        lastTransactionAt:
          type: string
          format: date-time
          description: æœ€å¾Œäº¤æ˜“æ™‚é–“
          example: "2025-01-26T18:30:00Z"
        createdAt:
          type: string
          format: date-time
          description: å»ºç«‹æ™‚é–“
          example: "2025-01-01T00:00:00Z"
        updatedAt:
          type: string
          format: date-time
          description: æ›´æ–°æ™‚é–“
          example: "2025-01-27T12:00:00Z"

    LedgerUpdateData:
      type: object
      properties:
        name:
          type: string
          maxLength: 100
        description:
          type: string
          maxLength: 500
        type:
          type: string
          enum: [personal, family, business, shared]
        currency:
          type: string
        icon:
          type: string
        color:
          type: string
          pattern: '^#[0-9A-Fa-f]{6}$'
        isDefault:
          type: boolean
        settings:
          type: object
          properties:
            autoBackup:
              type: boolean
            allowCollaboration:
              type: boolean
            budgetAlert:
              type: boolean

    LedgerResponseExpert:
      allOf:
        - $ref: '#/components/schemas/Ledger'
        - type: object
          properties:
            analytics:
              type: object
              properties:
                monthlyGrowth:
                  type: number
                  example: 5.2
                categoryCount:
                  type: integer
                  example: 15
                accountCount:
                  type: integer
                  example: 5
            permissions:
              type: array
              items:
                type: string
              example: ["view", "edit", "manage", "admin"]

    LedgerResponseGuiding:
      type: object
      properties:
        ledgerId:
          type: string
          format: uuid
        name:
          type: string
        icon:
          type: string
        color:
          type: string
        isDefault:
          type: boolean
        simpleMessage:
          type: string
          example: "âœ… å®¶åº­è¨˜å¸³æœ¬å»ºç«‹æˆåŠŸï¼"

    LedgerDetailExpert:
      allOf:
        - $ref: '#/components/schemas/Ledger'
        - type: object
          properties:
            statistics:
              type: object
              properties:
                totalIncome:
                  type: number
                  example: 50000
                totalExpense:
                  type: number
                  example: 35000
                balance:
                  type: number
                  example: 15000
                avgDailyTransactions:
                  type: number
                  example: 4.2
            recentTransactions:
              type: array
              items:
                type: object
              maxItems: 5
            topCategories:
              type: array
              items:
                type: object
              maxItems: 5
            collaborators:
              type: array
              items:
                $ref: '#/components/schemas/LedgerCollaborator'
              maxItems: 10

    LedgerDetailGuiding:
      type: object
      properties:
        ledgerId:
          type: string
          format: uuid
        name:
          type: string
        icon:
          type: string
        totalTransactions:
          type: integer
          example: 45
        encouragement:
          type: string
          example: "é€™å€‹æœˆå·²è¨˜éŒ„ 45 ç­†äº¤æ˜“ï¼Œç¹¼çºŒåŠ æ²¹ï¼"

    LedgerSummaryExpert:
      type: object
      properties:
        overview:
          type: object
          properties:
            totalIncome:
              type: number
              example: 50000
            totalExpense:
              type: number
              example: 35000
            netIncome:
              type: number
              example: 15000
            transactionCount:
              type: integer
              example: 156
        trends:
          type: object
          properties:
            dailyAverage:
              type: number
              example: 1166.67
            monthlyGrowth:
              type: number
              example: 5.2
            categoryBreakdown:
              type: array
              items:
                type: object
        budgetAnalysis:
          type: object
          properties:
            totalBudget:
              type: number
              example: 40000
            usedBudget:
              type: number
              example: 35000
            remainingBudget:
              type: number
              example: 5000
            utilizationRate:
              type: number
              example: 87.5

    LedgerSummaryGuiding:
      type: object
      properties:
        simpleStats:
          type: object
          properties:
            totalSpent:
              type: number
              example: 35000
            transactionCount:
              type: integer
              example: 45
        message:
          type: string
          example: "æœ¬æœˆå·²èŠ±è²» NT$35,000ï¼Œè¨˜éŒ„äº† 45 ç­†äº¤æ˜“"

    LedgerCollaborator:
      type: object
      properties:
        collaboratorId:
          type: string
          format: uuid
          description: å”ä½œè€…ID
          example: "550e8400-e29b-41d4-a716-446655440002"
        userId:
          type: string
          format: uuid
          description: ä½¿ç”¨è€…ID
          example: "550e8400-e29b-41d4-a716-446655440003"
        email:
          type: string
          format: email
          description: å”ä½œè€…Email
          example: "collaborator@example.com"
        displayName:
          type: string
          description: é¡¯ç¤ºåç¨±
          example: "ç‹å°è¯"
        avatar:
          type: string
          format: uri
          description: é ­åƒURL
          example: "https://example.com/avatar2.jpg"
        role:
          type: string
          enum: [viewer, editor, admin]
          description: æ¬Šé™è§’è‰²
          example: "editor"
        status:
          type: string
          enum: [pending, active, suspended]
          description: å”ä½œç‹€æ…‹
          example: "active"
        permissions:
          type: array
          items:
            type: string
          description: å…·é«”æ¬Šé™åˆ—è¡¨
          example: ["view_transactions", "create_transactions", "edit_own_transactions"]
        joinedAt:
          type: string
          format: date-time
          description: åŠ å…¥æ™‚é–“
          example: "2025-01-15T10:00:00Z"
        lastActiveAt:
          type: string
          format: date-time
          description: æœ€å¾Œæ´»å‹•æ™‚é–“
          example: "2025-01-26T14:30:00Z"

    LedgerInvitation:
      type: object
      properties:
        invitationId:
          type: string
          format: uuid
          description: é‚€è«‹ID
          example: "550e8400-e29b-41d4-a716-446655440004"
        ledgerId:
          type: string
          format: uuid
          description: å¸³æœ¬ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        ledgerName:
          type: string
          description: å¸³æœ¬åç¨±
          example: "å®¶åº­è¨˜å¸³æœ¬"
        inviterUserId:
          type: string
          format: uuid
          description: é‚€è«‹è€…ID
          example: "550e8400-e29b-41d4-a716-446655440001"
        inviterName:
          type: string
          description: é‚€è«‹è€…åç¨±
          example: "å¼µå°æ˜"
        invitedEmail:
          type: string
          format: email
          description: å—é‚€è€…Email
          example: "invited@example.com"
        role:
          type: string
          enum: [viewer, editor, admin]
          description: é‚€è«‹è§’è‰²
          example: "editor"
        message:
          type: string
          description: é‚€è«‹è¨Šæ¯
          example: "æ­¡è¿åŠ å…¥æˆ‘å€‘çš„å®¶åº­è¨˜å¸³æœ¬"
        status:
          type: string
          enum: [pending, accepted, declined, expired]
          description: é‚€è«‹ç‹€æ…‹
          example: "pending"
        createdAt:
          type: string
          format: date-time
          description: é‚€è«‹æ™‚é–“
          example: "2025-01-25T12:00:00Z"
        expiresAt:
          type: string
          format: date-time
          description: éæœŸæ™‚é–“
          example: "2025-02-01T12:00:00Z"

    PaginationResponse:
      type: object
      properties:
        page:
          type: integer
          description: ç•¶å‰é ç¢¼
          example: 1
        limit:
          type: integer
          description: æ¯é ç­†æ•¸
          example: 20
        total:
          type: integer
          description: ç¸½ç­†æ•¸
          example: 156
        totalPages:
          type: integer
          description: ç¸½é æ•¸
          example: 8
        hasNext:
          type: boolean
          description: æ˜¯å¦æœ‰ä¸‹ä¸€é 
          example: true
        hasPrev:
          type: boolean
          description: æ˜¯å¦æœ‰ä¸Šä¸€é 
          example: false
        nextPage:
          type: integer
          nullable: true
          description: ä¸‹ä¸€é é ç¢¼
          example: 2
        prevPage:
          type: integer
          nullable: true
          description: ä¸Šä¸€é é ç¢¼
          example: null

    ResponseMetadata:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
          description: å›æ‡‰æ™‚é–“æˆ³
          example: "2025-01-27T12:00:00Z"
        requestId:
          type: string
          format: uuid
          description: è«‹æ±‚å”¯ä¸€è­˜åˆ¥ç¬¦
          example: "550e8400-e29b-41d4-a716-446655440001"
        userMode:
          type: string
          enum: [Expert, Inertial, Cultivation, Guiding]
          description: ä½¿ç”¨è€…æ¨¡å¼
          example: "Expert"

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            code:
              type: string
              description: éŒ¯èª¤ä»£ç¢¼
              example: "VALIDATION_ERROR"
            message:
              type: string
              description: éŒ¯èª¤è¨Šæ¯
              example: "å¸³æœ¬åç¨±å·²å­˜åœ¨"
            field:
              type: string
              description: éŒ¯èª¤æ¬„ä½
              example: "name"
            timestamp:
              type: string
              format: date-time
              example: "2025-01-27T12:00:00Z"
            requestId:
              type: string
              format: uuid
              example: "550e8400-e29b-41d4-a716-446655440001"
            details:
              type: object
              description: è©³ç´°éŒ¯èª¤è³‡è¨Š

tags:
  - name: Ledgers
    description: å¸³æœ¬ç®¡ç†ç›¸é—œ API
