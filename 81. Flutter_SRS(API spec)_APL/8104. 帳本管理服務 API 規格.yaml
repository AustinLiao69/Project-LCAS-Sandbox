
openapi: 3.0.3
info:
  title: 帳本管理服務 API 規格
  description: LCAS 帳本管理服務API規格，提供帳本CRUD、協作管理和分頁查詢功能
  version: 2.0.0
  contact:
    name: LCAS SA Team
    email: sa@lcas.com

servers:
  - url: https://api.lcas.com/v2
    description: Production server
  - url: https://staging-api.lcas.com/v2
    description: Staging server

tags:
  - name: Ledger Management
    description: 帳本管理相關操作
  - name: Collaboration
    description: 帳本協作功能
  - name: Sharing
    description: 帳本分享與權限

paths:
  /ledgers:
    get:
      tags:
        - Ledger Management
      summary: 取得帳本列表
      description: 取得用戶可存取的帳本列表，支援分頁和篩選
      operationId: getLedgers
      parameters:
        - name: userId
          in: query
          required: true
          description: 用戶ID
          schema:
            type: string
            example: "Uae47d9d496e4596d70ed724a7d6e2948"
        - name: userMode
          in: query
          description: 用戶模式（影響回應內容）
          schema:
            type: string
            enum: [Expert, Inertial, Cultivation, Guiding]
            default: Expert
            example: "Expert"
        - name: type
          in: query
          description: 帳本類型篩選
          schema:
            type: string
            enum: [personal, shared, family, business]
            example: "personal"
        - name: status
          in: query
          description: 帳本狀態篩選
          schema:
            type: string
            enum: [active, archived, suspended]
            default: active
            example: "active"
        - name: role
          in: query
          description: 用戶在帳本中的角色篩選
          schema:
            type: string
            enum: [owner, admin, editor, viewer]
            example: "owner"
        - name: keyword
          in: query
          description: 關鍵字搜尋（帳本名稱、描述）
          schema:
            type: string
            example: "家庭帳本"
        - name: page
          in: query
          description: 頁碼
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: limit
          in: query
          description: 每頁筆數
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 20
        - name: sort
          in: query
          description: 排序方式
          schema:
            type: string
            enum: [createdAt_desc, createdAt_asc, name_asc, name_desc, lastUsed_desc]
            default: lastUsed_desc
            example: "lastUsed_desc"
        - name: filter
          in: query
          description: 進階篩選條件（JSON格式）
          schema:
            type: string
            example: '{"hasCollaborators":true,"createdAfter":"2025-01-01"}'
      responses:
        '200':
          description: 取得成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      ledgers:
                        type: array
                        items:
                          type: object
                          properties:
                            ledgerId:
                              type: string
                              description: 帳本ID
                              example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
                            name:
                              type: string
                              description: 帳本名稱
                              example: "個人記帳本"
                            description:
                              type: string
                              description: 帳本描述
                              example: "我的個人財務管理帳本"
                            type:
                              type: string
                              enum: [personal, shared, family, business]
                              description: 帳本類型
                              example: "personal"
                            ownerId:
                              type: string
                              description: 擁有者ID
                              example: "Uae47d9d496e4596d70ed724a7d6e2948"
                            userRole:
                              type: string
                              enum: [owner, admin, editor, viewer]
                              description: 用戶在此帳本的角色
                              example: "owner"
                            status:
                              type: string
                              enum: [active, archived, suspended]
                              description: 帳本狀態
                              example: "active"
                            createdAt:
                              type: string
                              format: date-time
                              description: 創建時間
                              example: "2025-08-22T12:00:00Z"
                            updatedAt:
                              type: string
                              format: date-time
                              description: 最後更新時間
                              example: "2025-08-22T12:00:00Z"
                            lastUsedAt:
                              type: string
                              format: date-time
                              description: 最後使用時間
                              example: "2025-08-22T12:00:00Z"
                            collaborators:
                              type: object
                              description: 協作者資訊（Expert模式顯示）
                              properties:
                                count:
                                  type: integer
                                  example: 3
                                hasInvites:
                                  type: boolean
                                  example: true
                            statistics:
                              type: object
                              description: 帳本統計（根據用戶模式顯示不同詳細程度）
                              properties:
                                totalEntries:
                                  type: integer
                                  example: 156
                                totalAmount:
                                  type: number
                                  example: 45678.90
                                lastEntry:
                                  type: string
                                  format: date-time
                                  example: "2025-08-22T10:30:00Z"
                  metadata:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          currentPage:
                            type: integer
                            example: 1
                          totalPages:
                            type: integer
                            example: 3
                          totalCount:
                            type: integer
                            example: 45
                          hasNext:
                            type: boolean
                            example: true
                          hasPrevious:
                            type: boolean
                            example: false
                          pageSize:
                            type: integer
                            example: 20
                      filters:
                        type: object
                        properties:
                          appliedFilters:
                            type: object
                            example: {"type": "personal", "status": "active"}
                          userMode:
                            type: string
                            example: "Expert"
                      summary:
                        type: object
                        properties:
                          totalLedgers:
                            type: integer
                            example: 45
                          ownedLedgers:
                            type: integer
                            example: 12
                          sharedLedgers:
                            type: integer
                            example: 33

    post:
      tags:
        - Ledger Management
      summary: 創建新帳本
      description: 創建新的記帳帳本
      operationId: createLedger
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - ownerId
              properties:
                name:
                  type: string
                  description: 帳本名稱
                  example: "家庭記帳本"
                description:
                  type: string
                  description: 帳本描述
                  example: "用於記錄家庭日常收支的帳本"
                type:
                  type: string
                  enum: [personal, shared, family, business]
                  description: 帳本類型
                  default: personal
                  example: "family"
                ownerId:
                  type: string
                  description: 擁有者用戶ID
                  example: "Uae47d9d496e4596d70ed724a7d6e2948"
                settings:
                  type: object
                  description: 帳本設定
                  properties:
                    currency:
                      type: string
                      description: 預設幣別
                      default: "NTD"
                      example: "NTD"
                    timezone:
                      type: string
                      description: 時區
                      default: "Asia/Taipei"
                      example: "Asia/Taipei"
                    allowCollaboration:
                      type: boolean
                      description: 是否允許協作
                      default: false
                      example: true
                    defaultViewMode:
                      type: string
                      enum: [Expert, Inertial, Cultivation, Guiding]
                      description: 預設查看模式
                      default: "Expert"
                      example: "Expert"
                initialCollaborators:
                  type: array
                  description: 初始協作者（可選）
                  items:
                    type: object
                    properties:
                      userId:
                        type: string
                        example: "user_456"
                      role:
                        type: string
                        enum: [admin, editor, viewer]
                        example: "editor"
      responses:
        '201':
          description: 創建成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      ledgerId:
                        type: string
                        description: 帳本ID
                        example: "ledger_1692700800000"
                      name:
                        type: string
                        description: 帳本名稱
                        example: "家庭記帳本"
                      type:
                        type: string
                        description: 帳本類型
                        example: "family"
                      ownerId:
                        type: string
                        description: 擁有者ID
                        example: "Uae47d9d496e4596d70ed724a7d6e2948"
                      createdAt:
                        type: string
                        format: date-time
                        description: 創建時間
                        example: "2025-08-22T12:00:00Z"
                      initializedSubjects:
                        type: boolean
                        description: 科目是否已初始化
                        example: true
                      subjectCount:
                        type: integer
                        description: 初始化的科目數量
                        example: 156
                  metadata:
                    type: object
                    properties:
                      settings:
                        type: object
                        properties:
                          currency:
                            type: string
                            example: "NTD"
                          allowCollaboration:
                            type: boolean
                            example: true

  /ledgers/{ledgerId}:
    get:
      tags:
        - Ledger Management
      summary: 取得帳本詳細資訊
      description: 取得指定帳本的詳細資訊
      operationId: getLedgerDetails
      parameters:
        - name: ledgerId
          in: path
          required: true
          description: 帳本ID
          schema:
            type: string
            example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
        - name: userId
          in: query
          required: true
          description: 請求用戶ID
          schema:
            type: string
            example: "Uae47d9d496e4596d70ed724a7d6e2948"
        - name: userMode
          in: query
          description: 用戶模式（影響回應內容細節）
          schema:
            type: string
            enum: [Expert, Inertial, Cultivation, Guiding]
            default: Expert
            example: "Expert"
        - name: includeCollaborators
          in: query
          description: 是否包含協作者資訊
          schema:
            type: boolean
            default: false
            example: true
        - name: includeStatistics
          in: query
          description: 是否包含統計資訊
          schema:
            type: boolean
            default: true
            example: true
      responses:
        '200':
          description: 取得成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      ledgerId:
                        type: string
                        description: 帳本ID
                        example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
                      name:
                        type: string
                        description: 帳本名稱
                        example: "個人記帳本"
                      description:
                        type: string
                        description: 帳本描述
                        example: "我的個人財務管理帳本"
                      type:
                        type: string
                        description: 帳本類型
                        example: "personal"
                      ownerId:
                        type: string
                        description: 擁有者ID
                        example: "Uae47d9d496e4596d70ed724a7d6e2948"
                      userRole:
                        type: string
                        enum: [owner, admin, editor, viewer]
                        description: 用戶在此帳本的角色
                        example: "owner"
                      status:
                        type: string
                        description: 帳本狀態
                        example: "active"
                      settings:
                        type: object
                        description: 帳本設定
                        properties:
                          currency:
                            type: string
                            example: "NTD"
                          timezone:
                            type: string
                            example: "Asia/Taipei"
                          allowCollaboration:
                            type: boolean
                            example: true
                          defaultViewMode:
                            type: string
                            example: "Expert"
                      collaborators:
                        type: array
                        description: 協作者列表（需要權限）
                        items:
                          type: object
                          properties:
                            userId:
                              type: string
                              example: "user_456"
                            displayName:
                              type: string
                              example: "張三"
                            role:
                              type: string
                              enum: [admin, editor, viewer]
                              example: "editor"
                            joinedAt:
                              type: string
                              format: date-time
                              example: "2025-08-22T12:00:00Z"
                            lastActive:
                              type: string
                              format: date-time
                              example: "2025-08-22T11:00:00Z"
                      statistics:
                        type: object
                        description: 帳本統計（根據用戶模式顯示不同詳細程度）
                        properties:
                          totalEntries:
                            type: integer
                            example: 156
                          totalIncome:
                            type: number
                            example: 75000.00
                          totalExpense:
                            type: number
                            example: 45678.90
                          balance:
                            type: number
                            example: 29321.10
                          lastEntry:
                            type: string
                            format: date-time
                            example: "2025-08-22T10:30:00Z"
                          monthlyAverage:
                            type: number
                            example: 15000.00
                      permissions:
                        type: object
                        description: 用戶權限
                        properties:
                          canRead:
                            type: boolean
                            example: true
                          canWrite:
                            type: boolean
                            example: true
                          canDelete:
                            type: boolean
                            example: true
                          canManageCollaborators:
                            type: boolean
                            example: true
                          canExport:
                            type: boolean
                            example: true
                      createdAt:
                        type: string
                        format: date-time
                        description: 創建時間
                        example: "2025-08-22T12:00:00Z"
                      updatedAt:
                        type: string
                        format: date-time
                        description: 最後更新時間
                        example: "2025-08-22T12:00:00Z"
                  metadata:
                    type: object
                    properties:
                      userMode:
                        type: string
                        example: "Expert"
                      includeCollaborators:
                        type: boolean
                        example: true
                      accessLevel:
                        type: string
                        example: "full"

    put:
      tags:
        - Ledger Management
      summary: 更新帳本資訊
      description: 更新帳本的基本資訊和設定
      operationId: updateLedger
      parameters:
        - name: ledgerId
          in: path
          required: true
          description: 帳本ID
          schema:
            type: string
            example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: 帳本名稱
                  example: "更新後的帳本名稱"
                description:
                  type: string
                  description: 帳本描述
                  example: "更新後的帳本描述"
                settings:
                  type: object
                  description: 帳本設定
                  properties:
                    currency:
                      type: string
                      example: "NTD"
                    timezone:
                      type: string
                      example: "Asia/Taipei"
                    allowCollaboration:
                      type: boolean
                      example: true
                    defaultViewMode:
                      type: string
                      enum: [Expert, Inertial, Cultivation, Guiding]
                      example: "Expert"
                userId:
                  type: string
                  description: 操作用戶ID
                  example: "Uae47d9d496e4596d70ed724a7d6e2948"
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      ledgerId:
                        type: string
                        example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
                      updatedFields:
                        type: array
                        items:
                          type: string
                        example: ["name", "description", "settings"]
                      updatedAt:
                        type: string
                        format: date-time
                        example: "2025-08-22T12:00:00Z"

    delete:
      tags:
        - Ledger Management
      summary: 刪除帳本
      description: 刪除指定的帳本（需要擁有者權限）
      operationId: deleteLedger
      parameters:
        - name: ledgerId
          in: path
          required: true
          description: 帳本ID
          schema:
            type: string
            example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - confirmationToken
                - userId
              properties:
                confirmationToken:
                  type: string
                  description: 確認刪除的令牌
                  example: "confirm_delete_user_Uae47d9d496e4596d70ed724a7d6e2948"
                userId:
                  type: string
                  description: 操作用戶ID
                  example: "Uae47d9d496e4596d70ed724a7d6e2948"
                backupData:
                  type: boolean
                  description: 是否在刪除前備份資料
                  default: true
                  example: true
                transferCollaborators:
                  type: string
                  description: 協作者轉移到的帳本ID（可選）
                  example: "target_ledger_id"
      responses:
        '200':
          description: 刪除成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      ledgerId:
                        type: string
                        example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
                      backupId:
                        type: string
                        description: 備份ID（如果有備份）
                        example: "backup_12345"
                      deletedAt:
                        type: string
                        format: date-time
                        example: "2025-08-22T12:00:00Z"
                      affectedCollaborators:
                        type: integer
                        description: 受影響的協作者數量
                        example: 3

  /ledgers/{ledgerId}/collaborators:
    get:
      tags:
        - Collaboration
      summary: 取得帳本協作者列表
      description: 取得指定帳本的協作者列表，支援分頁
      operationId: getLedgerCollaborators
      parameters:
        - name: ledgerId
          in: path
          required: true
          description: 帳本ID
          schema:
            type: string
            example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
        - name: userId
          in: query
          required: true
          description: 請求用戶ID
          schema:
            type: string
            example: "Uae47d9d496e4596d70ed724a7d6e2948"
        - name: role
          in: query
          description: 角色篩選
          schema:
            type: string
            enum: [admin, editor, viewer]
            example: "editor"
        - name: status
          in: query
          description: 狀態篩選
          schema:
            type: string
            enum: [active, invited, suspended]
            default: active
            example: "active"
        - name: page
          in: query
          description: 頁碼
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: limit
          in: query
          description: 每頁筆數
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 20
            example: 20
        - name: sort
          in: query
          description: 排序方式
          schema:
            type: string
            enum: [joinedAt_desc, joinedAt_asc, name_asc, name_desc, lastActive_desc]
            default: joinedAt_desc
            example: "joinedAt_desc"
      responses:
        '200':
          description: 取得成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      collaborators:
                        type: array
                        items:
                          type: object
                          properties:
                            userId:
                              type: string
                              example: "user_456"
                            displayName:
                              type: string
                              example: "張三"
                            email:
                              type: string
                              example: "user@example.com"
                            role:
                              type: string
                              enum: [admin, editor, viewer]
                              example: "editor"
                            status:
                              type: string
                              enum: [active, invited, suspended]
                              example: "active"
                            joinedAt:
                              type: string
                              format: date-time
                              example: "2025-08-22T12:00:00Z"
                            lastActive:
                              type: string
                              format: date-time
                              example: "2025-08-22T11:00:00Z"
                            contributionStats:
                              type: object
                              properties:
                                totalEntries:
                                  type: integer
                                  example: 25
                                lastEntry:
                                  type: string
                                  format: date-time
                                  example: "2025-08-22T10:30:00Z"
                  metadata:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          currentPage:
                            type: integer
                            example: 1
                          totalPages:
                            type: integer
                            example: 2
                          totalCount:
                            type: integer
                            example: 25
                          hasNext:
                            type: boolean
                            example: true
                          hasPrevious:
                            type: boolean
                            example: false

    post:
      tags:
        - Collaboration
      summary: 邀請協作者
      description: 邀請用戶加入帳本協作
      operationId: inviteCollaborator
      parameters:
        - name: ledgerId
          in: path
          required: true
          description: 帳本ID
          schema:
            type: string
            example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - inviteeId
                - role
                - inviterId
              properties:
                inviteeId:
                  type: string
                  description: 被邀請者用戶ID
                  example: "user_456"
                role:
                  type: string
                  enum: [admin, editor, viewer]
                  description: 指派角色
                  example: "editor"
                inviterId:
                  type: string
                  description: 邀請者用戶ID
                  example: "Uae47d9d496e4596d70ed724a7d6e2948"
                message:
                  type: string
                  description: 邀請訊息
                  example: "邀請您加入我的記帳帳本"
                permissions:
                  type: object
                  description: 自訂權限設定
                  properties:
                    canExport:
                      type: boolean
                      default: true
                      example: true
                    canInviteOthers:
                      type: boolean
                      default: false
                      example: false
                    canModifySettings:
                      type: boolean
                      default: false
                      example: false
      responses:
        '201':
          description: 邀請發送成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      inviteId:
                        type: string
                        description: 邀請ID
                        example: "invite_12345"
                      inviteeId:
                        type: string
                        example: "user_456"
                      role:
                        type: string
                        example: "editor"
                      status:
                        type: string
                        enum: [sent, pending, accepted, declined]
                        example: "sent"
                      invitedAt:
                        type: string
                        format: date-time
                        example: "2025-08-22T12:00:00Z"
                      expiresAt:
                        type: string
                        format: date-time
                        description: 邀請過期時間
                        example: "2025-08-29T12:00:00Z"

  /ledgers/{ledgerId}/collaborators/{userId}:
    patch:
      tags:
        - Collaboration
      summary: 更新協作者角色
      description: 更新指定協作者的角色和權限
      operationId: updateCollaboratorRole
      parameters:
        - name: ledgerId
          in: path
          required: true
          description: 帳本ID
          schema:
            type: string
            example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
        - name: userId
          in: path
          required: true
          description: 協作者用戶ID
          schema:
            type: string
            example: "user_456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - newRole
                - operatorId
              properties:
                newRole:
                  type: string
                  enum: [admin, editor, viewer]
                  description: 新角色
                  example: "admin"
                operatorId:
                  type: string
                  description: 操作者用戶ID
                  example: "Uae47d9d496e4596d70ed724a7d6e2948"
                permissions:
                  type: object
                  description: 自訂權限設定
                  properties:
                    canExport:
                      type: boolean
                      example: true
                    canInviteOthers:
                      type: boolean
                      example: true
                    canModifySettings:
                      type: boolean
                      example: false
                reason:
                  type: string
                  description: 變更原因
                  example: "提升為管理員"
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      userId:
                        type: string
                        example: "user_456"
                      previousRole:
                        type: string
                        example: "editor"
                      newRole:
                        type: string
                        example: "admin"
                      updatedAt:
                        type: string
                        format: date-time
                        example: "2025-08-22T12:00:00Z"
                      updatedPermissions:
                        type: object
                        properties:
                          canExport:
                            type: boolean
                            example: true
                          canInviteOthers:
                            type: boolean
                            example: true

    delete:
      tags:
        - Collaboration
      summary: 移除協作者
      description: 從帳本中移除指定的協作者
      operationId: removeCollaborator
      parameters:
        - name: ledgerId
          in: path
          required: true
          description: 帳本ID
          schema:
            type: string
            example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
        - name: userId
          in: path
          required: true
          description: 協作者用戶ID
          schema:
            type: string
            example: "user_456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - operatorId
              properties:
                operatorId:
                  type: string
                  description: 操作者用戶ID
                  example: "Uae47d9d496e4596d70ed724a7d6e2948"
                reason:
                  type: string
                  description: 移除原因
                  example: "不再需要存取權限"
                notifyUser:
                  type: boolean
                  description: 是否通知被移除的用戶
                  default: true
                  example: true
      responses:
        '200':
          description: 移除成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      removedUserId:
                        type: string
                        example: "user_456"
                      previousRole:
                        type: string
                        example: "editor"
                      removedAt:
                        type: string
                        format: date-time
                        example: "2025-08-22T12:00:00Z"
                      notificationSent:
                        type: boolean
                        example: true

  /ledgers/{ledgerId}/share:
    post:
      tags:
        - Sharing
      summary: 產生分享連結
      description: 為帳本產生分享連結
      operationId: generateShareLink
      parameters:
        - name: ledgerId
          in: path
          required: true
          description: 帳本ID
          schema:
            type: string
            example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - shareType
              properties:
                userId:
                  type: string
                  description: 分享者用戶ID
                  example: "Uae47d9d496e4596d70ed724a7d6e2948"
                shareType:
                  type: string
                  enum: [view_only, edit_access, full_access]
                  description: 分享類型
                  example: "view_only"
                expiresAt:
                  type: string
                  format: date-time
                  description: 過期時間（可選）
                  example: "2025-08-29T12:00:00Z"
                maxUses:
                  type: integer
                  description: 最大使用次數（可選）
                  minimum: 1
                  example: 10
                description:
                  type: string
                  description: 分享說明
                  example: "查看我的家庭帳本"
      responses:
        '201':
          description: 分享連結創建成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      shareId:
                        type: string
                        description: 分享ID
                        example: "share_12345"
                      shareUrl:
                        type: string
                        format: uri
                        description: 分享連結
                        example: "https://app.lcas.com/share/share_12345"
                      shareCode:
                        type: string
                        description: 分享代碼
                        example: "LCAS2025"
                      shareType:
                        type: string
                        example: "view_only"
                      createdAt:
                        type: string
                        format: date-time
                        example: "2025-08-22T12:00:00Z"
                      expiresAt:
                        type: string
                        format: date-time
                        example: "2025-08-29T12:00:00Z"
                      maxUses:
                        type: integer
                        example: 10
                      currentUses:
                        type: integer
                        example: 0

components:
  schemas:
    Ledger:
      type: object
      properties:
        ledgerId:
          type: string
          description: 帳本ID
          example: "user_Uae47d9d496e4596d70ed724a7d6e2948"
        name:
          type: string
          description: 帳本名稱
          example: "個人記帳本"
        type:
          type: string
          enum: [personal, shared, family, business]
          description: 帳本類型
          example: "personal"
        ownerId:
          type: string
          description: 擁有者ID
          example: "Uae47d9d496e4596d70ed724a7d6e2948"

    Collaborator:
      type: object
      properties:
        userId:
          type: string
          description: 用戶ID
          example: "user_456"
        displayName:
          type: string
          description: 顯示名稱
          example: "張三"
        role:
          type: string
          enum: [admin, editor, viewer]
          description: 角色
          example: "editor"

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            code:
              type: string
              example: "ERROR_CODE"
            message:
              type: string
              example: "錯誤訊息"
            details:
              type: string
              example: "詳細錯誤說明"

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

security:
  - BearerAuth: []
