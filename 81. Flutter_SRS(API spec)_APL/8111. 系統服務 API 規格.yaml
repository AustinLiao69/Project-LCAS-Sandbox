
openapi: 3.0.3
info:
  title: LCAS 2.0 ç³»çµ±æœå‹™ API è¦æ ¼
  description: |
    ç³»çµ±æœå‹™ API æä¾› LCAS 2.0 ç³»çµ±çš„åŸºç¤ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…å«å¥åº·æª¢æŸ¥ã€
    ç³»çµ±ç›£æ§ã€é…ç½®ç®¡ç†ã€æ—¥èªŒç®¡ç†ç­‰æ ¸å¿ƒç³»çµ±æœå‹™ã€‚
    
    ## ğŸ¯ æœå‹™ç¯„åœ
    - **ç³»çµ±å¥åº·æª¢æŸ¥**ï¼šæœå‹™ç‹€æ…‹ç›£æ§ã€å¯ç”¨æ€§æª¢æ¸¬
    - **ç³»çµ±é…ç½®ç®¡ç†**ï¼šå‹•æ…‹é…ç½®æ›´æ–°ã€ç’°å¢ƒè¨­å®š
    - **æ—¥èªŒç®¡ç†**ï¼šç³»çµ±æ—¥èªŒæŸ¥è©¢ã€éŒ¯èª¤è¿½è¹¤
    - **ç›£æ§å‘Šè­¦**ï¼šæ€§èƒ½ç›£æ§ã€ç•°å¸¸å‘Šè­¦
    - **ç¶­è­·æ¨¡å¼**ï¼šç³»çµ±ç¶­è­·ã€ç‰ˆæœ¬ç®¡ç†
    
  version: 1.0.0
  contact:
    name: LCAS 2.0 API Support
    email: support@lcas.app
  license:
    name: Proprietary
    
servers:
  - url: https://api.lcas.app/v1
    description: ç”Ÿç”¢ç’°å¢ƒ
  - url: https://staging-api.lcas.app/v1
    description: æ¸¬è©¦ç’°å¢ƒ
  - url: http://localhost:5000/v1
    description: é–‹ç™¼ç’°å¢ƒ

tags:
  - name: system-health
    description: ç³»çµ±å¥åº·æª¢æŸ¥
  - name: system-config
    description: ç³»çµ±é…ç½®ç®¡ç†
  - name: system-monitoring
    description: ç³»çµ±ç›£æ§å‘Šè­¦
  - name: system-maintenance
    description: ç³»çµ±ç¶­è­·ç®¡ç†

paths:
  /system/health:
    get:
      tags: [system-health]
      summary: ç³»çµ±å¥åº·æª¢æŸ¥
      description: æª¢æŸ¥ç³»çµ±å„æœå‹™æ¨¡çµ„çš„å¥åº·ç‹€æ…‹å’Œå¯ç”¨æ€§
      operationId: getSystemHealth
      responses:
        '200':
          description: ç³»çµ±å¥åº·ç‹€æ…‹
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      status:
                        type: string
                        enum: [healthy, degraded, unhealthy]
                        example: healthy
                      timestamp:
                        type: string
                        format: date-time
                      services:
                        type: object
                        properties:
                          api:
                            $ref: '#/components/schemas/ServiceHealth'
                          database:
                            $ref: '#/components/schemas/ServiceHealth'
                          authentication:
                            $ref: '#/components/schemas/ServiceHealth'
                          backup:
                            $ref: '#/components/schemas/ServiceHealth'
                      metrics:
                        type: object
                        properties:
                          uptime:
                            type: string
                            example: "99.98%"
                          avgResponseTime:
                            type: string
                            example: "28ms"
                          activeUsers:
                            type: integer
                            example: 1250
                          systemLoad:
                            type: string
                            example: "0.65"
                      version:
                        type: string
                        example: "2.1.13"

  /system/config:
    get:
      tags: [system-config]
      summary: å–å¾—ç³»çµ±é…ç½®
      description: æŸ¥è©¢ç•¶å‰ç³»çµ±é…ç½®åƒæ•¸
      operationId: getSystemConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ç³»çµ±é…ç½®è³‡è¨Š
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      environment:
                        type: string
                        example: production
                      features:
                        type: object
                        properties:
                          ai_assistant:
                            type: boolean
                          gamification:
                            type: boolean
                          collaboration:
                            type: boolean
                      limits:
                        type: object
                        properties:
                          maxConcurrentUsers:
                            type: integer
                          rateLimitPerMinute:
                            type: integer
                          maxFileSize:
                            type: string
                            
    put:
      tags: [system-config]
      summary: æ›´æ–°ç³»çµ±é…ç½®
      description: å‹•æ…‹æ›´æ–°ç³»çµ±é…ç½®åƒæ•¸ï¼ˆéœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼‰
      operationId: updateSystemConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                configKey:
                  type: string
                  example: "features.ai_assistant"
                configValue:
                  type: string
                  example: "true"
                reason:
                  type: string
                  example: "å•Ÿç”¨AIåŠ©ç†åŠŸèƒ½"
      responses:
        '200':
          description: é…ç½®æ›´æ–°æˆåŠŸ
        '403':
          description: æ¬Šé™ä¸è¶³

  /system/monitoring/alerts:
    get:
      tags: [system-monitoring]
      summary: å–å¾—ç³»çµ±å‘Šè­¦
      description: æŸ¥è©¢ç³»çµ±ç›£æ§å‘Šè­¦è³‡è¨Š
      operationId: getSystemAlerts
      security:
        - bearerAuth: []
      parameters:
        - name: severity
          in: query
          description: å‘Šè­¦åš´é‡ç¨‹åº¦
          schema:
            type: string
            enum: [critical, high, medium, low]
        - name: status
          in: query
          description: å‘Šè­¦ç‹€æ…‹
          schema:
            type: string
            enum: [active, resolved, suppressed]
      responses:
        '200':
          description: å‘Šè­¦æŸ¥è©¢æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      alerts:
                        type: array
                        items:
                          $ref: '#/components/schemas/SystemAlert'

  /system/maintenance:
    get:
      tags: [system-maintenance]
      summary: å–å¾—ç¶­è­·ç‹€æ…‹
      description: æŸ¥è©¢ç³»çµ±ç¶­è­·æ¨¡å¼ç‹€æ…‹
      operationId: getMaintenanceStatus
      responses:
        '200':
          description: ç¶­è­·ç‹€æ…‹æŸ¥è©¢æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      isMaintenanceMode:
                        type: boolean
                      scheduledMaintenance:
                        type: object
                        properties:
                          startTime:
                            type: string
                            format: date-time
                          endTime:
                            type: string
                            format: date-time
                          description:
                            type: string
                            
    post:
      tags: [system-maintenance]
      summary: è¨­å®šç¶­è­·æ¨¡å¼
      description: å•Ÿç”¨æˆ–åœç”¨ç³»çµ±ç¶­è­·æ¨¡å¼
      operationId: setMaintenanceMode
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enabled:
                  type: boolean
                  description: æ˜¯å¦å•Ÿç”¨ç¶­è­·æ¨¡å¼
                message:
                  type: string
                  description: ç¶­è­·è¨Šæ¯
                estimatedDuration:
                  type: integer
                  description: é ä¼°ç¶­è­·æ™‚é–“ï¼ˆåˆ†é˜ï¼‰
      responses:
        '200':
          description: ç¶­è­·æ¨¡å¼è¨­å®šæˆåŠŸ
        '403':
          description: æ¬Šé™ä¸è¶³

  /help/contact:
    post:
      tags: [system-maintenance]
      summary: è¯ç¹«å®¢æœ
      description: |
        æäº¤å®¢æœè¯ç¹«è«‹æ±‚ï¼Œæ”¯æ´å•é¡Œåˆ†é¡èˆ‡å„ªå…ˆç´šè¨­å®šã€‚
        
        **å°æ‡‰ç•«é¢**: S-506 å¹«åŠ©ä¸­å¿ƒé 
        **å››æ¨¡å¼å·®ç•°**: å•é¡Œåˆ†é¡èˆ‡è¡¨å–®è¤‡é›œåº¦ä¸åŒ
      operationId: contactSupport
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                category:
                  type: string
                  enum: [technical, billing, feature_request, bug_report, general, account]
                  example: "technical"
                  description: "å•é¡Œåˆ†é¡"
                priority:
                  type: string
                  enum: [low, medium, high, urgent]
                  example: "medium"
                  description: "å•é¡Œå„ªå…ˆç´š"
                subject:
                  type: string
                  example: "ç„¡æ³•åŒæ­¥äº¤æ˜“è³‡æ–™"
                  maxLength: 200
                  description: "å•é¡Œä¸»æ—¨"
                message:
                  type: string
                  example: "æˆ‘çš„äº¤æ˜“è³‡æ–™ç„¡æ³•æ­£å¸¸åŒæ­¥ï¼Œå·²ç¶“é‡æ–°ç™»å…¥ä½†å•é¡Œä¾ç„¶å­˜åœ¨ã€‚"
                  maxLength: 2000
                  description: "å•é¡Œè©³ç´°æè¿°"
                contactMethod:
                  type: string
                  enum: [email, phone, in_app]
                  example: "email"
                  description: "å¸Œæœ›çš„è¯ç¹«æ–¹å¼"
                contactInfo:
                  type: object
                  properties:
                    email:
                      type: string
                      format: email
                      example: "user@example.com"
                    phone:
                      type: string
                      example: "+886-912-345-678"
                    preferredTime:
                      type: string
                      example: "å·¥ä½œæ—¥ä¸Šåˆ 9:00-12:00"
                attachments:
                  type: array
                  items:
                    type: object
                    properties:
                      filename:
                        type: string
                        example: "screenshot.png"
                      size:
                        type: integer
                        example: 1024768
                      mimeType:
                        type: string
                        example: "image/png"
                      base64Data:
                        type: string
                        description: "Base64 ç·¨ç¢¼çš„æª”æ¡ˆå…§å®¹"
                  maxItems: 5
                  description: "é™„ä»¶åˆ—è¡¨ï¼ˆæœ€å¤š 5 å€‹æª”æ¡ˆï¼‰"
                systemInfo:
                  type: object
                  properties:
                    platform:
                      type: string
                      enum: [iOS, Android, Web]
                      example: "iOS"
                    appVersion:
                      type: string
                      example: "2.1.0"
                    deviceModel:
                      type: string
                      example: "iPhone 13"
                    osVersion:
                      type: string
                      example: "iOS 16.0"
                userMode:
                  type: string
                  enum: [Expert, Inertial, Cultivation, Guiding]
                  example: "Expert"
                  description: "ç”¨æˆ¶æ¨¡å¼"
              required:
                - category
                - subject
                - message
                - contactMethod
      responses:
        '201':
          description: å®¢æœè«‹æ±‚æäº¤æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      ticketId:
                        type: string
                        example: "TKT-2025012700123"
                        description: "å®¢æœå·¥å–®è™Ÿç¢¼"
                      category:
                        type: string
                        example: "technical"
                      priority:
                        type: string
                        example: "medium"
                      status:
                        type: string
                        enum: [pending, assigned, in_progress, resolved, closed]
                        example: "pending"
                        description: "å·¥å–®ç‹€æ…‹"
                      estimatedResponseTime:
                        type: object
                        properties:
                          hours:
                            type: integer
                            example: 24
                          businessHours:
                            type: boolean
                            example: true
                        description: "é ä¼°å›è¦†æ™‚é–“"
                      assignedAgent:
                        type: object
                        properties:
                          name:
                            type: string
                            example: "å®¢æœå°ç‹"
                          id:
                            type: string
                            example: "agent-001"
                        description: "æŒ‡æ´¾çš„å®¢æœäººå“¡"
                      trackingUrl:
                        type: string
                        example: "https://support.lcas.app/tickets/TKT-2025012700123"
                        description: "å·¥å–®è¿½è¹¤é€£çµ"
                      contactInfo:
                        type: object
                        properties:
                          email:
                            type: string
                            example: "support@lcas.app"
                          phone:
                            type: string
                            example: "+886-2-1234-5678"
                          workingHours:
                            type: string
                            example: "é€±ä¸€è‡³é€±äº” 9:00-18:00"
                      autoReply:
                        type: object
                        properties:
                          sent:
                            type: boolean
                            example: true
                          message:
                            type: string
                            example: "æ„Ÿè¬æ‚¨çš„ä¾†ä¿¡ï¼Œæˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„å•é¡Œï¼Œå°‡åœ¨ 24 å°æ™‚å…§å›è¦†ã€‚"
                      nextSteps:
                        type: array
                        items:
                          type: string
                        example: [
                          "æˆ‘å€‘å°‡æ–¼ 24 å°æ™‚å…§é€é Email å›è¦†",
                          "æ‚¨å¯ä»¥é€éå·¥å–®è™Ÿç¢¼è¿½è¹¤è™•ç†é€²åº¦",
                          "å¦‚æœ‰ç·Šæ€¥å•é¡Œè«‹ç›´æ¥æ’¥æ‰“å®¢æœé›»è©±"
                        ]
                        description: "å¾ŒçºŒè™•ç†æ­¥é©Ÿ"
        '400':
          description: è«‹æ±‚åƒæ•¸éŒ¯èª¤
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: "VALIDATION_ERROR"
                      message:
                        type: string
                        example: "å•é¡Œæè¿°ä¸èƒ½ç‚ºç©º"
                      field:
                        type: string
                        example: "message"
        '413':
          description: é™„ä»¶å¤§å°è¶…éé™åˆ¶
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: "FILE_TOO_LARGE"
                      message:
                        type: string
                        example: "é™„ä»¶å¤§å°ä¸èƒ½è¶…é 10MB"
                      maxSize:
                        type: string
                        example: "10MB"
        '429':
          description: è«‹æ±‚éæ–¼é »ç¹
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: "RATE_LIMIT_EXCEEDED"
                      message:
                        type: string
                        example: "è«‹æ±‚éæ–¼é »ç¹ï¼Œè«‹ç¨å¾Œå†è©¦"
                      retryAfter:
                        type: integer
                        example: 300
                        description: "å»ºè­°é‡è©¦é–“éš”ï¼ˆç§’ï¼‰"
        '401':
          description: æœªæˆæ¬Šå­˜å–
        '500':
          description: å…§éƒ¨ä¼ºæœå™¨éŒ¯èª¤

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    ServiceHealth:
      type: object
      properties:
        status:
          type: string
          enum: [up, down, degraded]
        responseTime:
          type: string
          example: "45ms"
        lastCheck:
          type: string
          format: date-time
        details:
          type: object

    SystemAlert:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        description:
          type: string
        severity:
          type: string
          enum: [critical, high, medium, low]
        status:
          type: string
          enum: [active, resolved, suppressed]
        triggeredAt:
          type: string
          format: date-time
        resolvedAt:
          type: string
          format: date-time
          nullable: true
        affectedServices:
          type: array
          items:
            type: string
