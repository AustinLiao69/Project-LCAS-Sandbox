
openapi: 3.0.3
info:
  title: LCAS 2.0 ç³»çµ±æœå‹™ API è¦æ ¼
  description: |
    ç³»çµ±æœå‹™ API æä¾› LCAS 2.0 ç³»çµ±çš„åŸºç¤ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…å«å¥åº·æª¢æŸ¥ã€
    ç³»çµ±ç›£æ§ã€é…ç½®ç®¡ç†ã€æ—¥èªŒç®¡ç†ç­‰æ ¸å¿ƒç³»çµ±æœå‹™ã€‚
    
    ## ğŸ¯ æœå‹™ç¯„åœ
    - **ç³»çµ±å¥åº·æª¢æŸ¥**ï¼šæœå‹™ç‹€æ…‹ç›£æ§ã€å¯ç”¨æ€§æª¢æ¸¬
    - **ç³»çµ±é…ç½®ç®¡ç†**ï¼šå‹•æ…‹é…ç½®æ›´æ–°ã€ç’°å¢ƒè¨­å®š
    - **æ—¥èªŒç®¡ç†**ï¼šç³»çµ±æ—¥èªŒæŸ¥è©¢ã€éŒ¯èª¤è¿½è¹¤
    - **ç›£æ§å‘Šè­¦**ï¼šæ€§èƒ½ç›£æ§ã€ç•°å¸¸å‘Šè­¦
    - **ç¶­è­·æ¨¡å¼**ï¼šç³»çµ±ç¶­è­·ã€ç‰ˆæœ¬ç®¡ç†
    
  version: 1.0.0
  contact:
    name: LCAS 2.0 API Support
    email: support@lcas.app
  license:
    name: Proprietary
    
servers:
  - url: https://api.lcas.app/v1
    description: ç”Ÿç”¢ç’°å¢ƒ
  - url: https://staging-api.lcas.app/v1
    description: æ¸¬è©¦ç’°å¢ƒ
  - url: http://localhost:5000/v1
    description: é–‹ç™¼ç’°å¢ƒ

tags:
  - name: system-health
    description: ç³»çµ±å¥åº·æª¢æŸ¥
  - name: system-config
    description: ç³»çµ±é…ç½®ç®¡ç†
  - name: system-monitoring
    description: ç³»çµ±ç›£æ§å‘Šè­¦
  - name: system-maintenance
    description: ç³»çµ±ç¶­è­·ç®¡ç†

paths:
  /system/welcome:
    get:
      tags:
        - System Services
      summary: æ­¡è¿é è³‡è¨Š
      description: å–å¾—æ‡‰ç”¨ç¨‹å¼æ­¡è¿é é¢çš„å€‹äººåŒ–è³‡è¨Š
      operationId: getWelcomeInfo
      security:
        - BearerAuth: []
      parameters:
        - name: X-User-Mode
          in: header
          schema:
            type: string
            enum: [Expert, Inertial, Cultivation, Guiding]
      responses:
        '200':
          description: æˆåŠŸå–å¾—æ­¡è¿è³‡è¨Š
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          welcomeMessage:
                            type: string
                            description: å€‹äººåŒ–æ­¡è¿è¨Šæ¯
                          quickActions:
                            type: array
                            items:
                              type: object
                              properties:
                                title:
                                  type: string
                                description:
                                  type: string
                                action:
                                  type: string
                                icon:
                                  type: string
                          statistics:
                            type: object
                            properties:
                              totalTransactions:
                                type: integer
                              monthlySpending:
                                type: number
                              budgetUsage:
                                type: number
                          tips:
                            type: array
                            items:
                              type: string
                            description: æ ¹æ“šç”¨æˆ¶æ¨¡å¼æä¾›çš„ä½¿ç”¨æŠ€å·§

  /system/app-info:
    get:
      tags:
        - System Services
      summary: APPè³‡è¨Š
      description: å–å¾—æ‡‰ç”¨ç¨‹å¼åŸºæœ¬è³‡è¨Š
      operationId: getAppInfo
      responses:
        '200':
          description: æˆåŠŸå–å¾—APPè³‡è¨Š
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          appName:
                            type: string
                            example: "LCAS 2.0"
                          version:
                            type: string
                            example: "2.0.0"
                          buildNumber:
                            type: string
                          releaseDate:
                            type: string
                            format: date
                          features:
                            type: array
                            items:
                              type: string
                          changelog:
                            type: array
                            items:
                              type: object
                              properties:
                                version:
                                  type: string
                                date:
                                  type: string
                                changes:
                                  type: array
                                  items:
                                    type: string

  /system/app-promotion:
    get:
      tags:
        - System Services
      summary: APPæ¨å»£è³‡è¨Š
      description: å–å¾—æ‡‰ç”¨ç¨‹å¼æ¨å»£æ´»å‹•å’Œå„ªæƒ è³‡è¨Š
      operationId: getAppPromotion
      security:
        - BearerAuth: []
      parameters:
        - name: platform
          in: query
          schema:
            type: string
            enum: [ios, android, web]
        - name: userMode
          in: query
          schema:
            type: string
            enum: [Expert, Inertial, Cultivation, Guiding]
      responses:
        '200':
          description: æˆåŠŸå–å¾—æ¨å»£è³‡è¨Š
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          activePromotions:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                title:
                                  type: string
                                description:
                                  type: string
                                imageUrl:
                                  type: string
                                actionUrl:
                                  type: string
                                startDate:
                                  type: string
                                  format: date-time
                                endDate:
                                  type: string
                                  format: date-time
                                targetModes:
                                  type: array
                                  items:
                                    type: string
                          referralProgram:
                            type: object
                            properties:
                              enabled:
                                type: boolean
                              referralCode:
                                type: string
                              rewards:
                                type: array
                                items:
                                  type: object

  /system/health:
    get:
      tags: [system-health]
      summary: ç³»çµ±å¥åº·æª¢æŸ¥
      description: æª¢æŸ¥ç³»çµ±å„æœå‹™æ¨¡çµ„çš„å¥åº·ç‹€æ…‹å’Œå¯ç”¨æ€§
      operationId: getSystemHealth
      parameters:
        - name: X-User-Mode
          in: header
          description: ç”¨æˆ¶æ¨¡å¼æ¨™è­˜ï¼ˆå½±éŸ¿å›æ‡‰è©³ç´°ç¨‹åº¦ï¼‰
          schema:
            type: string
            enum: [Expert, Inertial, Cultivation, Guiding]
            default: Expert
      responses:
        '200':
          description: ç³»çµ±å¥åº·ç‹€æ…‹ï¼ˆå››æ¨¡å¼å·®ç•°åŒ–å›æ‡‰ï¼‰
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    oneOf:
                      - $ref: '#/components/schemas/HealthCheckExpert'
                      - $ref: '#/components/schemas/HealthCheckGuiding'
                  metadata:
                    type: object
                    properties:
                      timestamp:
                        type: string
                        format: date-time
                        example: "2025-01-27T12:00:00Z"
                      requestId:
                        type: string
                        format: uuid
                        example: "550e8400-e29b-41d4-a716-446655440001"
                      userMode:
                        type: string
                        enum: [Expert, Inertial, Cultivation, Guiding]
                        example: "Expert"

  /system/config:
    get:
      tags: [system-config]
      summary: å–å¾—ç³»çµ±é…ç½®
      description: æŸ¥è©¢ç•¶å‰ç³»çµ±é…ç½®åƒæ•¸
      operationId: getSystemConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ç³»çµ±é…ç½®è³‡è¨Š
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      environment:
                        type: string
                        example: production
                      features:
                        type: object
                        properties:
                          ai_assistant:
                            type: boolean
                          gamification:
                            type: boolean
                          collaboration:
                            type: boolean
                      limits:
                        type: object
                        properties:
                          maxConcurrentUsers:
                            type: integer
                          rateLimitPerMinute:
                            type: integer
                          maxFileSize:
                            type: string
                            
    put:
      tags: [system-config]
      summary: æ›´æ–°ç³»çµ±é…ç½®
      description: å‹•æ…‹æ›´æ–°ç³»çµ±é…ç½®åƒæ•¸ï¼ˆéœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼‰
      operationId: updateSystemConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                configKey:
                  type: string
                  example: "features.ai_assistant"
                configValue:
                  type: string
                  example: "true"
                reason:
                  type: string
                  example: "å•Ÿç”¨AIåŠ©ç†åŠŸèƒ½"
      responses:
        '200':
          description: é…ç½®æ›´æ–°æˆåŠŸ
        '403':
          description: æ¬Šé™ä¸è¶³

  /system/monitoring/alerts:
    get:
      tags: [system-monitoring]
      summary: å–å¾—ç³»çµ±å‘Šè­¦
      description: æŸ¥è©¢ç³»çµ±ç›£æ§å‘Šè­¦è³‡è¨Š
      operationId: getSystemAlerts
      security:
        - bearerAuth: []
      parameters:
        - name: severity
          in: query
          description: å‘Šè­¦åš´é‡ç¨‹åº¦
          schema:
            type: string
            enum: [critical, high, medium, low]
        - name: status
          in: query
          description: å‘Šè­¦ç‹€æ…‹
          schema:
            type: string
            enum: [active, resolved, suppressed]
      responses:
        '200':
          description: å‘Šè­¦æŸ¥è©¢æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      alerts:
                        type: array
                        items:
                          $ref: '#/components/schemas/SystemAlert'

  /system/welcome:
    get:
      tags: [system-config]
      summary: æ­¡è¿é è³‡è¨Š
      description: å–å¾—æ­¡è¿é é¢é¡¯ç¤ºè³‡è¨Š
      operationId: getWelcomeInfo
      responses:
        '200':
          description: æ­¡è¿è³‡è¨Š
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "æ­¡è¿ä½¿ç”¨ LCAS 2.0"
                      subtitle:
                        type: string
                        example: "æ™ºæ…§è¨˜å¸³ï¼Œè¼•é¬†ç†è²¡"
                      features:
                        type: array
                        items:
                          type: string
                        example: ["LINE å¿«é€Ÿè¨˜å¸³", "å¤šå¸³æœ¬ç®¡ç†", "æ™ºæ…§åˆ†æ"]
                      appDownloadUrl:
                        type: string
                        example: "https://app.lcas.app/download"

  /system/app-info:
    get:
      tags: [system-config]
      summary: APP è³‡è¨Š
      description: å–å¾—æ‡‰ç”¨ç¨‹å¼åŸºæœ¬è³‡è¨Š
      operationId: getAppInfo
      responses:
        '200':
          description: APP è³‡è¨Š
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      appName:
                        type: string
                        example: "LCAS 2.0"
                      version:
                        type: string
                        example: "2.1.0"
                      buildNumber:
                        type: string
                        example: "2025012701"
                      lastUpdated:
                        type: string
                        format: date-time
                        example: "2025-01-27T12:00:00Z"

  /system/app-promotion:
    get:
      tags: [system-config]
      summary: APP æ¨å»£è³‡è¨Š
      description: å–å¾—æ‡‰ç”¨ç¨‹å¼æ¨å»£ç›¸é—œè³‡è¨Š
      operationId: getAppPromotion
      responses:
        '200':
          description: æ¨å»£è³‡è¨Š
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      promotionTitle:
                        type: string
                        example: "ç«‹å³ä¸‹è¼‰ LCAS APP"
                      description:
                        type: string
                        example: "äº«å—æ›´å®Œæ•´çš„è¨˜å¸³é«”é©—"
                      downloadLinks:
                        type: object
                        properties:
                          ios:
                            type: string
                            example: "https://apps.apple.com/app/lcas"
                          android:
                            type: string
                            example: "https://play.google.com/store/apps/details?id=com.lcas.app"
                      features:
                        type: array
                        items:
                          type: string
                        example: ["åŒæ­¥è¨˜å¸³", "æ™ºæ…§åˆ†æ", "é ç®—ç®¡ç†"]

  /system/maintenance:
    get:
      tags: [system-maintenance]
      summary: å–å¾—ç¶­è­·ç‹€æ…‹
      description: æŸ¥è©¢ç³»çµ±ç¶­è­·æ¨¡å¼ç‹€æ…‹
      operationId: getMaintenanceStatus
      responses:
        '200':
          description: ç¶­è­·ç‹€æ…‹æŸ¥è©¢æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      isMaintenanceMode:
                        type: boolean
                      scheduledMaintenance:
                        type: object
                        properties:
                          startTime:
                            type: string
                            format: date-time
                          endTime:
                            type: string
                            format: date-time
                          description:
                            type: string
                            
    post:
      tags: [system-maintenance]
      summary: è¨­å®šç¶­è­·æ¨¡å¼
      description: å•Ÿç”¨æˆ–åœç”¨ç³»çµ±ç¶­è­·æ¨¡å¼
      operationId: setMaintenanceMode
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enabled:
                  type: boolean
                  description: æ˜¯å¦å•Ÿç”¨ç¶­è­·æ¨¡å¼
                message:
                  type: string
                  description: ç¶­è­·è¨Šæ¯
                estimatedDuration:
                  type: integer
                  description: é ä¼°ç¶­è­·æ™‚é–“ï¼ˆåˆ†é˜ï¼‰
      responses:
        '200':
          description: ç¶­è­·æ¨¡å¼è¨­å®šæˆåŠŸ
        '403':
          description: æ¬Šé™ä¸è¶³

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    ServiceHealth:
      type: object
      properties:
        status:
          type: string
          enum: [up, down, degraded]
        responseTime:
          type: string
          example: "45ms"
        lastCheck:
          type: string
          format: date-time
        details:
          type: object

    HealthCheckExpert:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
          example: healthy
        services:
          type: object
          properties:
            api:
              $ref: '#/components/schemas/ServiceHealth'
            database:
              $ref: '#/components/schemas/ServiceHealth'
            authentication:
              $ref: '#/components/schemas/ServiceHealth'
            backup:
              $ref: '#/components/schemas/ServiceHealth'
        metrics:
          type: object
          properties:
            uptime:
              type: string
              example: "99.98%"
            avgResponseTime:
              type: string
              example: "28ms"
            activeUsers:
              type: integer
              example: 1250
            systemLoad:
              type: string
              example: "0.65"
        version:
          type: string
          example: "2.1.13"
        detailedMetrics:
          type: object
          properties:
            cpuUsage:
              type: number
              example: 65.2
            memoryUsage:
              type: number
              example: 78.5
            diskSpace:
              type: number
              example: 45.3

    HealthCheckGuiding:
      type: object
      properties:
        status:
          type: string
          example: "ç³»çµ±é‹è¡Œæ­£å¸¸"
        simpleIndicator:
          type: boolean
          example: true

    SystemAlert:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        description:
          type: string
        severity:
          type: string
          enum: [critical, high, medium, low]
        status:
          type: string
          enum: [active, resolved, suppressed]
        triggeredAt:
          type: string
          format: date-time
        resolvedAt:
          type: string
          format: date-time
          nullable: true
        affectedServices:
          type: array
          items:
            type: string
