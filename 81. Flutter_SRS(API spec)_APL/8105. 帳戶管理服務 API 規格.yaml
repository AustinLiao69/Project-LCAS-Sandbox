openapi: 3.0.3
info:
  title: LCAS 2.0 - å¸³æˆ¶ç®¡ç†æœå‹™ API è¦æ ¼
  description: |
    **å¸³æˆ¶ç®¡ç†æœå‹™ (Account Management Services)**

    æœ¬æœå‹™æä¾›å®Œæ•´çš„å¸³æˆ¶ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…å«å¸³æˆ¶çš„å»ºç«‹ã€æŸ¥è©¢ã€ä¿®æ”¹ã€åˆªé™¤ä»¥åŠé¤˜é¡ç®¡ç†ã€‚
    æ”¯æ´å¤šç¨®å¸³æˆ¶é¡å‹ï¼ˆç¾é‡‘ã€éŠ€è¡Œã€ä¿¡ç”¨å¡ã€æŠ•è³‡ç­‰ï¼‰ï¼Œä¸¦æä¾›å››æ¨¡å¼å·®ç•°åŒ–é«”é©—ã€‚

    ## ğŸ¯ æœå‹™ç¯„åœ
    - **å¸³æˆ¶ CRUD**ï¼šå»ºç«‹ã€æŸ¥è©¢ã€ä¿®æ”¹ã€åˆªé™¤å¸³æˆ¶
    - **å¸³æˆ¶é¡å‹ç®¡ç†**ï¼šç¾é‡‘ã€éŠ€è¡Œã€ä¿¡ç”¨å¡ã€æŠ•è³‡ã€å€Ÿè²¸å¸³æˆ¶
    - **é¤˜é¡ç®¡ç†**ï¼šå³æ™‚é¤˜é¡æŸ¥è©¢ã€é¤˜é¡æ­·å²è¿½è¹¤
    - **å¸³æˆ¶è½‰å¸³**ï¼šå¸³æˆ¶é–“è³‡é‡‘è½‰ç§»
    - **å¸³æˆ¶çµ±è¨ˆ**ï¼šä½¿ç”¨çµ±è¨ˆèˆ‡åˆ†æ

    ## ğŸ¨ å››æ¨¡å¼å·®ç•°åŒ–æ”¯æ´

    | æ¨¡å¼ | ç‰¹è‰²åŠŸèƒ½ |
    |------|----------|
    | **Expert** | å®Œæ•´å¸³æˆ¶ç®¡ç†å·¥å…·ã€é€²éšçµ±è¨ˆåˆ†æã€æ‰¹æ¬¡æ“ä½œ |
    | **Inertial** | æ¨™æº–å¸³æˆ¶æ“ä½œã€ç°¡æ½”ä»‹é¢ã€å›ºå®šæµç¨‹ |
    | **Cultivation** | å¸³æˆ¶å»ºè­°ã€ç†è²¡å¼•å°ã€é€²åº¦è¿½è¹¤ |
    | **Guiding** | æ¥µç°¡å¸³æˆ¶è¨­å®šã€é è¨­é…ç½®ã€æœ€å°‘æ±ºç­– |

    ## ğŸ—‚ï¸ å°æ‡‰ç•«é¢
    - **S-205**ï¼šå¸³æˆ¶é¸æ“‡é 
    - **S-304**ï¼šå¸³æˆ¶ç®¡ç†ä¸»é   
    - **S-305**ï¼šå»ºç«‹å¸³æˆ¶é 

  version: 1.0.0
  contact:
    name: LCAS 2.0 é–‹ç™¼åœ˜éšŠ
    email: dev@lcas.com
  license:
    name: MIT License

servers:
  - url: https://api.lcas.com/v1
    description: æ­£å¼ç’°å¢ƒ
  - url: https://api-staging.lcas.com/v1
    description: æ¸¬è©¦ç’°å¢ƒ

security:
  - BearerAuth: []
  - FirebaseAuth: []

paths:
  /accounts:
    get:
      summary: "å–å¾—å¸³æˆ¶åˆ—è¡¨"
      description: |
        å–å¾—ä½¿ç”¨è€…çš„å¸³æˆ¶åˆ—è¡¨ï¼Œæ”¯æ´åˆ†é ã€ç¯©é¸å’Œæ’åºã€‚
        æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼è¿”å›ä¸åŒè©³ç´°ç¨‹åº¦çš„è³‡è¨Šã€‚
      tags:
        - å¸³æˆ¶æŸ¥è©¢
      parameters:
        - name: ledgerId
          in: query
          description: "æŒ‡å®šå¸³æœ¬ IDï¼ˆå¯é¸ï¼Œé è¨­ç‚ºæ‰€æœ‰å¸³æœ¬ï¼‰"
          schema:
            type: string
        - name: type
          in: query
          description: "å¸³æˆ¶é¡å‹ç¯©é¸"
          schema:
            type: string
            enum: [cash, bank, credit_card, investment, loan, other]
        - name: active
          in: query
          description: "æ˜¯å¦åªé¡¯ç¤ºå•Ÿç”¨å¸³æˆ¶"
          schema:
            type: boolean
            default: true
        - name: includeBalance
          in: query
          description: "æ˜¯å¦åŒ…å«é¤˜é¡è³‡è¨Š"
          schema:
            type: boolean
            default: true
        - name: page
          in: query
          description: "é ç¢¼ï¼ˆå¾ 1 é–‹å§‹ï¼‰"
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          description: "æ¯é ç­†æ•¸"
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: sortBy
          in: query
          description: "æ’åºæ¬„ä½"
          schema:
            type: string
            enum: [name, type, balance, createdAt, lastUsed]
            default: "name"
        - name: sortOrder
          in: query
          description: "æ’åºæ–¹å‘"
          schema:
            type: string
            enum: [asc, desc]
            default: "asc"
      responses:
        '200':
          description: "æˆåŠŸå–å¾—å¸³æˆ¶åˆ—è¡¨"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      accounts:
                        type: array
                        items:
                          $ref: '#/components/schemas/Account'
                      pagination:
                        $ref: '#/components/schemas/Pagination'
                      summary:
                        type: object
                        description: "å¸³æˆ¶çµ±è¨ˆæ‘˜è¦ï¼ˆExpert/Inertial æ¨¡å¼ï¼‰"
                        properties:
                          totalAccounts:
                            type: integer
                            example: 8
                          totalBalance:
                            type: number
                            example: 125000
                          byType:
                            type: object
                            properties:
                              cash:
                                type: object
                                properties:
                                  count:
                                    type: integer
                                    example: 2
                                  balance:
                                    type: number
                                    example: 5000
                              bank:
                                type: object
                                properties:
                                  count:
                                    type: integer
                                    example: 3
                                  balance:
                                    type: number
                                    example: 100000
                              credit_card:
                                type: object
                                properties:
                                  count:
                                    type: integer
                                    example: 2
                                  balance:
                                    type: number
                                    example: -15000
                              investment:
                                type: object
                                properties:
                                  count:
                                    type: integer
                                    example: 1
                                  balance:
                                    type: number
                                    example: 35000
                  error:
                    type: object
                    nullable: true
                    example: null
                  message:
                    type: string
                    example: "æˆåŠŸå–å¾—å¸³æˆ¶åˆ—è¡¨"
                  metadata:
                    type: object
                    required:
                      - timestamp
                      - requestId
                      - userMode
                      - apiVersion
                      - processingTimeMs
                      - modeFeatures
                    properties:
                      timestamp:
                        type: string
                        format: date-time
                        example: "2025-01-27T12:00:00Z"
                        description: "API å›æ‡‰æ™‚é–“æˆ³"
                      requestId:
                        type: string
                        example: "req-uuid-12345"
                        description: "è«‹æ±‚å”¯ä¸€è­˜åˆ¥ç¢¼"
                      userMode:
                        type: string
                        enum: [Expert, Inertial, Cultivation, Guiding]
                        example: "Expert"
                        description: "ç”¨æˆ¶ç•¶å‰æ¨¡å¼"
                      apiVersion:
                        type: string
                        example: "v1.0.0"
                        description: "API ç‰ˆæœ¬"
                      processingTimeMs:
                        type: number
                        example: 120
                        description: "è™•ç†æ™‚é–“ï¼ˆæ¯«ç§’ï¼‰"
                      modeFeatures:
                        type: object
                        description: "å››æ¨¡å¼ç‰¹å®šæ¬„ä½"
                        properties:
                          detailedAnalytics:
                            type: boolean
                            example: true
                          advancedOptions:
                            type: boolean
                            example: true
                          performanceMetrics:
                            type: boolean
                            example: true
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

    post:
      summary: "å»ºç«‹å¸³æˆ¶"
      description: |
        å»ºç«‹æ–°çš„å¸³æˆ¶ã€‚ä¸åŒæ¨¡å¼æä¾›ä¸åŒçš„å»ºç«‹é¸é …å’Œé è¨­å€¼ã€‚
      tags:
        - å¸³æˆ¶ç®¡ç†
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - type
                - ledgerId
              properties:
                name:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "ä¸­åœ‹ä¿¡è¨—æ”¯ç¥¨å¸³æˆ¶"
                  description: "å¸³æˆ¶åç¨±"
                type:
                  type: string
                  enum: [cash, bank, credit_card, investment, loan, other]
                  example: "bank"
                  description: "å¸³æˆ¶é¡å‹"
                ledgerId:
                  type: string
                  example: "ledger-uuid-001"
                  description: "æ‰€å±¬å¸³æœ¬ ID"
                currency:
                  type: string
                  example: "TWD"
                  default: "TWD"
                  description: "å¹£åˆ¥"
                initialBalance:
                  type: number
                  example: 10000
                  default: 0
                  description: "åˆå§‹é¤˜é¡"
                description:
                  type: string
                  maxLength: 200
                  example: "è–ªæ°´å°ˆç”¨å¸³æˆ¶"
                  description: "å¸³æˆ¶æè¿°"
                bankName:
                  type: string
                  example: "ä¸­åœ‹ä¿¡è¨—éŠ€è¡Œ"
                  description: "éŠ€è¡Œåç¨±ï¼ˆbank/credit_card é¡å‹æ™‚å¿…å¡«ï¼‰"
                accountNumber:
                  type: string
                  example: "****1234"
                  description: "å¸³è™Ÿæœ«å››ç¢¼"
                creditLimit:
                  type: number
                  example: 50000
                  description: "ä¿¡ç”¨é¡åº¦ï¼ˆcredit_card é¡å‹æ™‚å¯å¡«ï¼‰"
                interestRate:
                  type: number
                  example: 1.2
                  description: "åˆ©ç‡ï¼ˆloan/investment é¡å‹æ™‚å¯å¡«ï¼‰"
                icon:
                  type: string
                  example: "bank"
                  description: "å¸³æˆ¶åœ–ç¤º"
                color:
                  type: string
                  example: "#4CAF50"
                  description: "å¸³æˆ¶é¡è‰²"
                isActive:
                  type: boolean
                  default: true
                  description: "æ˜¯å¦å•Ÿç”¨"
                sortOrder:
                  type: integer
                  example: 1
      responses:
        '201':
          description: "å¸³æˆ¶å»ºç«‹æˆåŠŸ"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    allOf:
                      - $ref: '#/components/schemas/Account'
                      - type: object
                        properties:
                          message:
                            type: string
                            example: "å¸³æˆ¶å»ºç«‹æˆåŠŸ"
                          suggestions:
                            type: array
                            description: "å¸³æˆ¶è¨­å®šå»ºè­°ï¼ˆCultivation æ¨¡å¼ï¼‰"
                            items:
                              type: object
                              properties:
                                type:
                                  type: string
                                  example: "budget_setup"
                                title:
                                  type: string
                                  example: "è¨­å®šé ç®—"
                                description:
                                  type: string
                                  example: "ç‚ºæ­¤å¸³æˆ¶è¨­å®šæ¯æœˆæ”¯å‡ºé ç®—"
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '409':
          description: "å¸³æˆ¶åç¨±é‡è¤‡"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                success: false
                error:
                  code: "ACCOUNT_NAME_EXISTS"
                  message: "å¸³æˆ¶åç¨±å·²å­˜åœ¨"
                  field: "name"
                  timestamp: "2025-01-27T12:00:00Z"
                  requestId: "req-uuid-123"

  /accounts/{id}:
    get:
      summary: "å–å¾—å¸³æˆ¶è©³æƒ…"
      description: |
        å–å¾—æŒ‡å®šå¸³æˆ¶çš„è©³ç´°è³‡è¨Šï¼ŒåŒ…å«é¤˜é¡ã€ä½¿ç”¨çµ±è¨ˆç­‰ã€‚
      tags:
        - å¸³æˆ¶æŸ¥è©¢
      parameters:
        - name: id
          in: path
          required: true
          description: "å¸³æˆ¶ ID"
          schema:
            type: string
        - name: includeTransactions
          in: query
          description: "æ˜¯å¦åŒ…å«æœ€è¿‘äº¤æ˜“è¨˜éŒ„"
          schema:
            type: boolean
            default: false
        - name: transactionLimit
          in: query
          description: "äº¤æ˜“è¨˜éŒ„ç­†æ•¸ï¼ˆç•¶ includeTransactions=true æ™‚ï¼‰"
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 10
      responses:
        '200':
          description: "æˆåŠŸå–å¾—å¸³æˆ¶è©³æƒ…"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    allOf:
                      - $ref: '#/components/schemas/Account'
                      - type: object
                        properties:
                          statistics:
                            type: object
                            description: "å¸³æˆ¶ä½¿ç”¨çµ±è¨ˆï¼ˆExpert/Inertial æ¨¡å¼ï¼‰"
                            properties:
                              transactionCount:
                                type: integer
                                example: 156
                              lastTransaction:
                                type: string
                                format: date-time
                                example: "2025-01-27T10:30:00Z"
                              monthlyAverage:
                                type: number
                                example: -8500
                                description: "æœˆå¹³å‡è®Šå‹•"
                              balanceHistory:
                                type: array
                                description: "é¤˜é¡æ­·å²ï¼ˆæœ€è¿‘ 30 å¤©ï¼‰"
                                items:
                                  type: object
                                  properties:
                                    date:
                                      type: string
                                      format: date
                                    balance:
                                      type: number
                                    change:
                                      type: number
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

    put:
      summary: "æ›´æ–°å¸³æˆ¶"
      description: |
        æ›´æ–°å¸³æˆ¶è³‡è¨Šï¼Œä¸åŒ…å«é¤˜é¡èª¿æ•´ï¼ˆé¤˜é¡èª¿æ•´éœ€é€éäº¤æ˜“è¨˜éŒ„ï¼‰ã€‚
      tags:
        - å¸³æˆ¶ç®¡ç†
      parameters:
        - name: id
          in: path
          required: true
          description: "å¸³æˆ¶ ID"
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "ä¸­ä¿¡æ”¯ç¥¨å¸³æˆ¶ï¼ˆæ›´æ–°ï¼‰"
                description:
                  type: string
                  maxLength: 200
                  example: "ä¸»è¦è–ªæ°´å¸³æˆ¶"
                bankName:
                  type: string
                  example: "ä¸­åœ‹ä¿¡è¨—å•†æ¥­éŠ€è¡Œ"
                accountNumber:
                  type: string
                  example: "****5678"
                creditLimit:
                  type: number
                  example: 80000
                interestRate:
                  type: number
                  example: 1.5
                icon:
                  type: string
                  example: "bank"
                color:
                  type: string
                  example: "#2196F3"
                isActive:
                  type: boolean
                  example: true
                sortOrder:
                  type: integer
                  example: 2
      responses:
        '200':
          description: "å¸³æˆ¶æ›´æ–°æˆåŠŸ"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Account'
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '409':
          description: "å¸³æˆ¶åç¨±é‡è¤‡"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      summary: "åˆªé™¤å¸³æˆ¶"
      description: |
        åˆªé™¤å¸³æˆ¶ã€‚è‹¥å¸³æˆ¶æœ‰äº¤æ˜“è¨˜éŒ„ï¼Œå°‡é€²è¡Œè»Ÿåˆªé™¤ï¼›è‹¥ç„¡äº¤æ˜“è¨˜éŒ„ï¼Œå‰‡æ°¸ä¹…åˆªé™¤ã€‚
      tags:
        - å¸³æˆ¶ç®¡ç†
      parameters:
        - name: id
          in: path
          required: true
          description: "å¸³æˆ¶ ID"
          schema:
            type: string
        - name: force
          in: query
          description: "æ˜¯å¦å¼·åˆ¶åˆªé™¤ï¼ˆå³ä½¿æœ‰äº¤æ˜“è¨˜éŒ„ï¼‰"
          schema:
            type: boolean
            default: false
        - name: transferTo
          in: query
          description: "è½‰ç§»äº¤æ˜“è¨˜éŒ„åˆ°æŒ‡å®šå¸³æˆ¶ IDï¼ˆç•¶ force=false ä¸”æœ‰äº¤æ˜“è¨˜éŒ„æ™‚ï¼‰"
          schema:
            type: string
      responses:
        '200':
          description: "å¸³æˆ¶åˆªé™¤æˆåŠŸ"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      accountId:
                        type: string
                        example: "account-uuid-001"
                      deleteType:
                        type: string
                        enum: [soft, hard, transferred]
                        example: "soft"
                        description: "åˆªé™¤é¡å‹ï¼šsoft=è»Ÿåˆªé™¤ï¼Œhard=æ°¸ä¹…åˆªé™¤ï¼Œtransferred=è½‰ç§»å¾Œåˆªé™¤"
                      transactionCount:
                        type: integer
                        example: 25
                        description: "å—å½±éŸ¿çš„äº¤æ˜“è¨˜éŒ„æ•¸"
                      transferredTo:
                        type: string
                        example: "account-uuid-002"
                        description: "äº¤æ˜“è¨˜éŒ„è½‰ç§»åˆ°çš„å¸³æˆ¶ IDï¼ˆå¦‚é©ç”¨ï¼‰"
                      message:
                        type: string
                        example: "å¸³æˆ¶å·²åˆªé™¤ï¼Œç›¸é—œäº¤æ˜“è¨˜éŒ„å·²è½‰ç§»"
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '400':
          description: "ç„¡æ³•åˆªé™¤å¸³æˆ¶"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                success: false
                error:
                  code: "ACCOUNT_HAS_TRANSACTIONS"
                  message: "å¸³æˆ¶æœ‰äº¤æ˜“è¨˜éŒ„ï¼Œè«‹æŒ‡å®šè½‰ç§»ç›®æ¨™å¸³æˆ¶æˆ–ä½¿ç”¨å¼·åˆ¶åˆªé™¤"
                  timestamp: "2025-01-27T12:00:00Z"
                  requestId: "req-uuid-123"
                  details:
                    transactionCount: 25
                    suggestions:
                      - "æŒ‡å®š transferTo åƒæ•¸"
                      - "ä½¿ç”¨ force=true å¼·åˆ¶åˆªé™¤"
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /accounts/{id}/balance:
    get:
      summary: "å–å¾—å¸³æˆ¶é¤˜é¡"
      description: |
        å–å¾—æŒ‡å®šå¸³æˆ¶çš„å³æ™‚é¤˜é¡è³‡è¨Šï¼ŒåŒ…å«é¤˜é¡æ­·å²è¶¨å‹¢ã€‚
      tags:
        - å¸³æˆ¶æŸ¥è©¢
      parameters:
        - name: id
          in: path
          required: true
          description: "å¸³æˆ¶ ID"
          schema:
            type: string
        - name: includeHistory
          in: query
          description: "æ˜¯å¦åŒ…å«é¤˜é¡æ­·å²"
          schema:
            type: boolean
            default: false
        - name: historyDays
          in: query
          description: "é¤˜é¡æ­·å²å¤©æ•¸ï¼ˆç•¶ includeHistory=true æ™‚ï¼‰"
          schema:
            type: integer
            minimum: 1
            maximum: 365
            default: 30
      responses:
        '200':
          description: "æˆåŠŸå–å¾—å¸³æˆ¶é¤˜é¡"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      accountId:
                        type: string
                        example: "account-uuid-001"
                      accountName:
                        type: string
                        example: "ä¸­åœ‹ä¿¡è¨—æ”¯ç¥¨å¸³æˆ¶"
                      currentBalance:
                        type: number
                        example: 25000
                      currency:
                        type: string
                        example: "TWD"
                      lastUpdated:
                        type: string
                        format: date-time
                        example: "2025-01-27T10:30:00Z"
                      balanceChange:
                        type: object
                        description: "é¤˜é¡è®Šå‹•ï¼ˆExpert/Inertial æ¨¡å¼ï¼‰"
                        properties:
                          today:
                            type: number
                            example: -500
                          thisWeek:
                            type: number
                            example: -2000
                          thisMonth:
                            type: number
                            example: -8500
                      balanceHistory:
                        type: array
                        description: "é¤˜é¡æ­·å²ï¼ˆç•¶ includeHistory=true æ™‚ï¼‰"
                        items:
                          type: object
                          properties:
                            date:
                              type: string
                              format: date
                              example: "2025-01-27"
                            balance:
                              type: number
                              example: 25000
                            change:
                              type: number
                              example: -500
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /accounts/types:
    get:
      summary: "å–å¾—å¸³æˆ¶é¡å‹åˆ—è¡¨"
      description: |
        å–å¾—ç³»çµ±æ”¯æ´çš„å¸³æˆ¶é¡å‹æ¸…å–®ï¼ŒåŒ…å«é¡å‹èªªæ˜å’Œå»ºè­°è¨­å®šã€‚
      tags:
        - å¸³æˆ¶è¨­å®š
      responses:
        '200':
          description: "æˆåŠŸå–å¾—å¸³æˆ¶é¡å‹åˆ—è¡¨"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      types:
                        type: array
                        items:
                          type: object
                          properties:
                            code:
                              type: string
                              example: "bank"
                            name:
                              type: string
                              example: "éŠ€è¡Œå¸³æˆ¶"
                            description:
                              type: string
                              example: "éŠ€è¡Œå­˜æ¬¾å¸³æˆ¶ï¼ŒåŒ…å«æ”¯ç¥¨ã€å„²è“„ç­‰"
                            icon:
                              type: string
                              example: "bank"
                            color:
                              type: string
                              example: "#4CAF50"
                            fields:
                              type: array
                              description: "æ­¤é¡å‹éœ€è¦çš„é¡å¤–æ¬„ä½"
                              items:
                                type: object
                                properties:
                                  name:
                                    type: string
                                    example: "bankName"
                                  label:
                                    type: string
                                    example: "éŠ€è¡Œåç¨±"
                                  type:
                                    type: string
                                    example: "string"
                                  required:
                                    type: boolean
                                    example: true
                            examples:
                              type: array
                              description: "å¸³æˆ¶åç¨±ç¯„ä¾‹"
                              items:
                                type: string
                              example: ["ä¸­åœ‹ä¿¡è¨—æ”¯ç¥¨", "å°ç£éŠ€è¡Œå„²è“„", "éƒµå±€å¸³æˆ¶"]
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'

  /accounts/transfer:
    post:
      summary: "å¸³æˆ¶è½‰å¸³"
      description: |
        åœ¨å…©å€‹å¸³æˆ¶é–“é€²è¡Œè³‡é‡‘è½‰ç§»ï¼Œè‡ªå‹•å»ºç«‹å°æ‡‰çš„äº¤æ˜“è¨˜éŒ„ã€‚
      tags:
        - å¸³æˆ¶ç®¡ç†
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - fromAccountId
                - toAccountId
                - amount
              properties:
                fromAccountId:
                  type: string
                  example: "account-uuid-001"
                  description: "è½‰å‡ºå¸³æˆ¶ ID"
                toAccountId:
                  type: string
                  example: "account-uuid-002"
                  description: "è½‰å…¥å¸³æˆ¶ ID"
                amount:
                  type: number
                  minimum: 0.01
                  example: 5000
                  description: "è½‰å¸³é‡‘é¡"
                description:
                  type: string
                  maxLength: 200
                  example: "ç”Ÿæ´»è²»è½‰å¸³"
                  description: "è½‰å¸³èªªæ˜"
                date:
                  type: string
                  format: date
                  example: "2025-01-27"
                  description: "è½‰å¸³æ—¥æœŸï¼ˆé è¨­ç‚ºä»Šå¤©ï¼‰"
                categoryId:
                  type: string
                  example: "category-uuid-001"
                  description: "è½‰å¸³ç§‘ç›® IDï¼ˆå¯é¸ï¼‰"
                tags:
                  type: array
                  items:
                    type: string
                  example: ["è½‰å¸³", "ç”Ÿæ´»è²»"]
                  description: "æ¨™ç±¤"
      responses:
        '201':
          description: "è½‰å¸³æˆåŠŸ"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      transferId:
                        type: string
                        example: "transfer-uuid-001"
                      fromTransaction:
                        $ref: '#/components/schemas/TransactionSummary'
                      toTransaction:
                        $ref: '#/components/schemas/TransactionSummary'
                      fromAccountBalance:
                        type: number
                        example: 20000
                      toAccountBalance:
                        type: number
                        example: 15000
                      message:
                        type: string
                        example: "è½‰å¸³æˆåŠŸ"
                  metadata:
                    $ref: '#/components/schemas/ResponseMetadata'
        '400':
          description: "è½‰å¸³å¤±æ•—"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                insufficient_balance:
                  value:
                    success: false
                    error:
                      code: "INSUFFICIENT_BALANCE"
                      message: "å¸³æˆ¶é¤˜é¡ä¸è¶³"
                      timestamp: "2025-01-27T12:00:00Z"
                      requestId: "req-uuid-123"
                      details:
                        currentBalance: 3000
                        requiredAmount: 5000
                same_account:
                  value:
                    success: false
                    error:
                      code: "SAME_ACCOUNT_TRANSFER"
                      message: "ä¸èƒ½åœ¨ç›¸åŒå¸³æˆ¶é–“è½‰å¸³"
                      timestamp: "2025-01-27T12:00:00Z"
                      requestId: "req-uuid-123"
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: "å¸³æˆ¶ä¸å­˜åœ¨"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "JWT Token èªè­‰"

    FirebaseAuth:
      type: http
      scheme: bearer
      bearerFormat: Firebase
      description: "Firebase Authentication Token"

  schemas:
    Account:
      type: object
      properties:
        id:
          type: string
          example: "account-uuid-001"
        name:
          type: string
          example: "ä¸­åœ‹ä¿¡è¨—æ”¯ç¥¨å¸³æˆ¶"
        type:
          type: string
          enum: [cash, bank, credit_card, investment, loan, other]
          example: "bank"
        ledgerId:
          type: string
          example: "ledger-uuid-001"
        currency:
          type: string
          example: "TWD"
        currentBalance:
          type: number
          example: 25000
        description:
          type: string
          example: "ä¸»è¦è–ªæ°´å¸³æˆ¶"
        bankName:
          type: string
          example: "ä¸­åœ‹ä¿¡è¨—éŠ€è¡Œ"
        accountNumber:
          type: string
          example: "****1234"
        creditLimit:
          type: number
          example: 50000
        interestRate:
          type: number
          example: 1.2
        icon:
          type: string
          example: "bank"
        color:
          type: string
          example: "#4CAF50"
        isActive:
          type: boolean
          example: true
        sortOrder:
          type: integer
          example: 1
        createdAt:
          type: string
          format: date-time
          example: "2025-01-15T09:00:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-01-27T10:30:00Z"
        lastTransactionAt:
          type: string
          format: date-time
          example: "2025-01-27T10:30:00Z"

    TransactionSummary:
      type: object
      properties:
        id:
          type: string
          example: "transaction-uuid-001"
        amount:
          type: number
          example: 5000
        type:
          type: string
          enum: [income, expense, transfer]
          example: "transfer"
        categoryName:
          type: string
          example: "è½‰å¸³"
        description:
          type: string
          example: "ç”Ÿæ´»è²»è½‰å¸³"
        date:
          type: string
          format: date
          example: "2025-01-27"
        createdAt:
          type: string
          format: date-time
          example: "2025-01-27T10:30:00Z"

    Pagination:
      type: object
      properties:
        page:
          type: integer
          example: 1
        limit:
          type: integer
          example: 20
        total:
          type: integer
          example: 48
        totalPages:
          type: integer
          example: 3
        hasNext:
          type: boolean
          example: true
        hasPrev:
          type: boolean
          example: false

    Error:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          required:
            - code
            - message
            - timestamp
            - requestId
          properties:
            code:
              type: string
              example: "VALIDATION_ERROR"
            message:
              type: string
              example: "åƒæ•¸é©—è­‰å¤±æ•—"
            field:
              type: string
              example: "amount"
            timestamp:
              type: string
              format: date-time
              example: "2025-01-27T12:00:00Z"
            requestId:
              type: string
              example: "req-uuid-123"
            details:
              type: object
              description: "éŒ¯èª¤è©³ç´°è³‡è¨Šï¼ˆå¯é¸ï¼‰"

    ResponseMetadata:
      type: object
      description: "çµ±ä¸€å›æ‡‰ metadata çµæ§‹"
      required:
        - timestamp
        - requestId
        - userMode
      properties:
        timestamp:
          type: string
          format: date-time
          example: "2025-01-27T12:00:00Z"
          description: "å›æ‡‰æ™‚é–“æˆ³"
        requestId:
          type: string
          example: "req-uuid-123"
          description: "è«‹æ±‚è¿½è¹¤ ID"
        userMode:
          type: string
          enum: [Expert, Inertial, Cultivation, Guiding]
          example: "Expert"
          description: "ä½¿ç”¨è€…æ¨¡å¼"

  responses:
    BadRequestError:
      description: "è«‹æ±‚åƒæ•¸éŒ¯èª¤"
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            success: false
            error:
              code: "VALIDATION_ERROR"
              message: "å¸³æˆ¶åç¨±ä¸èƒ½ç‚ºç©º"
              field: "name"
              timestamp: "2025-01-27T12:00:00Z"
              requestId: "req-uuid-123"

    UnauthorizedError:
      description: "æœªæˆæ¬Šæˆ– Token ç„¡æ•ˆ"
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            success: false
            error:
              code: "UNAUTHORIZED"
              message: "Token ç„¡æ•ˆæˆ–å·²éæœŸ"
              timestamp: "2025-01-27T12:00:00Z"
              requestId: "req-uuid-123"

    NotFoundError:
      description: "è³‡æºä¸å­˜åœ¨"
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            success: false
            error:
              code: "ACCOUNT_NOT_FOUND"
              message: "æ‰¾ä¸åˆ°æŒ‡å®šçš„å¸³æˆ¶"
              timestamp: "2025-01-27T12:00:00Z"
              requestId: "req-uuid-123"

tags:
  - name: å¸³æˆ¶æŸ¥è©¢
    description: "å¸³æˆ¶è³‡è¨ŠæŸ¥è©¢ç›¸é—œåŠŸèƒ½"
  - name: å¸³æˆ¶ç®¡ç†
    description: "å¸³æˆ¶å»ºç«‹ã€ä¿®æ”¹ã€åˆªé™¤åŠŸèƒ½"
  - name: å¸³æˆ¶è¨­å®š
    description: "å¸³æˆ¶é¡å‹å’Œè¨­å®šç›¸é—œåŠŸèƒ½"