
# 8828. TDD_P028_é ç®—è©³æƒ…é é¢_v1.0.0

## æ–‡ä»¶è³‡è¨Š
- **æ–‡ä»¶æ¨™é¡Œ**: P028 é ç®—è©³æƒ…é é¢æŠ€è¡“è¨­è¨ˆæ–‡ä»¶
- **æ–‡ä»¶ç‰ˆæœ¬**: v1.0.0
- **å‰µå»ºæ—¥æœŸ**: 2025-01-26 20:30:00 +08:00 (å°ç£æ™‚é–“)
- **å‰µå»ºè€…**: LCAS SA Team
- **æœ€å¾Œæ›´æ–°**: 2025-01-26 20:30:00 +08:00 (å°ç£æ™‚é–“)
- **å°æ‡‰éœ€æ±‚æ–‡ä»¶**: P028_é ç®—è©³æƒ…é é¢_SRS.md
- **å°æ‡‰PRDæ–‡ä»¶**: 9005. Flutter_Presentation layer.md
- **é é¢ä»£ç¢¼**: P028 (Budget Detail Page)

---

## ğŸ“‘ ç›®æ¬¡ (Table of Contents)

1. [æŠ€è¡“æ¶æ§‹æ¦‚è¿°](#10-æŠ€è¡“æ¶æ§‹æ¦‚è¿°)
2. [Widgetæ¸…å–®](#20-widgetæ¸…å–®)
3. [æ ¸å¿ƒWidgetè¨­è¨ˆ](#30-æ ¸å¿ƒwidgetè¨­è¨ˆ)
4. [ç‹€æ…‹ç®¡ç†æ¶æ§‹](#40-ç‹€æ…‹ç®¡ç†æ¶æ§‹)
5. [APIæ•´åˆè¨­è¨ˆ](#50-apiæ•´åˆè¨­è¨ˆ)
6. [å°èˆªè·¯ç”±è¨­è¨ˆ](#60-å°èˆªè·¯ç”±è¨­è¨ˆ)
7. [éŸ¿æ‡‰å¼è¨­è¨ˆ](#70-éŸ¿æ‡‰å¼è¨­è¨ˆ)
8. [ç„¡éšœç¤™åŠŸèƒ½](#80-ç„¡éšœç¤™åŠŸèƒ½)
9. [æ•ˆèƒ½æœ€ä½³åŒ–](#90-æ•ˆèƒ½æœ€ä½³åŒ–)
10. [éŒ¯èª¤è™•ç†æ©Ÿåˆ¶](#100-éŒ¯èª¤è™•ç†æ©Ÿåˆ¶)

---

## 1.0 æŠ€è¡“æ¶æ§‹æ¦‚è¿°

### 1.1 æ¨¡çµ„å®šä½
P028é ç®—è©³æƒ…é é¢ä½œç‚ºLCAS 2.0 Flutteræ‡‰ç”¨ç¨‹å¼çš„é ç®—ç®¡ç†æ ¸å¿ƒæª¢è¦–ç•Œé¢ï¼Œè² è²¬è©³ç´°å±•ç¤ºé ç®—åŸ·è¡Œç‹€æ³ã€çµ±è¨ˆåˆ†æã€æ­·å²è¿½è¹¤åŠç®¡ç†æ“ä½œã€‚æœ¬é é¢æ¡ç”¨Clean Architectureè¨­è¨ˆï¼Œç¢ºä¿è³‡æ–™å±•ç¤ºçš„æº–ç¢ºæ€§èˆ‡äº’å‹•é«”é©—çš„æµæš¢æ€§ã€‚

### 1.2 æŠ€è¡“å †ç–Š
- **å‰ç«¯æ¡†æ¶**: Flutter 3.x
- **ç‹€æ…‹ç®¡ç†**: Provider + ChangeNotifier
- **è·¯ç”±ç®¡ç†**: GoRouter
- **HTTPå®¢æˆ¶ç«¯**: Dio
- **åœ–è¡¨å…ƒä»¶**: fl_chart
- **å‹•ç•«æ¡†æ¶**: Lottie
- **æ—¥æœŸè™•ç†**: intl
- **æ•¸æ“šæ ¼å¼åŒ–**: intl + NumberFormat

### 1.3 æ¨¡çµ„æ¶æ§‹
```dart
/**
 * P028_é ç®—è©³æƒ…é é¢_1.0.0
 * @module P028é ç®—è©³æƒ…é é¢
 * @description Flutter Presentation Layeré ç®—è©³æƒ…æª¢è¦–é é¢ - å¤šç¶­åº¦è³‡æ–™å±•ç¤ºã€å³æ™‚ç‹€æ…‹è¿½è¹¤ã€å››æ¨¡å¼å·®ç•°åŒ–
 * @update 2025-01-26: å‡ç´šè‡³v1.0ç‰ˆæœ¬ï¼Œæ–°å¢å®Œæ•´é ç®—è©³æƒ…åŠŸèƒ½è¨­è¨ˆï¼Œæ”¯æ´åœ–è¡¨è¦–è¦ºåŒ–ã€çµ±è¨ˆåˆ†æã€æ­·å²è¿½è¹¤
 */
```

---

## 2.0 Widgetæ¸…å–®

### 2.1 å®Œæ•´Widgetç´¢å¼•è¡¨

| # | Widgetåç¨± | ç‰ˆæœ¬ | æ‰€å±¬å±¤ç´š | åŠŸèƒ½æè¿° | ç›¸ä¾çµ„ä»¶ |
|---|------------|------|----------|----------|----------|
| 01 | BudgetDetailPage | V1.0.0 | é é¢å®¹å™¨å±¤ | ä¸»é ç®—è©³æƒ…é é¢å®¹å™¨åŠç”Ÿå‘½é€±æœŸç®¡ç† | BudgetDetailProviderã€Router |
| 02 | BudgetDetailScaffold | V1.0.0 | ä½ˆå±€çµæ§‹å±¤ | åŸºç¤é é¢çµæ§‹èˆ‡æ»¾å‹•è¦–åœ– | SliverAppBarã€ScrollView |
| 03 | BudgetHeaderSection | V1.0.0 | æ¨™é ­è³‡è¨Šå±¤ | é ç®—åŸºæœ¬è³‡è¨Šé¡¯ç¤ºå€åŸŸ | BudgetInfoCardã€StatusIndicator |
| 04 | BudgetInfoCard | V1.0.0 | è³‡è¨Šå¡ç‰‡å±¤ | é ç®—åŸºæœ¬è³‡è¨Šå¡ç‰‡ | AnimatedContainerã€BudgetStatus |
| 05 | BudgetProgressSection | V1.0.0 | é€²åº¦å±•ç¤ºå±¤ | é ç®—åŸ·è¡Œé€²åº¦è¦–è¦ºåŒ–å€åŸŸ | ProgressIndicatorã€UsageChart |
| 06 | ProgressIndicator | V1.0.0 | é€²åº¦æŒ‡ç¤ºå±¤ | é ç®—ä½¿ç”¨é€²åº¦æ¢èˆ‡æ•¸å€¼é¡¯ç¤º | LinearProgressIndicatorã€CircularProgress |
| 07 | UsageChart | V1.0.0 | åœ–è¡¨å±•ç¤ºå±¤ | é ç®—ä½¿ç”¨è¶¨å‹¢åœ–è¡¨ | LineChartã€BarChart |
| 08 | BudgetStatisticsSection | V1.0.0 | çµ±è¨ˆåˆ†æå±¤ | é ç®—çµ±è¨ˆæ•¸æ“šå±•ç¤ºå€åŸŸ | StatCardã€TrendIndicator |
| 09 | StatCard | V1.0.0 | çµ±è¨ˆå¡ç‰‡å±¤ | å–®é …çµ±è¨ˆè³‡æ–™å¡ç‰‡ | AnimatedNumberã€IconWidget |
| 10 | TrendIndicator | V1.0.0 | è¶¨å‹¢æŒ‡ç¤ºå±¤ | ä½¿ç”¨è¶¨å‹¢æŒ‡ç¤ºå™¨ | AnimatedIconã€ColorTransition |
| 11 | TransactionListSection | V1.0.0 | äº¤æ˜“æ¸…å–®å±¤ | ç›¸é—œäº¤æ˜“è¨˜éŒ„å±•ç¤ºå€åŸŸ | TransactionItemã€LoadMore |
| 12 | TransactionItem | V1.0.0 | äº¤æ˜“é …ç›®å±¤ | å–®ç­†äº¤æ˜“è¨˜éŒ„é¡¯ç¤º | ListTileã€SwipeActions |
| 13 | BudgetAnalysisSection | V1.0.0 | åˆ†æåœ–è¡¨å±¤ | é ç®—åˆ†æåœ–è¡¨å€åŸŸ | PieChartã€ComparisonChart |
| 14 | PieChart | V1.0.0 | é¤…åœ–å±•ç¤ºå±¤ | é ç®—åˆ†é¡ä½¿ç”¨é¤…åœ– | fl_chartã€LegendWidget |
| 15 | ComparisonChart | V1.0.0 | æ¯”è¼ƒåœ–è¡¨å±¤ | é ç®—èˆ‡å¯¦éš›ä½¿ç”¨æ¯”è¼ƒåœ– | BarChartã€DifferenceIndicator |
| 16 | BudgetHistorySection | V1.0.0 | æ­·å²è¨˜éŒ„å±¤ | é ç®—æ­·å²è®Šæ›´è¨˜éŒ„å€åŸŸ | HistoryTimelineã€ChangeLog |
| 17 | HistoryTimeline | V1.0.0 | æ™‚é–“è»¸å±¤ | é ç®—è®Šæ›´æ™‚é–“è»¸ | Timelineã€HistoryNode |
| 18 | AlertsSection | V1.0.0 | è­¦ç¤ºå€åŸŸå±¤ | é ç®—è­¦ç¤ºç‹€æ…‹é¡¯ç¤º | AlertCardã€NotificationBell |
| 19 | AlertCard | V1.0.0 | è­¦ç¤ºå¡ç‰‡å±¤ | é ç®—è­¦ç¤ºè¨Šæ¯å¡ç‰‡ | Containerã€AlertIcon |
| 20 | QuickActionsSection | V1.0.0 | å¿«é€Ÿæ“ä½œå±¤ | é ç®—ç®¡ç†å¿«é€Ÿæ“ä½œå€åŸŸ | ActionButtonã€FloatingActions |
| 21 | ActionButton | V1.0.0 | æ“ä½œæŒ‰éˆ•å±¤ | é ç®—ç®¡ç†æ“ä½œæŒ‰éˆ• | ElevatedButtonã€LoadingIndicator |
| 22 | ShareDialog | V1.0.0 | åˆ†äº«å°è©±æ¡†å±¤ | é ç®—è³‡è¨Šåˆ†äº«å°è©±æ¡† | BottomSheetã€ShareOptions |
| 23 | EditBudgetDialog | V1.0.0 | ç·¨è¼¯å°è©±æ¡†å±¤ | å¿«é€Ÿç·¨è¼¯é ç®—å°è©±æ¡† | Dialogã€FormFields |
| 24 | LoadingOverlay | V1.0.0 | è¼‰å…¥è¦†è“‹å±¤ | è³‡æ–™è¼‰å…¥ä¸­è¦†è“‹å±¤ | CircularProgressIndicatorã€Backdrop |
| 25 | ErrorStateWidget | V1.0.0 | éŒ¯èª¤ç‹€æ…‹å±¤ | éŒ¯èª¤ç‹€æ…‹é¡¯ç¤ºWidget | ErrorIconã€RetryButton |

---

## 3.0 æ ¸å¿ƒWidgetè¨­è¨ˆ

### 3.1 é é¢å®¹å™¨å±¤Widget

#### 3.1.1 BudgetDetailPage Widget
```dart
/**
 * 01. å°æ‡‰ 2.1ï¼šä¸»é ç®—è©³æƒ…é é¢å®¹å™¨Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é ç®—è©³æƒ…é é¢çš„ä¸»å®¹å™¨ï¼Œæ”¯æ´å¤šç¶­åº¦è³‡æ–™å±•ç¤ºèˆ‡å››æ¨¡å¼å·®ç•°åŒ–
 */
class BudgetDetailPage extends StatefulWidget {
  static const String routeName = '/budget-detail';
  final String budgetId;
  final UserMode? userMode;

  const BudgetDetailPage({
    Key? key,
    required this.budgetId,
    this.userMode,
  });

  @override
  State<BudgetDetailPage> createState();
}

/**
 * 02. å°æ‡‰ 2.1ï¼šé ç®—è©³æƒ…é é¢ç‹€æ…‹é¡åˆ¥
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description ç®¡ç†é ç®—è©³æƒ…é é¢çš„ç‹€æ…‹å’Œå‹•ç•«æ§åˆ¶å™¨
 */
class _BudgetDetailPageState extends State<BudgetDetailPage> 
    with TickerProviderStateMixin {
  late AnimationController _fadeController;
  late AnimationController _slideController;
  late Animation<double> _fadeAnimation;
  late Animation<Offset> _slideAnimation;

  @override
  void initState();

  /**
   * 03. å°æ‡‰ 2.1ï¼šåˆå§‹åŒ–å‹•ç•«æ§åˆ¶å™¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è¨­å®šé é¢å‹•ç•«æ•ˆæœ
   */
  void _initializeAnimations();

  /**
   * 04. å°æ‡‰ 2.1ï¼šåˆå§‹åŒ–é ç®—è©³æƒ…è³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description èª¿ç”¨Providerè¼‰å…¥é ç®—è©³æƒ…è³‡æ–™
   */
  Future<void> _initializeBudgetDetail();

  @override
  Widget build(BuildContext context);

  @override
  void dispose();
}
```

### 3.2 æ¨™é ­è³‡è¨Šå±¤Widget

#### 3.2.1 BudgetHeaderSection Widget
```dart
/**
 * 05. å°æ‡‰ 3.1ï¼šé ç®—æ¨™é ­å€åŸŸWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é¡¯ç¤ºé ç®—åŸºæœ¬è³‡è¨Šï¼Œæ”¯æ´å››æ¨¡å¼å·®ç•°åŒ–æ¨£å¼
 */
class BudgetHeaderSection extends StatelessWidget {
  final BudgetDetail budgetDetail;
  final UserMode? userMode;

  const BudgetHeaderSection({
    Key? key,
    required this.budgetDetail,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 06. å°æ‡‰ 3.1ï¼šå–å¾—æ¨¡å¼å°æ‡‰æ¨™é ­æ¨£å¼
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼è¿”å›å°æ‡‰çš„æ¨™é ­å±•ç¤ºæ¨£å¼
   */
  HeaderStyle _getHeaderStyleForMode(UserMode? mode);
}

/**
 * 07. å°æ‡‰ 3.1ï¼šé ç®—è³‡è¨Šå¡ç‰‡Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é¡¯ç¤ºé ç®—åŸºæœ¬è³‡è¨Šçš„å¡ç‰‡
 */
class BudgetInfoCard extends StatelessWidget {
  final BudgetDetail budgetDetail;
  final UserMode? userMode;

  const BudgetInfoCard({
    Key? key,
    required this.budgetDetail,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 08. å°æ‡‰ 3.1ï¼šå»ºæ§‹é ç®—ç‹€æ…‹æŒ‡ç¤ºå™¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ ¹æ“šé ç®—ç‹€æ…‹é¡¯ç¤ºå°æ‡‰çš„ç‹€æ…‹æŒ‡ç¤ºå™¨
   */
  Widget _buildStatusIndicator(BudgetStatus status);
}
```

### 3.3 é€²åº¦å±•ç¤ºå±¤Widget

#### 3.3.1 BudgetProgressSection Widget
```dart
/**
 * 09. å°æ‡‰ 3.2ï¼šé ç®—é€²åº¦å€åŸŸWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description å±•ç¤ºé ç®—åŸ·è¡Œé€²åº¦çš„è¦–è¦ºåŒ–å€åŸŸ
 */
class BudgetProgressSection extends StatelessWidget {
  final BudgetDetail budgetDetail;
  final BudgetStatistics statistics;
  final UserMode? userMode;

  const BudgetProgressSection({
    Key? key,
    required this.budgetDetail,
    required this.statistics,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);
}

/**
 * 10. å°æ‡‰ 3.2ï¼šé€²åº¦æŒ‡ç¤ºå™¨Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é¡¯ç¤ºé ç®—ä½¿ç”¨é€²åº¦çš„æŒ‡ç¤ºå™¨
 */
class ProgressIndicator extends StatefulWidget {
  final double percentage;
  final double amount;
  final double total;
  final BudgetStatus status;

  const ProgressIndicator({
    Key? key,
    required this.percentage,
    required this.amount,
    required this.total,
    required this.status,
  });

  @override
  State<ProgressIndicator> createState();
}

class _ProgressIndicatorState extends State<ProgressIndicator>
    with SingleTickerProviderStateMixin {
  late AnimationController _animationController;
  late Animation<double> _progressAnimation;

  @override
  void initState();

  @override
  Widget build(BuildContext context);

  /**
   * 11. å°æ‡‰ 3.2ï¼šå–å¾—é€²åº¦æ¢é¡è‰²
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ ¹æ“šé ç®—ç‹€æ…‹è¿”å›å°æ‡‰çš„é€²åº¦æ¢é¡è‰²
   */
  Color _getProgressColor(BudgetStatus status);

  @override
  void dispose();
}
```

### 3.4 åœ–è¡¨å±•ç¤ºå±¤Widget

#### 3.4.1 UsageChart Widget
```dart
/**
 * 12. å°æ‡‰ 3.3ï¼šé ç®—ä½¿ç”¨åœ–è¡¨Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description å±•ç¤ºé ç®—ä½¿ç”¨è¶¨å‹¢çš„åœ–è¡¨
 */
class UsageChart extends StatefulWidget {
  final List<TrendData> trendData;
  final ChartType chartType;
  final UserMode? userMode;

  const UsageChart({
    Key? key,
    required this.trendData,
    this.chartType = ChartType.line,
    this.userMode,
  });

  @override
  State<UsageChart> createState();
}

class _UsageChartState extends State<UsageChart> {
  @override
  Widget build(BuildContext context);

  /**
   * 13. å°æ‡‰ 3.3ï¼šå»ºæ§‹ç·šæ€§åœ–è¡¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å»ºæ§‹é ç®—ä½¿ç”¨è¶¨å‹¢ç·šæ€§åœ–è¡¨
   */
  Widget _buildLineChart();

  /**
   * 14. å°æ‡‰ 3.3ï¼šå»ºæ§‹æŸ±ç‹€åœ–è¡¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å»ºæ§‹é ç®—ä½¿ç”¨æŸ±ç‹€åœ–è¡¨
   */
  Widget _buildBarChart();

  /**
   * 15. å°æ‡‰ 3.3ï¼šè™•ç†åœ–è¡¨é»æ“Šäº‹ä»¶
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†åœ–è¡¨äº’å‹•é»æ“Šäº‹ä»¶
   */
  void _onChartTapped(FlTouchEvent event, FlTouchResponse? response);
}
```

### 3.5 çµ±è¨ˆåˆ†æå±¤Widget

#### 3.5.1 BudgetStatisticsSection Widget
```dart
/**
 * 16. å°æ‡‰ 3.4ï¼šé ç®—çµ±è¨ˆå€åŸŸWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description å±•ç¤ºé ç®—çµ±è¨ˆåˆ†æè³‡æ–™
 */
class BudgetStatisticsSection extends StatelessWidget {
  final BudgetStatistics statistics;
  final UserMode? userMode;

  const BudgetStatisticsSection({
    Key? key,
    required this.statistics,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 17. å°æ‡‰ 3.4ï¼šå–å¾—æ¨¡å¼å¯è¦‹çµ±è¨ˆé …ç›®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼è¿”å›æ‡‰é¡¯ç¤ºçš„çµ±è¨ˆé …ç›®
   */
  List<StatisticItem> _getVisibleStatsForMode(UserMode? mode);
}

/**
 * 18. å°æ‡‰ 3.4ï¼šçµ±è¨ˆå¡ç‰‡Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é¡¯ç¤ºå–®é …çµ±è¨ˆè³‡æ–™çš„å¡ç‰‡
 */
class StatCard extends StatefulWidget {
  final String title;
  final String value;
  final String subtitle;
  final IconData icon;
  final Color color;
  final TrendDirection? trend;

  const StatCard({
    Key? key,
    required this.title,
    required this.value,
    required this.subtitle,
    required this.icon,
    required this.color,
    this.trend,
  });

  @override
  State<StatCard> createState();
}

class _StatCardState extends State<StatCard>
    with SingleTickerProviderStateMixin {
  late AnimationController _animationController;
  late Animation<double> _scaleAnimation;

  @override
  void initState();

  @override
  Widget build(BuildContext context);

  /**
   * 19. å°æ‡‰ 3.4ï¼šå»ºæ§‹è¶¨å‹¢æŒ‡ç¤ºå™¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å»ºæ§‹é¡¯ç¤ºæ•¸æ“šè¶¨å‹¢çš„æŒ‡ç¤ºå™¨
   */
  Widget _buildTrendIndicator();

  @override
  void dispose();
}
```

### 3.6 äº¤æ˜“æ¸…å–®å±¤Widget

#### 3.6.1 TransactionListSection Widget
```dart
/**
 * 20. å°æ‡‰ 3.5ï¼šç›¸é—œäº¤æ˜“æ¸…å–®å€åŸŸWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description å±•ç¤ºèˆ‡é ç®—ç›¸é—œçš„äº¤æ˜“è¨˜éŒ„
 */
class TransactionListSection extends StatefulWidget {
  final String budgetId;
  final UserMode? userMode;

  const TransactionListSection({
    Key? key,
    required this.budgetId,
    this.userMode,
  });

  @override
  State<TransactionListSection> createState();
}

class _TransactionListSectionState extends State<TransactionListSection> {
  final ScrollController _scrollController = ScrollController();
  
  @override
  void initState();

  @override
  Widget build(BuildContext context);

  /**
   * 21. å°æ‡‰ 3.5ï¼šè™•ç†æ»¾å‹•è¼‰å…¥æ›´å¤š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†æ»¾å‹•åˆ°åº•éƒ¨æ™‚è¼‰å…¥æ›´å¤šäº¤æ˜“è¨˜éŒ„
   */
  void _onScrollLoadMore();

  @override
  void dispose();
}

/**
 * 22. å°æ‡‰ 3.5ï¼šäº¤æ˜“é …ç›®Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é¡¯ç¤ºå–®ç­†äº¤æ˜“è¨˜éŒ„
 */
class TransactionItem extends StatelessWidget {
  final Transaction transaction;
  final VoidCallback? onTap;
  final VoidCallback? onEdit;
  final VoidCallback? onDelete;

  const TransactionItem({
    Key? key,
    required this.transaction,
    this.onTap,
    this.onEdit,
    this.onDelete,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 23. å°æ‡‰ 3.5ï¼šå»ºæ§‹æ»‘å‹•æ“ä½œ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å»ºæ§‹äº¤æ˜“é …ç›®çš„æ»‘å‹•æ“ä½œé¸é …
   */
  Widget _buildSwipeActions(BuildContext context);
}
```

---

## 4.0 ç‹€æ…‹ç®¡ç†æ¶æ§‹

### 4.1 BudgetDetailProvider ç‹€æ…‹ç®¡ç†å™¨
```dart
/**
 * 24. å°æ‡‰ 4.1ï¼šé ç®—è©³æƒ…é é¢ç‹€æ…‹ç®¡ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description ç®¡ç†é ç®—è©³æƒ…é é¢çš„ç‹€æ…‹ï¼Œæ”¯æ´å¤šç¶­åº¦è³‡æ–™å±•ç¤ºå’Œå››æ¨¡å¼å·®ç•°åŒ–
 */
class BudgetDetailProvider extends ChangeNotifier {
  // ç‹€æ…‹å±¬æ€§
  BudgetDetailPageState _pageState = BudgetDetailPageState.loading;
  BudgetDetail? _budgetDetail;
  BudgetStatistics? _statistics;
  List<Transaction> _transactions = [];
  List<BudgetAlert> _alerts = [];
  List<TrendData> _trends = [];
  String? _errorMessage;
  UserMode? _userMode;

  // åœ–è¡¨é…ç½®
  ChartType _selectedChartType = ChartType.line;
  DateRange _selectedPeriod = DateRange.thisMonth;
  
  // åˆ†é ç‹€æ…‹
  bool _isLoadingMore = false;
  bool _hasMoreTransactions = true;
  int _currentPage = 1;

  // Getters
  BudgetDetailPageState get pageState;
  BudgetDetail? get budgetDetail;
  BudgetStatistics? get statistics;
  List<Transaction> get transactions;
  List<BudgetAlert> get alerts;
  List<TrendData> get trends;
  String? get errorMessage;
  UserMode? get userMode;
  ChartType get selectedChartType;
  DateRange get selectedPeriod;
  bool get isLoadingMore;
  bool get hasMoreTransactions;

  /**
   * 25. å°æ‡‰ 4.1ï¼šåˆå§‹åŒ–é ç®—è©³æƒ…
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description åˆå§‹åŒ–é ç®—è©³æƒ…é é¢è³‡æ–™
   */
  Future<void> initializeBudgetDetail(String budgetId, UserMode? mode);

  /**
   * 26. å°æ‡‰ 4.1ï¼šè¼‰å…¥é ç®—åŸºæœ¬è³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è¼‰å…¥é ç®—çš„åŸºæœ¬è³‡è¨Šå’Œç•¶å‰ç‹€æ…‹
   */
  Future<void> loadBudgetDetail(String budgetId);

  /**
   * 27. å°æ‡‰ 4.1ï¼šè¼‰å…¥é ç®—çµ±è¨ˆè³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è¼‰å…¥é ç®—çš„çµ±è¨ˆåˆ†æè³‡æ–™
   */
  Future<void> loadBudgetStatistics(String budgetId);

  /**
   * 28. å°æ‡‰ 4.1ï¼šè¼‰å…¥ç›¸é—œäº¤æ˜“è¨˜éŒ„
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è¼‰å…¥èˆ‡é ç®—ç›¸é—œçš„äº¤æ˜“è¨˜éŒ„
   */
  Future<void> loadBudgetTransactions(String budgetId, {bool loadMore = false});

  /**
   * 29. å°æ‡‰ 4.1ï¼šè¼‰å…¥è¶¨å‹¢è³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è¼‰å…¥é ç®—ä½¿ç”¨è¶¨å‹¢è³‡æ–™
   */
  Future<void> loadBudgetTrends(String budgetId);

  /**
   * 30. å°æ‡‰ 4.1ï¼šè¼‰å…¥é ç®—è­¦ç¤º
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è¼‰å…¥é ç®—ç›¸é—œçš„è­¦ç¤ºè³‡è¨Š
   */
  Future<void> loadBudgetAlerts(String budgetId);

  /**
   * 31. å°æ‡‰ 4.1ï¼šé‡æ–°æ•´ç†å…¨éƒ¨è³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description é‡æ–°è¼‰å…¥æ‰€æœ‰é ç®—è©³æƒ…ç›¸é—œè³‡æ–™
   */
  Future<void> refreshAll(String budgetId);

  /**
   * 32. å°æ‡‰ 4.1ï¼šåˆ‡æ›åœ–è¡¨é¡å‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description åˆ‡æ›é ç®—ä½¿ç”¨åœ–è¡¨çš„é¡¯ç¤ºé¡å‹
   */
  void changeChartType(ChartType chartType);

  /**
   * 33. å°æ‡‰ 4.1ï¼šåˆ‡æ›æ™‚é–“ç¯„åœ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description åˆ‡æ›é ç®—åˆ†æçš„æ™‚é–“ç¯„åœ
   */
  void changePeriod(DateRange period);

  /**
   * 34. å°æ‡‰ 4.1ï¼šåˆ†äº«é ç®—è³‡è¨Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description åˆ†äº«é ç®—è©³æƒ…è³‡è¨Š
   */
  Future<void> shareBudgetDetail(ShareFormat format);

  /**
   * 35. å°æ‡‰ 4.1ï¼šå¿«é€Ÿç·¨è¼¯é ç®—
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å¿«é€Ÿç·¨è¼¯é ç®—è¨­å®š
   */
  Future<void> quickEditBudget(QuickEditParams params);

  /**
   * 36. å°æ‡‰ 4.1ï¼šåˆªé™¤é ç®—
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description åˆªé™¤ç•¶å‰é ç®—
   */
  Future<void> deleteBudget(String budgetId);

  /**
   * 37. å°æ‡‰ 4.1ï¼šè¨­å®šé é¢ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ›´æ–°é é¢ç‹€æ…‹ä¸¦é€šçŸ¥ç›£è½è€…
   */
  void _setPageState(BudgetDetailPageState state);

  /**
   * 38. å°æ‡‰ 4.1ï¼šè¨­å®šéŒ¯èª¤è¨Šæ¯
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è¨­å®šéŒ¯èª¤è¨Šæ¯ä¸¦æ›´æ–°ç‹€æ…‹
   */
  void _setError(String message);

  /**
   * 39. å°æ‡‰ 4.1ï¼šæ¸…é™¤éŒ¯èª¤ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ¸…é™¤éŒ¯èª¤ç‹€æ…‹
   */
  void clearError();
}
```

### 4.2 ç‹€æ…‹æšèˆ‰å®šç¾©
```dart
/**
 * 40. å°æ‡‰ 4.2ï¼šé ç®—è©³æƒ…é é¢ç‹€æ…‹æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description å®šç¾©é ç®—è©³æƒ…é é¢çš„å„ç¨®ç‹€æ…‹
 */
enum BudgetDetailPageState {
  loading,        // è¼‰å…¥ä¸­
  loaded,         // è¼‰å…¥å®Œæˆ
  refreshing,     // é‡æ–°æ•´ç†ä¸­
  error,          // éŒ¯èª¤ç‹€æ…‹
}

/**
 * 41. å°æ‡‰ 4.2ï¼šåœ–è¡¨é¡å‹æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description æ”¯æ´çš„åœ–è¡¨é¡å‹
 */
enum ChartType {
  line,       // ç·šæ€§åœ–
  bar,        // æŸ±ç‹€åœ–
  pie,        // é¤…åœ–
  area,       // å€åŸŸåœ–
}

/**
 * 42. å°æ‡‰ 4.2ï¼šæ™‚é–“ç¯„åœæšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description çµ±è¨ˆåˆ†æçš„æ™‚é–“ç¯„åœé¸é …
 */
enum DateRange {
  thisWeek,       // æœ¬é€±
  thisMonth,      // æœ¬æœˆ
  thisQuarter,    // æœ¬å­£
  thisYear,       // æœ¬å¹´
  lastMonth,      // ä¸Šæœˆ
  lastQuarter,    // ä¸Šå­£
  custom,         // è‡ªè¨‚ç¯„åœ
}

/**
 * 43. å°æ‡‰ 4.2ï¼šåˆ†äº«æ ¼å¼æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é ç®—åˆ†äº«çš„æ ¼å¼é¸é …
 */
enum ShareFormat {
  image,          // åœ–ç‰‡æ ¼å¼
  pdf,            // PDFæ ¼å¼
  text,           // ç´”æ–‡å­—
  link,           // åˆ†äº«é€£çµ
}
```

---

## 5.0 APIæ•´åˆè¨­è¨ˆ

### 5.1 BudgetDetailApiService APIæœå‹™
```dart
/**
 * 44. å°æ‡‰ 5.1ï¼šé ç®—è©³æƒ…é é¢APIæœå‹™
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description è™•ç†é ç®—è©³æƒ…é é¢ç›¸é—œçš„APIèª¿ç”¨ï¼Œæ•´åˆBudgetServiceã€ReportServiceã€EntryService
 */
class BudgetDetailApiService {
  final ApiClient _apiClient = ApiClient();

  /**
   * 45. å°æ‡‰ 5.1ï¼šå–å¾—é ç®—è©³ç´°è³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å–å¾—é ç®—çš„è©³ç´°è³‡è¨Šï¼ˆå°æ‡‰F017ç«¯é»ï¼‰
   */
  Future<ApiResponse<BudgetDetailResponse>> getBudgetDetail(
    BudgetDetailRequest request
  );

  /**
   * 46. å°æ‡‰ 5.1ï¼šå–å¾—é ç®—çµ±è¨ˆè³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å–å¾—é ç®—çµ±è¨ˆåˆ†æè³‡æ–™ï¼ˆå°æ‡‰F017ç«¯é»ï¼‰
   */
  Future<ApiResponse<BudgetStatisticsResponse>> getBudgetStatistics(
    BudgetStatisticsRequest request
  );

  /**
   * 47. å°æ‡‰ 5.1ï¼šå–å¾—é ç®—ç›¸é—œäº¤æ˜“
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å–å¾—èˆ‡é ç®—ç›¸é—œçš„äº¤æ˜“è¨˜éŒ„ï¼ˆå°æ‡‰F008ç«¯é»ï¼‰
   */
  Future<ApiResponse<BudgetTransactionsResponse>> getBudgetTransactions(
    BudgetTransactionsRequest request
  );

  /**
   * 48. å°æ‡‰ 5.1ï¼šå–å¾—é ç®—è¶¨å‹¢è³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å–å¾—é ç®—ä½¿ç”¨è¶¨å‹¢è³‡æ–™ï¼ˆå°æ‡‰F017ç«¯é»ï¼‰
   */
  Future<ApiResponse<BudgetTrendsResponse>> getBudgetTrends(
    BudgetTrendsRequest request
  );

  /**
   * 49. å°æ‡‰ 5.1ï¼šå¿«é€Ÿç·¨è¼¯é ç®—
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å¿«é€Ÿç·¨è¼¯é ç®—è¨­å®šï¼ˆå°æ‡‰F016ç«¯é»ï¼‰
   */
  Future<ApiResponse<BudgetUpdateResponse>> quickEditBudget(
    QuickEditBudgetRequest request
  );

  /**
   * 50. å°æ‡‰ 5.1ï¼šåˆªé™¤é ç®—
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description åˆªé™¤é ç®—é …ç›®ï¼ˆå°æ‡‰F016ç«¯é»ï¼‰
   */
  Future<ApiResponse<DeleteResponse>> deleteBudget(
    DeleteBudgetRequest request
  );
}
```

### 5.2 è³‡æ–™æ¨¡å‹å®šç¾©
```dart
/**
 * 51. å°æ‡‰ 5.2ï¼šé ç®—è©³æƒ…è«‹æ±‚æ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é ç®—è©³æƒ…APIè«‹æ±‚è³‡æ–™çµæ§‹
 */
class BudgetDetailRequest {
  final String budgetId;
  final bool includeTransactions;
  final bool includeStatistics;
  final bool includeTrends;
  final bool includeAlerts;
  final DateRange? period;

  BudgetDetailRequest({
    required this.budgetId,
    this.includeTransactions = true,
    this.includeStatistics = true,
    this.includeTrends = true,
    this.includeAlerts = true,
    this.period,
  });

  Map<String, dynamic> toJson();
}

/**
 * 52. å°æ‡‰ 5.2ï¼šé ç®—è©³æƒ…å›æ‡‰æ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é ç®—è©³æƒ…APIå›æ‡‰è³‡æ–™çµæ§‹
 */
class BudgetDetailResponse {
  final bool success;
  final BudgetDetail budget;
  final BudgetStatistics? statistics;
  final List<Transaction>? transactions;
  final List<TrendData>? trends;
  final List<BudgetAlert>? alerts;

  BudgetDetailResponse({
    required this.success,
    required this.budget,
    this.statistics,
    this.transactions,
    this.trends,
    this.alerts,
  });

  factory BudgetDetailResponse.fromJson(Map<String, dynamic> json);
  Map<String, dynamic> toJson();
}

/**
 * 53. å°æ‡‰ 5.2ï¼šé ç®—è©³ç´°è³‡æ–™æ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description é ç®—è©³ç´°è³‡æ–™çµæ§‹
 */
class BudgetDetail {
  final String budgetId;
  final String name;
  final String description;
  final BudgetType type;
  final double amount;
  final double spent;
  final double remaining;
  final double percentage;
  final BudgetStatus status;
  final DateTime startDate;
  final DateTime endDate;
  final bool isRecurring;
  final AlertConfig? alertConfig;
  final DateTime createdAt;
  final DateTime updatedAt;

  BudgetDetail({
    required this.budgetId,
    required this.name,
    required this.description,
    required this.type,
    required this.amount,
    required this.spent,
    required this.remaining,
    required this.percentage,
    required this.status,
    required this.startDate,
    required this.endDate,
    required this.isRecurring,
    this.alertConfig,
    required this.createdAt,
    required this.updatedAt,
  });

  factory BudgetDetail.fromJson(Map<String, dynamic> json);
  Map<String, dynamic> toJson();
}
```

---

## 6.0 å°èˆªè·¯ç”±è¨­è¨ˆ

### 6.1 è·¯ç”±é…ç½®
```dart
/**
 * 54. å°æ‡‰ 6.1ï¼šé ç®—è©³æƒ…é é¢è·¯ç”±é…ç½®
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description å®šç¾©é ç®—è©³æƒ…é é¢çš„è·¯ç”±è¦å‰‡èˆ‡å°èˆªé‚è¼¯
 */
class BudgetDetailRoutes {
  static const String budgetDetail = '/budget-detail';
  static const String budgetEdit = '/budget-edit';
  static const String budgetShare = '/budget-share';
  static const String transactionDetail = '/transaction-detail';

  /**
   * 55. å°æ‡‰ 6.1ï¼šå–å¾—é ç®—è©³æƒ…è·¯ç”±
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å»ºç«‹é ç®—è©³æƒ…é é¢çš„GoRouteé…ç½®
   */
  static GoRoute getBudgetDetailRoute();
}

/**
 * 56. å°æ‡‰ 6.1ï¼šé ç®—è©³æƒ…å°èˆªæœå‹™
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description è™•ç†é ç®—è©³æƒ…ç›¸é—œçš„å°èˆªé‚è¼¯
 */
class BudgetDetailNavigationService {
  static final GoRouter _router;
  static GoRouter get router;

  /**
   * 57. å°æ‡‰ 6.1ï¼šå°èˆªåˆ°é ç®—ç·¨è¼¯
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å°èˆªåˆ°é ç®—ç·¨è¼¯é é¢
   */
  Future<void> navigateToBudgetEdit(String budgetId);

  /**
   * 58. å°æ‡‰ 6.1ï¼šå°èˆªåˆ°äº¤æ˜“è©³æƒ…
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å°èˆªåˆ°äº¤æ˜“è©³æƒ…é é¢
   */
  Future<void> navigateToTransactionDetail(String transactionId);

  /**
   * 59. å°æ‡‰ 6.1ï¼šå°èˆªåˆ°é ç®—ç¸½è¦½
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è¿”å›é ç®—ç¸½è¦½é é¢
   */
  void navigateToBudgetOverview();
}
```

---

## 7.0 éŸ¿æ‡‰å¼è¨­è¨ˆ

### 7.1 éŸ¿æ‡‰å¼è¼”åŠ©å·¥å…·
```dart
/**
 * 60. å°æ‡‰ 7.1ï¼šé ç®—è©³æƒ…é é¢éŸ¿æ‡‰å¼è¨­è¨ˆè¼”åŠ©å·¥å…·
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description éµå¾ª9005æ–‡ä»¶çš„éŸ¿æ‡‰å¼è¨­è¨ˆè¦ç¯„ï¼Œæä¾›é ç®—è©³æƒ…é é¢å°ˆç”¨çš„ä½ˆå±€ç®¡ç†
 */
class BudgetDetailResponsiveHelper {
  final BuildContext context;
  late final MediaQueryData _mediaQuery;
  late final Size _screenSize;

  BudgetDetailResponsiveHelper.of(BuildContext context);

  // æ–·é»åˆ¤æ–·å±¬æ€§ï¼ˆ9005è¦ç¯„ï¼‰
  bool get isMobile;
  bool get isTablet;
  bool get isSmallDesktop;
  bool get isLargeDesktop;
  DeviceType get deviceType;

  // é ç®—è©³æƒ…é é¢å°ˆç”¨å°ºå¯¸å±¬æ€§
  double get cardSpacing;
  double get sectionSpacing;
  EdgeInsets get contentPadding;
  double get chartHeight;
  double get headerHeight;
  double get statisticsCardWidth;

  /**
   * 61. å°æ‡‰ 7.1ï¼šå–å¾—å››æ¨¡å¼ä½ˆå±€é…ç½®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼å’Œè£ç½®é¡å‹è¿”å›é©ç•¶ä½ˆå±€é…ç½®
   */
  LayoutConfig getLayoutConfigForMode(UserMode? mode);

  /**
   * 62. å°æ‡‰ 7.1ï¼šå–å¾—åœ–è¡¨å¤§å°é…ç½®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ ¹æ“šè¢å¹•å¤§å°è¿”å›é©ç•¶çš„åœ–è¡¨å°ºå¯¸
   */
  ChartSizeConfig getChartSizeConfig();
}
```

---

## 8.0 ç„¡éšœç¤™åŠŸèƒ½

### 8.1 èªæ„åŒ–æ”¯æ´
```dart
/**
 * 63. å°æ‡‰ 8.1ï¼šé ç®—è©³æƒ…é é¢ç„¡éšœç¤™èªæ„åŒ–WidgetåŒ…è£å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description æä¾›WCAG 2.1 AAæ¨™æº–çš„å®Œæ•´ç„¡éšœç¤™æ”¯æ´ï¼ˆ9005è¦ç¯„ï¼‰
 */
class BudgetDetailAccessibilityWrapper {

  /**
   * 64. å°æ‡‰ 8.1ï¼šç‚ºé ç®—è³‡è¨Šæä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description ç‚ºé ç®—è©³æƒ…è³‡è¨Šæ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapBudgetInfo(Widget child, BudgetDetail budgetDetail);

  /**
   * 65. å°æ‡‰ 8.1ï¼šç‚ºåœ–è¡¨æä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description ç‚ºé ç®—åœ–è¡¨æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤å’Œæè¿°
   */
  static Widget wrapChart(Widget child, ChartType chartType, List<TrendData> data);

  /**
   * 66. å°æ‡‰ 8.1ï¼šç‚ºçµ±è¨ˆè³‡æ–™æä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description ç‚ºçµ±è¨ˆè³‡æ–™æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapStatistics(Widget child, BudgetStatistics statistics);

  /**
   * 67. å°æ‡‰ 8.1ï¼šç‚ºæ“ä½œæŒ‰éˆ•æä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description ç‚ºæ“ä½œæŒ‰éˆ•æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapActionButton(Widget child, String action, bool isEnabled);
}
```

---

## 9.0 æ•ˆèƒ½æœ€ä½³åŒ–

### 9.1 Widgetå¿«å–ç­–ç•¥
```dart
/**
 * 68. å°æ‡‰ 9.1ï¼šé ç®—è©³æƒ…é é¢Widgetå¿«å–ç®¡ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description å„ªåŒ–é ç®—è©³æƒ…é é¢Widgeté‡å»ºæ•ˆèƒ½ï¼Œæ¸›å°‘ä¸å¿…è¦çš„é‡å»º
 */
class BudgetDetailWidgetCache {
  static final Map<String, Widget> _cache = {};
  static final Map<String, DateTime> _cacheTimestamps = {};
  static const Duration _cacheValidDuration = Duration(minutes: 5);

  /**
   * 69. å°æ‡‰ 9.1ï¼šå–å¾—å¿«å–çš„åœ–è¡¨æˆ–å»ºç«‹æ–°çš„
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å¾å¿«å–ä¸­ç²å–åœ–è¡¨Widgetæˆ–å‰µå»ºæ–°çš„
   */
  static Widget getChartOrCreate(
    String key, 
    ChartType chartType, 
    List<TrendData> data,
    Widget Function() creator
  );

  /**
   * 70. å°æ‡‰ 9.1ï¼šå–å¾—å¿«å–çš„çµ±è¨ˆå¡ç‰‡æˆ–å»ºç«‹æ–°çš„
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description å¾å¿«å–ä¸­ç²å–çµ±è¨ˆå¡ç‰‡Widgetæˆ–å‰µå»ºæ–°çš„
   */
  static Widget getStatCardOrCreate(String key, Widget Function() creator);

  /**
   * 71. å°æ‡‰ 9.1ï¼šæ¸…é™¤é ç®—è©³æƒ…å¿«å–
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ¸…é™¤é ç®—è©³æƒ…é é¢ç›¸é—œçš„Widgetå¿«å–
   */
  static void clearBudgetDetailCache();
}
```

### 9.2 è³‡æ–™è¼‰å…¥å„ªåŒ–
```dart
/**
 * 72. å°æ‡‰ 9.2ï¼šé ç®—è©³æƒ…è³‡æ–™è¼‰å…¥å„ªåŒ–å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description å„ªåŒ–é ç®—è©³æƒ…è³‡æ–™è¼‰å…¥æ•ˆèƒ½
 */
class BudgetDetailPerformanceOptimizer {

  /**
   * 73. å°æ‡‰ 9.2ï¼šä¸¦è¡Œè¼‰å…¥é ç®—è³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description ä¸¦è¡Œè¼‰å…¥é ç®—ç›¸é—œçš„å¤šç¨®è³‡æ–™
   */
  static Future<BudgetDetailData> parallelLoadBudgetData(String budgetId);

  /**
   * 74. å°æ‡‰ 9.2ï¼šåˆ†é è¼‰å…¥äº¤æ˜“è¨˜éŒ„
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description åˆ†é è¼‰å…¥äº¤æ˜“è¨˜éŒ„ï¼Œé¿å…ä¸€æ¬¡è¼‰å…¥éå¤šè³‡æ–™
   */
  static Future<List<Transaction>> loadTransactionsPaginated(
    String budgetId, 
    int page, 
    int limit
  );

  /**
   * 75. å°æ‡‰ 9.2ï¼šæ™ºæ…§é‡æ–°æ•´ç†
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description æ™ºæ…§åˆ¤æ–·éœ€è¦é‡æ–°æ•´ç†çš„è³‡æ–™é …ç›®
   */
  static Future<void> smartRefresh(String budgetId, Duration lastUpdate);
}
```

---

## 10.0 éŒ¯èª¤è™•ç†æ©Ÿåˆ¶

### 10.1 çµ±ä¸€éŒ¯èª¤è™•ç†
```dart
/**
 * 76. å°æ‡‰ 10.1ï¼šé ç®—è©³æƒ…é é¢éŒ¯èª¤è™•ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description è™•ç†é ç®—è©³æƒ…é é¢çš„å„ç¨®éŒ¯èª¤æƒ…å¢ƒ
 */
class BudgetDetailErrorHandler {

  /**
   * 77. å°æ‡‰ 10.1ï¼šè™•ç†é ç®—è¼‰å…¥éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†é ç®—è©³æƒ…è¼‰å…¥å¤±æ•—çš„éŒ¯èª¤
   */
  static String handleBudgetLoadError(dynamic error);

  /**
   * 78. å°æ‡‰ 10.1ï¼šè™•ç†çµ±è¨ˆè³‡æ–™éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†çµ±è¨ˆè³‡æ–™è¼‰å…¥æˆ–è¨ˆç®—éŒ¯èª¤
   */
  static String handleStatisticsError(dynamic error);

  /**
   * 79. å°æ‡‰ 10.1ï¼šè™•ç†åœ–è¡¨æ¸²æŸ“éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†åœ–è¡¨æ¸²æŸ“å¤±æ•—çš„éŒ¯èª¤
   */
  static String handleChartRenderError(dynamic error);

  /**
   * 80. å°æ‡‰ 10.1ï¼šè™•ç†ç¶²è·¯é€£ç·šéŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†ç¶²è·¯é€£ç·šéŒ¯èª¤
   */
  static String handleNetworkError(DioError error);

  /**
   * 81. å°æ‡‰ 10.1ï¼šé¡¯ç¤ºéŒ¯èª¤ç‹€æ…‹Widget
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description é¡¯ç¤ºéŒ¯èª¤ç‹€æ…‹çš„Widget
   */
  static Widget buildErrorStateWidget(
    String errorMessage,
    VoidCallback? onRetry,
    {Widget? customIcon}
  );

  /**
   * 82. å°æ‡‰ 10.1ï¼šè™•ç†é ç®—ç·¨è¼¯éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†é ç®—ç·¨è¼¯æ“ä½œéŒ¯èª¤
   */
  static String handleBudgetEditError(dynamic error);

  /**
   * 83. å°æ‡‰ 10.1ï¼šè™•ç†åˆ†äº«éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†é ç®—åˆ†äº«åŠŸèƒ½éŒ¯èª¤
   */
  static String handleShareError(dynamic error);
}
```

### 10.2 éŒ¯èª¤å¾©åŸæ©Ÿåˆ¶
```dart
/**
 * 84. å°æ‡‰ 10.2ï¼šé ç®—è©³æƒ…éŒ¯èª¤å¾©åŸç­–ç•¥
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 20:30:00
 * @description æä¾›é ç®—è©³æƒ…å„ç¨®éŒ¯èª¤å¾©åŸæ©Ÿåˆ¶
 */
class BudgetDetailErrorRecovery {

  /**
   * 85. å°æ‡‰ 10.2ï¼šè‡ªå‹•é‡è©¦è¼‰å…¥æ©Ÿåˆ¶
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description é‡å°ç¶²è·¯éŒ¯èª¤ç­‰è‡¨æ™‚æ€§å•é¡Œçš„è‡ªå‹•é‡è©¦æ©Ÿåˆ¶
   */
  static Future<T> retryLoad<T>(
    Future<T> Function() loadOperation,
    {int maxRetries = 3}
  );

  /**
   * 86. å°æ‡‰ 10.2ï¼šå¿«å–é™ç´šç­–ç•¥
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description ç•¶ç¶²è·¯å¤±æ•—æ™‚ä½¿ç”¨å¿«å–è³‡æ–™çš„é™ç´šç­–ç•¥
   */
  static Future<BudgetDetailData?> fallbackToCache(String budgetId);

  /**
   * 87. å°æ‡‰ 10.2ï¼šéƒ¨åˆ†è¼‰å…¥ç­–ç•¥
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description ç•¶éƒ¨åˆ†è³‡æ–™è¼‰å…¥å¤±æ•—æ™‚çš„éƒ¨åˆ†é¡¯ç¤ºç­–ç•¥
   */
  static BudgetDetailData buildPartialData(
    BudgetDetail? budget,
    BudgetStatistics? statistics,
    List<Transaction>? transactions,
  );

  /**
   * 88. å°æ‡‰ 10.2ï¼šé›¢ç·šæ¨¡å¼è™•ç†
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 20:30:00
   * @description è™•ç†é›¢ç·šç‹€æ…‹çš„é ç®—è©³æƒ…é¡¯ç¤º
   */
  static Widget buildOfflineBudgetDetailWidget(BudgetDetail? cachedBudget);
}
```

---

## éµå¾ª0055è¨­è¨ˆåŸå‰‡

### éšå±¤æ¶æ§‹å°æ‡‰
- æœ¬TDDæ–‡ä»¶åŸºæ–¼P028_é ç®—è©³æƒ…é é¢_SRS.mdçš„éœ€æ±‚è¦æ ¼
- èˆ‡9005. Flutter_Presentation layer.mdçš„ç”¢å“è¦æ ¼ä¿æŒä¸€è‡´
- æ‰€æœ‰å‡½æ•¸ç¯€é»ç·¨è™Ÿå°æ‡‰ä¸Šå±¤æ–‡ä»¶çš„åŠŸèƒ½æ¢ç›®

### è¨­è¨ˆåŸå‰‡éµå¾ª
1. **éšå±¤æ¶æ§‹é‚è¼¯**: åš´æ ¼åŸºæ–¼SRSæ–‡ä»¶å®šç¾©çš„åŠŸèƒ½æ¢ç›®è¨­è¨ˆ
2. **åŒå±¤ç´šä¾è³´é—œä¿‚**: è€ƒé‡èˆ‡é ç®—ç¸½è¦½é é¢å’Œé ç®—ç·¨è¼¯é é¢çš„ä¾è³´é—œä¿‚
3. **ä»£ç¢¼ç¯€é»ç·¨è™Ÿ**: æ¡ç”¨ä¸åŠ å‰ç¶´çš„ç¯€é»ç·¨è™Ÿæ ¼å¼ï¼ˆå¦‚2.1ã€3.2ï¼‰
4. **å‘½åä¸€è‡´æ€§**: ä¿æŒèˆ‡ä½¿ç”¨è€…ä»‹é¢æ“ä½œæµç¨‹çš„åç¨±åŒæ­¥
5. **å¯è®€æ€§è¨­è¨ˆ**: æ¡ç”¨æ¨¡çµ„åŒ–è¨­è¨ˆï¼Œéµå¾ªä½è€¦åˆã€é«˜å…§èšåŸå‰‡

## æ–‡ä»¶ç¶­è­·è¨˜éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®æ”¹è€… | ä¿®æ”¹å…§å®¹ |
|------|------|--------|----------|
| **v1.0.0** | **2025-01-26 20:30:00 +08:00** | **LCAS SA Team** | **åˆç‰ˆå»ºç«‹ï¼šå®Œæ•´P028é ç®—è©³æƒ…é é¢TDDè¦æ ¼ï¼Œæ”¯æ´å¤šç¶­åº¦è³‡æ–™å±•ç¤ºï¼ˆåŸºæœ¬è³‡è¨Šã€åŸ·è¡Œé€²åº¦ã€çµ±è¨ˆåˆ†æã€åœ–è¡¨è¦–è¦ºåŒ–ã€äº¤æ˜“è¨˜éŒ„ã€æ­·å²è¿½è¹¤ï¼‰ï¼Œå¯¦ä½œå››æ¨¡å¼å·®ç•°åŒ–è¨­è¨ˆï¼Œå®Œæ•´éŒ¯èª¤è™•ç†æ©Ÿåˆ¶ï¼Œéµå¾ª0055è¨­è¨ˆåŸå‰‡ï¼Œå°æ‡‰P028 SRSè¦æ ¼** |

---

## å‚™è¨»

- **ç´”å‡½æ•¸å®£å‘Š**: å®Œå…¨ç§»é™¤æ‰€æœ‰å¯¦ä½œä»£ç¢¼ï¼Œåƒ…ä¿ç•™å‡½æ•¸åç¨±ã€åƒæ•¸å®šç¾©å’Œè¨»è§£
- **å¤šç¶­åº¦è³‡æ–™å±•ç¤º**: æ”¯æ´é ç®—åŸºæœ¬è³‡è¨Šã€åŸ·è¡Œé€²åº¦ã€çµ±è¨ˆåˆ†æã€åœ–è¡¨è¦–è¦ºåŒ–ã€äº¤æ˜“è¨˜éŒ„ç­‰å®Œæ•´å±•ç¤º
- **å››æ¨¡å¼å·®ç•°åŒ–**: æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼æä¾›ä¸åŒçš„è©³æƒ…ç•Œé¢è¤‡é›œåº¦å’ŒåŠŸèƒ½é¸é …
- **å³æ™‚è³‡æ–™æ›´æ–°**: å®Œæ•´çš„è³‡æ–™åŒæ­¥ã€ç‹€æ…‹è¿½è¹¤ã€æ™ºæ…§é‡æ–°æ•´ç†æ©Ÿåˆ¶
- **å®Œæ•´æŠ€è¡“æ¶æ§‹**: Widgetåˆ†å±¤ã€ç‹€æ…‹ç®¡ç†ã€APIæ•´åˆã€éŸ¿æ‡‰å¼è¨­è¨ˆã€ç„¡éšœç¤™æ”¯æ´ã€æ•ˆèƒ½æœ€ä½³åŒ–
- **è¦ç¯„å®Œå…¨å°é½Š**: èˆ‡0055ã€P028 SRSã€9005ã€9006æ–‡ä»¶å®Œå…¨ä¸€è‡´
- **ç¯€é»ç·¨è™Ÿæ¨™æº–åŒ–**: çµ±ä¸€ç·¨è™Ÿ01-88ï¼Œéµå¾ª0055è¦ç¯„æ ¼å¼
- **ç‰ˆæœ¬çµ±ä¸€å‡ç´š**: æ‰€æœ‰çµ„ä»¶ç‰ˆæœ¬çµ±ä¸€ç‚ºv1.0.0
