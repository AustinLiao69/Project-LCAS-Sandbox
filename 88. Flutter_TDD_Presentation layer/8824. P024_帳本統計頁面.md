
# 8824. TDD_P024_å¸³æœ¬çµ±è¨ˆé é¢_v1.0.0

## æ–‡ä»¶è³‡è¨Š
- **æ–‡ä»¶æ¨™é¡Œ**: P024 å¸³æœ¬çµ±è¨ˆé é¢æŠ€è¡“è¨­è¨ˆæ–‡ä»¶
- **æ–‡ä»¶ç‰ˆæœ¬**: v1.0.0
- **å‰µå»ºæ—¥æœŸ**: 2025-01-26 18:30:00 +08:00 (å°ç£æ™‚é–“)
- **å‰µå»ºè€…**: LCAS SA Team
- **æœ€å¾Œæ›´æ–°**: 2025-01-26 18:30:00 +08:00 (å°ç£æ™‚é–“)
- **å°æ‡‰éœ€æ±‚æ–‡ä»¶**: P024_å¸³æœ¬çµ±è¨ˆé é¢_SRS.md
- **å°æ‡‰PRDæ–‡ä»¶**: 9005. Flutter_Presentation layer.md
- **é é¢ä»£ç¢¼**: P024 (Ledger Statistics Page)

---

## ğŸ“‘ ç›®æ¬¡ (Table of Contents)

1. [æŠ€è¡“æ¶æ§‹æ¦‚è¿°](#10-æŠ€è¡“æ¶æ§‹æ¦‚è¿°)
2. [Widgetæ¸…å–®](#20-widgetæ¸…å–®)
3. [æ ¸å¿ƒWidgetè¨­è¨ˆ](#30-æ ¸å¿ƒwidgetè¨­è¨ˆ)
4. [ç‹€æ…‹ç®¡ç†æ¶æ§‹](#40-ç‹€æ…‹ç®¡ç†æ¶æ§‹)
5. [APIæ•´åˆè¨­è¨ˆ](#50-apiæ•´åˆè¨­è¨ˆ)
6. [å°èˆªè·¯ç”±è¨­è¨ˆ](#60-å°èˆªè·¯ç”±è¨­è¨ˆ)
7. [éŸ¿æ‡‰å¼è¨­è¨ˆ](#70-éŸ¿æ‡‰å¼è¨­è¨ˆ)
8. [ç„¡éšœç¤™åŠŸèƒ½](#80-ç„¡éšœç¤™åŠŸèƒ½)
9. [æ•ˆèƒ½æœ€ä½³åŒ–](#90-æ•ˆèƒ½æœ€ä½³åŒ–)
10. [éŒ¯èª¤è™•ç†æ©Ÿåˆ¶](#100-éŒ¯èª¤è™•ç†æ©Ÿåˆ¶)

---

## 1.0 æŠ€è¡“æ¶æ§‹æ¦‚è¿°

### 1.1 æ¨¡çµ„å®šä½
P024å¸³æœ¬çµ±è¨ˆé é¢ä½œç‚ºLCAS 2.0 Flutteræ‡‰ç”¨ç¨‹å¼çš„æ•¸æ“šåˆ†æä¸­å¿ƒï¼Œè² è²¬å¸³æœ¬è²¡å‹™çµ±è¨ˆã€è¶¨å‹¢åˆ†æã€æˆå“¡è²¢ç»åº¦çµ±è¨ˆã€é ç®—åŸ·è¡Œç‹€æ³ç­‰å¤šç¶­åº¦çµ±è¨ˆåŠŸèƒ½ã€‚æœ¬é é¢æ¡ç”¨Clean Architectureè¨­è¨ˆï¼Œç¢ºä¿æ•¸æ“šæº–ç¢ºæ€§èˆ‡è¦–è¦ºåŒ–æ•ˆæœã€‚

### 1.2 æŠ€è¡“å †ç–Š
- **å‰ç«¯æ¡†æ¶**: Flutter 3.x
- **ç‹€æ…‹ç®¡ç†**: Provider + ChangeNotifier
- **è·¯ç”±ç®¡ç†**: GoRouter
- **HTTPå®¢æˆ¶ç«¯**: Dio
- **æœ¬åœ°å„²å­˜**: SharedPreferences + FlutterSecureStorage
- **åœ–è¡¨è¦–è¦ºåŒ–**: fl_chart
- **æ•¸æ“šè™•ç†**: collection, intl
- **æª”æ¡ˆåŒ¯å‡º**: pdf, csv, excel

### 1.3 æ¨¡çµ„æ¶æ§‹
```dart
/**
 * P024_å¸³æœ¬çµ±è¨ˆé é¢_1.0.0
 * @module P024å¸³æœ¬çµ±è¨ˆé é¢
 * @description Flutter Presentation Layerå¸³æœ¬çµ±è¨ˆåˆ†æé é¢ - å¤šç¶­åº¦çµ±è¨ˆã€åœ–è¡¨è¦–è¦ºåŒ–ã€æ•¸æ“šåŒ¯å‡º
 * @update 2025-01-26: å‡ç´šè‡³v1.0ç‰ˆæœ¬ï¼Œæ–°å¢å®Œæ•´çµ±è¨ˆåŠŸèƒ½è¨­è¨ˆï¼Œæ”¯æ´è²¡å‹™åˆ†æã€è¶¨å‹¢é æ¸¬ã€æˆå“¡çµ±è¨ˆ
 */
```

---

## 2.0 Widgetæ¸…å–®

### 2.1 å®Œæ•´Widgetç´¢å¼•è¡¨

| # | Widgetåç¨± | ç‰ˆæœ¬ | æ‰€å±¬å±¤ç´š | åŠŸèƒ½æè¿° | ç›¸ä¾çµ„ä»¶ |
|---|------------|------|----------|----------|----------|
| 01 | LedgerStatisticsPage | V1.0.0 | é é¢å®¹å™¨å±¤ | ä¸»çµ±è¨ˆé é¢å®¹å™¨åŠç”Ÿå‘½é€±æœŸç®¡ç† | StatisticsProviderã€Router |
| 02 | StatisticsScaffold | V1.0.0 | ä½ˆå±€çµæ§‹å±¤ | åŸºç¤é é¢çµæ§‹èˆ‡èƒŒæ™¯è¨­å®š | StatisticsAppBarã€TabBar |
| 03 | StatisticsAppBar | V1.0.0 | é ‚éƒ¨å°èˆªå±¤ | çµ±è¨ˆé é¢é ‚éƒ¨å°èˆªåŠæ“ä½œæŒ‰éˆ• | IconButtonã€DateRangePicker |
| 04 | StatisticsTabBar | V1.0.0 | æ¨™ç±¤åˆ‡æ›å±¤ | çµ±è¨ˆè¦–åœ–æ¨™ç±¤åˆ‡æ›ä»‹é¢ | TabControllerã€AnimatedTab |
| 05 | FinancialSummarySection | V1.0.0 | è²¡å‹™æ‘˜è¦å±¤ | è²¡å‹™çµ±è¨ˆæ‘˜è¦é¡¯ç¤ºå€å¡Š | SummaryCardã€TrendIndicator |
| 06 | SummaryCard | V1.0.0 | æ‘˜è¦å¡ç‰‡å±¤ | å–®é …çµ±è¨ˆæ•¸æ“šå¡ç‰‡ | AnimatedCounterã€IconWidget |
| 07 | TrendIndicator | V1.0.0 | è¶¨å‹¢æŒ‡æ¨™å±¤ | æ•¸æ“šè®ŠåŒ–è¶¨å‹¢æŒ‡æ¨™ | AnimatedIconã€PercentageText |
| 08 | ChartSection | V1.0.0 | åœ–è¡¨å€åŸŸå±¤ | çµ±è¨ˆåœ–è¡¨é¡¯ç¤ºå€å¡Š | LineChartã€PieChartã€BarChart |
| 09 | LineChart | V1.0.0 | æŠ˜ç·šåœ–å±¤ | æ™‚é–“åºåˆ—è¶¨å‹¢æŠ˜ç·šåœ– | fl_chartã€ChartData |
| 10 | PieChart | V1.0.0 | åœ“é¤…åœ–å±¤ | åˆ†é¡åˆ†å¸ƒåœ“é¤…åœ– | fl_chartã€CategoryData |
| 11 | BarChart | V1.0.0 | æ©«æ¢åœ–å±¤ | æ¯”è¼ƒåˆ†ææ©«æ¢åœ– | fl_chartã€ComparisonData |
| 12 | CategoryBreakdownWidget | V1.0.0 | åˆ†é¡åˆ†æå±¤ | ç§‘ç›®åˆ†é¡çµ±è¨ˆåˆ†æ | CategoryListTileã€ExpansionTile |
| 13 | CategoryListTile | V1.0.0 | åˆ†é¡é …ç›®å±¤ | å–®ä¸€åˆ†é¡çµ±è¨ˆé …ç›® | ProgressBarã€AmountText |
| 14 | MemberContributionWidget | V1.0.0 | æˆå“¡è²¢ç»å±¤ | æˆå“¡æ´»å‹•çµ±è¨ˆåˆ†æ | MemberAvatarã€ContributionChart |
| 15 | MemberAvatar | V1.0.0 | æˆå“¡é ­åƒå±¤ | æˆå“¡é ­åƒåŠåŸºæœ¬ä¿¡æ¯ | CircleAvatarã€UserInfo |
| 16 | ContributionChart | V1.0.0 | è²¢ç»åœ–è¡¨å±¤ | æˆå“¡è²¢ç»åº¦åœ–è¡¨ | RadialChartã€ActivityIndicator |
| 17 | BudgetExecutionWidget | V1.0.0 | é ç®—åŸ·è¡Œå±¤ | é ç®—åŸ·è¡Œç‹€æ³åˆ†æ | BudgetProgressBarã€AlertIndicator |
| 18 | BudgetProgressBar | V1.0.0 | é ç®—é€²åº¦å±¤ | é ç®—åŸ·è¡Œé€²åº¦æ¢ | LinearProgressIndicatorã€StatusText |
| 19 | DateRangePicker | V1.0.0 | æ—¥æœŸé¸æ“‡å±¤ | çµ±è¨ˆæ™‚é–“ç¯„åœé¸æ“‡å™¨ | CalendarDatePickerã€DateButton |
| 20 | StatisticsFilterSheet | V1.0.0 | ç¯©é¸å™¨å±¤ | çµ±è¨ˆæ¢ä»¶ç¯©é¸åº•éƒ¨è¡¨å–® | FilterChipã€CheckboxListTile |
| 21 | ExportOptionsDialog | V1.0.0 | åŒ¯å‡ºé¸é …å±¤ | çµ±è¨ˆå ±è¡¨åŒ¯å‡ºé¸é …å°è©±æ¡† | RadioListTileã€ExportButton |
| 22 | LoadingIndicator | V1.0.0 | è¼‰å…¥ç‹€æ…‹å±¤ | çµ±è¨ˆè³‡æ–™è¼‰å…¥æŒ‡ç¤ºå™¨ | CircularProgressIndicatorã€ShimmerEffect |
| 23 | ErrorWidget | V1.0.0 | éŒ¯èª¤è™•ç†å±¤ | çµ±è¨ˆéŒ¯èª¤ç‹€æ…‹é¡¯ç¤º | AlertDialogã€RetryButton |
| 24 | EmptyStateWidget | V1.0.0 | ç©ºç‹€æ…‹å±¤ | ç„¡çµ±è¨ˆè³‡æ–™ç‹€æ…‹é¡¯ç¤º | EmptyIllustrationã€GuideText |

---

## 3.0 æ ¸å¿ƒWidgetè¨­è¨ˆ

### 3.1 é é¢å®¹å™¨å±¤Widget

#### 3.1.1 LedgerStatisticsPage Widget
```dart
/**
 * 01. å°æ‡‰ 2.1ï¼šä¸»å¸³æœ¬çµ±è¨ˆé é¢å®¹å™¨Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å¸³æœ¬çµ±è¨ˆé é¢çš„ä¸»å®¹å™¨ï¼Œæ”¯æ´å¤šç¶­åº¦çµ±è¨ˆåˆ†æèˆ‡åœ–è¡¨è¦–è¦ºåŒ–
 */
class LedgerStatisticsPage extends StatefulWidget {
  static const String routeName = '/ledger-statistics';
  final String ledgerId;
  final UserMode? userMode;
  final StatisticsViewType? initialView;

  const LedgerStatisticsPage({
    Key? key,
    required this.ledgerId,
    this.userMode,
    this.initialView,
  });

  @override
  State<LedgerStatisticsPage> createState();
}

/**
 * 02. å°æ‡‰ 2.1ï¼šå¸³æœ¬çµ±è¨ˆé é¢ç‹€æ…‹é¡åˆ¥
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description ç®¡ç†å¸³æœ¬çµ±è¨ˆé é¢çš„ç‹€æ…‹å’Œå‹•ç•«æ§åˆ¶å™¨
 */
class _LedgerStatisticsPageState extends State<LedgerStatisticsPage> 
    with TickerProviderStateMixin {
  late TabController _tabController;
  late AnimationController _fadeController;
  late AnimationController _chartController;
  late Animation<double> _fadeAnimation;
  late Animation<double> _chartAnimation;

  @override
  void initState();

  /**
   * 03. å°æ‡‰ 2.1ï¼šåˆå§‹åŒ–å‹•ç•«æ§åˆ¶å™¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¨­å®šé é¢é€²å…¥å‹•ç•«æ•ˆæœ
   */
  void _initializeAnimations();

  /**
   * 04. å°æ‡‰ 2.1ï¼šåˆå§‹åŒ–çµ±è¨ˆé é¢ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description èª¿ç”¨Provideré€²è¡Œçµ±è¨ˆé é¢åˆå§‹åŒ–
   */
  Future<void> _initializeStatistics();

  @override
  Widget build(BuildContext context);

  @override
  void dispose();
}
```

### 3.2 ä½ˆå±€çµæ§‹å±¤Widget

#### 3.2.1 StatisticsScaffold Widget
```dart
/**
 * 05. å°æ‡‰ 2.2ï¼šçµ±è¨ˆé é¢ä½ˆå±€çµæ§‹Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æä¾›çµ±è¨ˆé é¢çš„åŸºç¤ä½ˆå±€çµæ§‹ï¼Œæ”¯æ´å››æ¨¡å¼å·®ç•°åŒ–é¡¯ç¤º
 */
class StatisticsScaffold extends StatelessWidget {
  final Animation<double> fadeAnimation;
  final TabController tabController;
  final StatisticsProvider provider;
  final UserMode? userMode;

  const StatisticsScaffold({
    Key? key,
    required this.fadeAnimation,
    required this.tabController,
    required this.provider,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 06. å°æ‡‰ 2.2ï¼šå»ºç«‹çµ±è¨ˆæ¨™ç±¤åˆ—è¡¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼å»ºç«‹é©ç•¶çš„çµ±è¨ˆæ¨™ç±¤
   */
  List<Tab> _buildStatisticsTabs(UserMode? mode);
}
```

### 3.3 è²¡å‹™æ‘˜è¦å±¤Widget

#### 3.3.1 FinancialSummarySection Widget
```dart
/**
 * 07. å°æ‡‰ 3.1ï¼šè²¡å‹™çµ±è¨ˆæ‘˜è¦å€å¡ŠWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description é¡¯ç¤ºè²¡å‹™çµ±è¨ˆæ‘˜è¦ï¼Œæ”¯æ´å››æ¨¡å¼å·®ç•°åŒ–æ¨£å¼
 */
class FinancialSummarySection extends StatelessWidget {
  final FinancialSummary summary;
  final UserMode? userMode;

  const FinancialSummarySection({
    Key? key,
    required this.summary,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 08. å°æ‡‰ 3.1ï¼šå–å¾—æ¨¡å¼å°æ‡‰æ‘˜è¦ä½ˆå±€
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼è¿”å›å°æ‡‰çš„æ‘˜è¦ä½ˆå±€æ¨£å¼
   */
  Widget _getSummaryLayoutForMode(UserMode? mode);
}
```

#### 3.3.2 SummaryCard Widget
```dart
/**
 * 09. å°æ‡‰ 3.1.1ï¼šçµ±è¨ˆæ‘˜è¦å¡ç‰‡Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å–®é …çµ±è¨ˆæ•¸æ“šå¡ç‰‡ï¼Œæ”¯æ´å‹•ç•«æ•ˆæœ
 */
class SummaryCard extends StatefulWidget {
  final String title;
  final double value;
  final String? subtitle;
  final IconData icon;
  final Color? color;
  final TrendData? trend;
  final VoidCallback? onTap;

  const SummaryCard({
    Key? key,
    required this.title,
    required this.value,
    this.subtitle,
    required this.icon,
    this.color,
    this.trend,
    this.onTap,
  });

  @override
  State<SummaryCard> createState();
}

class _SummaryCardState extends State<SummaryCard> 
    with SingleTickerProviderStateMixin {
  late AnimationController _animationController;
  late Animation<double> _scaleAnimation;
  late Animation<double> _fadeAnimation;

  @override
  void initState();

  @override
  Widget build(BuildContext context);

  /**
   * 10. å°æ‡‰ 3.1.1ï¼šæ ¼å¼åŒ–æ•¸å€¼é¡¯ç¤º
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šæ•¸å€¼é¡å‹æ ¼å¼åŒ–é¡¯ç¤º
   */
  String _formatValue(double value);

  @override
  void dispose();
}
```

### 3.4 åœ–è¡¨é¡¯ç¤ºå±¤Widget

#### 3.4.1 ChartSection Widget
```dart
/**
 * 11. å°æ‡‰ 3.2ï¼šçµ±è¨ˆåœ–è¡¨å€å¡ŠWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æ•´åˆå¤šç¨®çµ±è¨ˆåœ–è¡¨é¡¯ç¤ºï¼Œæ”¯æ´å››æ¨¡å¼å·®ç•°åŒ–
 */
class ChartSection extends StatelessWidget {
  final StatisticsData data;
  final ChartType activeChartType;
  final UserMode? userMode;
  final Function(ChartType) onChartTypeChanged;

  const ChartSection({
    Key? key,
    required this.data,
    required this.activeChartType,
    this.userMode,
    required this.onChartTypeChanged,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 12. å°æ‡‰ 3.2ï¼šå–å¾—æ¨¡å¼å¯ç”¨åœ–è¡¨é¡å‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼è¿”å›å¯ç”¨çš„åœ–è¡¨é¡å‹åˆ—è¡¨
   */
  List<ChartType> _getAvailableChartsForMode(UserMode? mode);
}
```

#### 3.4.2 LineChart Widget
```dart
/**
 * 13. å°æ‡‰ 3.2.1ï¼šæ™‚é–“åºåˆ—æŠ˜ç·šåœ–Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æ™‚é–“åºåˆ—è¶¨å‹¢æŠ˜ç·šåœ–ï¼Œæ”¯æ´ç¸®æ”¾å’Œäº’å‹•
 */
class StatisticsLineChart extends StatefulWidget {
  final List<TimeSeriesData> data;
  final DateRange dateRange;
  final Function(TimeSeriesData)? onDataPointTap;

  const StatisticsLineChart({
    Key? key,
    required this.data,
    required this.dateRange,
    this.onDataPointTap,
  });

  @override
  State<StatisticsLineChart> createState();
}

class _StatisticsLineChartState extends State<StatisticsLineChart> 
    with SingleTickerProviderStateMixin {
  late AnimationController _animationController;
  late Animation<double> _pathAnimation;

  @override
  void initState();

  @override
  Widget build(BuildContext context);

  /**
   * 14. å°æ‡‰ 3.2.1ï¼šå»ºç«‹åœ–è¡¨æ•¸æ“šé»
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è½‰æ›çµ±è¨ˆæ•¸æ“šç‚ºåœ–è¡¨æ•¸æ“šé»
   */
  List<FlSpot> _buildDataPoints();

  /**
   * 15. å°æ‡‰ 3.2.1ï¼šè™•ç†æ•¸æ“šé»é»æ“Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†åœ–è¡¨æ•¸æ“šé»é»æ“Šäº‹ä»¶
   */
  void _handleDataPointTap(FlTouchEvent event, LineTouchResponse? response);

  @override
  void dispose();
}
```

#### 3.4.3 PieChart Widget
```dart
/**
 * 16. å°æ‡‰ 3.2.2ï¼šåˆ†é¡åˆ†å¸ƒåœ“é¤…åœ–Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description åˆ†é¡åˆ†å¸ƒåœ“é¤…åœ–ï¼Œæ”¯æ´äº’å‹•å’Œåœ–ä¾‹
 */
class StatisticsPieChart extends StatefulWidget {
  final List<CategoryData> data;
  final Function(CategoryData)? onSectionTap;

  const StatisticsPieChart({
    Key? key,
    required this.data,
    this.onSectionTap,
  });

  @override
  State<StatisticsPieChart> createState();
}

class _StatisticsPieChartState extends State<StatisticsPieChart> 
    with SingleTickerProviderStateMixin {
  late AnimationController _animationController;
  late Animation<double> _rotationAnimation;
  int? _activeSectionIndex;

  @override
  void initState();

  @override
  Widget build(BuildContext context);

  /**
   * 17. å°æ‡‰ 3.2.2ï¼šå»ºç«‹åœ“é¤…åœ–å€å¡Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è½‰æ›åˆ†é¡æ•¸æ“šç‚ºåœ“é¤…åœ–å€å¡Š
   */
  List<PieChartSectionData> _buildPieSections();

  /**
   * 18. å°æ‡‰ 3.2.2ï¼šè™•ç†å€å¡Šé»æ“Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†åœ“é¤…åœ–å€å¡Šé»æ“Šäº‹ä»¶
   */
  void _handleSectionTap(FlTouchEvent event, PieTouchResponse? response);

  @override
  void dispose();
}
```

### 3.5 åˆ†é¡åˆ†æå±¤Widget

#### 3.5.1 CategoryBreakdownWidget Widget
```dart
/**
 * 19. å°æ‡‰ 3.3ï¼šåˆ†é¡çµ±è¨ˆåˆ†æWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description ç§‘ç›®åˆ†é¡çµ±è¨ˆåˆ†æï¼Œæ”¯æ´å±•é–‹è©³ç´°
 */
class CategoryBreakdownWidget extends StatefulWidget {
  final List<CategoryStats> categories;
  final Function(CategoryStats)? onCategoryTap;

  const CategoryBreakdownWidget({
    Key? key,
    required this.categories,
    this.onCategoryTap,
  });

  @override
  State<CategoryBreakdownWidget> createState();
}

class _CategoryBreakdownWidgetState extends State<CategoryBreakdownWidget> {
  final Set<String> _expandedCategories = {};

  @override
  Widget build(BuildContext context);

  /**
   * 20. å°æ‡‰ 3.3ï¼šåˆ‡æ›åˆ†é¡å±•é–‹ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description åˆ‡æ›åˆ†é¡çš„å±•é–‹/æ”¶åˆç‹€æ…‹
   */
  void _toggleCategoryExpansion(String categoryId);
}
```

### 3.6 æˆå“¡è²¢ç»å±¤Widget

#### 3.6.1 MemberContributionWidget Widget
```dart
/**
 * 21. å°æ‡‰ 3.4ï¼šæˆå“¡è²¢ç»çµ±è¨ˆWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æˆå“¡æ´»å‹•èˆ‡è²¢ç»åº¦çµ±è¨ˆåˆ†æ
 */
class MemberContributionWidget extends StatelessWidget {
  final List<MemberStats> members;
  final Function(MemberStats)? onMemberTap;

  const MemberContributionWidget({
    Key? key,
    required this.members,
    this.onMemberTap,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 22. å°æ‡‰ 3.4ï¼šæ’åºæˆå“¡çµ±è¨ˆ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šè²¢ç»åº¦æ’åºæˆå“¡çµ±è¨ˆ
   */
  List<MemberStats> _sortMembersByContribution(List<MemberStats> members);
}
```

---

## 4.0 ç‹€æ…‹ç®¡ç†æ¶æ§‹

### 4.1 StatisticsProvider ç‹€æ…‹ç®¡ç†å™¨
```dart
/**
 * 23. å°æ‡‰ 4.1ï¼šçµ±è¨ˆé é¢ç‹€æ…‹ç®¡ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description ç®¡ç†çµ±è¨ˆé é¢çš„ç‹€æ…‹ï¼Œæ”¯æ´å¤šç¶­åº¦çµ±è¨ˆåˆ†æå’Œå››æ¨¡å¼å·®ç•°åŒ–
 */
class StatisticsProvider extends ChangeNotifier {
  // ç‹€æ…‹å±¬æ€§
  StatisticsPageState _pageState = StatisticsPageState.initial;
  StatisticsViewType _activeView = StatisticsViewType.overview;
  ChartType _activeChartType = ChartType.line;
  bool _isLoading = false;
  String? _errorMessage;
  StatisticsErrorType? _errorType;
  UserMode? _userMode;

  // çµ±è¨ˆè³‡æ–™
  FinancialSummary? _financialSummary;
  List<TimeSeriesData> _trendData = [];
  List<CategoryStats> _categoryStats = [];
  List<MemberStats> _memberStats = [];
  BudgetExecutionStats? _budgetStats;

  // ç¯©é¸æ¢ä»¶
  DateRange _dateRange = DateRange.currentMonth();
  Set<String> _selectedCategories = {};
  Set<String> _selectedMembers = {};

  // Getters
  StatisticsPageState get pageState;
  StatisticsViewType get activeView;
  ChartType get activeChartType;
  bool get isLoading;
  String? get errorMessage;
  StatisticsErrorType? get errorType;
  UserMode? get userMode;
  FinancialSummary? get financialSummary;
  List<TimeSeriesData> get trendData;
  List<CategoryStats> get categoryStats;
  List<MemberStats> get memberStats;
  BudgetExecutionStats? get budgetStats;
  DateRange get dateRange;
  Set<String> get selectedCategories;
  Set<String> get selectedMembers;

  /**
   * 24. å°æ‡‰ 4.1ï¼šåˆå§‹åŒ–çµ±è¨ˆé é¢
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description åˆå§‹åŒ–çµ±è¨ˆé é¢ç‹€æ…‹å’Œè¼‰å…¥çµ±è¨ˆè³‡æ–™
   */
  Future<void> initializeStatistics(String ledgerId, UserMode? mode);

  /**
   * 25. å°æ‡‰ 4.1ï¼šè¨­å®šä½¿ç”¨è€…æ¨¡å¼
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¨­å®šä½¿ç”¨è€…æ¨¡å¼ä¸¦æ›´æ–°å¯ç”¨çµ±è¨ˆåŠŸèƒ½
   */
  void setUserMode(UserMode mode);

  /**
   * 26. å°æ‡‰ 4.1ï¼šè¼‰å…¥è²¡å‹™çµ±è¨ˆæ‘˜è¦
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¼‰å…¥å¸³æœ¬è²¡å‹™çµ±è¨ˆæ‘˜è¦
   */
  Future<void> loadFinancialSummary(String ledgerId);

  /**
   * 27. å°æ‡‰ 4.1ï¼šè¼‰å…¥è¶¨å‹¢åˆ†æè³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¼‰å…¥æ™‚é–“åºåˆ—è¶¨å‹¢åˆ†æè³‡æ–™
   */
  Future<void> loadTrendAnalysis(String ledgerId);

  /**
   * 28. å°æ‡‰ 4.1ï¼šè¼‰å…¥åˆ†é¡çµ±è¨ˆ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¼‰å…¥ç§‘ç›®åˆ†é¡çµ±è¨ˆè³‡æ–™
   */
  Future<void> loadCategoryStatistics(String ledgerId);

  /**
   * 29. å°æ‡‰ 4.1ï¼šè¼‰å…¥æˆå“¡çµ±è¨ˆ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¼‰å…¥æˆå“¡æ´»å‹•èˆ‡è²¢ç»çµ±è¨ˆ
   */
  Future<void> loadMemberStatistics(String ledgerId);

  /**
   * 30. å°æ‡‰ 4.1ï¼šè¼‰å…¥é ç®—åŸ·è¡Œçµ±è¨ˆ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¼‰å…¥é ç®—åŸ·è¡Œç‹€æ³çµ±è¨ˆ
   */
  Future<void> loadBudgetStatistics(String ledgerId);

  /**
   * 31. å°æ‡‰ 4.1ï¼šæ›´æ–°çµ±è¨ˆè¦–åœ–
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description åˆ‡æ›çµ±è¨ˆè¦–åœ–é¡å‹
   */
  void updateActiveView(StatisticsViewType viewType);

  /**
   * 32. å°æ‡‰ 4.1ï¼šæ›´æ–°åœ–è¡¨é¡å‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description åˆ‡æ›åœ–è¡¨é¡¯ç¤ºé¡å‹
   */
  void updateChartType(ChartType chartType);

  /**
   * 33. å°æ‡‰ 4.1ï¼šæ›´æ–°æ—¥æœŸç¯„åœ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°çµ±è¨ˆæ—¥æœŸç¯„åœä¸¦é‡æ–°è¼‰å…¥è³‡æ–™
   */
  Future<void> updateDateRange(DateRange dateRange);

  /**
   * 34. å°æ‡‰ 4.1ï¼šæ›´æ–°åˆ†é¡ç¯©é¸
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°åˆ†é¡ç¯©é¸æ¢ä»¶
   */
  Future<void> updateCategoryFilter(Set<String> categories);

  /**
   * 35. å°æ‡‰ 4.1ï¼šæ›´æ–°æˆå“¡ç¯©é¸
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°æˆå“¡ç¯©é¸æ¢ä»¶
   */
  Future<void> updateMemberFilter(Set<String> members);

  /**
   * 36. å°æ‡‰ 4.1ï¼šåŒ¯å‡ºçµ±è¨ˆå ±è¡¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description åŒ¯å‡ºçµ±è¨ˆå ±è¡¨åˆ°æª”æ¡ˆ
   */
  Future<void> exportStatistics(ExportFormat format, String ledgerId);

  /**
   * 37. å°æ‡‰ 4.1ï¼šé‡æ–°æ•´ç†çµ±è¨ˆè³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description é‡æ–°è¼‰å…¥æ‰€æœ‰çµ±è¨ˆè³‡æ–™
   */
  Future<void> refreshStatistics(String ledgerId);

  /**
   * 38. å°æ‡‰ 4.1ï¼šè¨­å®šè¼‰å…¥ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°è¼‰å…¥ç‹€æ…‹ä¸¦é€šçŸ¥ç›£è½è€…
   */
  void _setLoading(bool loading);

  /**
   * 39. å°æ‡‰ 4.1ï¼šè¨­å®šé é¢ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°é é¢ç‹€æ…‹ä¸¦é€šçŸ¥ç›£è½è€…
   */
  void _setPageState(StatisticsPageState state);

  /**
   * 40. å°æ‡‰ 4.1ï¼šè¨­å®šéŒ¯èª¤è¨Šæ¯
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¨­å®šéŒ¯èª¤è¨Šæ¯å’ŒéŒ¯èª¤é¡å‹
   */
  void _setError(String message, StatisticsErrorType type, dynamic error);

  /**
   * 41. å°æ‡‰ 4.1ï¼šæ¸…é™¤éŒ¯èª¤ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ¸…é™¤éŒ¯èª¤ç‹€æ…‹ä¸¦æ±ºå®šå¾ŒçºŒå‹•ä½œ
   */
  void clearError();
}
```

### 4.2 ç‹€æ…‹æšèˆ‰å®šç¾©
```dart
/**
 * 42. å°æ‡‰ 4.2ï¼šçµ±è¨ˆé é¢ç‹€æ…‹æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å®šç¾©çµ±è¨ˆé é¢çš„å„ç¨®ç‹€æ…‹
 */
enum StatisticsPageState {
  initial,     // åˆå§‹ç‹€æ…‹
  loading,     // è¼‰å…¥ä¸­
  loaded,      // å·²è¼‰å…¥
  refreshing,  // é‡æ–°æ•´ç†ä¸­
  error,       // éŒ¯èª¤ç‹€æ…‹
}

/**
 * 43. å°æ‡‰ 4.2ï¼šçµ±è¨ˆè¦–åœ–é¡å‹æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description çµ±è¨ˆè¦–åœ–é¡å‹
 */
enum StatisticsViewType {
  overview,    // ç¸½è¦½
  financial,   // è²¡å‹™çµ±è¨ˆ
  trends,      // è¶¨å‹¢åˆ†æ
  categories,  // åˆ†é¡åˆ†æ
  members,     // æˆå“¡çµ±è¨ˆ
  budgets,     // é ç®—åŸ·è¡Œ
}

/**
 * 44. å°æ‡‰ 4.2ï¼šåœ–è¡¨é¡å‹æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æ”¯æ´çš„åœ–è¡¨é¡å‹
 */
enum ChartType {
  line,        // æŠ˜ç·šåœ–
  bar,         // æ©«æ¢åœ–
  pie,         // åœ“é¤…åœ–
  area,        // é¢ç©åœ–
  donut,       // ç’°å½¢åœ–
  scatter,     // æ•£é»åœ–
}

/**
 * 45. å°æ‡‰ 4.2ï¼šçµ±è¨ˆéŒ¯èª¤é¡å‹æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description çµ±è¨ˆéŒ¯èª¤é¡å‹åˆ†é¡
 */
enum StatisticsErrorType {
  networkError,        // ç¶²è·¯éŒ¯èª¤
  dataNotFound,        // è³‡æ–™ä¸å­˜åœ¨
  accessDenied,        // å­˜å–è¢«æ‹’
  calculationError,    // è¨ˆç®—éŒ¯èª¤
  exportError,         // åŒ¯å‡ºéŒ¯èª¤
  unknown,            // æœªçŸ¥éŒ¯èª¤
}
```

---

## 5.0 APIæ•´åˆè¨­è¨ˆ

### 5.1 StatisticsApiService APIæœå‹™
```dart
/**
 * 46. å°æ‡‰ 5.1ï¼šçµ±è¨ˆé é¢APIæœå‹™
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è™•ç†çµ±è¨ˆé é¢ç›¸é—œçš„APIèª¿ç”¨ï¼Œæ”¯æ´F022å ±è¡¨ç”ŸæˆåŠŸèƒ½
 */
class StatisticsApiService {
  final ApiClient _apiClient = ApiClient();

  /**
   * 47. å°æ‡‰ 5.1ï¼šå–å¾—å¸³æœ¬çµ±è¨ˆæ‘˜è¦
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å–å¾—å¸³æœ¬è²¡å‹™çµ±è¨ˆæ‘˜è¦ï¼ˆå°æ‡‰F022ç«¯é»ï¼‰
   */
  Future<ApiResponse<FinancialSummary>> getLedgerStatistics(
    String ledgerId, 
    StatisticsRequest request
  );

  /**
   * 48. å°æ‡‰ 5.1ï¼šå–å¾—è¶¨å‹¢åˆ†æè³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å–å¾—æ™‚é–“åºåˆ—è¶¨å‹¢åˆ†æï¼ˆå°æ‡‰F022ç«¯é»ï¼‰
   */
  Future<ApiResponse<TrendAnalysis>> getTrendAnalysis(
    String ledgerId, 
    TrendAnalysisRequest request
  );

  /**
   * 49. å°æ‡‰ 5.1ï¼šå–å¾—åˆ†é¡çµ±è¨ˆ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å–å¾—ç§‘ç›®åˆ†é¡çµ±è¨ˆåˆ†æï¼ˆå°æ‡‰F022ç«¯é»ï¼‰
   */
  Future<ApiResponse<CategoryBreakdown>> getCategoryStatistics(
    String ledgerId, 
    CategoryStatsRequest request
  );

  /**
   * 50. å°æ‡‰ 5.1ï¼šå–å¾—æˆå“¡çµ±è¨ˆ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å–å¾—æˆå“¡æ´»å‹•çµ±è¨ˆåˆ†æï¼ˆå°æ‡‰F022ç«¯é»ï¼‰
   */
  Future<ApiResponse<MemberActivityStats>> getMemberStatistics(
    String ledgerId, 
    MemberStatsRequest request
  );

  /**
   * 51. å°æ‡‰ 5.1ï¼šåŒ¯å‡ºçµ±è¨ˆå ±è¡¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description åŒ¯å‡ºçµ±è¨ˆå ±è¡¨åˆ°æª”æ¡ˆï¼ˆå°æ‡‰F024ç«¯é»ï¼‰
   */
  Future<ApiResponse<ExportResponse>> exportStatistics(
    String ledgerId, 
    ExportRequest request
  );

  /**
   * 52. å°æ‡‰ 5.1ï¼šè™•ç†DioéŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†DioéŒ¯èª¤ä¸¦è½‰æ›ç‚ºä½¿ç”¨è€…å‹å–„è¨Šæ¯
   */
  String _handleDioError(DioError error);
}
```

### 5.2 è³‡æ–™æ¨¡å‹å®šç¾©
```dart
/**
 * 53. å°æ‡‰ 5.2ï¼šçµ±è¨ˆè«‹æ±‚æ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description çµ±è¨ˆAPIè«‹æ±‚è³‡æ–™çµæ§‹
 */
class StatisticsRequest {
  final String ledgerId;
  final DateRange dateRange;
  final List<String>? categoryIds;
  final List<String>? memberIds;
  final StatisticsViewType viewType;

  StatisticsRequest({
    required this.ledgerId,
    required this.dateRange,
    this.categoryIds,
    this.memberIds,
    required this.viewType,
  });

  Map<String, dynamic> toJson();
}

/**
 * 54. å°æ‡‰ 5.2ï¼šè²¡å‹™çµ±è¨ˆæ‘˜è¦æ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è²¡å‹™çµ±è¨ˆæ‘˜è¦è³‡æ–™çµæ§‹
 */
class FinancialSummary {
  final double totalIncome;
  final double totalExpense;
  final double netAmount;
  final double averageDaily;
  final int entryCount;
  final PeriodComparison? comparison;
  final List<TopCategory> topCategories;

  FinancialSummary({
    required this.totalIncome,
    required this.totalExpense,
    required this.netAmount,
    required this.averageDaily,
    required this.entryCount,
    this.comparison,
    required this.topCategories,
  });

  factory FinancialSummary.fromJson(Map<String, dynamic> json);
  Map<String, dynamic> toJson();
}

/**
 * 55. å°æ‡‰ 5.2ï¼šè¶¨å‹¢åˆ†ææ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è¶¨å‹¢åˆ†æè³‡æ–™çµæ§‹
 */
class TrendAnalysis {
  final List<TimeSeriesData> dailyTrend;
  final List<TimeSeriesData> monthlyTrend;
  final String trendDirection;
  final double growthRate;
  final List<TrendInsight> insights;

  TrendAnalysis({
    required this.dailyTrend,
    required this.monthlyTrend,
    required this.trendDirection,
    required this.growthRate,
    required this.insights,
  });

  factory TrendAnalysis.fromJson(Map<String, dynamic> json);
  Map<String, dynamic> toJson();
}
```

---

## 6.0 å°èˆªè·¯ç”±è¨­è¨ˆ

### 6.1 è·¯ç”±é…ç½®
```dart
/**
 * 56. å°æ‡‰ 6.1ï¼šçµ±è¨ˆé é¢è·¯ç”±é…ç½®
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å®šç¾©çµ±è¨ˆé é¢çš„è·¯ç”±è¦å‰‡èˆ‡å°èˆªé‚è¼¯
 */
class StatisticsRoutes {
  static const String statistics = '/ledger/:ledgerId/statistics';
  static const String categoryDetail = '/statistics/category/:categoryId';
  static const String memberDetail = '/statistics/member/:memberId';
  static const String budgetDetail = '/statistics/budget/:budgetId';

  /**
   * 57. å°æ‡‰ 6.1ï¼šå–å¾—çµ±è¨ˆé é¢è·¯ç”±
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹çµ±è¨ˆé é¢çš„GoRouteé…ç½®
   */
  static GoRoute getStatisticsRoute();
}

/**
 * 58. å°æ‡‰ 6.1ï¼šçµ±è¨ˆå°èˆªæœå‹™
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è™•ç†çµ±è¨ˆç›¸é—œçš„å°èˆªé‚è¼¯
 */
class StatisticsNavigationService {
  static final GoRouter _router;
  static GoRouter get router;

  /**
   * 59. å°æ‡‰ 6.1ï¼šå°èˆªåˆ°åˆ†é¡è©³æƒ…
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å°èˆªåˆ°åˆ†é¡çµ±è¨ˆè©³æƒ…é é¢
   */
  Future<void> navigateToCategoryDetail(String categoryId);

  /**
   * 60. å°æ‡‰ 6.1ï¼šå°èˆªåˆ°æˆå“¡è©³æƒ…
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å°èˆªåˆ°æˆå“¡çµ±è¨ˆè©³æƒ…é é¢
   */
  Future<void> navigateToMemberDetail(String memberId);

  /**
   * 61. å°æ‡‰ 6.1ï¼šå°èˆªåˆ°å ±è¡¨ä¸­å¿ƒ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å°èˆªåˆ°å ±è¡¨ä¸­å¿ƒé é¢
   */
  Future<void> navigateToReportCenter();

  /**
   * 62. å°æ‡‰ 6.1ï¼šè¿”å›å¸³æœ¬è©³æƒ…
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¿”å›åˆ°å¸³æœ¬è©³æƒ…é é¢
   */
  void navigateBackToLedger();
}
```

---

## 7.0 éŸ¿æ‡‰å¼è¨­è¨ˆ

### 7.1 éŸ¿æ‡‰å¼è¼”åŠ©å·¥å…·
```dart
/**
 * 63. å°æ‡‰ 7.1ï¼šçµ±è¨ˆé é¢éŸ¿æ‡‰å¼è¨­è¨ˆè¼”åŠ©å·¥å…·
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description éµå¾ª9005æ–‡ä»¶çš„éŸ¿æ‡‰å¼è¨­è¨ˆè¦ç¯„ï¼Œæä¾›çµ±è¨ˆé é¢å°ˆç”¨çš„ä½ˆå±€ç®¡ç†
 */
class StatisticsResponsiveHelper {
  final BuildContext context;
  late final MediaQueryData _mediaQuery;
  late final Size _screenSize;

  StatisticsResponsiveHelper.of(BuildContext context);

  // æ–·é»åˆ¤æ–·å±¬æ€§ï¼ˆ9005è¦ç¯„ï¼‰
  bool get isMobile;
  bool get isTablet;
  bool get isSmallDesktop;
  bool get isLargeDesktop;
  DeviceType get deviceType;

  // çµ±è¨ˆé é¢å°ˆç”¨å°ºå¯¸å±¬æ€§
  double get chartHeight;
  double get summaryCardWidth;
  double get summaryCardHeight;
  int get gridColumns;
  EdgeInsets get chartPadding;
  double get legendSize;

  /**
   * 64. å°æ‡‰ 7.1ï¼šå–å¾—å››æ¨¡å¼åœ–è¡¨å°ºå¯¸
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼å’Œè£ç½®é¡å‹è¿”å›é©ç•¶åœ–è¡¨å°ºå¯¸
   */
  Size getChartSizeForMode(UserMode? mode);

  /**
   * 65. å°æ‡‰ 7.1ï¼šå–å¾—æ¨¡å¼å°æ‡‰ä½ˆå±€é…ç½®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼è¿”å›é©ç•¶ä½ˆå±€é…ç½®
   */
  StatisticsLayoutConfig getLayoutConfigForMode(UserMode? mode);
}
```

---

## 8.0 ç„¡éšœç¤™åŠŸèƒ½

### 8.1 èªæ„åŒ–æ”¯æ´
```dart
/**
 * 66. å°æ‡‰ 8.1ï¼šçµ±è¨ˆé é¢ç„¡éšœç¤™èªæ„åŒ–WidgetåŒ…è£å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æä¾›WCAG 2.1 AAæ¨™æº–çš„å®Œæ•´ç„¡éšœç¤™æ”¯æ´ï¼ˆ9005è¦ç¯„ï¼‰
 */
class StatisticsAccessibilityWrapper {

  /**
   * 67. å°æ‡‰ 8.1ï¼šç‚ºçµ±è¨ˆåœ–è¡¨æä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç‚ºå„ç¨®çµ±è¨ˆåœ–è¡¨æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapChart(Widget child, ChartType type, String description);

  /**
   * 68. å°æ‡‰ 8.1ï¼šç‚ºçµ±è¨ˆæ•¸æ“šæä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç‚ºçµ±è¨ˆæ•¸æ“šå’Œæ‘˜è¦æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapStatisticsData(Widget child, String label, String value);

  /**
   * 69. å°æ‡‰ 8.1ï¼šç‚ºç¯©é¸å™¨æä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç‚ºç¯©é¸é¸é …æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapFilterOption(Widget child, String filterType, bool isSelected);
}
```

---

## 9.0 æ•ˆèƒ½æœ€ä½³åŒ–

### 9.1 Widgetå¿«å–ç­–ç•¥
```dart
/**
 * 70. å°æ‡‰ 9.1ï¼šçµ±è¨ˆé é¢Widgetå¿«å–ç®¡ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å„ªåŒ–çµ±è¨ˆé é¢Widgeté‡å»ºæ•ˆèƒ½ï¼Œæ¸›å°‘ä¸å¿…è¦çš„é‡å»º
 */
class StatisticsWidgetCache {
  static final Map<String, Widget> _cache = {};
  static final Map<String, DateTime> _cacheTimestamps = {};
  static const Duration _cacheValidDuration = Duration(minutes: 10);

  /**
   * 71. å°æ‡‰ 9.1ï¼šå–å¾—å¿«å–çš„åœ–è¡¨æˆ–å»ºç«‹æ–°çš„
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å¾å¿«å–ä¸­ç²å–åœ–è¡¨Widgetæˆ–å‰µå»ºæ–°çš„
   */
  static Widget getChartOrCreate(
    String key, 
    ChartType type, 
    Widget Function() creator
  );

  /**
   * 72. å°æ‡‰ 9.1ï¼šæ¸…é™¤çµ±è¨ˆé é¢å¿«å–
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ¸…é™¤çµ±è¨ˆé é¢ç›¸é—œçš„Widgetå¿«å–
   */
  static void clearStatisticsCache();
}

/**
 * 73. å°æ‡‰ 9.1ï¼šçµ±è¨ˆè³‡æ–™å¿«å–ç®¡ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description ç®¡ç†çµ±è¨ˆè³‡æ–™çš„å¿«å–ç­–ç•¥
 */
class StatisticsDataCache {
  static final Map<String, dynamic> _dataCache = {};
  static final Map<String, DateTime> _cacheTimestamps = {};
  static const Duration _dataValidDuration = Duration(minutes: 5);

  /**
   * 74. å°æ‡‰ 9.1ï¼šå¿«å–çµ±è¨ˆè³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å¿«å–çµ±è¨ˆè³‡æ–™ä»¥æ¸›å°‘é‡è¤‡è«‹æ±‚
   */
  static void cacheData(String key, dynamic data);

  /**
   * 75. å°æ‡‰ 9.1ï¼šå–å¾—å¿«å–çš„çµ±è¨ˆè³‡æ–™
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å¾å¿«å–ä¸­ç²å–çµ±è¨ˆè³‡æ–™
   */
  static T? getCachedData<T>(String key);
}
```

---

## 10.0 éŒ¯èª¤è™•ç†æ©Ÿåˆ¶

### 10.1 çµ±ä¸€éŒ¯èª¤è™•ç†
```dart
/**
 * 76. å°æ‡‰ 10.1ï¼šçµ±è¨ˆé é¢éŒ¯èª¤è™•ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æ ¹æ“šP024è¦ç¯„çš„å…·é«”éŒ¯èª¤æƒ…å¢ƒé€²è¡Œè©³ç´°è™•ç†
 */
class StatisticsErrorHandler {

  /**
   * 77. å°æ‡‰ 10.1ï¼šè™•ç†çµ±è¨ˆè¼‰å…¥éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†çµ±è¨ˆè³‡æ–™è¼‰å…¥éŒ¯èª¤ï¼ˆP024è¦ç¯„ï¼‰
   */
  static String handleStatisticsLoadError(dynamic error);

  /**
   * 78. å°æ‡‰ 10.1ï¼šè™•ç†åœ–è¡¨æ¸²æŸ“éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†åœ–è¡¨æ¸²æŸ“éŒ¯èª¤ï¼ˆP024è¦ç¯„ï¼‰
   */
  static String handleChartRenderError(dynamic error, ChartType chartType);

  /**
   * 79. å°æ‡‰ 10.1ï¼šè™•ç†åŒ¯å‡ºéŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†çµ±è¨ˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤ï¼ˆP024è¦ç¯„ï¼‰
   */
  static String handleExportError(dynamic error, ExportFormat format);

  /**
   * 80. å°æ‡‰ 10.1ï¼šé¡¯ç¤ºéŒ¯èª¤å°è©±æ¡†
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯å°è©±æ¡†ï¼ˆP024è¦ç¯„ï¼‰
   */
  static Future<void> showErrorDialog(
    BuildContext context, 
    String message, 
    StatisticsErrorType errorType,
    {VoidCallback? onRetry, VoidCallback? onDismiss}
  );
}
```

---

## éµå¾ª0055è¨­è¨ˆåŸå‰‡

### éšå±¤æ¶æ§‹å°æ‡‰
- æœ¬TDDæ–‡ä»¶åŸºæ–¼P024_å¸³æœ¬çµ±è¨ˆé é¢_SRS.mdçš„éœ€æ±‚è¦æ ¼
- èˆ‡9005. Flutter_Presentation layer.mdçš„ç”¢å“è¦æ ¼ä¿æŒä¸€è‡´
- æ‰€æœ‰å‡½æ•¸ç¯€é»ç·¨è™Ÿå°æ‡‰ä¸Šå±¤æ–‡ä»¶çš„åŠŸèƒ½æ¢ç›®

### è¨­è¨ˆåŸå‰‡éµå¾ª
1. **éšå±¤æ¶æ§‹é‚è¼¯**: åš´æ ¼åŸºæ–¼SRSæ–‡ä»¶å®šç¾©çš„åŠŸèƒ½æ¢ç›®è¨­è¨ˆ
2. **åŒå±¤ç´šä¾è³´é—œä¿‚**: è€ƒé‡èˆ‡å¸³æœ¬è©³æƒ…é é¢å’Œå ±è¡¨ä¸­å¿ƒçš„ä¾è³´é—œä¿‚
3. **ä»£ç¢¼ç¯€é»ç·¨è™Ÿ**: æ¡ç”¨ä¸åŠ å‰ç¶´çš„ç¯€é»ç·¨è™Ÿæ ¼å¼ï¼ˆå¦‚2.1ã€3.2ï¼‰
4. **å‘½åä¸€è‡´æ€§**: ä¿æŒèˆ‡ä½¿ç”¨è€…ä»‹é¢æ“ä½œæµç¨‹çš„åç¨±åŒæ­¥
5. **å¯è®€æ€§è¨­è¨ˆ**: æ¡ç”¨æ¨¡çµ„åŒ–è¨­è¨ˆï¼Œéµå¾ªä½è€¦åˆã€é«˜å…§èšåŸå‰‡

## æ–‡ä»¶ç¶­è­·è¨˜éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®æ”¹è€… | ä¿®æ”¹å…§å®¹ |
|------|------|--------|----------|
| **v1.0.0** | **2025-01-26 18:30:00 +08:00** | **LCAS SA Team** | **åˆç‰ˆå»ºç«‹ï¼šå®Œæ•´P024å¸³æœ¬çµ±è¨ˆé é¢TDDè¦æ ¼ï¼Œæ”¯æ´å¤šç¶­åº¦çµ±è¨ˆåˆ†æï¼ˆè²¡å‹™æ‘˜è¦ã€è¶¨å‹¢åˆ†æã€åˆ†é¡çµ±è¨ˆã€æˆå“¡è²¢ç»ã€é ç®—åŸ·è¡Œï¼‰ï¼Œå¯¦ä½œåœ–è¡¨è¦–è¦ºåŒ–ï¼ˆæŠ˜ç·šåœ–ã€åœ“é¤…åœ–ã€æ©«æ¢åœ–ï¼‰ï¼Œå®Œæ•´éŒ¯èª¤è™•ç†æ©Ÿåˆ¶ï¼Œéµå¾ª0055è¨­è¨ˆåŸå‰‡ï¼Œå°æ‡‰P024 SRSè¦æ ¼** |

---

## å‚™è¨»

- **ç´”å‡½æ•¸å®£å‘Š**: å®Œå…¨ç§»é™¤æ‰€æœ‰å¯¦ä½œä»£ç¢¼ï¼Œåƒ…ä¿ç•™å‡½æ•¸åç¨±ã€åƒæ•¸å®šç¾©å’Œè¨»è§£
- **å¤šç¶­åº¦çµ±è¨ˆæ”¯æ´**: æ”¯æ´è²¡å‹™æ‘˜è¦ã€è¶¨å‹¢åˆ†æã€åˆ†é¡çµ±è¨ˆã€æˆå“¡è²¢ç»ã€é ç®—åŸ·è¡Œç­‰å®Œæ•´çµ±è¨ˆåŠŸèƒ½
- **å››æ¨¡å¼å·®ç•°åŒ–**: æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼æä¾›ä¸åŒçš„çµ±è¨ˆç•Œé¢è¤‡é›œåº¦å’Œåˆ†ææ·±åº¦
- **åœ–è¡¨è¦–è¦ºåŒ–**: å®Œæ•´çš„æŠ˜ç·šåœ–ã€åœ“é¤…åœ–ã€æ©«æ¢åœ–ã€é¢ç©åœ–ç­‰åœ–è¡¨æ”¯æ´èˆ‡äº’å‹•åŠŸèƒ½
- **å®Œæ•´æŠ€è¡“æ¶æ§‹**: Widgetåˆ†å±¤ã€ç‹€æ…‹ç®¡ç†ã€APIæ•´åˆã€éŸ¿æ‡‰å¼è¨­è¨ˆã€ç„¡éšœç¤™æ”¯æ´ã€æ•ˆèƒ½æœ€ä½³åŒ–
- **è¦ç¯„å®Œå…¨å°é½Š**: èˆ‡0055ã€P024ã€9005æ–‡ä»¶å®Œå…¨ä¸€è‡´
- **ç¯€é»ç·¨è™Ÿæ¨™æº–åŒ–**: çµ±ä¸€ç·¨è™Ÿ01-80ï¼Œéµå¾ª0055è¦ç¯„æ ¼å¼
- **ç‰ˆæœ¬çµ±ä¸€å‡ç´š**: æ‰€æœ‰çµ„ä»¶ç‰ˆæœ¬çµ±ä¸€ç‚ºv1.0.0
