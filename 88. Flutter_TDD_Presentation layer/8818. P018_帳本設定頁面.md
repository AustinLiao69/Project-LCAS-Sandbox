
# 8818. TDD_P018_å¸³æœ¬è¨­å®šé é¢_v1.0.0

## æ–‡ä»¶è³‡è¨Š
- **æ–‡ä»¶æ¨™é¡Œ**: P018 å¸³æœ¬è¨­å®šé é¢æŠ€è¡“è¨­è¨ˆæ–‡ä»¶
- **æ–‡ä»¶ç‰ˆæœ¬**: v1.0.0
- **å‰µå»ºæ—¥æœŸ**: 2025-01-26 18:30:00 +08:00 (å°ç£æ™‚é–“)
- **å‰µå»ºè€…**: LCAS SA Team
- **æœ€å¾Œæ›´æ–°**: 2025-01-26 18:30:00 +08:00 (å°ç£æ™‚é–“)
- **å°æ‡‰éœ€æ±‚æ–‡ä»¶**: P018_å¸³æœ¬è¨­å®šé é¢_SRS.md
- **å°æ‡‰PRDæ–‡ä»¶**: 9005. Flutter_Presentation layer.md
- **é é¢ä»£ç¢¼**: P018 (Ledger Settings Page)

---

## ğŸ“‘ ç›®æ¬¡ (Table of Contents)

1. [æŠ€è¡“æ¶æ§‹æ¦‚è¿°](#10-æŠ€è¡“æ¶æ§‹æ¦‚è¿°)
2. [Widgetæ¸…å–®](#20-widgetæ¸…å–®)
3. [æ ¸å¿ƒWidgetè¨­è¨ˆ](#30-æ ¸å¿ƒwidgetè¨­è¨ˆ)
4. [ç‹€æ…‹ç®¡ç†æ¶æ§‹](#40-ç‹€æ…‹ç®¡ç†æ¶æ§‹)
5. [APIæ•´åˆè¨­è¨ˆ](#50-apiæ•´åˆè¨­è¨ˆ)
6. [å°èˆªè·¯ç”±è¨­è¨ˆ](#60-å°èˆªè·¯ç”±è¨­è¨ˆ)
7. [éŸ¿æ‡‰å¼è¨­è¨ˆ](#70-éŸ¿æ‡‰å¼è¨­è¨ˆ)
8. [ç„¡éšœç¤™åŠŸèƒ½](#80-ç„¡éšœç¤™åŠŸèƒ½)
9. [æ•ˆèƒ½æœ€ä½³åŒ–](#90-æ•ˆèƒ½æœ€ä½³åŒ–)
10. [éŒ¯èª¤è™•ç†æ©Ÿåˆ¶](#100-éŒ¯èª¤è™•ç†æ©Ÿåˆ¶)

---

## 1.0 æŠ€è¡“æ¶æ§‹æ¦‚è¿°

### 1.1 æ¨¡çµ„å®šä½
P018å¸³æœ¬è¨­å®šé é¢ä½œç‚ºLCAS 2.0 Flutteræ‡‰ç”¨ç¨‹å¼çš„å¸³æœ¬ç®¡ç†ä¸­å¿ƒï¼Œè² è²¬å¸³æœ¬åŸºæœ¬è³‡è¨Šä¿®æ”¹ã€æˆå“¡æ¬Šé™ç®¡ç†ã€é€²éšåŠŸèƒ½è¨­å®šã€å®‰å…¨æ€§é…ç½®ï¼Œä»¥åŠå¸³æœ¬ç”Ÿå‘½é€±æœŸç®¡ç†ã€‚æœ¬é é¢æ¡ç”¨Clean Architectureè¨­è¨ˆï¼Œç¢ºä¿åŠŸèƒ½å®Œæ•´æ€§èˆ‡å®‰å…¨æ€§ã€‚

### 1.2 æŠ€è¡“å †ç–Š
- **å‰ç«¯æ¡†æ¶**: Flutter 3.x
- **ç‹€æ…‹ç®¡ç†**: Provider + ChangeNotifier
- **è·¯ç”±ç®¡ç†**: GoRouter
- **HTTPå®¢æˆ¶ç«¯**: Dio
- **æœ¬åœ°å„²å­˜**: SharedPreferences + FlutterSecureStorage
- **è¡¨å–®é©—è­‰**: FormBuilderValidators
- **æ¬Šé™ç®¡ç†**: permission_handler
- **æª”æ¡ˆé¸æ“‡**: file_picker

### 1.3 æ¨¡çµ„æ¶æ§‹
```dart
/**
 * P018_å¸³æœ¬è¨­å®šé é¢_1.0.0
 * @module P018å¸³æœ¬è¨­å®šé é¢
 * @description Flutter Presentation Layerå¸³æœ¬è¨­å®šç®¡ç†é é¢ - å®Œæ•´è¨­å®šç®¡ç†ã€æˆå“¡æ¬Šé™ã€å®‰å…¨é…ç½®ã€ç”Ÿå‘½é€±æœŸç®¡ç†
 * @update 2025-01-26: å‡ç´šè‡³v1.0ç‰ˆæœ¬ï¼Œæ–°å¢å®Œæ•´å¸³æœ¬è¨­å®šåŠŸèƒ½è¨­è¨ˆï¼Œæ”¯æ´åŸºæœ¬è³‡è¨Šã€æˆå“¡ç®¡ç†ã€é€²éšè¨­å®šã€å®‰å…¨æ€§é…ç½®
 */
```

---

## 2.0 Widgetæ¸…å–®

### 2.1 å®Œæ•´Widgetç´¢å¼•è¡¨

| # | Widgetåç¨± | ç‰ˆæœ¬ | æ‰€å±¬å±¤ç´š | åŠŸèƒ½æè¿° | ç›¸ä¾çµ„ä»¶ |
|---|------------|------|----------|----------|----------|
| 01 | LedgerSettingsPage | V1.0.0 | é é¢å®¹å™¨å±¤ | ä¸»è¨­å®šé é¢å®¹å™¨åŠç”Ÿå‘½é€±æœŸç®¡ç† | LedgerSettingsProviderã€Router |
| 02 | SettingsScaffold | V1.0.0 | ä½ˆå±€çµæ§‹å±¤ | åŸºç¤é é¢çµæ§‹èˆ‡å°èˆªè¨­å®š | SettingsAppBarã€SettingsTabBar |
| 03 | SettingsAppBar | V1.0.0 | å°èˆªåˆ—å±¤ | è¨­å®šé é¢é ‚éƒ¨å°èˆªåˆ— | BackButtonã€SaveButton |
| 04 | SettingsTabBar | V1.0.0 | åˆ†é å°èˆªå±¤ | è¨­å®šåˆ†é¡åˆ†é å°èˆª | BasicInfoTabã€MembersTab |
| 05 | BasicInfoTab | V1.0.0 | åŸºæœ¬è¨­å®šå±¤ | å¸³æœ¬åŸºæœ¬è³‡è¨Šè¨­å®šå€å¡Š | BasicInfoFormã€IconSelector |
| 06 | BasicInfoForm | V1.0.0 | è¡¨å–®å±¤ | åŸºæœ¬è³‡è¨Šç·¨è¼¯è¡¨å–® | NameInputã€DescriptionInput |
| 07 | NameInput | V1.0.0 | è¼¸å…¥å…ƒä»¶å±¤ | å¸³æœ¬åç¨±è¼¸å…¥æ¬„ä½ | TextFormFieldã€Validator |
| 08 | DescriptionInput | V1.0.0 | è¼¸å…¥å…ƒä»¶å±¤ | å¸³æœ¬æè¿°è¼¸å…¥æ¬„ä½ | TextFormFieldã€Validator |
| 09 | IconSelector | V1.0.0 | é¸æ“‡å™¨å±¤ | å¸³æœ¬åœ–ç¤ºé¸æ“‡å™¨ | GridViewã€IconButton |
| 10 | ColorThemeSelector | V1.0.0 | é¸æ“‡å™¨å±¤ | ä¸»é¡Œè‰²å½©é¸æ“‡å™¨ | ColorPickerã€ThemePreview |
| 11 | CurrencySelector | V1.0.0 | é¸æ“‡å™¨å±¤ | é è¨­è²¨å¹£é¸æ“‡å™¨ | DropdownButtonã€CurrencyList |
| 12 | MembersTab | V1.0.0 | æˆå“¡ç®¡ç†å±¤ | æˆå“¡ç®¡ç†åˆ†é å€å¡Š | MembersListã€InviteButton |
| 13 | MembersList | V1.0.0 | æ¸…å–®å±¤ | æˆå“¡æ¸…å–®é¡¯ç¤º | MemberCardã€PendingInvitation |
| 14 | MemberCard | V1.0.0 | å¡ç‰‡å±¤ | æˆå“¡è³‡è¨Šå¡ç‰‡ | Avatarã€RoleChipã€ActionMenu |
| 15 | RoleChip | V1.0.0 | ç‹€æ…‹å…ƒä»¶å±¤ | æˆå“¡è§’è‰²æ¨™ç±¤ | Chipã€RoleColor |
| 16 | MemberActionMenu | V1.0.0 | é¸å–®å±¤ | æˆå“¡æ“ä½œé¸å–® | PopupMenuButtonã€MenuItem |
| 17 | InviteButton | V1.0.0 | å‹•ä½œå…ƒä»¶å±¤ | é‚€è«‹æˆå“¡æŒ‰éˆ• | FloatingActionButtonã€InviteDialog |
| 18 | InviteDialog | V1.0.0 | å°è©±æ¡†å±¤ | é‚€è«‹æˆå“¡å°è©±æ¡† | EmailInputã€RoleSelector |
| 19 | PendingInvitation | V1.0.0 | ç‹€æ…‹å¡ç‰‡å±¤ | å¾…è™•ç†é‚€è«‹å¡ç‰‡ | Cardã€StatusIndicator |
| 20 | AdvancedTab | V1.0.0 | é€²éšè¨­å®šå±¤ | é€²éšåŠŸèƒ½è¨­å®šå€å¡Š | BudgetSettingsã€NotificationSettings |
| 21 | BudgetSettings | V1.0.0 | é ç®—è¨­å®šå±¤ | é ç®—ç›¸é—œè¨­å®š | BudgetFormã€RulesList |
| 22 | NotificationSettings | V1.0.0 | é€šçŸ¥è¨­å®šå±¤ | æé†’é€šçŸ¥è¨­å®š | NotificationFormã€PreferencesList |
| 23 | CategorySettings | V1.0.0 | ç§‘ç›®è¨­å®šå±¤ | ç§‘ç›®åˆ†é¡è¨­å®š | CategoryManagerã€DefaultCategories |
| 24 | SecurityTab | V1.0.0 | å®‰å…¨è¨­å®šå±¤ | å®‰å…¨æ€§èˆ‡éš±ç§è¨­å®šå€å¡Š | PrivacySettingsã€AccessControl |
| 25 | PrivacySettings | V1.0.0 | éš±ç§è¨­å®šå±¤ | éš±ç§ç­‰ç´šè¨­å®š | PrivacySelectorã€PermissionMatrix |
| 26 | AccessControl | V1.0.0 | å­˜å–æ§åˆ¶å±¤ | å­˜å–æ¬Šé™æ§åˆ¶ | AccessFormã€RestrictionList |
| 27 | DataEncryption | V1.0.0 | åŠ å¯†è¨­å®šå±¤ | è³‡æ–™åŠ å¯†è¨­å®š | EncryptionToggleã€SecurityWarning |
| 28 | ManagementTab | V1.0.0 | ç®¡ç†åŠŸèƒ½å±¤ | å¸³æœ¬ç”Ÿå‘½é€±æœŸç®¡ç†å€å¡Š | TransferOwnershipã€ArchiveLedger |
| 29 | TransferOwnership | V1.0.0 | è½‰ç§»æ“æœ‰æ¬Šå±¤ | æ“æœ‰æ¬Šè½‰ç§»åŠŸèƒ½ | OwnerSelectorã€ConfirmDialog |
| 30 | ArchiveLedger | V1.0.0 | æ­¸æª”åŠŸèƒ½å±¤ | å¸³æœ¬æ­¸æª”åŠŸèƒ½ | ArchiveButtonã€ArchiveDialog |
| 31 | DeleteLedger | V1.0.0 | åˆªé™¤åŠŸèƒ½å±¤ | å¸³æœ¬åˆªé™¤åŠŸèƒ½ | DeleteButtonã€DeleteConfirmation |
| 32 | SaveButton | V1.0.0 | å„²å­˜å…ƒä»¶å±¤ | è¨­å®šå„²å­˜æŒ‰éˆ• | ElevatedButtonã€LoadingIndicator |
| 33 | ChangeTracker | V1.0.0 | è®Šæ›´è¿½è¹¤å±¤ | è¨­å®šè®Šæ›´è¿½è¹¤ | ChangeIndicatorã€UnsavedWarning |
| 34 | ValidationIndicator | V1.0.0 | é©—è­‰æŒ‡ç¤ºå±¤ | è¡¨å–®é©—è­‰ç‹€æ…‹æŒ‡ç¤º | Iconã€ValidationMessage |
| 35 | LoadingOverlay | V1.0.0 | è¼‰å…¥ç‹€æ…‹å±¤ | è¨­å®šè¼‰å…¥è¦†è“‹å±¤ | CircularProgressIndicatorã€Backdrop |

---

## 3.0 æ ¸å¿ƒWidgetè¨­è¨ˆ

### 3.1 é é¢å®¹å™¨å±¤Widget

#### 3.1.1 LedgerSettingsPage Widget
```dart
/**
 * 01. å°æ‡‰ 2.1ï¼šä¸»è¨­å®šé é¢å®¹å™¨Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å¸³æœ¬è¨­å®šé é¢çš„ä¸»å®¹å™¨ï¼Œæ”¯æ´å®Œæ•´è¨­å®šç®¡ç†èˆ‡å››æ¨¡å¼å·®ç•°åŒ–
 */
class LedgerSettingsPage extends StatefulWidget {
  static const String routeName = '/ledger-settings';
  final String ledgerId;
  final String? initialTab;
  final UserMode? userMode;

  const LedgerSettingsPage({
    Key? key,
    required this.ledgerId,
    this.initialTab,
    this.userMode,
  });

  @override
  State<LedgerSettingsPage> createState();
}

/**
 * 02. å°æ‡‰ 2.1ï¼šè¨­å®šé é¢ç‹€æ…‹é¡åˆ¥
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description ç®¡ç†è¨­å®šé é¢çš„ç‹€æ…‹å’Œåˆ†é æ§åˆ¶å™¨
 */
class _LedgerSettingsPageState extends State<LedgerSettingsPage>
    with TickerProviderStateMixin {
  late TabController _tabController;
  late ScrollController _scrollController;
  final GlobalKey<FormState> _formKey = GlobalKey<FormState>();

  @override
  void initState();

  /**
   * 03. å°æ‡‰ 2.1ï¼šåˆå§‹åŒ–åˆ†é æ§åˆ¶å™¨
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¨­å®šåˆ†é æ§åˆ¶å™¨èˆ‡åˆå§‹åˆ†é 
   */
  void _initializeTabController();

  /**
   * 04. å°æ‡‰ 2.1ï¼šåˆå§‹åŒ–è¨­å®šé é¢
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¼‰å…¥å¸³æœ¬è¨­å®šè³‡æ–™ä¸¦åˆå§‹åŒ–ç‹€æ…‹
   */
  Future<void> _initializeSettings();

  @override
  Widget build(BuildContext context);

  @override
  void dispose();
}
```

### 3.2 ä½ˆå±€çµæ§‹å±¤Widget

#### 3.2.1 SettingsScaffold Widget
```dart
/**
 * 05. å°æ‡‰ 2.2ï¼šè¨­å®šé é¢ä½ˆå±€çµæ§‹Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æä¾›è¨­å®šé é¢çš„åŸºç¤ä½ˆå±€çµæ§‹ï¼Œæ”¯æ´å››æ¨¡å¼å·®ç•°åŒ–ç•Œé¢
 */
class SettingsScaffold extends StatelessWidget {
  final TabController tabController;
  final ScrollController scrollController;
  final GlobalKey<FormState> formKey;
  final LedgerSettingsProvider provider;
  final UserMode? userMode;

  const SettingsScaffold({
    Key? key,
    required this.tabController,
    required this.scrollController,
    required this.formKey,
    required this.provider,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 06. å°æ‡‰ 2.2ï¼šå»ºç«‹è¨­å®šå…§å®¹å€åŸŸ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šç•¶å‰åˆ†é å»ºç«‹å°æ‡‰çš„è¨­å®šå…§å®¹å€åŸŸ
   */
  Widget _buildSettingsContent(BuildContext context);
}
```

#### 3.2.2 SettingsAppBar Widget
```dart
/**
 * 07. å°æ‡‰ 2.2ï¼šè¨­å®šé é¢å°èˆªåˆ—Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è¨­å®šé é¢é ‚éƒ¨å°èˆªåˆ—ï¼ŒåŒ…å«è¿”å›æŒ‰éˆ•å’Œå„²å­˜æŒ‰éˆ•
 */
class SettingsAppBar extends StatelessWidget implements PreferredSizeWidget {
  final LedgerSettingsProvider provider;
  final VoidCallback? onSave;
  final bool hasChanges;

  const SettingsAppBar({
    Key? key,
    required this.provider,
    this.onSave,
    this.hasChanges = false,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 08. å°æ‡‰ 2.2ï¼šå»ºç«‹å„²å­˜æŒ‰éˆ•
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šè®Šæ›´ç‹€æ…‹é¡¯ç¤ºå„²å­˜æŒ‰éˆ•
   */
  Widget _buildSaveButton(BuildContext context);

  @override
  Size get preferredSize;
}
```

### 3.3 åˆ†é å°èˆªå±¤Widget

#### 3.3.1 SettingsTabBar Widget
```dart
/**
 * 09. å°æ‡‰ 3.1ï¼šè¨­å®šåˆ†é å°èˆªWidget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è¨­å®šé é¢åˆ†é å°èˆªï¼Œæ”¯æ´åŸºæœ¬è³‡è¨Šã€æˆå“¡ç®¡ç†ã€é€²éšè¨­å®šã€å®‰å…¨æ€§
 */
class SettingsTabBar extends StatelessWidget {
  final TabController controller;
  final UserMode? userMode;
  final String currentUserId;
  final UserRole currentUserRole;

  const SettingsTabBar({
    Key? key,
    required this.controller,
    this.userMode,
    required this.currentUserId,
    required this.currentUserRole,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 10. å°æ‡‰ 3.1ï¼šå–å¾—å¯ç”¨åˆ†é æ¸…å–®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¬Šé™å’Œæ¨¡å¼è¿”å›å¯ç”¨çš„è¨­å®šåˆ†é 
   */
  List<SettingsTab> _getAvailableTabs();

  /**
   * 11. å°æ‡‰ 3.1ï¼šå»ºç«‹åˆ†é æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹è¨­å®šåˆ†é çš„æ¨™ç±¤é …ç›®
   */
  Widget _buildTabItem(SettingsTab tab, BuildContext context);
}
```

### 3.4 åŸºæœ¬è¨­å®šå±¤Widget

#### 3.4.1 BasicInfoTab Widget
```dart
/**
 * 12. å°æ‡‰ 3.2ï¼šåŸºæœ¬è³‡è¨Šè¨­å®šåˆ†é Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å¸³æœ¬åŸºæœ¬è³‡è¨Šè¨­å®šå€å¡Šï¼ŒåŒ…å«åç¨±ã€æè¿°ã€åœ–ç¤ºã€ä¸»é¡Œè¨­å®š
 */
class BasicInfoTab extends StatelessWidget {
  final LedgerSettingsProvider provider;
  final GlobalKey<FormState> formKey;
  final UserMode? userMode;

  const BasicInfoTab({
    Key? key,
    required this.provider,
    required this.formKey,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 13. å°æ‡‰ 3.2ï¼šå»ºç«‹åŸºæœ¬è³‡è¨Šè¡¨å–®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹åŒ…å«æ‰€æœ‰åŸºæœ¬è³‡è¨Šæ¬„ä½çš„è¡¨å–®
   */
  Widget _buildBasicInfoForm(BuildContext context);
}
```

#### 3.4.2 BasicInfoForm Widget
```dart
/**
 * 14. å°æ‡‰ 3.2ï¼šåŸºæœ¬è³‡è¨Šç·¨è¼¯è¡¨å–®Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description åŸºæœ¬è³‡è¨Šçš„ç·¨è¼¯è¡¨å–®ï¼Œæ”¯æ´å³æ™‚é©—è­‰å’Œé è¦½
 */
class BasicInfoForm extends StatefulWidget {
  final LedgerSettingsProvider provider;
  final GlobalKey<FormState> formKey;

  const BasicInfoForm({
    Key? key,
    required this.provider,
    required this.formKey,
  });

  @override
  State<BasicInfoForm> createState();
}

class _BasicInfoFormState extends State<BasicInfoForm> {
  late TextEditingController _nameController;
  late TextEditingController _descriptionController;

  @override
  void initState();

  @override
  Widget build(BuildContext context);

  /**
   * 15. å°æ‡‰ 3.2ï¼šé©—è­‰åŸºæœ¬è³‡è¨Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description é©—è­‰å¸³æœ¬åç¨±å’Œæè¿°çš„æ ¼å¼èˆ‡è¦å‰‡
   */
  String? _validateBasicInfo(String? value, String fieldType);

  @override
  void dispose();
}
```

### 3.5 æˆå“¡ç®¡ç†å±¤Widget

#### 3.5.1 MembersTab Widget
```dart
/**
 * 16. å°æ‡‰ 3.3ï¼šæˆå“¡ç®¡ç†åˆ†é Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æˆå“¡ç®¡ç†åˆ†é å€å¡Šï¼Œæ”¯æ´æˆå“¡æ¸…å–®ã€æ¬Šé™ç®¡ç†ã€é‚€è«‹åŠŸèƒ½
 */
class MembersTab extends StatelessWidget {
  final LedgerSettingsProvider provider;
  final UserMode? userMode;

  const MembersTab({
    Key? key,
    required this.provider,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 17. å°æ‡‰ 3.3ï¼šå»ºç«‹æˆå“¡ç®¡ç†å€åŸŸ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹æˆå“¡æ¸…å–®å’Œç®¡ç†åŠŸèƒ½å€åŸŸ
   */
  Widget _buildMemberManagementArea(BuildContext context);
}
```

#### 3.5.2 MembersList Widget
```dart
/**
 * 18. å°æ‡‰ 3.3ï¼šæˆå“¡æ¸…å–®Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description é¡¯ç¤ºå¸³æœ¬æˆå“¡æ¸…å–®ï¼Œæ”¯æ´è§’è‰²ç®¡ç†å’Œæ¬Šé™èª¿æ•´
 */
class MembersList extends StatelessWidget {
  final List<MemberModel> members;
  final List<InvitationModel> pendingInvitations;
  final Function(String userId, UserRole newRole)? onRoleChanged;
  final Function(String userId)? onRemoveMember;

  const MembersList({
    Key? key,
    required this.members,
    required this.pendingInvitations,
    this.onRoleChanged,
    this.onRemoveMember,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 19. å°æ‡‰ 3.3ï¼šå»ºç«‹æˆå“¡é …ç›®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹å–®å€‹æˆå“¡çš„é¡¯ç¤ºé …ç›®
   */
  Widget _buildMemberItem(MemberModel member, BuildContext context);

  /**
   * 20. å°æ‡‰ 3.3ï¼šå»ºç«‹å¾…è™•ç†é‚€è«‹é …ç›®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹å¾…è™•ç†é‚€è«‹çš„é¡¯ç¤ºé …ç›®
   */
  Widget _buildPendingInvitationItem(InvitationModel invitation, BuildContext context);
}
```

### 3.6 é€²éšè¨­å®šå±¤Widget

#### 3.6.1 AdvancedTab Widget
```dart
/**
 * 21. å°æ‡‰ 3.4ï¼šé€²éšåŠŸèƒ½è¨­å®šåˆ†é Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description é€²éšåŠŸèƒ½è¨­å®šå€å¡Šï¼ŒåŒ…å«é ç®—ã€é€šçŸ¥ã€ç§‘ç›®ç­‰è¨­å®š
 */
class AdvancedTab extends StatelessWidget {
  final LedgerSettingsProvider provider;
  final UserMode? userMode;

  const AdvancedTab({
    Key? key,
    required this.provider,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 22. å°æ‡‰ 3.4ï¼šå»ºç«‹é€²éšè¨­å®šå€åŸŸ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹æ‰€æœ‰é€²éšè¨­å®šçš„å€åŸŸ
   */
  Widget _buildAdvancedSettingsArea(BuildContext context);
}
```

### 3.7 å®‰å…¨è¨­å®šå±¤Widget

#### 3.7.1 SecurityTab Widget
```dart
/**
 * 23. å°æ‡‰ 3.5ï¼šå®‰å…¨æ€§è¨­å®šåˆ†é Widget
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å®‰å…¨æ€§èˆ‡éš±ç§è¨­å®šå€å¡Šï¼ŒåŒ…å«éš±ç§ç­‰ç´šã€å­˜å–æ§åˆ¶ã€è³‡æ–™åŠ å¯†
 */
class SecurityTab extends StatelessWidget {
  final LedgerSettingsProvider provider;
  final UserMode? userMode;

  const SecurityTab({
    Key? key,
    required this.provider,
    this.userMode,
  });

  @override
  Widget build(BuildContext context);

  /**
   * 24. å°æ‡‰ 3.5ï¼šå»ºç«‹å®‰å…¨è¨­å®šå€åŸŸ
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹æ‰€æœ‰å®‰å…¨æ€§è¨­å®šçš„å€åŸŸ
   */
  Widget _buildSecuritySettingsArea(BuildContext context);
}
```

---

## 4.0 ç‹€æ…‹ç®¡ç†æ¶æ§‹

### 4.1 LedgerSettingsProvider ç‹€æ…‹ç®¡ç†å™¨
```dart
/**
 * 25. å°æ‡‰ 4.1ï¼šå¸³æœ¬è¨­å®šç‹€æ…‹ç®¡ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description ç®¡ç†å¸³æœ¬è¨­å®šé é¢çš„ç‹€æ…‹ï¼Œæ”¯æ´å®Œæ•´è¨­å®šç®¡ç†å’Œè®Šæ›´è¿½è¹¤
 */
class LedgerSettingsProvider extends ChangeNotifier {
  // ç‹€æ…‹å±¬æ€§
  SettingsPageState _pageState = SettingsPageState.loading;
  String _ledgerId = '';
  LedgerSettingsModel? _originalSettings;
  LedgerSettingsModel? _currentSettings;
  bool _hasChanges = false;
  bool _isLoading = false;
  bool _isSaving = false;
  String? _errorMessage;
  SettingsErrorType? _errorType;
  SettingsTab _activeTab = SettingsTab.basicInfo;

  // æˆå“¡ç®¡ç†ç‹€æ…‹
  List<MemberModel> _members = [];
  List<InvitationModel> _pendingInvitations = [];
  bool _isInviting = false;

  // é©—è­‰ç‹€æ…‹
  Map<String, String?> _validationErrors = {};
  Map<String, bool> _fieldValidation = {};

  // Getters
  SettingsPageState get pageState;
  String get ledgerId;
  LedgerSettingsModel? get originalSettings;
  LedgerSettingsModel? get currentSettings;
  bool get hasChanges;
  bool get isLoading;
  bool get isSaving;
  String? get errorMessage;
  SettingsErrorType? get errorType;
  SettingsTab get activeTab;
  List<MemberModel> get members;
  List<InvitationModel> get pendingInvitations;
  bool get isInviting;
  Map<String, String?> get validationErrors;

  /**
   * 26. å°æ‡‰ 4.1ï¼šåˆå§‹åŒ–è¨­å®šé é¢
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¼‰å…¥å¸³æœ¬è¨­å®šè³‡æ–™å’Œæˆå“¡æ¸…å–®
   */
  Future<void> initializeSettings(String ledgerId);

  /**
   * 27. å°æ‡‰ 4.1ï¼šè¼‰å…¥å¸³æœ¬è¨­å®š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å¾APIè¼‰å…¥å¸³æœ¬è¨­å®šè³‡æ–™
   */
  Future<void> _loadLedgerSettings();

  /**
   * 28. å°æ‡‰ 4.1ï¼šè¼‰å…¥æˆå“¡æ¸…å–®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¼‰å…¥å¸³æœ¬æˆå“¡å’Œå¾…è™•ç†é‚€è«‹æ¸…å–®
   */
  Future<void> _loadMembersList();

  /**
   * 29. å°æ‡‰ 4.1ï¼šæ›´æ–°åŸºæœ¬è³‡è¨Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°å¸³æœ¬åŸºæœ¬è³‡è¨Šè¨­å®š
   */
  void updateBasicInfo({
    String? name,
    String? description,
    String? iconId,
    String? colorTheme,
    String? currency,
  });

  /**
   * 30. å°æ‡‰ 4.1ï¼šæ›´æ–°æˆå“¡è§’è‰²
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°æˆå“¡çš„è§’è‰²æ¬Šé™
   */
  Future<void> updateMemberRole(String userId, UserRole newRole);

  /**
   * 31. å°æ‡‰ 4.1ï¼šé‚€è«‹æ–°æˆå“¡
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description é‚€è«‹æ–°æˆå“¡åŠ å…¥å¸³æœ¬
   */
  Future<void> inviteMember(String email, UserRole role);

  /**
   * 32. å°æ‡‰ 4.1ï¼šç§»é™¤æˆå“¡
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å¾å¸³æœ¬ä¸­ç§»é™¤æˆå“¡
   */
  Future<void> removeMember(String userId);

  /**
   * 33. å°æ‡‰ 4.1ï¼šæ›´æ–°é€²éšè¨­å®š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°å¸³æœ¬é€²éšåŠŸèƒ½è¨­å®š
   */
  void updateAdvancedSettings({
    BudgetSettingsModel? budgetSettings,
    NotificationSettingsModel? notificationSettings,
    CategorySettingsModel? categorySettings,
  });

  /**
   * 34. å°æ‡‰ 4.1ï¼šæ›´æ–°å®‰å…¨è¨­å®š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°å¸³æœ¬å®‰å…¨æ€§è¨­å®š
   */
  void updateSecuritySettings({
    PrivacyLevel? privacyLevel,
    bool? requireApproval,
    bool? allowPublicView,
    bool? dataEncryption,
  });

  /**
   * 35. å°æ‡‰ 4.1ï¼šå„²å­˜æ‰€æœ‰è®Šæ›´
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å„²å­˜æ‰€æœ‰è¨­å®šè®Šæ›´åˆ°æœå‹™å™¨
   */
  Future<void> saveAllChanges();

  /**
   * 36. å°æ‡‰ 4.1ï¼šé‡è¨­è®Šæ›´
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description é‡è¨­æ‰€æœ‰æœªå„²å­˜çš„è®Šæ›´
   */
  void resetChanges();

  /**
   * 37. å°æ‡‰ 4.1ï¼šåˆ‡æ›æ´»å‹•åˆ†é 
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description åˆ‡æ›ç•¶å‰æ´»å‹•çš„è¨­å®šåˆ†é 
   */
  void setActiveTab(SettingsTab tab);

  /**
   * 38. å°æ‡‰ 4.1ï¼šé©—è­‰è¨­å®šæ¬„ä½
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description é©—è­‰è¨­å®šæ¬„ä½çš„æœ‰æ•ˆæ€§
   */
  String? validateField(String fieldName, dynamic value);

  /**
   * 39. å°æ‡‰ 4.1ï¼šè½‰ç§»å¸³æœ¬æ“æœ‰æ¬Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å°‡å¸³æœ¬æ“æœ‰æ¬Šè½‰ç§»çµ¦å…¶ä»–æˆå“¡
   */
  Future<void> transferOwnership(String newOwnerId);

  /**
   * 40. å°æ‡‰ 4.1ï¼šæ­¸æª”å¸³æœ¬
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å°‡å¸³æœ¬è¨­ç‚ºæ­¸æª”ç‹€æ…‹
   */
  Future<void> archiveLedger();

  /**
   * 41. å°æ‡‰ 4.1ï¼šåˆªé™¤å¸³æœ¬
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ°¸ä¹…åˆªé™¤å¸³æœ¬
   */
  Future<void> deleteLedger(String confirmationText);

  /**
   * 42. å°æ‡‰ 4.1ï¼šæª¢æ¸¬è®Šæ›´
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æª¢æ¸¬ç•¶å‰è¨­å®šæ˜¯å¦æœ‰è®Šæ›´
   */
  void _detectChanges();

  /**
   * 43. å°æ‡‰ 4.1ï¼šè¨­å®šè¼‰å…¥ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¨­å®šè¼‰å…¥ç‹€æ…‹ä¸¦é€šçŸ¥ç›£è½è€…
   */
  void _setLoading(bool loading);

  /**
   * 44. å°æ‡‰ 4.1ï¼šè¨­å®šå„²å­˜ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¨­å®šå„²å­˜ç‹€æ…‹ä¸¦é€šçŸ¥ç›£è½è€…
   */
  void _setSaving(bool saving);

  /**
   * 45. å°æ‡‰ 4.1ï¼šè¨­å®šéŒ¯èª¤ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¨­å®šéŒ¯èª¤è¨Šæ¯å’Œé¡å‹
   */
  void _setError(String message, SettingsErrorType type);

  /**
   * 46. å°æ‡‰ 4.1ï¼šæ¸…é™¤éŒ¯èª¤ç‹€æ…‹
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ¸…é™¤éŒ¯èª¤ç‹€æ…‹
   */
  void clearError();
}
```

### 4.2 ç‹€æ…‹æšèˆ‰å®šç¾©
```dart
/**
 * 47. å°æ‡‰ 4.2ï¼šè¨­å®šé é¢ç‹€æ…‹æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å®šç¾©è¨­å®šé é¢çš„å„ç¨®ç‹€æ…‹
 */
enum SettingsPageState {
  loading,      // è¼‰å…¥ä¸­
  ready,        // æº–å‚™å°±ç·’
  saving,       // å„²å­˜ä¸­
  error,        // éŒ¯èª¤ç‹€æ…‹
}

/**
 * 48. å°æ‡‰ 4.2ï¼šè¨­å®šåˆ†é æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è¨­å®šé é¢çš„åˆ†é é¡å‹
 */
enum SettingsTab {
  basicInfo,    // åŸºæœ¬è³‡è¨Š
  members,      // æˆå“¡ç®¡ç†
  advanced,     // é€²éšè¨­å®š
  security,     // å®‰å…¨æ€§è¨­å®š
  management,   // ç”Ÿå‘½é€±æœŸç®¡ç†
}

/**
 * 49. å°æ‡‰ 4.2ï¼šè¨­å®šéŒ¯èª¤é¡å‹æšèˆ‰
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è¨­å®šç›¸é—œéŒ¯èª¤é¡å‹åˆ†é¡
 */
enum SettingsErrorType {
  networkError,         // ç¶²è·¯éŒ¯èª¤
  permissionDenied,     // æ¬Šé™ä¸è¶³
  validationError,      // é©—è­‰éŒ¯èª¤
  memberLimitExceeded,  // æˆå“¡æ•¸é‡è¶…é™
  ownerTransferFailed,  // æ“æœ‰æ¬Šè½‰ç§»å¤±æ•—
  deletionFailed,       // åˆªé™¤å¤±æ•—
  unknown,             // æœªçŸ¥éŒ¯èª¤
}
```

---

## 5.0 APIæ•´åˆè¨­è¨ˆ

### 5.1 LedgerSettingsApiService APIæœå‹™
```dart
/**
 * 50. å°æ‡‰ 5.1ï¼šå¸³æœ¬è¨­å®šAPIæœå‹™
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è™•ç†å¸³æœ¬è¨­å®šç›¸é—œçš„APIèª¿ç”¨
 */
class LedgerSettingsApiService {
  final ApiClient _apiClient = ApiClient();

  /**
   * 51. å°æ‡‰ 5.1ï¼šå–å¾—å¸³æœ¬è¨­å®š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å–å¾—å¸³æœ¬å®Œæ•´è¨­å®šè³‡æ–™
   */
  Future<ApiResponse<LedgerSettingsResponse>> getLedgerSettings(String ledgerId);

  /**
   * 52. å°æ‡‰ 5.1ï¼šæ›´æ–°åŸºæœ¬è³‡è¨Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°å¸³æœ¬åŸºæœ¬è³‡è¨Š
   */
  Future<ApiResponse<UpdateBasicInfoResponse>> updateBasicInfo(
    String ledgerId,
    UpdateBasicInfoRequest request,
  );

  /**
   * 53. å°æ‡‰ 5.1ï¼šç®¡ç†æˆå“¡
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ‰¹é‡æ›´æ–°æˆå“¡ç®¡ç†
   */
  Future<ApiResponse<ManageMembersResponse>> manageMembers(
    String ledgerId,
    ManageMembersRequest request,
  );

  /**
   * 54. å°æ‡‰ 5.1ï¼šæ›´æ–°é€²éšè¨­å®š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°å¸³æœ¬é€²éšåŠŸèƒ½è¨­å®š
   */
  Future<ApiResponse<UpdateAdvancedSettingsResponse>> updateAdvancedSettings(
    String ledgerId,
    UpdateAdvancedSettingsRequest request,
  );

  /**
   * 55. å°æ‡‰ 5.1ï¼šæ›´æ–°å®‰å…¨è¨­å®š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ›´æ–°å¸³æœ¬å®‰å…¨æ€§è¨­å®š
   */
  Future<ApiResponse<UpdateSecuritySettingsResponse>> updateSecuritySettings(
    String ledgerId,
    UpdateSecuritySettingsRequest request,
  );

  /**
   * 56. å°æ‡‰ 5.1ï¼šè½‰ç§»æ“æœ‰æ¬Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è½‰ç§»å¸³æœ¬æ“æœ‰æ¬Š
   */
  Future<ApiResponse<TransferOwnershipResponse>> transferOwnership(
    String ledgerId,
    TransferOwnershipRequest request,
  );

  /**
   * 57. å°æ‡‰ 5.1ï¼šæ­¸æª”å¸³æœ¬
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å°‡å¸³æœ¬è¨­ç‚ºæ­¸æª”ç‹€æ…‹
   */
  Future<ApiResponse<ArchiveLedgerResponse>> archiveLedger(
    String ledgerId,
    ArchiveLedgerRequest request,
  );

  /**
   * 58. å°æ‡‰ 5.1ï¼šåˆªé™¤å¸³æœ¬
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ°¸ä¹…åˆªé™¤å¸³æœ¬
   */
  Future<ApiResponse<DeleteLedgerResponse>> deleteLedger(
    String ledgerId,
    DeleteLedgerRequest request,
  );

  /**
   * 59. å°æ‡‰ 5.1ï¼šè™•ç†DioéŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†DioéŒ¯èª¤ä¸¦è½‰æ›ç‚ºä½¿ç”¨è€…å‹å–„è¨Šæ¯
   */
  String _handleDioError(DioError error);
}
```

### 5.2 è³‡æ–™æ¨¡å‹å®šç¾©
```dart
/**
 * 60. å°æ‡‰ 5.2ï¼šå¸³æœ¬è¨­å®šæ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å¸³æœ¬è¨­å®šè³‡æ–™æ¨¡å‹
 */
class LedgerSettingsModel {
  final String ledgerId;
  final String name;
  final String? description;
  final String iconId;
  final String colorTheme;
  final String currency;
  final String? timeZone;
  final String? locale;
  final BudgetSettingsModel? budgetSettings;
  final NotificationSettingsModel? notificationSettings;
  final CategorySettingsModel? categorySettings;
  final PrivacyLevel privacyLevel;
  final bool requireApproval;
  final bool allowPublicView;
  final bool dataEncryption;
  final DateTime lastModified;
  final String modifiedBy;

  LedgerSettingsModel({
    required this.ledgerId,
    required this.name,
    this.description,
    required this.iconId,
    required this.colorTheme,
    required this.currency,
    this.timeZone,
    this.locale,
    this.budgetSettings,
    this.notificationSettings,
    this.categorySettings,
    required this.privacyLevel,
    required this.requireApproval,
    required this.allowPublicView,
    required this.dataEncryption,
    required this.lastModified,
    required this.modifiedBy,
  });

  factory LedgerSettingsModel.fromJson(Map<String, dynamic> json);
  Map<String, dynamic> toJson();
}

/**
 * 61. å°æ‡‰ 5.2ï¼šæˆå“¡æ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å¸³æœ¬æˆå“¡è³‡æ–™æ¨¡å‹
 */
class MemberModel {
  final String userId;
  final String name;
  final String email;
  final UserRole role;
  final DateTime joinDate;
  final DateTime? lastActive;
  final List<String> permissions;
  final bool isActive;

  MemberModel({
    required this.userId,
    required this.name,
    required this.email,
    required this.role,
    required this.joinDate,
    this.lastActive,
    required this.permissions,
    required this.isActive,
  });

  factory MemberModel.fromJson(Map<String, dynamic> json);
  Map<String, dynamic> toJson();
}

/**
 * 62. å°æ‡‰ 5.2ï¼šé‚€è«‹æ¨¡å‹
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æˆå“¡é‚€è«‹è³‡æ–™æ¨¡å‹
 */
class InvitationModel {
  final String inviteId;
  final String email;
  final UserRole role;
  final InvitationStatus status;
  final DateTime sentDate;
  final DateTime expiryDate;
  final String invitedBy;

  InvitationModel({
    required this.inviteId,
    required this.email,
    required this.role,
    required this.status,
    required this.sentDate,
    required this.expiryDate,
    required this.invitedBy,
  });

  factory InvitationModel.fromJson(Map<String, dynamic> json);
}
```

---

## 6.0 å°èˆªè·¯ç”±è¨­è¨ˆ

### 6.1 è·¯ç”±é…ç½®
```dart
/**
 * 63. å°æ‡‰ 6.1ï¼šå¸³æœ¬è¨­å®šé é¢è·¯ç”±é…ç½®
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å®šç¾©å¸³æœ¬è¨­å®šé é¢çš„è·¯ç”±è¦å‰‡èˆ‡å°èˆªé‚è¼¯
 */
class LedgerSettingsRoutes {
  static const String ledgerSettings = '/ledger-settings';
  static const String memberManagement = '/member-management';
  static const String ledgerList = '/ledger-list';
  static const String home = '/home';

  /**
   * 64. å°æ‡‰ 6.1ï¼šå–å¾—è¨­å®šé é¢è·¯ç”±
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å»ºç«‹è¨­å®šé é¢çš„GoRouteé…ç½®
   */
  static GoRoute getLedgerSettingsRoute();
}

/**
 * 65. å°æ‡‰ 6.1ï¼šè¨­å®šå°èˆªæœå‹™
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è™•ç†è¨­å®šç›¸é—œçš„å°èˆªé‚è¼¯
 */
class LedgerSettingsNavigationService {
  static final GoRouter _router;
  static GoRouter get router;

  /**
   * 66. å°æ‡‰ 6.1ï¼šè¿”å›å¸³æœ¬æ¸…å–®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¨­å®šå®Œæˆå¾Œè¿”å›å¸³æœ¬æ¸…å–®
   */
  Future<void> navigateToLedgerList();

  /**
   * 67. å°æ‡‰ 6.1ï¼šå°èˆªåˆ°æˆå“¡ç®¡ç†
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å°èˆªåˆ°å°ˆé–€çš„æˆå“¡ç®¡ç†é é¢
   */
  Future<void> navigateToMemberManagement(String ledgerId);

  /**
   * 68. å°æ‡‰ 6.1ï¼šè¿”å›é¦–é 
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è¿”å›åˆ°æ‡‰ç”¨ç¨‹å¼é¦–é 
   */
  Future<void> navigateToHome();

  /**
   * 69. å°æ‡‰ 6.1ï¼šé¡¯ç¤ºé›¢é–‹ç¢ºèªå°è©±æ¡†
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç•¶æœ‰æœªå„²å­˜è®Šæ›´æ™‚é¡¯ç¤ºé›¢é–‹ç¢ºèªå°è©±æ¡†
   */
  Future<bool> showExitConfirmation(BuildContext context, bool hasChanges);
}
```

---

## 7.0 éŸ¿æ‡‰å¼è¨­è¨ˆ

### 7.1 éŸ¿æ‡‰å¼è¼”åŠ©å·¥å…·
```dart
/**
 * 70. å°æ‡‰ 7.1ï¼šå¸³æœ¬è¨­å®šé é¢éŸ¿æ‡‰å¼è¨­è¨ˆè¼”åŠ©å·¥å…·
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description éµå¾ª9005æ–‡ä»¶çš„éŸ¿æ‡‰å¼è¨­è¨ˆè¦ç¯„ï¼Œæä¾›è¨­å®šé é¢å°ˆç”¨çš„ä½ˆå±€ç®¡ç†
 */
class LedgerSettingsResponsiveHelper {
  final BuildContext context;
  late final MediaQueryData _mediaQuery;
  late final Size _screenSize;

  LedgerSettingsResponsiveHelper.of(BuildContext context);

  // æ–·é»åˆ¤æ–·å±¬æ€§ï¼ˆ9005è¦ç¯„ï¼‰
  bool get isMobile;
  bool get isTablet;
  bool get isSmallDesktop;
  bool get isLargeDesktop;
  DeviceType get deviceType;

  // è¨­å®šé é¢å°ˆç”¨å°ºå¯¸å±¬æ€§
  double get settingsFormWidth;
  double get settingsFormMaxWidth;
  EdgeInsets get settingsFormPadding;
  double get settingsItemHeight;
  double get tabBarHeight;
  double get sectionSpacing;
  int get tabColumns;

  /**
   * 71. å°æ‡‰ 7.1ï¼šå–å¾—å››æ¨¡å¼ä½ˆå±€é…ç½®
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼å’Œè£ç½®é¡å‹è¿”å›é©ç•¶ä½ˆå±€é…ç½®
   */
  SettingsLayoutConfig getLayoutConfigForMode(UserMode? mode);

  /**
   * 72. å°æ‡‰ 7.1ï¼šå–å¾—æ¨¡å¼å°æ‡‰é–“è·
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼è¿”å›é©ç•¶é–“è·è¨­å®š
   */
  EdgeInsets getSpacingForMode(UserMode? mode, SpacingType type);
}
```

---

## 8.0 ç„¡éšœç¤™åŠŸèƒ½

### 8.1 èªæ„åŒ–æ”¯æ´
```dart
/**
 * 73. å°æ‡‰ 8.1ï¼šå¸³æœ¬è¨­å®šé é¢ç„¡éšœç¤™èªæ„åŒ–WidgetåŒ…è£å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description æä¾›WCAG 2.1 AAæ¨™æº–çš„å®Œæ•´ç„¡éšœç¤™æ”¯æ´ï¼ˆ9005è¦ç¯„ï¼‰
 */
class LedgerSettingsAccessibilityWrapper {

  /**
   * 74. å°æ‡‰ 8.1ï¼šç‚ºè¨­å®šé …ç›®æä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç‚ºå„ç¨®è¨­å®šé …ç›®æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapSettingsItem(Widget child, String itemType, {String? label, String? hint});

  /**
   * 75. å°æ‡‰ 8.1ï¼šç‚ºæˆå“¡å¡ç‰‡æä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç‚ºæˆå“¡å¡ç‰‡æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapMemberCard(Widget child, MemberModel member, bool canModify);

  /**
   * 76. å°æ‡‰ 8.1ï¼šç‚ºåˆ†é æ¨™ç±¤æä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç‚ºè¨­å®šåˆ†é æ¨™ç±¤æ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapTabItem(Widget child, SettingsTab tab, bool isActive);

  /**
   * 77. å°æ‡‰ 8.1ï¼šç‚ºå±éšªæ“ä½œæä¾›èªæ„åŒ–æ¨™ç±¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç‚ºåˆªé™¤ã€è½‰ç§»ç­‰å±éšªæ“ä½œæ·»åŠ é©ç•¶çš„èªæ„åŒ–æ¨™ç±¤
   */
  static Widget wrapDangerousAction(Widget child, String actionType, bool isEnabled);
}
```

---

## 9.0 æ•ˆèƒ½æœ€ä½³åŒ–

### 9.1 Widgetå¿«å–ç­–ç•¥
```dart
/**
 * 78. å°æ‡‰ 9.1ï¼šå¸³æœ¬è¨­å®šé é¢Widgetå¿«å–ç®¡ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description å„ªåŒ–è¨­å®šé é¢Widgeté‡å»ºæ•ˆèƒ½ï¼Œæ¸›å°‘ä¸å¿…è¦çš„é‡å»º
 */
class LedgerSettingsWidgetCache {
  static final Map<String, Widget> _cache = {};
  static final Map<String, DateTime> _cacheTimestamps = {};
  static const Duration _cacheValidDuration = Duration(minutes: 15);

  /**
   * 79. å°æ‡‰ 9.1ï¼šå¿«å–è¨­å®šé …ç›®Widget
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å¿«å–éœæ…‹çš„è¨­å®šé …ç›®Widget
   */
  static Widget getSettingsItemOrCreate(String key, Widget Function() creator);

  /**
   * 80. å°æ‡‰ 9.1ï¼šå¿«å–æˆå“¡å¡ç‰‡Widget
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description å¿«å–æˆå“¡å¡ç‰‡Widgetä»¥æå‡åˆ—è¡¨æ•ˆèƒ½
   */
  static Widget getMemberCardOrCreate(String memberId, Widget Function() creator);

  /**
   * 81. å°æ‡‰ 9.1ï¼šæ¸…é™¤è¨­å®šå¿«å–
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description æ¸…é™¤è¨­å®šé é¢ç›¸é—œçš„Widgetå¿«å–
   */
  static void clearSettingsCache();
}
```

---

## 10.0 éŒ¯èª¤è™•ç†æ©Ÿåˆ¶

### 10.1 çµ±ä¸€éŒ¯èª¤è™•ç†
```dart
/**
 * 82. å°æ‡‰ 10.1ï¼šå¸³æœ¬è¨­å®šé é¢éŒ¯èª¤è™•ç†å™¨
 * @version 2025-01-26-V1.0.0
 * @date 2025-01-26 18:30:00
 * @description è™•ç†è¨­å®šé é¢å„ç¨®éŒ¯èª¤æƒ…å¢ƒ
 */
class LedgerSettingsErrorHandler {

  /**
   * 83. å°æ‡‰ 10.1ï¼šè™•ç†è¨­å®šæ›´æ–°éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†è¨­å®šæ›´æ–°å¤±æ•—éŒ¯èª¤
   */
  static String handleSettingsUpdateError(dynamic error);

  /**
   * 84. å°æ‡‰ 10.1ï¼šè™•ç†æˆå“¡ç®¡ç†éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†æˆå“¡ç®¡ç†æ“ä½œéŒ¯èª¤
   */
  static String handleMemberManagementError(dynamic error, String operation);

  /**
   * 85. å°æ‡‰ 10.1ï¼šè™•ç†æ¬Šé™éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†æ¬Šé™ä¸è¶³éŒ¯èª¤
   */
  static String handlePermissionError(dynamic error);

  /**
   * 86. å°æ‡‰ 10.1ï¼šè™•ç†é©—è­‰éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†è¡¨å–®é©—è­‰éŒ¯èª¤
   */
  static Map<String, String> handleValidationErrors(dynamic error);

  /**
   * 87. å°æ‡‰ 10.1ï¼šè™•ç†ç¶²è·¯éŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†ç¶²è·¯é€£ç·šéŒ¯èª¤
   */
  static String handleNetworkError(DioError error);

  /**
   * 88. å°æ‡‰ 10.1ï¼šé¡¯ç¤ºéŒ¯èª¤å°è©±æ¡†
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯å°è©±æ¡†
   */
  static Future<void> showErrorDialog(
    BuildContext context,
    String message,
    SettingsErrorType errorType,
    {VoidCallback? onRetry, VoidCallback? onDismiss},
  );

  /**
   * 89. å°æ‡‰ 10.1ï¼šè™•ç†å±éšªæ“ä½œéŒ¯èª¤
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description è™•ç†åˆªé™¤ã€è½‰ç§»ç­‰å±éšªæ“ä½œéŒ¯èª¤
   */
  static String handleDangerousOperationError(dynamic error, String operation);

  /**
   * 90. å°æ‡‰ 10.1ï¼šé¡¯ç¤ºé›¢é–‹è­¦å‘Š
   * @version 2025-01-26-V1.0.0
   * @date 2025-01-26 18:30:00
   * @description ç•¶æœ‰æœªå„²å­˜è®Šæ›´æ™‚é¡¯ç¤ºé›¢é–‹è­¦å‘Š
   */
  static Future<bool> showUnsavedChangesWarning(BuildContext context);
}
```

---

## éµå¾ª0055è¨­è¨ˆåŸå‰‡

### éšå±¤æ¶æ§‹å°æ‡‰
- æœ¬TDDæ–‡ä»¶åŸºæ–¼P018_å¸³æœ¬è¨­å®šé é¢_SRS.mdçš„éœ€æ±‚è¦æ ¼
- èˆ‡9005. Flutter_Presentation layer.mdçš„ç”¢å“è¦æ ¼ä¿æŒä¸€è‡´
- æ‰€æœ‰å‡½æ•¸ç¯€é»ç·¨è™Ÿå°æ‡‰ä¸Šå±¤æ–‡ä»¶çš„åŠŸèƒ½æ¢ç›®

### è¨­è¨ˆåŸå‰‡éµå¾ª
1. **éšå±¤æ¶æ§‹é‚è¼¯**: åš´æ ¼åŸºæ–¼SRSæ–‡ä»¶å®šç¾©çš„åŠŸèƒ½æ¢ç›®è¨­è¨ˆ
2. **åŒå±¤ç´šä¾è³´é—œä¿‚**: è€ƒé‡èˆ‡å¸³æœ¬æ¸…å–®é é¢å’Œæˆå“¡ç®¡ç†é é¢çš„ä¾è³´é—œä¿‚
3. **ä»£ç¢¼ç¯€é»ç·¨è™Ÿ**: æ¡ç”¨ä¸åŠ å‰ç¶´çš„ç¯€é»ç·¨è™Ÿæ ¼å¼ï¼ˆå¦‚2.1ã€3.2ï¼‰
4. **å‘½åä¸€è‡´æ€§**: ä¿æŒèˆ‡ä½¿ç”¨è€…ä»‹é¢æ“ä½œæµç¨‹çš„åç¨±åŒæ­¥
5. **å¯è®€æ€§è¨­è¨ˆ**: æ¡ç”¨æ¨¡çµ„åŒ–è¨­è¨ˆï¼Œéµå¾ªä½è€¦åˆã€é«˜å…§èšåŸå‰‡

## æ–‡ä»¶ç¶­è­·è¨˜éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®æ”¹è€… | ä¿®æ”¹å…§å®¹ |
|------|------|--------|----------|
| **v1.0.0** | **2025-01-26 18:30:00 +08:00** | **LCAS SA Team** | **åˆç‰ˆå»ºç«‹ï¼šå®Œæ•´P018å¸³æœ¬è¨­å®šé é¢TDDè¦æ ¼ï¼Œæ”¯æ´åŸºæœ¬è³‡è¨Šç®¡ç†ã€æˆå“¡æ¬Šé™ç®¡ç†ã€é€²éšåŠŸèƒ½è¨­å®šã€å®‰å…¨æ€§é…ç½®ã€å¸³æœ¬ç”Ÿå‘½é€±æœŸç®¡ç†ï¼Œå¯¦ä½œå››æ¨¡å¼å·®ç•°åŒ–è¨­è¨ˆï¼Œå®Œæ•´éŒ¯èª¤è™•ç†æ©Ÿåˆ¶ï¼Œéµå¾ª0055è¨­è¨ˆåŸå‰‡ï¼Œå°æ‡‰P018 SRSè¦æ ¼** |

---

## å‚™è¨»

- **ç´”å‡½æ•¸å®£å‘Š**: å®Œå…¨ç§»é™¤æ‰€æœ‰å¯¦ä½œä»£ç¢¼ï¼Œåƒ…ä¿ç•™å‡½æ•¸åç¨±ã€åƒæ•¸å®šç¾©å’Œè¨»è§£
- **å®Œæ•´è¨­å®šç®¡ç†**: æ”¯æ´åŸºæœ¬è³‡è¨Šã€æˆå“¡æ¬Šé™ã€é€²éšè¨­å®šã€å®‰å…¨æ€§ã€ç”Ÿå‘½é€±æœŸç­‰å®Œæ•´ç®¡ç†åŠŸèƒ½
- **å››æ¨¡å¼å·®ç•°åŒ–**: æ ¹æ“šä½¿ç”¨è€…æ¨¡å¼æä¾›ä¸åŒçš„è¨­å®šç•Œé¢è¤‡é›œåº¦å’Œé¸é …
- **æ¬Šé™é©—è­‰**: å®Œæ•´çš„æ¬Šé™é©—è­‰æ©Ÿåˆ¶ï¼Œç¢ºä¿æ“ä½œå®‰å…¨æ€§
- **è®Šæ›´è¿½è¹¤**: å³æ™‚è¿½è¹¤è¨­å®šè®Šæ›´ï¼Œæä¾›æœªå„²å­˜è®Šæ›´è­¦å‘Š
- **å®Œæ•´æŠ€è¡“æ¶æ§‹**: Widgetåˆ†å±¤ã€ç‹€æ…‹ç®¡ç†ã€APIæ•´åˆã€éŸ¿æ‡‰å¼è¨­è¨ˆã€ç„¡éšœç¤™æ”¯æ´ã€æ•ˆèƒ½æœ€ä½³åŒ–
- **è¦ç¯„å®Œå…¨å°é½Š**: èˆ‡0055ã€P018 SRSã€9005æ–‡ä»¶å®Œå…¨ä¸€è‡´
- **ç¯€é»ç·¨è™Ÿæ¨™æº–åŒ–**: çµ±ä¸€ç·¨è™Ÿ01-90ï¼Œéµå¾ª0055è¦ç¯„æ ¼å¼
- **ç‰ˆæœ¬çµ±ä¸€å‡ç´š**: æ‰€æœ‰çµ„ä»¶ç‰ˆæœ¬çµ±ä¸€ç‚ºv1.0.0
