
# 9203. SRS_Flutter_User_Flow_v2.0

## 文件資訊
- **文件標題**: Flutter User Flow 四模式使用者流程系統需求規格書
- **文件版本**: v2.0
- **創建日期**: 2025-07-30 14:00:00 +08:00 (台灣時間)
- **創建者**: LCAS PM Team
- **最後更新**: 2025-01-10 14:00:00 +08:00 (台灣時間)
- **模組代碼**: Flutter_UF (Flutter User Flow)

---

## 📑 目次 (Table of Contents)

1. 文件基本資訊
   - 1.1 文件概述
   - 1.2 關聯文件
   - 1.3 流程目標與背景

2. 流程圖（Flow Diagram）
   - 2.1 流程圖連結
   - 2.2 圖示說明
   - 2.3 節點定義

3. 主要流程設計
   - 3.1 用戶註冊與模式識別流程
   - 3.2 精準控制者模式 - 專案管理流程
   - 3.3 紀錄習慣者模式 - 美感記帳體驗流程
   - 3.4 轉型挑戰者模式 - 習慣養成支持流程
   - 3.5 潛在覺醒者模式 - 智慧引導覺醒流程
   - 3.6 跨模式協作流程 - 家庭財務管理
   - 3.7 模式切換與升級流程

4. 條件分支與例外流程
   - 4.1 錯誤情況處理
   - 4.2 權限與角色例外
   - 4.3 邊界行為處理

5. 與系統整合點
   - 5.1 後端API呼叫節點
   - 5.2 資料傳入／傳出
   - 5.3 外部服務依賴

6. 補充説明
   - 6.1 UX設計考量
   - 6.2 與其他模組關聯
   - 6.3 可存取性／響應式考量

## 7. 文件維護記錄

| 版本 | 日期 | 修改者 | 修改內容 |
|------|------|--------|----------|
| v1.0.0 | 2025-07-30 14:00:00 +08:00 | LCAS PM Team | 初版建立 - 四模式User Flow完整設計 |
| v2.0 | 2025-01-10 14:00:00 +08:00 | LCAS PM Team | 新增完整目次結構，升級版本規格 |

---

## 1. 文件基本資訊
- **文件名稱**：LCAS 2.0 四模式使用者流程設計
- **版本編號**：v2.0
- **撰寫日期**：2025-07-30
- **撰寫者**：LCAS PM Team
- **關聯文件**：
  - PRD 連結：0018. Feature list.md
  - User Stories 連結：7001. Flutter_User story.md
  - User Scenarios 連結：7002. Flutter_User_Scenarios.md
  - Wireframe 連結：91. Flutter_Module code_AP layer
  - API Spec 連結：01. Replit_Module code_Business layer

---

## 2. 流程目標與背景
- **功能目標**：建立四模式個人化記帳體驗，滿足不同自律動機矩陣用戶需求
- **角色對象**：精準控制者、紀錄習慣者、轉型挑戰者、潛在覺醒者
- **使用起始情境**：用戶註冊後進行模式識別或手動選擇模式
- **使用裝置與平台**：LINE OA + Mobile APP 雙平台協作

---

## 3. 流程圖（Flow Diagram）
- 流程圖連結：[Figma設計稿待補]
- 圖示說明：
  - 🟢 開始/結束節點
  - 🔵 操作步驟
  - 🔶 決策點
  - 🟡 系統處理
  - 🔴 異常處理

---

## 4. 主要流程設計

### 4.1 用戶註冊與模式識別流程

| 步驟編號 | 畫面名稱 | 使用者操作 | 系統反應 | 備註／條件 |
|----------|-----------|-------------|-------------|--------------|
| 1.1 | 歡迎頁面 | 選擇註冊方式 | 顯示註冊選項 | LINE OA自動註冊/APP手動註冊 |
| 1.2 | 身份驗證 | 完成第三方登入 | 建立使用者帳號 | 調用F001 API |
| 1.3 | 模式測評頁面 | 回答5道簡易問題 | 分析自律動機水平 | 問題涵蓋記帳習慣/目標明確度 |
| 1.4 | 模式推薦 | 查看推薦模式 | 顯示匹配模式說明 | 可手動調整或接受推薦 |
| 1.5 | 模式確認 | 確認選擇模式 | 初始化模式設定 | 調用F011設定個人化參數 |
| 1.6 | 引導完成 | 查看功能引導 | 進入對應模式主頁 | 不同模式顯示不同UI |

### 4.2 精準控制者模式 - 專案管理流程

| 步驟編號 | 畫面名稱 | 使用者操作 | 系統反應 | 備註／條件 |
|----------|-----------|-------------|-------------|--------------|
| 2.1 | 專案管理主頁 | 點擊「新建專案」 | 顯示專案建立精靈 | 調用F031 API |
| 2.2 | 專案設定 | 輸入專案資訊 | 驗證並暫存資料 | 專案名稱/預算/時間範圍 |
| 2.3 | 預算分配 | 設定分類預算 | 顯示分配圖表 | 調用F037預算設定 |
| 2.4 | 成員邀請 | 添加協作成員 | 發送邀請通知 | 調用F040共享帳本功能 |
| 2.5 | 專案建立確認 | 確認建立專案 | 專案帳本建立成功 | 自動初始化科目代碼 |
| 2.6 | 記帳操作 | LINE快速記帳 | 即時同步至專案 | 「收入 股息 1500 台積電」 |
| 2.7 | 深度分析 | 查看專案報表 | 產生多維分析圖表 | 調用F043標準報表 |
| 2.8 | 報表匯出 | 匯出投資報表 | 生成PDF/Excel檔案 | 調用F045匯出功能 |

### 4.3 紀錄習慣者模式 - 美感記帳體驗流程

| 步驟編號 | 畫面名稱 | 使用者操作 | 系統反應 | 備註／條件 |
|----------|-----------|-------------|-------------|--------------|
| 3.1 | 個人化設定 | 選擇主題風格 | 套用視覺主題 | 櫻花粉/湖水藍等選項 |
| 3.2 | 提醒設定 | 設定記帳提醒 | 建立溫和提醒 | 調用F049排程提醒 |
| 3.3 | 記帳主頁 | 收到晚間提醒 | 「🌙 該為今天劃下美好句號了」 | 21:00個人化提醒 |
| 3.4 | 美感記帳介面 | 優雅輸入支出 | 顯示美觀輸入介面 | 調用F007 APP記帳 |
| 3.5 | 科目選擇 | 選擇美感圖示 | 顯示精美科目圖示 | 調用F010科目管理 |
| 3.6 | 記帳完成 | 確認儲存 | 播放完成動畫 | 視覺回饋增強儀式感 |
| 3.7 | 月度檢視 | 查看收支圖表 | 顯示美感數據視覺化 | 調用F009記錄查詢 |
| 3.8 | 自動備份 | 系統自動執行 | 雲端備份完成 | 調用F051自動備份 |

### 4.4 轉型挑戰者模式 - 習慣養成支持流程

| 步驟編號 | 畫面名稱 | 使用者操作 | 系統反應 | 備註／條件 |
|----------|-----------|-------------|-------------|--------------|
| 4.1 | 目標設定 | 設定月度預算 | 建立預算目標 | 調用F037預算設定 |
| 4.2 | 預算分配 | 分配各類別預算 | 顯示預算分配圖 | 生活費/娛樂費/儲蓄 |
| 4.3 | 提醒配置 | 設定多重提醒 | 建立提醒排程 | 餐後/晚間/週末檢討 |
| 4.4 | LINE快速記帳 | 回傳記帳訊息 | 「支出 午餐 180」 | 調用WH模組處理 |
| 4.5 | 即時回饋 | 查看系統回應 | 「✅ 已記錄！本月餐飲預算還剩$2,300」 | 調用F038預算監控 |
| 4.6 | 預算警示 | 收到警示通知 | 「⚠️ 娛樂費已用80%」 | 調用F039預算警示 |
| 4.7 | 社群支持 | 邀請室友協作 | 建立共享帳本 | 調用F040共享帳本 |
| 4.8 | 成就回饋 | 週末查看進度 | 「🎉 本週記帳率85%，比上週進步了！」 | 正向激勵機制 |

### 4.5 潛在覺醒者模式 - 智慧引導覺醒流程

| 步驟編號 | 畫面名稱 | 使用者操作 | 系統反應 | 備註／條件 |
|----------|-----------|-------------|-------------|--------------|
| 5.1 | LINE加入 | 掃描QR Code加入 | 發送溫暖歡迎訊息 | 「👋 歡迎來到LCAS！」 |
| 5.2 | 零門檻開始 | 第一次記帳嘗試 | 「支出 午餐 120」 | 極簡化操作 |
| 5.3 | 驚喜回應 | 查看系統反應 | 「🎉 恭喜完成第一筆記錄！」 | 正向鼓勵 |
| 5.4 | 溫和提醒 | 收到智慧提醒 | 「💡 這週記錄了5筆，總共$850」 | 非侵入式提醒 |
| 5.5 | 覺醒時刻 | 點擊查看分析 | 「原來我一週在飲料上花了$200！」 | 視覺化覺醒 |
| 5.6 | 引導設目標 | 接受系統建議 | 「要不要試試設個小目標？」 | 漸進式引導 |
| 5.7 | 視覺化分析 | 查看消費圖表 | 「📊 你的消費大餅圖出爐啦！」 | 調用F043報表功能 |
| 5.8 | 習慣建立 | 持續使用2週 | 自動記錄率提升至50% | 成功覺醒指標 |

### 4.6 跨模式協作流程 - 家庭財務管理

| 步驟編號 | 畫面名稱 | 使用者操作 | 系統反應 | 備註／條件 |
|----------|-----------|-------------|-------------|--------------|
| 6.1 | 家庭帳本建立 | 父親建立共享帳本 | 「張家家庭帳本」建立 | 調用F040共享帳本 |
| 6.2 | 預算設定 | 設定家庭預算 | 生活費/教育費/娛樂費分配 | 調用F037預算管理 |
| 6.3 | 成員邀請 | 邀請家庭成員 | 發送邀請連結 | 調用F041權限管理 |
| 6.4 | 權限分配 | 設定成員權限 | 不同權限等級設定 | 管理員/記帳者/檢視者 |
| 6.5 | 多平台記帳 | 各成員使用偏好平台 | 即時同步資料 | 調用F042即時同步 |
| 6.6 | 協作記帳 | 母親LINE記帳 | 「支出 菜錢 450 全聯採購」 | 跨平台即時同步 |
| 6.7 | 子女參與 | 子女記錄零用錢 | 「支出 文具 80」 | 培養理財觀念 |
| 6.8 | 家庭報表 | 週末家庭會議 | 產生家庭財務報表 | 調用F043報表產出 |
| 6.9 | 智慧建議 | 查看系統分析 | 「本月教育支出比預期少30%」 | AI智慧分析 |
| 6.10 | 目標達成 | 達成儲蓄目標 | 「🎉 恭喜達成旅遊基金目標！」 | 全家慶祝通知 |

### 4.7 模式切換與升級流程

| 步驟編號 | 畫面名稱 | 使用者操作 | 系統反應 | 備註／條件 |
|----------|-----------|-------------|-------------|--------------|
| 7.1 | 行為分析 | 系統監測使用模式 | 發現行為變化模式 | 3個月使用數據分析 |
| 7.2 | 智慧推薦 | 收到升級建議 | 「🤖 發現您對投資有興趣，要不要試試專案帳本？」 | 個人化推薦 |
| 7.3 | 功能預覽 | 查看新功能介紹 | 展示進階功能特色 | 專案帳本/投資分析 |
| 7.4 | 模式升級 | 確認切換模式 | 解鎖進階功能介面 | 紀錄習慣者→精準控制者 |
| 7.5 | 資料遷移 | 自動資料轉換 | 舊資料無縫遷移 | 保持資料完整性 |
| 7.6 | 新手引導 | 查看功能教學 | 「📚 歡迎進入精準控制者模式！」 | 模式特色功能介紹 |
| 7.7 | 個人化調整 | 介面自動調整 | 更專業的UI風格 | 功能更豐富複雜 |

---

## 5. 條件分支與例外流程

### 5.1 錯誤情況處理
- **網路連線異常**：自動切換離線模式，資料暫存本地
- **API呼叫失敗**：顯示友善錯誤訊息，提供重試機制
- **資料同步衝突**：彈出衝突解決對話框，用戶選擇保留版本
- **權限不足**：引導用戶升級或聯繫管理員

### 5.2 權限與角色例外
- **免費版限制**：提示升級專業版，展示付費功能優勢
- **協作權限不足**：顯示權限說明，引導聯繫帳本管理員
- **資料存取限制**：依據用戶權限動態顯示可用功能

### 5.3 邊界行為處理
- **預算超支**：漸進式警示，從提醒到緊急通知
- **記帳頻率過低**：智慧調整提醒頻率，避免打擾
- **模式不適配**：主動建議模式調整，提供切換選項

---

## 6. 與系統整合點

### 6.1 後端API呼叫節點
- **F001使用者註冊**：POST /auth/register
- **F007 APP記帳功能**：POST /app/ledger/entry  
- **F031專案帳本建立**：POST /app/projects/create
- **F037預算設定建立**：POST /app/budgets/create
- **F040共享帳本建立**：POST /app/shared/create
- **F043標準報表產出**：POST /app/reports/generate
- **F049排程提醒設定**：POST /schedule/reminder

### 6.2 資料傳入／傳出
- **輸入資料**：用戶輸入、系統設定、外部API資料
- **輸出資料**：記帳記錄、分析報表、通知訊息
- **資料格式**：JSON標準格式，支援多語系本地化

### 6.3 外部服務依賴
- **LINE平台**：Webhook接收、Push API發送、Rich Menu管理
- **Firebase**：使用者認證、Firestore資料庫、Cloud Functions
- **第三方登入**：Google、Apple、Facebook OAuth整合

---

## 7. 補充説明

### 7.1 UX設計考量
- **模式差異化**：每個模式有獨特的UI風格和互動模式
- **漸進式揭露**：根據用戶熟練度逐步展示進階功能
- **情感化設計**：使用合適的語調和視覺元素增強使用體驗
- **回饋機制**：適時的正向回饋增強用戶粘性

### 7.2 與其他模組關聯
- **WH模組**：處理LINE Webhook，路由到相應功能模組
- **FS模組**：Firestore資料庫操作，確保資料一致性
- **DD模組**：智慧資料處理，支援個人化推薦
- **SR模組**：排程提醒服務，支援個人化通知

### 7.3 可存取性／響應式考量
- **多裝置適配**：支援手機、平板、桌面設備
- **無障礙設計**：支援螢幕閱讀器、大字體、高對比度
- **語音輔助**：支援語音輸入記帳、語音提醒
- **網路適應**：支援弱網路環境，離線功能完整

---

## 8. 版本紀錄

| 版本 | 日期 | 編輯者 | 說明 |
|------|------|--------|------|
| v1.0.0 | 2025/01/24 | LCAS PM Team | 初版 - 四模式User Flow完整設計 |
