

# Module Code架構檢查工具

請對指定的Module Code文件執行以下七大檢查項目：

## 🔍 檢查項目

### 1. Dart語法規範性檢查
**檢查重點**：
- Dart語言語法正確性（類別、函數、變數宣告）
- Import順序是否符合規範（Dart核心庫 → 第三方庫 → 專案模組）
- 函數註解格式是否符合標準（/** */ 格式）
- Null safety語法正確使用

**檢查標準**：
✅ Dart語法完全正確
✅ Import順序規範正確
✅ 函數註解格式標準
✅ Null safety語法正確

### 2. 架構設計完整性檢查
**檢查重點**：
- 是否遵循0026文件PL層職責範圍
- 四層架構設計原則正確實作
- API整合是否符合8088文件規範
- 四模式差異化支援完整性

**檢查標準**：
✅ PL層職責範圍正確
✅ 四層架構設計正確
✅ API整合規範正確
✅ 四模式支援完整

### 3. 核心設計文件對照檢查
**檢查重點**：
- 0015產品規格對照檢查（核心功能需求一致性）
- 0026架構對應矩陣驗證（PL-APL-BL三層對應正確）
- 0090 Sprint計畫符合性檢查（Phase範圍遵循）
- 1311 符合資料欄位規範

**檢查標準**：
✅ 0015 產品規格完全對應
✅ 0026 三層架構矩陣正確
✅ 0090 Sprint範圍符合
✅ 1311 符合資料欄位規範

### 4. API規格整合驗證檢查
**檢查重點**：
- 81號資料夾API SPEC檔案對應檢查（13個API服務整合）
- RESTful API端點與Module函數對應檢查
- 請求/回應格式驗證（JSON格式、錯誤處理）
- 四模式差異化API檢查（Expert/Inertial/Cultivation/Guiding）

**檢查標準**：
✅ 13個API SPEC完全對應
✅ RESTful端點函數對應正確
✅ 請求回應格式標準
✅ 四模式API差異化完整

### 5. 函數實作品質檢查
**檢查重點**：
- 函數簽名是否與LLD文件一致
- 函數內容實作完整性
- 錯誤處理機制是否完善
- 回傳值類型正確性

**檢查標準**：
✅ 函數簽名與LLD一致
✅ 函數實作完整
✅ 錯誤處理完善
✅ 回傳值類型正確

### 6. JWT認證與安全性檢查
**檢查重點**：
- JWT Token管理正確實作
- API安全認證機制完整
- 使用者權限控制實作
- 敏感資料保護機制

**檢查標準**：
✅ JWT認證機制正確
✅ API安全認證完整
✅ 權限控制實作完善
✅ 敏感資料保護到位

### 7. 版本控制與註解規範檢查
**檢查重點**：
- 版本資訊是否完整（@version, @date, @update）
- 函數註解是否詳細且準確
- 模組描述是否完整
- 變更記錄是否詳細記錄

**檢查標準**：
✅ 版本資訊完整
✅ 函數註解詳細準確
✅ 模組描述完整
✅ 變更記錄詳細

## 📊 檢查報告格式

### 📋 [文件名稱] Module Code架構檢查報告

#### 1️⃣ Dart語法規範性
- ✅/❌ Dart語法正確性
- ✅/❌ Import順序規範
- ✅/❌ 函數註解格式
- ✅/❌ Null safety語法

#### 2️⃣ 架構設計完整性
- ✅/❌ PL層職責範圍
- ✅/❌ 四層架構設計
- ✅/❌ API整合規範
- ✅/❌ 四模式支援

#### 3️⃣ 核心設計文件對照
- ✅/❌ 0015產品規格對應
- ✅/❌ 0026架構矩陣正確
- ✅/❌ 0090 Sprint範圍符合
- ✅/❌ 8088 API規範標準

#### 4️⃣ API規格整合驗證
- ✅/❌ 13個API SPEC對應
- ✅/❌ RESTful端點對應
- ✅/❌ 請求回應格式
- ✅/❌ 四模式API差異化

#### 5️⃣ 函數實作品質
- ✅/❌ 函數簽名一致性
- ✅/❌ 函數實作完整性
- ✅/❌ 錯誤處理機制
- ✅/❌ 回傳值類型

#### 6️⃣ JWT認證與安全性
- ✅/❌ JWT認證機制
- ✅/❌ API安全認證
- ✅/❌ 權限控制實作
- ✅/❌ 敏感資料保護

#### 7️⃣ 版本控制與註解規範
- ✅/❌ 版本資訊完整性
- ✅/❌ 函數註解品質
- ✅/❌ 模組描述完整性
- ✅/❌ 變更記錄完整性

### 🔧 修正建議
**高優先級問題**：
1. [具體問題描述]
2. [修正建議]

**中優先級問題**：
1. [具體問題描述]
2. [修正建議]

**優化建議**：
1. [優化方向]
2. [改善建議]

### 📈 整體評分
- **Dart語法規範**：X/10
- **架構設計完整**：X/10
- **核心文件對照**：X/10
- **API規格整合**：X/10
- **函數實作品質**：X/10
- **JWT認證安全**：X/10
- **版本控制規範**：X/10
- **綜合評分**：X/10

### 🎯 特殊檢查項目（Module Code專屬）

#### 0015產品規格對照檢查
- ✅/❌ 核心功能需求對應
- ✅/❌ 四模式理論實作
- ✅/❌ 雙平台策略支援
- ✅/❌ 功能架構完整性

#### 0026文件遵循檢查
- ✅/❌ 嚴格限制在PL層職責
- ✅/❌ 不超出文件規範內容
- ✅/❌ 正確消費APL層API服務
- ✅/❌ UI邏輯與業務邏輯分離

#### 0090文件規範檢查
- ✅/❌ 符合Phase開發範圍
- ✅/❌ Sprint計畫優先級遵循
- ✅/❌ 核心功能優先實作
- ✅/❌ 不超出Sprint範圍

#### 8088文件規範檢查
- ✅/❌ API調用格式統一
- ✅/❌ 錯誤處理標準化
- ✅/❌ JWT認證正確實作
- ✅/❌ 回應格式規範化

#### 81號資料夾API SPEC整合檢查
- ✅/❌ 8101認證服務API對應
- ✅/❌ 8102用戶管理服務API對應
- ✅/❌ 8103記帳交易服務API對應
- ✅/❌ 8104帳本管理服務API對應
- ✅/❌ 8105帳戶管理服務API對應
- ✅/❌ 8106科目管理服務API對應
- ✅/❌ 8107預算管理服務API對應
- ✅/❌ 8108報表分析服務API對應
- ✅/❌ 8109 AI助理服務API對應
- ✅/❌ 8110激勵系統服務API對應
- ✅/❌ 8111系統服務API對應
- ✅/❌ 8112備份管理服務API對應
- ✅/❌ 8113通知管理服務API對應

#### RESTful API整合檢查
- ✅/❌ HTTP客戶端正確配置
- ✅/❌ 請求/回應處理完整
- ✅/❌ 認證Token管理
- ✅/❌ 網路錯誤處理
- ✅/❌ API端點URL正確
- ✅/❌ HTTP方法使用正確
- ✅/❌ 請求標頭設定完整
- ✅/❌ 回應狀態碼處理

#### 四模式差異化檢查
- ✅/❌ Expert模式進階功能
- ✅/❌ Inertial模式穩定性
- ✅/❌ Cultivation模式激勵
- ✅/❌ Guiding模式簡化
- ✅/❌ 模式切換機制
- ✅/❌ 模式特定API調用
- ✅/❌ 模式差異化UI顯示
- ✅/❌ 模式偏好設定

#### JSON格式處理檢查
- ✅/❌ JSON序列化/反序列化
- ✅/❌ 嵌套JSON處理
- ✅/❌ 空值處理機制
- ✅/❌ 類型轉換安全性
- ✅/❌ JSON Schema驗證
- ✅/❌ 錯誤格式處理
- ✅/❌ 大數據JSON處理
- ✅/❌ JSON壓縮傳輸

#### 狀態管理檢查
- ✅/❌ Provider模式正確使用
- ✅/❌ 狀態更新機制完善
- ✅/❌ 狀態持久化正確
- ✅/❌ 狀態同步機制

#### 導航管理檢查
- ✅/❌ 路由配置正確
- ✅/❌ 頁面跳轉邏輯
- ✅/❌ 返回堆疊管理
- ✅/❌ 深度連結支援

#### 表單驗證檢查
- ✅/❌ 即時驗證機制
- ✅/❌ 完整表單驗證
- ✅/❌ 錯誤訊息顯示
- ✅/❌ 用戶體驗優化

#### 安全性檢查
- ✅/❌ 輸入資料驗證
- ✅/❌ Token安全儲存
- ✅/❌ 敏感資料加密
- ✅/❌ 權限控制實作

## 📝 使用說明（階段二完整版）

1. **完整檢查流程**：
   - 選擇要檢查的Module Code檔案
   - 對照相應的LLD文件規格
   - 比對核心設計文件（0015、0026、0090、8088）
   - 驗證81號資料夾13個API SPEC整合
   - **新增：同資料夾內代碼水平對照檢查**
   - **新增：透過0026文件進行BL模組對應驗證**
   - 逐項檢查九大項目和特殊項目
   - 生成完整詳細檢查報告

2. **檢查重點（階段二擴展）**：
   - 確保代碼符合Dart語言規範
   - 驗證架構設計正確性
   - 核心設計文件交叉驗證
   - API規格整合完整性檢查
   - 檢查函數實作完整性
   - 確保JWT認證與安全性
   - 確保版本控制規範
   - **新增：水平對照一致性驗證**
   - **新增：BL模組對應完整性檢查**

3. **質量標準（9項評分）**：
   - 綜合評分 ≥ 8.5：優秀
   - 綜合評分 7.0-8.4：良好
   - 綜合評分 < 7.0：需要改善

4. **水平對照檢查方法**：
   - 比較同資料夾內所有模組代碼
   - 檢查命名規範統一性
   - 驗證函數簽名一致性
   - 確保錯誤處理機制統一
   - 檢測依賴關係衝突

5. **BL模組對應檢查方法**：
   - 解析0026三層架構對應矩陣
   - 驗證PL-APL-BL對應關係
   - 檢查函數調用與BL模組匹配
   - 確保資料流向架構完整性
   - 驗證跨層資料傳遞正確性

6. **常見問題解決（擴展版）**：
   - 語法錯誤：檢查Dart語法規範
   - 架構問題：遵循四層架構原則
   - 文件對照問題：嚴格比對核心設計文件
   - API整合問題：確保13個API SPEC完整對應
   - 函數問題：對照LLD文件規格
   - 安全性問題：檢查JWT認證與權限控制
   - 版本問題：補充完整版本資訊
   - **新增：水平對照問題：統一同資料夾內代碼風格**
   - **新增：BL對應問題：調整三層架構對應關係**

### 8. 水平對照檢查（同資料夾內代碼一致性）
**檢查重點**：
- 同資料夾內模組代碼風格一致性
- 函數命名規範統一性
- 參數類型與回傳值一致性
- 依賴關係與模組耦合檢查

**檢查標準**：
✅ 命名規範統一一致
✅ 函數簽名格式一致
✅ 錯誤處理機制統一
✅ 依賴關係無衝突

### 9. BL模組對應檢查（透過0026文件比對）
**檢查重點**：
- 透過0026文件找出對應BL模組功能
- PL-APL-BL三層對應關係驗證
- BL模組函數與PL層調用匹配
- 資料流向與架構完整性檢查

**檢查標準**：
✅ BL模組功能完全對應
✅ 三層架構對應正確
✅ 函數調用關係正確
✅ 資料流向符合設計

## 📊 階段二擴展檢查報告格式

### 📋 [文件名稱] Module Code階構檢查報告（完整版）

#### 8️⃣ 水平對照檢查（同資料夾內一致性）
- ✅/❌ 命名規範統一性
- ✅/❌ 函數簽名一致性
- ✅/❌ 錯誤處理統一性
- ✅/❌ 依賴關係無衝突

#### 9️⃣ BL模組對應檢查（0026文件驗證）
- ✅/❌ BL模組功能對應
- ✅/❌ 三層架構對應
- ✅/❌ 函數調用關係
- ✅/❌ 資料流向正確

### 🔧 階段二新增修正建議
**水平對照問題**：
1. [同資料夾內不一致問題描述]
2. [建議統一方案]

**BL模組對應問題**：
1. [對應關係問題描述]
2. [架構調整建議]

### 📈 完整評分系統（9大項目）
- **Dart語法規範**：X/10
- **架構設計完整**：X/10
- **核心文件對照**：X/10
- **API規格整合**：X/10
- **函數實作品質**：X/10
- **JWT認證安全**：X/10
- **版本控制規範**：X/10
- **水平對照一致**：X/10
- **BL模組對應**：X/10
- **綜合評分**：X/10

### 🎯 階段二特殊檢查項目

#### 水平對照具體檢查項目

##### 同資料夾模組命名一致性
- ✅/❌ 類別命名規則統一（如：XxxFunctionGroup格式）
- ✅/❌ 函數命名前綴一致（如：buildXxx, handleXxx格式）
- ✅/❌ 變數命名規範統一（駝峰式命名）
- ✅/❌ 常數命名格式統一（全大寫加底線）
- ✅/❌ 檔案命名規則一致（如：7301, 7302格式）

##### 函數簽名與結構一致性
- ✅/❌ 建構函數參數順序統一
- ✅/❌ 回傳值類型格式一致（Future、Widget等）
- ✅/❌ 錯誤處理模式統一（try-catch結構）
- ✅/❌ 註解格式完全一致（版本、日期、描述格式）
- ✅/❌ 函數可見性修飾符使用一致

##### 依賴關係與耦合檢查
- ✅/❌ Import語句順序和分組一致
- ✅/❌ 跨模組依賴關係合理
- ✅/❌ 循環依賴檢測通過
- ✅/❌ 共享資源使用方式統一
- ✅/❌ 第三方庫使用版本一致

##### 程式碼風格一致性
- ✅/❌ 縮排和空格使用統一
- ✅/❌ 大括號位置風格一致
- ✅/❌ 註解撰寫風格統一
- ✅/❌ 常量定義位置統一
- ✅/❌ 日誌輸出格式一致

#### BL模組對應具體檢查項目

##### 0026文件三層對應驗證
- ✅/❌ PL層功能與0026文件定義完全對應
- ✅/❌ 對應APL服務調用正確實作
- ✅/❌ 指定BL模組功能完整覆蓋
- ✅/❌ 跨層資料傳遞格式正確
- ✅/❌ 架構分層職責清楚分離

##### BL模組功能匹配檢查
以73資料夾為例（7301, 7302）：
- ✅/❌ 7301對應BL模組：1309.AM.js 帳號管理功能對應
- ✅/❌ 7302對應BL模組：1301.BK.js 記帳核心功能對應
- ✅/❌ 與1305.SR.js排程提醒模組整合正確
- ✅/❌ 與1310.DL.js診斷日誌模組整合正確
- ✅/❌ 與1311.FS.js Firestore操作模組整合正確

##### API調用與BL模組一致性
- ✅/❌ API調用參數與BL模組期望格式一致
- ✅/❌ API回應處理與BL模組回傳格式匹配
- ✅/❌ 錯誤代碼對應與BL模組錯誤處理一致
- ✅/❌ 認證Token處理與BL模組安全機制匹配
- ✅/❌ 資料驗證規則與BL模組驗證邏輯一致

##### 資料流向完整性檢查
- ✅/❌ 用戶操作 → PL層處理 → APL調用 → BL執行流程正確
- ✅/❌ BL執行結果 → APL回應 → PL層處理 → 用戶反饋流程完整
- ✅/❌ 錯誤處理在各層級間傳遞正確
- ✅/❌ 狀態管理在跨層操作中保持一致
- ✅/❌ 非同步操作在各層級間協調正確

## 🚨 特別注意事項（階段二擴展）

### 水平對照檢查重點
- **73資料夾檢查**：7301與7302之間的一致性
- **同層級模組**：確保同一功能群組內的模組風格統一
- **命名衝突**：檢測同資料夾內是否有重複或衝突的定義
- **相互依賴**：驗證模組間的相互調用關係是否合理

### BL模組對應檢查重點
- **0026對應矩陣**：嚴格按照文件定義進行三層對應檢查
- **功能完整性**：確保PL層功能完全對應到指定BL模組
- **資料契約**：驗證跨層資料傳遞格式的一致性
- **錯誤處理**：確保錯誤在各層級間正確傳遞和處理

### 核心設計文件對照
- **0015產品規格**：確保核心功能需求完全對應
- **0026架構矩陣**：PL-APL-BL三層對應關係正確
- **0090 Sprint計畫**：嚴格遵循Phase開發範圍
- **8088 API規範**：RESTful設計原則完整遵循

### API規格整合要求
- **13個API SPEC**：完整對應81號資料夾所有API服務
- **RESTful標準**：HTTP方法、狀態碼、格式規範
- **認證機制**：JWT Token管理與安全認證
- **錯誤處理**：統一的錯誤回應機制

### PL層職責範圍
- 嚴格限制在展示層邏輯
- 不能包含業務邏輯處理
- 正確消費APL層提供的API
- UI狀態管理與用戶互動

### 四模式差異化
- Expert模式：進階功能與詳細資訊
- Inertial模式：穩定一致的操作體驗
- Cultivation模式：激勵與成就系統
- Guiding模式：簡化流程與引導

### JWT認證與安全性
- Token安全儲存與管理
- API請求認證標頭設定
- 權限控制與存取限制
- 敏感資料加密保護

### 版本控制規範
- 模組版次與函數版次必須升版
- 完整的變更記錄與說明
- 標準化的註解格式
- 明確的更新日期記錄

## 📚 參考文件
- [0015. Product_SPEC_LCAS_2.0](../../00.%20Master_Project%20document/0015.%20Product_SPEC_LCAS_2.0.md)
- [0026. PL-APL-BL mapping matrix](../../00.%20Master_Project%20document/0026.%20PL-APL-BL%20mapping%20matrix.md)
- [0090. Sprint計畫](../../00.%20Master_Project%20document/0090.%20Sprint計畫.md)
- [8088. API設計規範](../../80.%20Flutter_PRD_APL/8088.%20API設計規範.md)
- [81號資料夾 API SPEC](../../81.%20Flutter_SRS(API%20spec)_APL/)
- [9901. Character_PG](../../99.%20Team%20members/9901.%20Character_PG)
- [9825. 撰寫Module code_PL](../98B.%20撰寫文件或代碼/9825.%20撰寫Module%20code_PL)

