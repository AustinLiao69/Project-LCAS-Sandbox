
# Test Code架構檢查工具

請對指定的Test Code文件執行以下四大檢查項目：

## 🔍 檢查項目

### 1. Dart語法規範性檢查
**檢查重點**：
- Mockito null safety 兼容性（禁用any匹配器）
- Import順序是否符合規範（Dart核心庫 → 第三方庫 → 專案模組 → Mock檔案）
- @GenerateMocks註解是否按字母順序排列
- AAA模式（Arrange-Act-Assert）結構是否正確

**檢查標準**：
✅ 無any匹配器，使用argThat(isA<T>())
✅ Import順序規範正確
✅ Mock服務定義符合規範
✅ AAA模式結構清晰

### 2. 測試覆蓋度完整性檢查
**檢查重點**：
- 是否涵蓋對應Test Plan的所有測試案例
- 正常流程、異常流程、邊界值測試是否完整
- API端點測試是否100%覆蓋
- 四模式差異化測試是否實作

**檢查標準**：
✅ Test Plan案例100%覆蓋
✅ 正常/異常/邊界測試完整
✅ API端點測試完整
✅ 四模式測試實作完成

### 3. 版本控制與註解規範檢查
**檢查重點**：
- 函數註解格式是否符合Dart語言規範
- 版本資訊是否完整（@version, @date, @update）
- 測試案例編碼是否對應TC-XXX格式
- 變更記錄是否詳細記錄

**檢查標準**：
✅ Dart註解格式規範
✅ 版本資訊完整
✅ 測試案例編碼對應
✅ 變更記錄詳細

### 4. Mock服務與整合性檢查
**檢查重點**：
- Mock服務設定是否正確使用when語法
- 是否正確整合到Fake_service_switch.dart
- verify驗證是否完整且準確
- thenReturn/thenAnswer回傳值是否非空

**檢查標準**：
✅ Mock服務設定正確
✅ Fake service整合完整
✅ verify驗證準確
✅ 回傳值非空設定

## 📊 檢查報告格式

### 📋 [文件名稱] Test Code架構檢查報告

#### 1️⃣ Dart語法規範性
- ✅/❌ Mockito語法正確性
- ✅/❌ Import順序規範
- ✅/❌ Mock服務定義
- ✅/❌ AAA模式結構

#### 2️⃣ 測試覆蓋度完整性
- ✅/❌ Test Plan覆蓋度
- ✅/❌ 測試流程完整性
- ✅/❌ API端點覆蓋
- ✅/❌ 四模式測試實作

#### 3️⃣ 版本控制與註解規範
- ✅/❌ Dart註解格式
- ✅/❌ 版本資訊完整性
- ✅/❌ 測試案例編碼
- ✅/❌ 變更記錄完整性

#### 4️⃣ Mock服務與整合性
- ✅/❌ Mock服務設定
- ✅/❌ Fake service整合
- ✅/❌ verify驗證準確性
- ✅/❌ 回傳值設定

### 🔧 修正建議
**高優先級問題**：
1. [具體問題描述]
2. [修正建議]

**中優先級問題**：
1. [具體問題描述]
2. [修正建議]

**優化建議**：
1. [優化方向]
2. [改善建議]

### 📈 整體評分
- **Dart語法規範**：X/10
- **測試覆蓋度**：X/10
- **版本控制規範**：X/10
- **Mock整合性**：X/10
- **綜合評分**：X/10

### 🎯 特殊檢查項目（Test Code專屬）

#### Null Safety檢查
- ✅/❌ 無any匹配器使用
- ✅/❌ argThat(isA<T>())正確使用
- ✅/❌ 類型匹配器完整性
- ✅/❌ null safety相容性

#### TDD規範檢查
- ✅/❌ Red-Green-Refactor循環
- ✅/❌ 測試先行原則
- ✅/❌ 小步迭代設計
- ✅/❌ 重構優化實作

#### 效能測試檢查
- ✅/❌ 回應時間測試
- ✅/❌ 併發處理測試
- ✅/❌ 記憶體使用監控
- ✅/❌ 壓力測試實作

#### 安全性測試檢查
- ✅/❌ 輸入驗證測試
- ✅/❌ Token安全測試
- ✅/❌ 權限控制測試
- ✅/❌ 攻擊防護測試

#### 四模式專屬檢查
- ✅/❌ Expert模式測試
- ✅/❌ Inertial模式測試
- ✅/❌ Cultivation模式測試
- ✅/❌ Guiding模式測試

#### pubspec.yaml檢查
- ✅/❌ 依賴版本正確性
- ✅/❌ test、mockito版本相容
- ✅/❌ build_runner配置
- ✅/❌ 依賴衝突檢查

## 📝 使用說明

1. **檢查流程**：
   - 選擇要檢查的Test Code檔案
   - 對照相應的Test Plan文件
   - 逐項檢查四大項目和特殊項目
   - 生成詳細檢查報告

2. **檢查重點**：
   - 確保測試代碼符合Dart語言規範
   - 驗證Mockito null safety相容性
   - 檢查測試覆蓋度充足性
   - 確保Mock服務整合正確

3. **質量標準**：
   - 綜合評分 ≥ 8.5：優秀
   - 綜合評分 7.0-8.4：良好
   - 綜合評分 < 7.0：需要改善

4. **常見問題解決**：
   - any匹配器問題：改用argThat(isA<T>())
   - null safety錯誤：確保傳入非空值
   - Mock設定問題：使用thenReturn回傳非空值
   - Import順序問題：遵循規範順序排列

## 🚨 特別注意事項

### Mockito Null Safety相容性
- 絕對禁止使用any匹配器
- 必須使用argThat(isA<T>())替代
- 確保when語法回傳非空值
- 檢查Mock物件生成正確性

### TDD開發規範
- 確認測試先行開發
- 驗證Red-Green-Refactor循環
- 檢查小步迭代實作
- 確保重構優化品質

### 整合測試要求
- 驗證Fake_service_switch整合
- 檢查端到端測試流程
- 確認服務間協作測試
- 驗證環境配置正確性

## 📚 參考文件
- [6005. 測試代碼開發規範](../60.%20Flutter_Project%20document/6005.%20測試代碼開發規範.md)
- [6006. Dart代碼測試錯誤之報告](../60.%20Flutter_Project%20document/6006.%20Dart代碼測試錯誤之報告.md)
- [9823. Test plan架構檢查工具](9823.%20Test%20plan架構檢查工具.md)
- [9821. LLD文件架構檢查工具](9821.%20LLD文件架構檢查工具.md)
