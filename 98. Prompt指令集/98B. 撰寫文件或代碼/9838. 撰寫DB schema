ç¯„æœ¬å¦‚ä¸‹ï¼š

ğŸ”· Firestore NoSQL DB Schema Template

________________________________________
1. Overview
æè¿°æ•´é«”è³‡æ–™åº«æ¶æ§‹ã€‚
Database Type: Firestore (NoSQL, document-based)
Structure Style: Collections â†’ Documents â†’ Subcollections
Version: v1.0
Last Update: YYYY-MM-DD
Maintainers:
Notes:
ç°¡è¿°æ•´é«”æ¶æ§‹åŸå‰‡ï¼Œä¾‹å¦‚ï¼š
â€¢	æ¯å€‹ä¸»é›†åˆéƒ½ä½¿ç”¨è‡ªå‹•ç”Ÿæˆçš„ ID
â€¢	åš´æ ¼å€åˆ†ä¸»é›†åˆèˆ‡å­é›†åˆ
â€¢	æ‰€æœ‰æ™‚é–“æ¬„ä½ä½¿ç”¨ Firestore Timestamp
â€¢	æ‰€æœ‰ module éƒ½å¿…é ˆç¶­è­· backward compatibility
________________________________________
2. Naming Conventions
å®šç¾©å‘½åè¦å‰‡ï¼ˆéå¸¸é‡è¦ï¼‰
Collections: lowercase_with_underscores
Documents: autoId æˆ– meaningfulId
Fields: camelCase
Timestamps: createdAt, updatedAt
User Reference: userId
Ledger Reference: ledgerId
________________________________________
3. Global Rules
é©ç”¨æ–¼æ•´å€‹è³‡æ–™åº«çš„ schema è¦å‰‡ï¼š
â€¢	æ‰€æœ‰ document å¿…é ˆåŒ…å« createdAt
â€¢	æ‰€æœ‰å¯ä¿®æ”¹ document å¿…é ˆåŒ…å« updatedAt
â€¢	status æ¬„ä½å¿…é ˆç‚º enumï¼šactive / archived / deleted
â€¢	Boolean ä¸€å¾‹ä½¿ç”¨ true / false
â€¢	é¿å… nullï¼ˆä½¿ç”¨ç©ºå­—ä¸²ã€ç©ºç‰©ä»¶ã€ç©ºé™£åˆ—ï¼‰
________________________________________
4. Collections Schema
ä»¥ä¸‹ç‚ºä¸»æ¨¡æ¿ï¼Œä½ åªè¦è¤‡è£½ sectionsï¼Œä¾ç…§è‡ªå·±å°ˆæ¡ˆæ›¿æ›ã€‚
________________________________________
ğŸ”¹ 4.1 Collection: users
Document ID
UIDï¼ˆä¾†è‡ª Firebase Authï¼‰
Fields
Field	Type	Required	Description	Constraints
displayName	string	optional	é¡¯ç¤ºåç¨±	max 50 chars
email	string	required	Email	unique
userType	string	required	M/S/J	enum
timezone	string	optional	User timezone	default: Asia/Taipei
linkedAccounts	object	optional	è·¨å¹³å°å¸³è™Ÿ	LINE/iOS/Android
settings	object	optional	ä½¿ç”¨è€…è¨­å®š	see below
status	string	required	User status	enum: active/suspended/deleted
createdAt	timestamp	required	å‰µå»ºæ™‚é–“	
updatedAt	timestamp	required	æ›´æ–°æ™‚é–“	
Substructures
settings:
settings: {
  notifications: boolean,
  language: string
}
________________________________________
ğŸ”¹ 4.2 Collection: ledgers
Document ID
ledgerIdï¼ˆautoId æˆ– customï¼‰
Fields
Field	Type	Required	Description	Constraints
name	string	required	å¸³æœ¬åç¨±	max 50 chars
owner	string	required	owner userId	must exist
type	string	required	å¸³æœ¬é¡å‹	enum
status	string	required	active/archived	
settings	object	optional	å¸³æœ¬è¨­å®š	
createdAt	timestamp	required		
updatedAt	timestamp	required		
Subcollections
Subcollection	Description
wallets	å¸³æˆ¶åˆ—è¡¨
categories	ç§‘ç›®åˆ—è¡¨
budgets	é ç®—è¨­å®š
________________________________________
ğŸ”¹ 4.3 Subcollection Template
Collection: ledgers/{ledgerId}/wallets
Fields
Field	Type	Required	Description
id	string	required	å¸³æˆ¶ ID
name	string	required	å¸³æˆ¶åç¨±
type	string	required	cash/bank/card
balance	number	required	å¸³æˆ¶é¤˜é¡
userId	string	required	æ‰€å±¬ç”¨æˆ¶
status	string	required	active/inactive
createdAt	timestamp	required	å»ºç«‹æ™‚é–“
updatedAt	timestamp	required	æ›´æ–°æ™‚é–“
________________________________________
5. Relations
æè¿°é›†åˆèˆ‡é›†åˆçš„é—œè¯ï¼š
â€¢	users.uid â†’ ledgers.owner
â€¢	ledgers.ledgerId â†’ budgets.ledgerId
â€¢	ledgers.ledgerId â†’ collaborations.ledgerId
â€¢	collaborations.members.userId â†’ users.uid
æ ¼å¼ï¼š
users (1) â€” (many) ledgers  
ledgers (1) â€” (many) wallets  
ledgers (1) â€” (many) categories
________________________________________
6. Validation Rules
ä½ å¯ä»¥åŠ ï¼š
â€¢	Firestore Security Rules
â€¢	Cloud Functions validation
â€¢	å‹åˆ¥å®šç¾©ï¼ˆä¾‹å¦‚ TypeScript interfacesï¼‰
________________________________________
7. Lifecycle
æè¿°æ¯å€‹è³‡æ–™ç‹€æ…‹çš„ç”Ÿå‘½é€±æœŸï¼Œå¦‚ï¼š
active â†’ archived â†’ deleted
________________________________________
8. Indexes
è¨˜éŒ„ Firestore Indexï¼ˆé‡è¦ï¼‰
collaborations:
  - ledgerId ASC, userId ASC
ledgers:
  - owner ASC, status ASC
________________________________________
9. Versioning
è¨˜éŒ„æ¯æ¬¡ schema æ”¹å‹•ï¼š

